(()=>{var exports={};exports.id=974,exports.ids=[974],exports.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4198:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.InternalChannel=void 0;let d=c(46401),e=c(71902),f=c(34891),g=c(34979),h=c(74216),i=c(88474),j=c(21314),k=c(98675),l=c(49152),m=c(15982),n=c(30999),o=c(13678),p=c(16050),q=c(48888),r=c(47989),s=c(88523),t=c(20407),u=c(88174),v=c(78484),w=c(36454),x=0x7fffffff,y=1e3,z=18e5,A=new Map,B=0x1000000,C=1048576;class D extends w.BaseSubchannelWrapper{constructor(a,b){super(a),this.channel=b,this.refCount=0,this.subchannelStateListener=(a,c,d,e)=>{b.throttleKeepalive(e)},a.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}}class E{constructor(a,b,c){var q,r,s,t,w,E,F,G;if(this.credentials=b,this.options=c,this.connectivityState=o.ConnectivityState.IDLE,this.currentPicker=new g.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new p.ChannelzCallTracker,this.childrenTracker=new p.ChannelzChildrenTracker,"string"!=typeof a)throw TypeError("Channel target must be a string");if(!(b instanceof d.ChannelCredentials))throw TypeError("Channel credentials must be a ChannelCredentials object");if(c&&"object"!=typeof c)throw TypeError("Channel options must be an object");this.originalTarget=a;let H=(0,n.parseUri)(a);if(null===H)throw Error(`Could not parse target name "${a}"`);let I=(0,k.mapUriDefaultScheme)(H);if(null===I)throw Error(`Could not find a default scheme for target name "${a}"`);this.callRefTimer=setInterval(()=>{},x),null==(r=(q=this.callRefTimer).unref)||r.call(q),0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new p.ChannelzTrace,this.channelzRef=(0,p.registerChannelzChannel)(a,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,k.getDefaultAuthority)(I);let J=(0,m.mapProxyName)(I,c);this.target=J.target,this.options=Object.assign({},this.options,J.extraOptions),this.subchannelPool=(0,f.getSubchannelPool)((null!=(s=c["grpc.use_local_subchannel_pool"])?s:0)===0),this.retryBufferTracker=new v.MessageBufferTracker(null!=(t=c["grpc.retry_buffer_size"])?t:B,null!=(w=c["grpc.per_rpc_retry_buffer_size"])?w:C),this.keepaliveTime=null!=(E=c["grpc.keepalive_time_ms"])?E:-1,this.idleTimeoutMs=Math.max(null!=(F=c["grpc.client_idle_timeout_ms"])?F:z,y);let K={createSubchannel:(a,b)=>{let c=this.subchannelPool.getOrCreateSubchannel(this.target,a,Object.assign({},this.options,b),this.credentials);c.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",c.getChannelzRef());let d=new D(c,this);return this.wrappedSubchannels.add(d),d},updateState:(a,b)=>{this.currentPicker=b;let c=this.pickQueue.slice();for(let a of(this.pickQueue=[],c.length>0&&this.callRefTimerUnref(),c))a.doPick();this.updateState(a)},requestReresolution:()=>{throw Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:a=>{this.channelzEnabled&&this.childrenTracker.refChild(a)},removeChannelzChild:a=>{this.channelzEnabled&&this.childrenTracker.unrefChild(a)}};this.resolvingLoadBalancer=new e.ResolvingLoadBalancer(this.target,K,c,(a,b)=>{a.retryThrottling?A.set(this.getTarget(),new v.RetryThrottler(a.retryThrottling.maxTokens,a.retryThrottling.tokenRatio,A.get(this.getTarget()))):A.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=b,this.currentResolutionError=null,process.nextTick(()=>{let a=this.configSelectionQueue;for(let b of(this.configSelectionQueue=[],a.length>0&&this.callRefTimerUnref(),a))b.getConfig()})},a=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+a.code+' and details "'+a.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),null===this.configSelector&&(this.currentResolutionError=Object.assign(Object.assign({},(0,u.restrictControlPlaneStatusCode)(a.code,a.details)),{metadata:a.metadata}));let b=this.configSelectionQueue;for(let c of(this.configSelectionQueue=[],b.length>0&&this.callRefTimerUnref(),b))c.reportResolverError(a)}),this.filterStackFactory=new i.FilterStackFactory([new j.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(c,void 0,2));let L=Error();(0,l.trace)(h.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+") Channel constructed \n"+(null==(G=L.stack)?void 0:G.substring(L.stack.indexOf("\n")+1))),this.lastActivityTimestamp=new Date}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(a,b){(0,l.trace)(null!=b?b:h.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,n.uriToString)(this.target)+" "+a)}callRefTimerRef(){var a,b,c,d;(null==(b=(a=this.callRefTimer).hasRef)?void 0:b.call(a))||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null==(d=(c=this.callRefTimer).ref)||d.call(c))}callRefTimerUnref(){var a,b;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null==(b=(a=this.callRefTimer).unref)||b.call(a))}removeConnectivityStateWatcher(a){let b=this.connectivityStateWatchers.findIndex(b=>b===a);b>=0&&this.connectivityStateWatchers.splice(b,1)}updateState(a){for(let b of((0,l.trace)(h.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,n.uriToString)(this.target)+" "+o.ConnectivityState[this.connectivityState]+" -> "+o.ConnectivityState[a]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+o.ConnectivityState[a]),this.connectivityState=a,this.connectivityStateWatchers.slice()))a!==b.currentState&&(b.timer&&clearTimeout(b.timer),this.removeConnectivityStateWatcher(b),b.callback());a!==o.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(a){if(a>this.keepaliveTime)for(let b of(this.keepaliveTime=a,this.wrappedSubchannels))b.throttleKeepalive(a)}removeWrappedSubchannel(a){this.wrappedSubchannels.delete(a)}doPick(a,b){return this.currentPicker.pick({metadata:a,extraPickInfo:b})}queueCallForPick(a){this.pickQueue.push(a),this.callRefTimerRef()}getConfig(a,b){return(this.resolvingLoadBalancer.exitIdle(),this.configSelector)?{type:"SUCCESS",config:this.configSelector(a,b)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(a){this.configSelectionQueue.push(a),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(o.ConnectivityState.IDLE),this.currentPicker=new g.QueuePicker(this.resolvingLoadBalancer),this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}startIdleTimeout(a){var b,c;this.idleTimer=setTimeout(()=>{if(this.callCount>0)return void this.startIdleTimeout(this.idleTimeoutMs);let a=new Date().valueOf()-this.lastActivityTimestamp.valueOf();a>=this.idleTimeoutMs?(this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()):this.startIdleTimeout(this.idleTimeoutMs-a)},a),null==(c=(b=this.idleTimer).unref)||c.call(b)}maybeStartIdleTimer(){this.connectivityState===o.ConnectivityState.SHUTDOWN||this.idleTimer||this.startIdleTimeout(this.idleTimeoutMs)}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1}onCallEnd(a){this.channelzEnabled&&(a.code===h.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()}createLoadBalancingCall(a,b,c,d,e){let f=(0,t.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+f+'] method="'+b+'"'),new q.LoadBalancingCall(this,a,b,c,d,e,f)}createRetryingCall(a,b,c,d,e){let f=(0,t.getNextCallNumber)();return this.trace("createRetryingCall ["+f+'] method="'+b+'"'),new v.RetryingCall(this,a,b,c,d,e,f,this.retryBufferTracker,A.get(this.getTarget()))}createInnerCall(a,b,c,d,e){return 0===this.options["grpc.enable_retries"]?this.createLoadBalancingCall(a,b,c,d,e):this.createRetryingCall(a,b,c,d,e)}createResolvingCall(a,b,c,d,e){let f=(0,t.getNextCallNumber)();this.trace("createResolvingCall ["+f+'] method="'+a+'", deadline='+(0,r.deadlineToString)(b));let g={deadline:b,flags:null!=e?e:h.Propagate.DEFAULTS,host:null!=c?c:this.defaultAuthority,parentCall:d},i=new s.ResolvingCall(this,a,g,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),f);return this.onCallStart(),i.addStatusWatcher(a=>{this.onCallEnd(a)}),i}close(){this.resolvingLoadBalancer.destroy(),this.updateState(o.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,p.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,n.uriToString)(this.target)}getConnectivityState(a){let b=this.connectivityState;return a&&(this.resolvingLoadBalancer.exitIdle(),this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()),b}watchConnectivityState(a,b,c){if(this.connectivityState===o.ConnectivityState.SHUTDOWN)throw Error("Channel has been shut down");let d=null;if(b!==1/0){let a=b instanceof Date?b:new Date(b),f=new Date;if(b===-1/0||a<=f)return void process.nextTick(c,Error("Deadline passed without connectivity state change"));d=setTimeout(()=>{this.removeConnectivityStateWatcher(e),c(Error("Deadline passed without connectivity state change"))},a.getTime()-f.getTime())}let e={currentState:a,callback:c,timer:d};this.connectivityStateWatchers.push(e)}getChannelzRef(){return this.channelzRef}createCall(a,b,c,d,e){if("string"!=typeof a)throw TypeError("Channel#createCall: method must be a string");if(!("number"==typeof b||b instanceof Date))throw TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===o.ConnectivityState.SHUTDOWN)throw Error("Channel has been shut down");return this.createResolvingCall(a,b,c,d,e)}}b.InternalChannel=E},4369:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ServerCredentials=void 0;let d=c(28460);class e{static createInsecure(){return new f}static createSsl(a,b,c=!1){if(null!==a&&!Buffer.isBuffer(a))throw TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(b))throw TypeError("keyCertPairs must be an array");if("boolean"!=typeof c)throw TypeError("checkClientCertificate must be a boolean");let e=[],f=[];for(let a=0;a<b.length;a++){let c=b[a];if(null===c||"object"!=typeof c)throw TypeError(`keyCertPair[${a}] must be an object`);if(!Buffer.isBuffer(c.private_key))throw TypeError(`keyCertPair[${a}].private_key must be a Buffer`);if(!Buffer.isBuffer(c.cert_chain))throw TypeError(`keyCertPair[${a}].cert_chain must be a Buffer`);e.push(c.cert_chain),f.push(c.private_key)}return new g({ca:a||(0,d.getDefaultRootsData)()||void 0,cert:e,key:f,requestCert:c,ciphers:d.CIPHER_SUITES})}}b.ServerCredentials=e;class f extends e{_isSecure(){return!1}_getSettings(){return null}}class g extends e{constructor(a){super(),this.options=a}_isSecure(){return!0}_getSettings(){return this.options}}},4721:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Http2SubchannelCall=void 0;let d=c(73496),e=c(21820),f=c(74216),g=c(39316),h=c(77508),i=c(49152),j=c(74216),k="subchannel_call";function l(a){for(let[b,c]of Object.entries(e.constants.errno))if(c===a)return b;return"Unknown system error "+a}class m{constructor(a,b,c,e,i){var j;this.http2Stream=a,this.callEventTracker=b,this.listener=c,this.transport=e,this.callId=i,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=f.Status.UNKNOWN,this.finalStatus=null,this.internalError=null;let k=null!=(j=e.getOptions()["grpc.max_receive_message_length"])?j:f.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;this.decoder=new h.StreamDecoder(k),a.on("response",(a,b)=>{let c="";for(let b of Object.keys(a))c+="		"+b+": "+a[b]+"\n";switch(this.trace("Received server headers:\n"+c),a[":status"]){case 400:this.mappedStatusCode=f.Status.INTERNAL;break;case 401:this.mappedStatusCode=f.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=f.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=f.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=f.Status.UNAVAILABLE;break;default:this.mappedStatusCode=f.Status.UNKNOWN}if(b&d.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(a);else{let b;try{b=g.Metadata.fromHttp2Headers(a)}catch(a){this.endCall({code:f.Status.UNKNOWN,details:a.message,metadata:new g.Metadata});return}this.listener.onReceiveMetadata(b)}}),a.on("trailers",a=>{this.handleTrailers(a)}),a.on("data",a=>{let b;if(!this.statusOutput){this.trace("receive HTTP/2 data frame of length "+a.length);try{b=this.decoder.write(a)}catch(a){this.cancelWithStatus(f.Status.RESOURCE_EXHAUSTED,a.message);return}for(let a of b)this.trace("parsed message of length "+a.length),this.callEventTracker.addMessageReceived(),this.tryPush(a)}}),a.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),a.on("close",()=>{process.nextTick(()=>{var b;let c;if(this.trace("HTTP/2 stream closed with code "+a.rstCode),(null==(b=this.finalStatus)?void 0:b.code)===f.Status.OK)return;let e="";switch(a.rstCode){case d.constants.NGHTTP2_NO_ERROR:if(null!==this.finalStatus)return;c=f.Status.INTERNAL,e=`Received RST_STREAM with code ${a.rstCode}`;break;case d.constants.NGHTTP2_REFUSED_STREAM:c=f.Status.UNAVAILABLE,e="Stream refused by server";break;case d.constants.NGHTTP2_CANCEL:c=f.Status.CANCELLED,e="Call cancelled";break;case d.constants.NGHTTP2_ENHANCE_YOUR_CALM:c=f.Status.RESOURCE_EXHAUSTED,e="Bandwidth exhausted or memory limit exceeded";break;case d.constants.NGHTTP2_INADEQUATE_SECURITY:c=f.Status.PERMISSION_DENIED,e="Protocol not secure enough";break;case d.constants.NGHTTP2_INTERNAL_ERROR:c=f.Status.INTERNAL,null===this.internalError?e=`Received RST_STREAM with code ${a.rstCode} (Internal server error)`:"ECONNRESET"===this.internalError.code||"ETIMEDOUT"===this.internalError.code?(c=f.Status.UNAVAILABLE,e=this.internalError.message):e=`Received RST_STREAM with code ${a.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:c=f.Status.INTERNAL,e=`Received RST_STREAM with code ${a.rstCode}`}this.endCall({code:c,details:e,metadata:new g.Metadata,rstCode:a.rstCode})})}),a.on("error",a=>{"ERR_HTTP2_STREAM_ERROR"!==a.code&&(this.trace("Node error event: message="+a.message+" code="+a.code+" errno="+l(a.errno)+" syscall="+a.syscall),this.internalError=a),this.callEventTracker.onStreamEnd(!1)})}onDisconnect(){this.endCall({code:f.Status.UNAVAILABLE,details:"Connection dropped",metadata:new g.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(a){i.trace(j.LogVerbosity.DEBUG,k,"["+this.callId+"] "+a)}endCall(a){(null===this.finalStatus||this.finalStatus.code===f.Status.OK)&&(this.finalStatus=a,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){null===this.finalStatus||this.finalStatus.code===f.Status.OK&&(!this.readsClosed||0!==this.unpushedReadMessages.length||this.isReadFilterPending||this.isPushPending)||this.outputStatus()}push(a){this.trace("pushing to reader message of length "+(a instanceof Buffer?a.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,this.statusOutput||(this.listener.onReceiveMessage(a),this.maybeOutputStatus())})}tryPush(a){this.canPush?(this.http2Stream.pause(),this.push(a)):(this.trace("unpushedReadMessages.push message of length "+a.length),this.unpushedReadMessages.push(a))}handleTrailers(a){let b;this.callEventTracker.onStreamEnd(!0);let c="";for(let b of Object.keys(a))c+="		"+b+": "+a[b]+"\n";this.trace("Received server trailers:\n"+c);try{b=g.Metadata.fromHttp2Headers(a)}catch(a){b=new g.Metadata}let d=b.getMap(),e=this.mappedStatusCode;if(e===f.Status.UNKNOWN&&"string"==typeof d["grpc-status"]){let a=Number(d["grpc-status"]);a in f.Status&&(e=a,this.trace("received status code "+a+" from server")),b.remove("grpc-status")}let h="";if("string"==typeof d["grpc-message"]){try{h=decodeURI(d["grpc-message"])}catch(a){h=d["grpc-message"]}b.remove("grpc-message"),this.trace('received status details string "'+h+'" from server')}let i={code:e,details:h,metadata:b};this.endCall(i)}destroyHttp2Stream(){var a;if(!this.http2Stream.destroyed){let b;b=(null==(a=this.finalStatus)?void 0:a.code)===f.Status.OK?d.constants.NGHTTP2_NO_ERROR:d.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+b),this.http2Stream.close(b)}}cancelWithStatus(a,b){this.trace("cancelWithStatus code: "+a+' details: "'+b+'"'),this.endCall({code:a,details:b,metadata:new g.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(null!==this.finalStatus&&this.finalStatus.code!==f.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let a=this.unpushedReadMessages.shift();this.push(a);return}this.http2Stream.resume()}sendMessageWithContext(a,b){this.trace("write() called with message of length "+b.length);let c=b=>{process.nextTick(()=>{var c;let d=f.Status.UNAVAILABLE;(null==b?void 0:b.code)==="ERR_STREAM_WRITE_AFTER_END"&&(d=f.Status.INTERNAL),b&&this.cancelWithStatus(d,`Write error: ${b.message}`),null==(c=a.callback)||c.call(a)})};this.trace("sending data chunk of length "+b.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(b,c)}catch(a){this.endCall({code:f.Status.UNAVAILABLE,details:`Write failed with error ${a.message}`,metadata:new g.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}}b.Http2SubchannelCall=m},4755:(a,b,c)=>{"use strict";a.exports=e;var d=c(60054);function e(a){if(a)for(var b=Object.keys(a),c=0;c<b.length;++c)this[b[c]]=a[b[c]]}e.create=function(a){return this.$type.create(a)},e.encode=function(a,b){return this.$type.encode(a,b)},e.encodeDelimited=function(a,b){return this.$type.encodeDelimited(a,b)},e.decode=function(a){return this.$type.decode(a)},e.decodeDelimited=function(a){return this.$type.decodeDelimited(a)},e.verify=function(a){return this.$type.verify(a)},e.fromObject=function(a){return this.$type.fromObject(a)},e.toObject=function(a,b){return this.$type.toObject(a,b)},e.prototype.toJSON=function(){return this.$type.toObject(this,d.toJSONOptions)}},6620:(a,b,c)=>{"use strict";a.exports=i;var d=c(27791),e=c(90290);function f(a,b){return a.name+": "+b+(a.repeated&&"array"!==b?"[]":a.map&&"object"!==b?"{k:"+a.keyType+"}":"")+" expected"}function g(a,b,c,e){if(b.resolvedType)if(b.resolvedType instanceof d){a("switch(%s){",e)("default:")("return%j",f(b,"enum value"));for(var g=Object.keys(b.resolvedType.values),h=0;h<g.length;++h)a("case %i:",b.resolvedType.values[g[h]]);a("break")("}")}else a("{")("var e=types[%i].verify(%s);",c,e)("if(e)")("return%j+e",b.name+".")("}");else switch(b.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":a("if(!util.isInteger(%s))",e)("return%j",f(b,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":a("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",e,e,e,e)("return%j",f(b,"integer|Long"));break;case"float":case"double":a('if(typeof %s!=="number")',e)("return%j",f(b,"number"));break;case"bool":a('if(typeof %s!=="boolean")',e)("return%j",f(b,"boolean"));break;case"string":a("if(!util.isString(%s))",e)("return%j",f(b,"string"));break;case"bytes":a('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',e,e,e)("return%j",f(b,"buffer"))}return a}function h(a,b,c){switch(b.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":a("if(!util.key32Re.test(%s))",c)("return%j",f(b,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":a("if(!util.key64Re.test(%s))",c)("return%j",f(b,"integer|Long key"));break;case"bool":a("if(!util.key2Re.test(%s))",c)("return%j",f(b,"boolean key"))}return a}function i(a){var b=e.codegen(["m"],a.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),c=a.oneofsArray,d={};c.length&&b("var p={}");for(var i=0;i<a.fieldsArray.length;++i){var j=a._fieldsArray[i].resolve(),k="m"+e.safeProp(j.name);if(j.optional&&b("if(%s!=null&&m.hasOwnProperty(%j)){",k,j.name),j.map)b("if(!util.isObject(%s))",k)("return%j",f(j,"object"))("var k=Object.keys(%s)",k)("for(var i=0;i<k.length;++i){"),h(b,j,"k[i]"),g(b,j,i,k+"[k[i]]")("}");else if(j.repeated)b("if(!Array.isArray(%s))",k)("return%j",f(j,"array"))("for(var i=0;i<%s.length;++i){",k),g(b,j,i,k+"[i]")("}");else{if(j.partOf){var l=e.safeProp(j.partOf.name);1===d[j.partOf.name]&&b("if(p%s===1)",l)("return%j",j.partOf.name+": multiple values"),d[j.partOf.name]=1,b("p%s=1",l)}g(b,j,i,k)}j.optional&&b("}")}return b("return null")}},6775:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.BaseFilter=void 0;class c{async sendMetadata(a){return a}receiveMetadata(a){return a}async sendMessage(a){return a}async receiveMessage(a){return a}receiveTrailers(a){return a}}b.BaseFilter=c},6792:(a,b,c)=>{"use strict";var d=b,e=c(27791),f=c(90290);function g(a,b,c,d){var f=!1;if(b.resolvedType)if(b.resolvedType instanceof e){a("switch(d%s){",d);for(var g=b.resolvedType.values,h=Object.keys(g),i=0;i<h.length;++i)g[h[i]]!==b.typeDefault||f||(a("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',d,d,d),b.repeated||a("break"),f=!0),a("case%j:",h[i])("case %i:",g[h[i]])("m%s=%j",d,g[h[i]])("break");a("}")}else a('if(typeof d%s!=="object")',d)("throw TypeError(%j)",b.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",d,c,d);else{var j=!1;switch(b.type){case"double":case"float":a("m%s=Number(d%s)",d,d);break;case"uint32":case"fixed32":a("m%s=d%s>>>0",d,d);break;case"int32":case"sint32":case"sfixed32":a("m%s=d%s|0",d,d);break;case"uint64":j=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":a("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",d,d,j)('else if(typeof d%s==="string")',d)("m%s=parseInt(d%s,10)",d,d)('else if(typeof d%s==="number")',d)("m%s=d%s",d,d)('else if(typeof d%s==="object")',d)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",d,d,d,j?"true":"");break;case"bytes":a('if(typeof d%s==="string")',d)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",d,d,d)("else if(d%s.length >= 0)",d)("m%s=d%s",d,d);break;case"string":a("m%s=String(d%s)",d,d);break;case"bool":a("m%s=Boolean(d%s)",d,d)}}return a}function h(a,b,c,d){if(b.resolvedType)b.resolvedType instanceof e?a("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",d,c,d,d,c,d,d):a("d%s=types[%i].toObject(m%s,o)",d,c,d);else{var f=!1;switch(b.type){case"double":case"float":a("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",d,d,d,d);break;case"uint64":f=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":a('if(typeof m%s==="number")',d)("d%s=o.longs===String?String(m%s):m%s",d,d,d)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",d,d,d,d,f?"true":"",d);break;case"bytes":a("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",d,d,d,d,d);break;default:a("d%s=m%s",d,d)}}return a}d.fromObject=function(a){var b=a.fieldsArray,c=f.codegen(["d"],a.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!b.length)return c("return new this.ctor");c("var m=new this.ctor");for(var d=0;d<b.length;++d){var h=b[d].resolve(),i=f.safeProp(h.name);h.map?(c("if(d%s){",i)('if(typeof d%s!=="object")',i)("throw TypeError(%j)",h.fullName+": object expected")("m%s={}",i)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",i),g(c,h,d,i+"[ks[i]]")("}")("}")):h.repeated?(c("if(d%s){",i)("if(!Array.isArray(d%s))",i)("throw TypeError(%j)",h.fullName+": array expected")("m%s=[]",i)("for(var i=0;i<d%s.length;++i){",i),g(c,h,d,i+"[i]")("}")("}")):(h.resolvedType instanceof e||c("if(d%s!=null){",i),g(c,h,d,i),h.resolvedType instanceof e||c("}"))}return c("return m")},d.toObject=function(a){var b=a.fieldsArray.slice().sort(f.compareFieldsById);if(!b.length)return f.codegen()("return {}");for(var c=f.codegen(["m","o"],a.name+"$toObject")("if(!o)")("o={}")("var d={}"),d=[],g=[],i=[],j=0;j<b.length;++j)b[j].partOf||(b[j].resolve().repeated?d:b[j].map?g:i).push(b[j]);if(d.length){for(c("if(o.arrays||o.defaults){"),j=0;j<d.length;++j)c("d%s=[]",f.safeProp(d[j].name));c("}")}if(g.length){for(c("if(o.objects||o.defaults){"),j=0;j<g.length;++j)c("d%s={}",f.safeProp(g[j].name));c("}")}if(i.length){for(c("if(o.defaults){"),j=0;j<i.length;++j){var k=i[j],l=f.safeProp(k.name);if(k.resolvedType instanceof e)c("d%s=o.enums===String?%j:%j",l,k.resolvedType.valuesById[k.typeDefault],k.typeDefault);else if(k.long)c("if(util.Long){")("var n=new util.Long(%i,%i,%j)",k.typeDefault.low,k.typeDefault.high,k.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",l)("}else")("d%s=o.longs===String?%j:%i",l,k.typeDefault.toString(),k.typeDefault.toNumber());else if(k.bytes){var m="["+Array.prototype.slice.call(k.typeDefault).join(",")+"]";c("if(o.bytes===String)d%s=%j",l,String.fromCharCode.apply(String,k.typeDefault))("else{")("d%s=%s",l,m)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",l,l)("}")}else c("d%s=%j",l,k.typeDefault)}c("}")}var n=!1;for(j=0;j<b.length;++j){var k=b[j],o=a._fieldsArray.indexOf(k),l=f.safeProp(k.name);k.map?(n||(n=!0,c("var ks2")),c("if(m%s&&(ks2=Object.keys(m%s)).length){",l,l)("d%s={}",l)("for(var j=0;j<ks2.length;++j){"),h(c,k,o,l+"[ks2[j]]")("}")):k.repeated?(c("if(m%s&&m%s.length){",l,l)("d%s=[]",l)("for(var j=0;j<m%s.length;++j){",l),h(c,k,o,l+"[j]")("}")):(c("if(m%s!=null&&m.hasOwnProperty(%j)){",l,k.name),h(c,k,o,l),k.partOf&&c("if(o.oneofs)")("d%s=%j",f.safeProp(k.partOf.name),k.name)),c("}")}return c("return d")}},9054:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ChildLoadBalancerHandler=void 0;let d=c(64432),e=c(13678),f="child_load_balancer_helper";class g{constructor(a){this.channelControlHelper=a,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(a){this.parent=a,this.child=null}createSubchannel(a,b){return this.parent.channelControlHelper.createSubchannel(a,b)}updateState(a,b){var c;if(this.calledByPendingChild()){if(a===e.ConnectivityState.CONNECTING)return;null==(c=this.parent.currentChild)||c.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(a,b)}requestReresolution(){var a;let b=null!=(a=this.parent.pendingChild)?a:this.parent.currentChild;this.child===b&&this.parent.channelControlHelper.requestReresolution()}setChild(a){this.child=a}addChannelzChild(a){this.parent.channelControlHelper.addChannelzChild(a)}removeChannelzChild(a){this.parent.channelControlHelper.removeChannelzChild(a)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(a,b){return a.getLoadBalancerName()!==b.getLoadBalancerName()}updateAddressList(a,b,c){let e;if(null===this.currentChild||null===this.latestConfig||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,b)){let a=new this.ChildPolicyHelper(this),c=(0,d.createLoadBalancer)(b,a);a.setChild(c),null===this.currentChild?(this.currentChild=c,e=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=c,e=this.pendingChild)}else e=null===this.pendingChild?this.currentChild:this.pendingChild;this.latestConfig=b,e.updateAddressList(a,b,c)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return f}}b.ChildLoadBalancerHandler=g},9259:(a,b,c)=>{"use strict";a.exports=y,y.filename=null,y.defaults={keepCase:!1};var d=c(76043),e=c(31502),f=c(68134),g=c(99408),h=c(49316),i=c(67369),j=c(27791),k=c(25811),l=c(23455),m=c(72481),n=c(18657),o=c(90290),p=/^[1-9][0-9]*$/,q=/^-?[1-9][0-9]*$/,r=/^0[x][0-9a-fA-F]+$/,s=/^-?0[x][0-9a-fA-F]+$/,t=/^0[0-7]+$/,u=/^-?0[0-7]+$/,v=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,w=/^[a-zA-Z_][a-zA-Z_0-9]*$/,x=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/;function y(a,b,c){b instanceof e||(c=b,b=new e),c||(c=y.defaults);var z,A,B,C,D=c.preferTrailingComment||!1,E=d(a,c.alternateCommentMode||!1),F=E.next,G=E.push,H=E.peek,I=E.skip,J=E.cmnt,K=!0,L="proto2",M=b,N=[],O={},P=c.keepCase?function(a){return a}:o.camelCase;function Q(){N.forEach(a=>{a._edition=L,Object.keys(O).forEach(b=>{void 0===a.getOption(b)&&a.setOption(b,O[b],!0)})})}function R(a,b,c){var d=y.filename;return c||(y.filename=null),Error("illegal "+(b||"token")+" '"+a+"' ("+(d?d+", ":"")+"line "+E.line+")")}function S(){var a,b=[];do{if('"'!==(a=F())&&"'"!==a)throw R(a);b.push(F()),I(a),a=H()}while('"'===a||"'"===a);return b.join("")}function T(a){var b=F();switch(b){case"'":case'"':return G(b),S();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return V(b,!0)}catch(c){if(a&&x.test(b))return b;throw R(b,"value")}}function U(a,b){do if(b&&('"'===(c=H())||"'"===c)){var c,d,e=S();if(a.push(e),L>=2023)throw R(e,"id")}else try{a.push([d=W(F()),I("to",!0)?W(F()):d])}catch(d){if(b&&x.test(c)&&L>=2023)a.push(c);else throw d}while(I(",",!0));var f={options:void 0};f.setOption=function(a,b){void 0===this.options&&(this.options={}),this.options[a]=b},aa(f,function(a){if("option"===a)ai(f,a),I(";");else throw R(a)},function(){am(f)})}function V(a,b){var c=1;switch("-"===a.charAt(0)&&(c=-1,a=a.substring(1)),a){case"inf":case"INF":case"Inf":return 1/0*c;case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(p.test(a))return c*parseInt(a,10);if(r.test(a))return c*parseInt(a,16);if(t.test(a))return c*parseInt(a,8);if(v.test(a))return c*parseFloat(a);throw R(a,"number",b)}function W(a,b){switch(a){case"max":case"MAX":case"Max":return 0x1fffffff;case"0":return 0}if(!b&&"-"===a.charAt(0))throw R(a,"id");if(q.test(a))return parseInt(a,10);if(s.test(a))return parseInt(a,16);if(u.test(a))return parseInt(a,8);throw R(a,"id")}function X(){if(void 0!==A)throw R("package");if(A=F(),!x.test(A))throw R(A,"name");M=M.define(A),I(";")}function Y(){var a,b=H();switch(b){case"weak":a=C||(C=[]),F();break;case"public":F();default:a=B||(B=[])}b=S(),I(";"),a.push(b)}function Z(){if(I("="),(L=S())<2023)throw R(L,"syntax");I(";")}function $(){if(I("="),!["2023"].includes(L=S()))throw R(L,"edition");I(";")}function _(a,b){switch(b){case"option":return ai(a,b),I(";"),!0;case"message":return ab(a,b),!0;case"enum":return ag(a,b),!0;case"service":return an(a,b),!0;case"extend":return ap(a,b),!0}return!1}function aa(a,b,c){var d,e=E.line;if(a&&("string"!=typeof a.comment&&(a.comment=J()),a.filename=y.filename),I("{",!0)){for(;"}"!==(d=F());)b(d);I(";",!0)}else c&&c(),I(";"),a&&("string"!=typeof a.comment||D)&&(a.comment=J(e)||a.comment)}function ab(a,b){if(!w.test(b=F()))throw R(b,"type name");var c=new f(b);aa(c,function(a){if(!_(c,a))switch(a){case"map":ae(c,a);break;case"required":if("proto2"!==L)throw R(a);case"repeated":ac(c,a);break;case"optional":if("proto3"===L)ac(c,"proto3_optional");else if("proto2"!==L)throw R(a);else ac(c,"optional");break;case"oneof":af(c,a);break;case"extensions":U(c.extensions||(c.extensions=[]));break;case"reserved":U(c.reserved||(c.reserved=[]),!0);break;default:if("proto2"===L||!x.test(a))throw R(a);G(a),ac(c,"optional")}}),a.add(c),a===M&&N.push(c)}function ac(a,b,c){var d=F();if("group"===d)return void ad(a,b);for(;d.endsWith(".")||H().startsWith(".");)d+=F();if(!x.test(d))throw R(d,"type");var e=F();if(!w.test(e))throw R(e,"name");e=P(e),I("=");var f=new g(e,W(F()),d,b,c);if(aa(f,function(a){if("option"===a)ai(f,a),I(";");else throw R(a)},function(){am(f)}),"proto3_optional"===b){var h=new i("_"+e);f.setOption("proto3_optional",!0),h.add(f),a.add(h)}else a.add(f);a===M&&N.push(f)}function ad(a,b){if(L>=2023)throw R("group");var c=F();if(!w.test(c))throw R(c,"name");var d=o.lcFirst(c);c===d&&(c=o.ucFirst(c)),I("=");var e=W(F()),h=new f(c);h.group=!0;var i=new g(d,e,c,b);i.filename=y.filename,aa(h,function(a){switch(a){case"option":ai(h,a),I(";");break;case"required":case"repeated":ac(h,a);break;case"optional":"proto3"===L?ac(h,"proto3_optional"):ac(h,"optional");break;case"message":ab(h,a);break;case"enum":ag(h,a);break;case"reserved":U(h.reserved||(h.reserved=[]),!0);break;default:throw R(a)}}),a.add(h).add(i)}function ae(a){I("<");var b=F();if(void 0===n.mapKey[b])throw R(b,"type");I(",");var c=F();if(!x.test(c))throw R(c,"type");I(">");var d=F();if(!w.test(d))throw R(d,"name");I("=");var e=new h(P(d),W(F()),b,c);aa(e,function(a){if("option"===a)ai(e,a),I(";");else throw R(a)},function(){am(e)}),a.add(e)}function af(a,b){if(!w.test(b=F()))throw R(b,"name");var c=new i(P(b));aa(c,function(a){"option"===a?(ai(c,a),I(";")):(G(a),ac(c,"optional"))}),a.add(c)}function ag(a,b){if(!w.test(b=F()))throw R(b,"name");var c=new j(b);aa(c,function(a){switch(a){case"option":ai(c,a),I(";");break;case"reserved":U(c.reserved||(c.reserved=[]),!0),void 0===c.reserved&&(c.reserved=[]);break;default:ah(c,a)}}),a.add(c),a===M&&N.push(c)}function ah(a,b){if(!w.test(b))throw R(b,"name");I("=");var c=W(F(),!0),d={options:void 0};d.getOption=function(a){return this.options[a]},d.setOption=function(a,b){m.prototype.setOption.call(d,a,b)},d.setParsedOption=function(){},aa(d,function(a){if("option"===a)ai(d,a),I(";");else throw R(a)},function(){am(d)}),a.add(b,c,d.comment,d.parsedOptions||d.options)}function ai(a,b){var c,d,e=!0;for("option"===b&&(b=F());"="!==b;){if("("===b){var f=F();I(")"),b="("+f+")"}if(e){if(e=!1,b.includes(".")&&!b.includes("(")){var g=b.split(".");c=g[0]+".",b=g[1];continue}c=b}else d=d?d+=b:b;b=F()}var h=aj(a,d?c.concat(d):c);d=d&&"."===d[0]?d.slice(1):d,al(a,c=c&&"."===c[c.length-1]?c.slice(0,-1):c,h,d)}function aj(a,b){if(I("{",!0)){for(var c={};!I("}",!0);){if(!w.test(z=F()))throw R(z,"name");if(null===z)throw R(z,"end of input");var d,e,f=z;if(I(":",!0),"{"===H())d=aj(a,b+"."+z);else if("["===H()){if(d=[],I("[",!0)){do e=T(!0),d.push(e);while(I(",",!0));I("]"),void 0!==e&&ak(a,b+"."+z,e)}}else d=T(!0),ak(a,b+"."+z,d);var g=c[f];g&&(d=[].concat(g).concat(d)),c[f]=d,I(",",!0),I(";",!0)}return c}var h=T(!0);return ak(a,b,h),h}function ak(a,b,c){if(M===a&&/^features\./.test(b)){O[b]=c;return}a.setOption&&a.setOption(b,c)}function al(a,b,c,d){a.setParsedOption&&a.setParsedOption(b,c,d)}function am(a){if(I("[",!0)){do ai(a,"option");while(I(",",!0));I("]")}return a}function an(a,b){if(!w.test(b=F()))throw R(b,"service name");var c=new k(b);aa(c,function(a){if(!_(c,a))if("rpc"===a)ao(c,a);else throw R(a)}),a.add(c),a===M&&N.push(c)}function ao(a,b){var c=J(),d=b;if(!w.test(b=F()))throw R(b,"name");var e,f,g,h,i=b;if(I("("),I("stream",!0)&&(f=!0),!x.test(b=F())||(e=b,I(")"),I("returns"),I("("),I("stream",!0)&&(h=!0),!x.test(b=F())))throw R(b);g=b,I(")");var j=new l(i,d,e,g,f,h);j.comment=c,aa(j,function(a){if("option"===a)ai(j,a),I(";");else throw R(a)}),a.add(j)}function ap(a,b){if(!x.test(b=F()))throw R(b,"reference");var c=b;aa(null,function(b){switch(b){case"required":case"repeated":ac(a,b,c);break;case"optional":"proto3"===L?ac(a,"proto3_optional",c):ac(a,"optional",c);break;default:if("proto2"===L||!x.test(b))throw R(b);G(b),ac(a,"optional",c)}})}for(;null!==(z=F());)switch(z){case"package":if(!K)throw R(z);X();break;case"import":if(!K)throw R(z);Y();break;case"syntax":if(!K)throw R(z);Z();break;case"edition":if(!K)throw R(z);$();break;case"option":ai(M,z),I(";",!0);break;default:if(_(M,z)){K=!1;continue}throw R(z)}return Q(),y.filename=null,{package:A,imports:B,weakImports:C,root:b}}},9827:(a,b,c)=>{"use strict";var d;Object.defineProperty(b,"__esModule",{value:!0}),b.setup=b.OutlierDetectionLoadBalancer=b.OutlierDetectionLoadBalancingConfig=void 0;let e=c(13678),f=c(74216),g=c(60649),h=c(80275),i=c(64432),j=c(9054),k=c(34979),l=c(41509),m=c(36454),n=c(49152),o="outlier_detection";function p(a){n.trace(f.LogVerbosity.DEBUG,o,a)}let q="outlier_detection",r=(null!=(d=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)?d:"true")==="true",s={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},t={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function u(a,b,c,d){if(b in a&&typeof a[b]!==c){let e=d?`${d}.${b}`:b;throw Error(`outlier detection config ${e} parse error: expected ${c}, got ${typeof a[b]}`)}}function v(a,b,c){let d=c?`${c}.${b}`:b;if(b in a){if(!(0,g.isDuration)(a[b]))throw Error(`outlier detection config ${d} parse error: expected Duration, got ${typeof a[b]}`);if(!(a[b].seconds>=0&&a[b].seconds<=315576e6&&a[b].nanos>=0&&a[b].nanos<=0x3b9ac9ff))throw Error(`outlier detection config ${d} parse error: values out of range for non-negative Duaration`)}}function w(a,b,c){let d=c?`${c}.${b}`:b;if(u(a,b,"number",c),b in a&&!(a[b]>=0&&a[b]<=100))throw Error(`outlier detection config ${d} parse error: value out of range for percentage (0-100)`)}class x{constructor(a,b,c,d,e,f,g){if(this.childPolicy=g,g.length>0&&"pick_first"===g[0].getLoadBalancerName())throw Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=null!=a?a:1e4,this.baseEjectionTimeMs=null!=b?b:3e4,this.maxEjectionTimeMs=null!=c?c:3e5,this.maxEjectionPercent=null!=d?d:10,this.successRateEjection=e?Object.assign(Object.assign({},s),e):null,this.failurePercentageEjection=f?Object.assign(Object.assign({},t),f):null}getLoadBalancerName(){return q}toJsonObject(){return{interval:(0,g.msToDuration)(this.intervalMs),base_ejection_time:(0,g.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,g.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(a=>a.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(a){return new x(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,a)}static createFromJson(a){var b;if(v(a,"interval"),v(a,"base_ejection_time"),v(a,"max_ejection_time"),w(a,"max_ejection_percent"),"success_rate_ejection"in a){if("object"!=typeof a.success_rate_ejection)throw Error("outlier detection config success_rate_ejection must be an object");u(a.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),w(a.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),u(a.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),u(a.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in a){if("object"!=typeof a.failure_percentage_ejection)throw Error("outlier detection config failure_percentage_ejection must be an object");w(a.failure_percentage_ejection,"threshold","failure_percentage_ejection"),w(a.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),u(a.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),u(a.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new x(a.interval?(0,g.durationToMs)(a.interval):null,a.base_ejection_time?(0,g.durationToMs)(a.base_ejection_time):null,a.max_ejection_time?(0,g.durationToMs)(a.max_ejection_time):null,null!=(b=a.max_ejection_percent)?b:null,a.success_rate_ejection,a.failure_percentage_ejection,a.child_policy.map(i.validateLoadBalancingConfig))}}b.OutlierDetectionLoadBalancingConfig=x;class y extends m.BaseSubchannelWrapper{constructor(a,b){super(a),this.mapEntry=b,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=a.getConnectivityState(),a.addConnectivityStateListener((a,b,c,d)=>{if(this.childSubchannelState=c,!this.ejected)for(let a of this.stateListeners)a(this,b,c,d)})}getConnectivityState(){return this.ejected?e.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(a){this.stateListeners.push(a)}removeConnectivityStateListener(a){let b=this.stateListeners.indexOf(a);b>-1&&this.stateListeners.splice(b,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let a=this.mapEntry.subchannelWrappers.indexOf(this);a>=0&&this.mapEntry.subchannelWrappers.splice(a,1)}}eject(){for(let a of(this.ejected=!0,this.stateListeners))a(this,this.childSubchannelState,e.ConnectivityState.TRANSIENT_FAILURE,-1)}uneject(){for(let a of(this.ejected=!1,this.stateListeners))a(this,e.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState,-1)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}}function z(){return{success:0,failure:0}}class A{constructor(){this.activeBucket=z(),this.inactiveBucket=z()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=z()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}}class B{constructor(a,b){this.wrappedPicker=a,this.countCalls=b}pick(a){let b=this.wrappedPicker.pick(a);if(b.pickResultType!==k.PickResultType.COMPLETE)return b;{let a=b.subchannel,c=a.getMapEntry();if(!c)return Object.assign(Object.assign({},b),{subchannel:a.getWrappedSubchannel()});{let d=b.onCallEnded;return this.countCalls&&(d=a=>{var d;a===f.Status.OK?c.counter.addSuccess():c.counter.addFailure(),null==(d=b.onCallEnded)||d.call(b,a)}),Object.assign(Object.assign({},b),{subchannel:a.getWrappedSubchannel(),onCallEnded:d})}}}}class C{constructor(a){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new j.ChildLoadBalancerHandler((0,h.createChildChannelControlHelper)(a,{createSubchannel:(b,c)=>{let d=a.createSubchannel(b,c),e=this.addressMap.get((0,l.subchannelAddressToString)(b)),f=new y(d,e);return(null==e?void 0:e.currentEjectionTimestamp)!==null&&f.eject(),null==e||e.subchannelWrappers.push(f),f},updateState:(b,c)=>{b===e.ConnectivityState.READY?a.updateState(b,new B(c,this.isCountingEnabled())):a.updateState(b,c)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return null!==this.latestConfig&&(null!==this.latestConfig.getSuccessRateEjectionConfig()||null!==this.latestConfig.getFailurePercentageEjectionConfig())}getCurrentEjectionPercent(){let a=0;for(let b of this.addressMap.values())null!==b.currentEjectionTimestamp&&(a+=1);return 100*a/this.addressMap.size}runSuccessRateCheck(a){if(!this.latestConfig)return;let b=this.latestConfig.getSuccessRateEjectionConfig();if(!b)return;p("Running success rate check");let c=b.request_volume,d=0,e=[];for(let[a,b]of this.addressMap){let f=b.counter.getLastSuccesses(),g=b.counter.getLastFailures();p("Stats for "+a+": successes="+f+" failures="+g+" targetRequestVolume="+c),f+g>=c&&(d+=1,e.push(f/(f+g)))}if(p("Found "+d+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+e+"]"),d<b.minimum_hosts)return;let f=e.reduce((a,b)=>a+b)/e.length,g=0;for(let a of e){let b=a-f;g+=b*b}let h=Math.sqrt(g/e.length),i=f-h*(b.stdev_factor/1e3);for(let[d,e]of(p("stdev="+h+" ejectionThreshold="+i),this.addressMap.entries())){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let f=e.counter.getLastSuccesses(),g=e.counter.getLastFailures();if(f+g<c)continue;let h=f/(f+g);if(p("Checking candidate "+d+" successRate="+h),h<i){let c=100*Math.random();p("Candidate "+d+" randomNumber="+c+" enforcement_percentage="+b.enforcement_percentage),c<b.enforcement_percentage&&(p("Ejecting candidate "+d),this.eject(e,a))}}}runFailurePercentageCheck(a){if(!this.latestConfig)return;let b=this.latestConfig.getFailurePercentageEjectionConfig();if(!b)return;p("Running failure percentage check. threshold="+b.threshold+" request volume threshold="+b.request_volume);let c=0;for(let a of this.addressMap.values())a.counter.getLastSuccesses()+a.counter.getLastFailures()>=b.request_volume&&(c+=1);if(!(c<b.minimum_hosts))for(let[c,d]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let e=d.counter.getLastSuccesses(),f=d.counter.getLastFailures();if((p("Candidate successes="+e+" failures="+f),!(e+f<b.request_volume))&&100*f/(f+e)>b.threshold){let e=100*Math.random();p("Candidate "+c+" randomNumber="+e+" enforcement_percentage="+b.enforcement_percentage),e<b.enforcement_percentage&&(p("Ejecting candidate "+c),this.eject(d,a))}}}eject(a,b){for(let b of(a.currentEjectionTimestamp=new Date,a.ejectionTimeMultiplier+=1,a.subchannelWrappers))b.eject()}uneject(a){for(let b of(a.currentEjectionTimestamp=null,a.subchannelWrappers))b.uneject()}switchAllBuckets(){for(let a of this.addressMap.values())a.counter.switchBuckets()}startTimer(a){var b,c;this.ejectionTimer=setTimeout(()=>this.runChecks(),a),null==(c=(b=this.ejectionTimer).unref)||c.call(b)}runChecks(){let a=new Date;if(p("Ejection timer running"),this.switchAllBuckets(),this.latestConfig)for(let[b,c]of(this.timerStartTime=a,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(a),this.runFailurePercentageCheck(a),this.addressMap.entries()))if(null===c.currentEjectionTimestamp)c.ejectionTimeMultiplier>0&&(c.ejectionTimeMultiplier-=1);else{let a=this.latestConfig.getBaseEjectionTimeMs(),d=this.latestConfig.getMaxEjectionTimeMs(),e=new Date(c.currentEjectionTimestamp.getTime());e.setMilliseconds(e.getMilliseconds()+Math.min(a*c.ejectionTimeMultiplier,Math.max(a,d))),e<new Date&&(p("Unejecting "+b),this.uneject(c))}}updateAddressList(a,b,c){if(!(b instanceof x))return;let d=new Set;for(let b of a)d.add((0,l.subchannelAddressToString)(b));for(let a of d)this.addressMap.has(a)||(p("Adding map entry for "+a),this.addressMap.set(a,{counter:new A,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let a of this.addressMap.keys())d.has(a)||(p("Removing map entry for "+a),this.addressMap.delete(a));let e=(0,i.getFirstUsableConfig)(b.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(a,e,c),b.getSuccessRateEjectionConfig()||b.getFailurePercentageEjectionConfig())if(this.timerStartTime){p("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let a=b.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(a)}else p("Starting new timer"),this.timerStartTime=new Date,this.startTimer(b.getIntervalMs()),this.switchAllBuckets();else for(let a of(p("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer),this.addressMap.values()))this.uneject(a),a.ejectionTimeMultiplier=0;this.latestConfig=b}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return q}}b.OutlierDetectionLoadBalancer=C,b.setup=function(){r&&(0,h.registerLoadBalancerType)(q,C,x)}},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13678:(a,b)=>{"use strict";var c;Object.defineProperty(b,"__esModule",{value:!0}),b.ConnectivityState=void 0,function(a){a[a.IDLE=0]="IDLE",a[a.CONNECTING=1]="CONNECTING",a[a.READY=2]="READY",a[a.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",a[a.SHUTDOWN=4]="SHUTDOWN"}(c||(b.ConnectivityState=c={}))},14985:a=>{"use strict";a.exports=require("dns")},15982:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.getProxiedConnection=b.mapProxyName=void 0;let d=c(49152),e=c(74216),f=c(98675),g=c(81630),h=c(34631),i=c(49152),j=c(41509),k=c(30999),l=c(79551),m=c(19109),n="proxy";function o(a){i.trace(e.LogVerbosity.DEBUG,n,a)}function p(){let a,b="",c="";if(process.env.grpc_proxy)c="grpc_proxy",b=process.env.grpc_proxy;else if(process.env.https_proxy)c="https_proxy",b=process.env.https_proxy;else{if(!process.env.http_proxy)return{};c="http_proxy",b=process.env.http_proxy}try{a=new l.URL(b)}catch(a){return(0,d.log)(e.LogVerbosity.ERROR,`cannot parse value of "${c}" env var`),{}}if("http:"!==a.protocol)return(0,d.log)(e.LogVerbosity.ERROR,`"${a.protocol}" scheme not supported in proxy URI`),{};let f=null;a.username&&(a.password?((0,d.log)(e.LogVerbosity.INFO,"userinfo found in proxy URI"),f=`${a.username}:${a.password}`):f=a.username);let g=a.hostname,h=a.port;""===h&&(h="80");let i={address:`${g}:${h}`};return f&&(i.creds=f),o("Proxy server "+i.address+" set by environment variable "+c),i}function q(){let a=process.env.no_grpc_proxy,b="no_grpc_proxy";return(a||(a=process.env.no_proxy,b="no_proxy"),a)?(o("No proxy server list set by environment variable "+b),a.split(",")):[]}b.mapProxyName=function(a,b){var c;let d={target:a,extraOptions:{}};if((null!=(c=b["grpc.enable_http_proxy"])?c:1)===0||"unix"===a.scheme)return d;let e=p();if(!e.address)return d;let f=(0,k.splitHostPort)(a.path);if(!f)return d;let g=f.host;for(let b of q())if(b===g)return o("Not using proxy for target in no_proxy list: "+(0,k.uriToString)(a)),d;let h={"grpc.http_connect_target":(0,k.uriToString)(a)};return e.creds&&(h["grpc.http_connect_creds"]=e.creds),{target:{scheme:"dns",path:e.address},extraOptions:h}},b.getProxiedConnection=function(a,b,c){var i;if(!("grpc.http_connect_target"in b))return Promise.resolve({});let l=b["grpc.http_connect_target"],n=(0,k.parseUri)(l);if(null===n)return Promise.resolve({});let p=(0,k.splitHostPort)(n.path);if(null===p)return Promise.resolve({});let q=`${p.host}:${null!=(i=p.port)?i:m.DEFAULT_PORT}`,r={method:"CONNECT",path:q},s={Host:q};(0,j.isTcpSubchannelAddress)(a)?(r.host=a.host,r.port=a.port):r.socketPath=a.path,"grpc.http_connect_creds"in b&&(s["Proxy-Authorization"]="Basic "+Buffer.from(b["grpc.http_connect_creds"]).toString("base64")),r.headers=s;let t=(0,j.subchannelAddressToString)(a);return o("Using proxy "+t+" to connect to "+r.path),new Promise((a,b)=>{let i=g.request(r);i.once("connect",(g,j,l)=>{var m;if(i.removeAllListeners(),j.removeAllListeners(),200===g.statusCode)if(o("Successfully connected to "+r.path+" through proxy "+t),"secureContext"in c){let d=(0,f.getDefaultAuthority)(n),e=(0,k.splitHostPort)(d),g=null!=(m=null==e?void 0:e.host)?m:d,i=h.connect(Object.assign({host:g,servername:g,socket:j},c),()=>{o("Successfully established a TLS connection to "+r.path+" through proxy "+t),a({socket:i,realTarget:n})});i.on("error",a=>{o("Failed to establish a TLS connection to "+r.path+" through proxy "+t+" with error "+a.message),b()})}else o("Successfully established a plaintext connection to "+r.path+" through proxy "+t),a({socket:j,realTarget:n});else(0,d.log)(e.LogVerbosity.ERROR,"Failed to connect to "+r.path+" through proxy "+t+" with status "+g.statusCode),b()}),i.once("error",a=>{i.removeAllListeners(),(0,d.log)(e.LogVerbosity.ERROR,"Failed to connect to proxy "+t+" with error "+a.message),b()}),i.end()})}},16050:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.setup=b.getChannelzServiceDefinition=b.getChannelzHandlers=b.unregisterChannelzRef=b.registerChannelzSocket=b.registerChannelzServer=b.registerChannelzSubchannel=b.registerChannelzChannel=b.ChannelzCallTracker=b.ChannelzChildrenTracker=b.ChannelzTrace=void 0;let d=c(91645),e=c(13678),f=c(74216),g=c(41509),h=c(72342),i=c(93131);function j(a){return{channel_id:a.id,name:a.name}}function k(a){return{subchannel_id:a.id,name:a.name}}function l(a){return{server_id:a.id}}function m(a){return{socket_id:a.id,name:a.name}}let n=32;class o{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(a,b,c){let d=new Date;this.events.push({description:b,severity:a,timestamp:d,childChannel:(null==c?void 0:c.kind)==="channel"?c:void 0,childSubchannel:(null==c?void 0:c.kind)==="subchannel"?c:void 0}),this.events.length>=2*n&&(this.events=this.events.slice(n)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:B(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(a=>({description:a.description,severity:a.severity,timestamp:B(a.timestamp),channel_ref:a.childChannel?j(a.childChannel):null,subchannel_ref:a.childSubchannel?k(a.childSubchannel):null}))}}}b.ChannelzTrace=o;class p{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(a){var b,c,d;switch(a.kind){case"channel":{let c=null!=(b=this.channelChildren.get(a.id))?b:{ref:a,count:0};c.count+=1,this.channelChildren.set(a.id,c);break}case"subchannel":{let b=null!=(c=this.subchannelChildren.get(a.id))?c:{ref:a,count:0};b.count+=1,this.subchannelChildren.set(a.id,b);break}case"socket":{let b=null!=(d=this.socketChildren.get(a.id))?d:{ref:a,count:0};b.count+=1,this.socketChildren.set(a.id,b)}}}unrefChild(a){switch(a.kind){case"channel":{let b=this.channelChildren.get(a.id);void 0!==b&&(b.count-=1,0===b.count?this.channelChildren.delete(a.id):this.channelChildren.set(a.id,b));break}case"subchannel":{let b=this.subchannelChildren.get(a.id);void 0!==b&&(b.count-=1,0===b.count?this.subchannelChildren.delete(a.id):this.subchannelChildren.set(a.id,b));break}case"socket":{let b=this.socketChildren.get(a.id);void 0!==b&&(b.count-=1,0===b.count?this.socketChildren.delete(a.id):this.socketChildren.set(a.id,b))}}}getChildLists(){let a=[];for(let{ref:b}of this.channelChildren.values())a.push(b);let b=[];for(let{ref:a}of this.subchannelChildren.values())b.push(a);let c=[];for(let{ref:a}of this.socketChildren.values())c.push(a);return{channels:a,subchannels:b,sockets:c}}}b.ChannelzChildrenTracker=p;class q{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}}b.ChannelzCallTracker=q;let r=1;function s(){return r++}let t=[],u=[],v=[],w=[];function x(a){let b=Number.parseInt(a,16);return[b/256|0,b%256]}function y(a){return""===a?[]:[].concat(...a.split(":").map(a=>x(a)))}function z(a){if((0,d.isIPv4)(a))return Buffer.from(Uint8Array.from(a.split(".").map(a=>Number.parseInt(a))));if(!(0,d.isIPv6)(a))return null;{let b,c,d=a.indexOf("::");-1===d?(b=a,c=""):(b=a.substring(0,d),c=a.substring(d+2));let e=Buffer.from(y(b)),f=Buffer.from(y(c)),g=Buffer.alloc(16-e.length-f.length,0);return Buffer.concat([e,g,f])}}function A(a){switch(a){case e.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case e.ConnectivityState.IDLE:return{state:"IDLE"};case e.ConnectivityState.READY:return{state:"READY"};case e.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case e.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function B(a){if(!a)return null;let b=a.getTime();return{seconds:b/1e3|0,nanos:b%1e3*1e6}}function C(a){let b=a.getInfo();return{ref:j(a.ref),data:{target:b.target,state:A(b.state),calls_started:b.callTracker.callsStarted,calls_succeeded:b.callTracker.callsSucceeded,calls_failed:b.callTracker.callsFailed,last_call_started_timestamp:B(b.callTracker.lastCallStartedTimestamp),trace:b.trace.getTraceMessage()},channel_ref:b.children.channels.map(a=>j(a)),subchannel_ref:b.children.subchannels.map(a=>k(a))}}function D(a,b){let c=Number.parseInt(a.request.channel_id),d=t[c];if(void 0===d)return void b({code:f.Status.NOT_FOUND,details:"No channel data found for id "+c});b(null,{channel:C(d)})}function E(a,b){let c=Number.parseInt(a.request.max_results),d=[],e=Number.parseInt(a.request.start_channel_id);for(;e<t.length;e++){let a=t[e];if(void 0!==a&&(d.push(C(a)),d.length>=c))break}b(null,{channel:d,end:e>=v.length})}function F(a){let b=a.getInfo();return{ref:l(a.ref),data:{calls_started:b.callTracker.callsStarted,calls_succeeded:b.callTracker.callsSucceeded,calls_failed:b.callTracker.callsFailed,last_call_started_timestamp:B(b.callTracker.lastCallStartedTimestamp),trace:b.trace.getTraceMessage()},listen_socket:b.listenerChildren.sockets.map(a=>m(a))}}function G(a,b){let c=Number.parseInt(a.request.server_id),d=v[c];if(void 0===d)return void b({code:f.Status.NOT_FOUND,details:"No server data found for id "+c});b(null,{server:F(d)})}function H(a,b){let c=Number.parseInt(a.request.max_results),d=[],e=Number.parseInt(a.request.start_server_id);for(;e<v.length;e++){let a=v[e];if(void 0!==a&&(d.push(F(a)),d.length>=c))break}b(null,{server:d,end:e>=v.length})}function I(a,b){let c=Number.parseInt(a.request.subchannel_id),d=u[c];if(void 0===d)return void b({code:f.Status.NOT_FOUND,details:"No subchannel data found for id "+c});let e=d.getInfo();b(null,{subchannel:{ref:k(d.ref),data:{target:e.target,state:A(e.state),calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:B(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},socket_ref:e.children.sockets.map(a=>m(a))}})}function J(a){var b;return(0,g.isTcpSubchannelAddress)(a)?{address:"tcpip_address",tcpip_address:{ip_address:null!=(b=z(a.host))?b:void 0,port:a.port}}:{address:"uds_address",uds_address:{filename:a.path}}}function K(a,b){var c,d,e,g,h;let i=Number.parseInt(a.request.socket_id),j=w[i];if(void 0===j)return void b({code:f.Status.NOT_FOUND,details:"No socket data found for id "+i});let k=j.getInfo(),l=k.security?{model:"tls",tls:{cipher_suite:k.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:null!=(c=k.security.cipherSuiteStandardName)?c:void 0,other_name:null!=(d=k.security.cipherSuiteOtherName)?d:void 0,local_certificate:null!=(e=k.security.localCertificate)?e:void 0,remote_certificate:null!=(g=k.security.remoteCertificate)?g:void 0}}:null;b(null,{socket:{ref:m(j.ref),local:k.localAddress?J(k.localAddress):null,remote:k.remoteAddress?J(k.remoteAddress):null,remote_name:null!=(h=k.remoteName)?h:void 0,security:l,data:{keep_alives_sent:k.keepAlivesSent,streams_started:k.streamsStarted,streams_succeeded:k.streamsSucceeded,streams_failed:k.streamsFailed,last_local_stream_created_timestamp:B(k.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:B(k.lastRemoteStreamCreatedTimestamp),messages_received:k.messagesReceived,messages_sent:k.messagesSent,last_message_received_timestamp:B(k.lastMessageReceivedTimestamp),last_message_sent_timestamp:B(k.lastMessageSentTimestamp),local_flow_control_window:k.localFlowControlWindow?{value:k.localFlowControlWindow}:null,remote_flow_control_window:k.remoteFlowControlWindow?{value:k.remoteFlowControlWindow}:null}}})}function L(a,b){let c=Number.parseInt(a.request.server_id),d=v[c];if(void 0===d)return void b({code:f.Status.NOT_FOUND,details:"No server data found for id "+c});let e=Number.parseInt(a.request.start_socket_id),g=Number.parseInt(a.request.max_results),h=d.getInfo().sessionChildren.sockets.sort((a,b)=>a.id-b.id),i=[],j=0;for(;j<h.length&&(!(h[j].id>=e)||(i.push(m(h[j])),!(i.length>=g)));j++);b(null,{socket_ref:i,end:j>=h.length})}function M(){return{GetChannel:D,GetTopChannels:E,GetServer:G,GetServers:H,GetSubchannel:I,GetSocket:K,GetServerSockets:L}}b.registerChannelzChannel=function(a,b,c){let d=s(),e={id:d,name:a,kind:"channel"};return c&&(t[d]={ref:e,getInfo:b}),e},b.registerChannelzSubchannel=function(a,b,c){let d=s(),e={id:d,name:a,kind:"subchannel"};return c&&(u[d]={ref:e,getInfo:b}),e},b.registerChannelzServer=function(a,b){let c=s(),d={id:c,kind:"server"};return b&&(v[c]={ref:d,getInfo:a}),d},b.registerChannelzSocket=function(a,b,c){let d=s(),e={id:d,name:a,kind:"socket"};return c&&(w[d]={ref:e,getInfo:b}),e},b.unregisterChannelzRef=function(a){switch(a.kind){case"channel":delete t[a.id];return;case"subchannel":delete u[a.id];return;case"server":delete v[a.id];return;case"socket":delete w[a.id];return}},b.getChannelzHandlers=M;let N=null;function O(){if(N)return N;let a=(0,c(47372).Yi)("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]});return N=(0,i.loadPackageDefinition)(a).grpc.channelz.v1.Channelz.service}b.getChannelzServiceDefinition=O,b.setup=function(){(0,h.registerAdminService)(O,M)}},16452:a=>{var b=1/0,c="[object Symbol]",d=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,e=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,f="\ud800-\udfff",g="\\u0300-\\u036f\\ufe20-\\ufe23",h="\\u20d0-\\u20f0",i="\\u2700-\\u27bf",j="a-z\\xdf-\\xf6\\xf8-\\xff",k="A-Z\\xc0-\\xd6\\xd8-\\xde",l="\\ufe0e\\ufe0f",m="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",n="[']",o="["+f+"]",p="["+m+"]",q="["+g+h+"]",r="\\d+",s="["+i+"]",t="["+j+"]",u="[^"+f+m+r+i+j+k+"]",v="\ud83c[\udffb-\udfff]",w="[^"+f+"]",x="(?:\ud83c[\udde6-\uddff]){2}",y="[\ud800-\udbff][\udc00-\udfff]",z="["+k+"]",A="\\u200d",B="(?:"+t+"|"+u+")",C="(?:"+z+"|"+u+")",D="(?:"+n+"(?:d|ll|m|re|s|t|ve))?",E="(?:"+n+"(?:D|LL|M|RE|S|T|VE))?",F="(?:"+q+"|"+v+")?",G="["+l+"]?",H="(?:"+A+"(?:"+[w,x,y].join("|")+")"+G+F+")*",I=G+F+H,J="(?:"+[s,x,y].join("|")+")"+I,K="(?:"+[w+q+"?",q,x,y,o].join("|")+")",L=RegExp(n,"g"),M=RegExp(q,"g"),N=RegExp(v+"(?="+v+")|"+K+I,"g"),O=RegExp([z+"?"+t+"+"+D+"(?="+[p,z,"$"].join("|")+")",C+"+"+E+"(?="+[p,z+B,"$"].join("|")+")",z+"?"+B+"+"+D,z+"+"+E,r,J].join("|"),"g"),P=RegExp("["+A+f+g+h+l+"]"),Q=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,R={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"ss"},S="object"==typeof global&&global&&global.Object===Object&&global,T="object"==typeof self&&self&&self.Object===Object&&self,U=S||T||Function("return this")();function V(a,b,c,d){var e=-1,f=a?a.length:0;for(d&&f&&(c=a[++e]);++e<f;)c=b(c,a[e],e,a);return c}function W(a){return a.split("")}function X(a){return a.match(d)||[]}var Y=function(a){return function(b){return null==a?void 0:a[b]}}(R);function Z(a){return P.test(a)}function $(a){return Q.test(a)}function _(a){return Z(a)?aa(a):W(a)}function aa(a){return a.match(N)||[]}function ab(a){return a.match(O)||[]}var ac=Object.prototype.toString,ad=U.Symbol,ae=ad?ad.prototype:void 0,af=ae?ae.toString:void 0;function ag(a,b,c){var d=-1,e=a.length;b<0&&(b=-b>e?0:e+b),(c=c>e?e:c)<0&&(c+=e),e=b>c?0:c-b>>>0,b>>>=0;for(var f=Array(e);++d<e;)f[d]=a[d+b];return f}function ah(a){if("string"==typeof a)return a;if(al(a))return af?af.call(a):"";var c=a+"";return"0"==c&&1/a==-b?"-0":c}function ai(a,b,c){var d=a.length;return c=void 0===c?d:c,!b&&c>=d?a:ag(a,b,c)}function aj(a){return function(b){var c=Z(b=am(b))?_(b):void 0,d=c?c[0]:b.charAt(0),e=c?ai(c,1).join(""):b.slice(1);return d[a]()+e}}function ak(a){return!!a&&"object"==typeof a}function al(a){return"symbol"==typeof a||ak(a)&&ac.call(a)==c}function am(a){return null==a?"":ah(a)}var an=function(a){return function(b){return V(ar(ap(b).replace(L,"")),a,"")}}(function(a,b,c){return b=b.toLowerCase(),a+(c?ao(b):b)});function ao(a){return aq(am(a).toLowerCase())}function ap(a){return(a=am(a))&&a.replace(e,Y).replace(M,"")}var aq=aj("toUpperCase");function ar(a,b,c){return(a=am(a),void 0===(b=c?void 0:b))?$(a)?ab(a):X(a):a.match(b)||[]}a.exports=an},17273:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ClientDuplexStreamImpl=b.ClientWritableStreamImpl=b.ClientReadableStreamImpl=b.ClientUnaryCallImpl=b.callErrorFromStatus=void 0;let d=c(94735),e=c(27910),f=c(74216);b.callErrorFromStatus=function(a,b){let c=`${a.code} ${f.Status[a.code]}: ${a.details}`,d=Error(c),e=`${d.stack}
for call at
${b}`;return Object.assign(Error(c),a,{stack:e})};class g extends d.EventEmitter{constructor(){super()}cancel(){var a;null==(a=this.call)||a.cancelWithStatus(f.Status.CANCELLED,"Cancelled on client")}getPeer(){var a,b;return null!=(b=null==(a=this.call)?void 0:a.getPeer())?b:"unknown"}}b.ClientUnaryCallImpl=g;class h extends e.Readable{constructor(a){super({objectMode:!0}),this.deserialize=a}cancel(){var a;null==(a=this.call)||a.cancelWithStatus(f.Status.CANCELLED,"Cancelled on client")}getPeer(){var a,b;return null!=(b=null==(a=this.call)?void 0:a.getPeer())?b:"unknown"}_read(a){var b;null==(b=this.call)||b.startRead()}}b.ClientReadableStreamImpl=h;class i extends e.Writable{constructor(a){super({objectMode:!0}),this.serialize=a}cancel(){var a;null==(a=this.call)||a.cancelWithStatus(f.Status.CANCELLED,"Cancelled on client")}getPeer(){var a,b;return null!=(b=null==(a=this.call)?void 0:a.getPeer())?b:"unknown"}_write(a,b,c){var d;let e={callback:c},f=Number(b);Number.isNaN(f)||(e.flags=f),null==(d=this.call)||d.sendMessageWithContext(e,a)}_final(a){var b;null==(b=this.call)||b.halfClose(),a()}}b.ClientWritableStreamImpl=i;class j extends e.Duplex{constructor(a,b){super({objectMode:!0}),this.serialize=a,this.deserialize=b}cancel(){var a;null==(a=this.call)||a.cancelWithStatus(f.Status.CANCELLED,"Cancelled on client")}getPeer(){var a,b;return null!=(b=null==(a=this.call)?void 0:a.getPeer())?b:"unknown"}_read(a){var b;null==(b=this.call)||b.startRead()}_write(a,b,c){var d;let e={callback:c},f=Number(b);Number.isNaN(f)||(e.flags=f),null==(d=this.call)||d.sendMessageWithContext(e,a)}_final(a){var b;null==(b=this.call)||b.halfClose(),a()}}b.ClientDuplexStreamImpl=j},18657:(a,b,c)=>{"use strict";var d=b,e=c(90290),f=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function g(a,b){var c=0,d={};for(b|=0;c<a.length;)d[f[c+b]]=a[c++];return d}d.basic=g([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),d.defaults=g([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",e.emptyArray,null]),d.long=g([0,0,0,1,1],7),d.mapKey=g([0,0,0,5,5,0,0,0,1,1,0,2],2),d.packed=g([1,5,0,0,0,5,5,0,0,0,1,1,0])},19006:(a,b,c)=>{"use strict";var d=b,e=c(4755);d[".google.protobuf.Any"]={fromObject:function(a){if(a&&a["@type"]){var b=a["@type"].substring(a["@type"].lastIndexOf("/")+1),c=this.lookup(b);if(c){var d="."===a["@type"].charAt(0)?a["@type"].slice(1):a["@type"];return -1===d.indexOf("/")&&(d="/"+d),this.create({type_url:d,value:c.encode(c.fromObject(a)).finish()})}}return this.fromObject(a)},toObject:function(a,b){var c="type.googleapis.com/",d="",f="";if(b&&b.json&&a.type_url&&a.value){f=a.type_url.substring(a.type_url.lastIndexOf("/")+1),d=a.type_url.substring(0,a.type_url.lastIndexOf("/")+1);var g=this.lookup(f);g&&(a=g.decode(a.value))}if(!(a instanceof this.ctor)&&a instanceof e){var h=a.$type.toObject(a,b),i="."===a.$type.fullName[0]?a.$type.fullName.slice(1):a.$type.fullName;return""===d&&(d=c),f=d+i,h["@type"]=f,h}return this.toObject(a,b)}}},19109:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.setup=b.DEFAULT_PORT=void 0;let d=c(98675),e=c(14985),f=c(28354),g=c(27885),h=c(74216),i=c(39316),j=c(49152),k=c(74216),l=c(30999),m=c(91645),n=c(54447),o="dns_resolver";function p(a){j.trace(k.LogVerbosity.DEBUG,o,a)}b.DEFAULT_PORT=443;let q=3e4,r=f.promisify(e.resolveTxt),s=f.promisify(e.lookup);function t(...a){let b=[];for(let c=0;c<Math.max.apply(null,a.map(a=>a.length));c++)for(let d of a)c<d.length&&b.push(d[c]);return b}class u{constructor(a,c,d){var e,f,g;this.target=a,this.listener=c,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,p("Resolver constructed for target "+(0,l.uriToString)(a));let j=(0,l.splitHostPort)(a.path);null===j?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,m.isIPv4)(j.host)||(0,m.isIPv6)(j.host)?(this.ipResult=[{host:j.host,port:null!=(e=j.port)?e:b.DEFAULT_PORT}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=j.host,this.port=null!=(f=j.port)?f:b.DEFAULT_PORT),this.percentage=100*Math.random(),1===d["grpc.service_config_disable_resolution"]&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:h.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,l.uriToString)(this.target)}`,metadata:new i.Metadata};let k={initialDelay:d["grpc.initial_reconnect_backoff_ms"],maxDelay:d["grpc.max_reconnect_backoff_ms"]};this.backoff=new n.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},k),this.backoff.unref(),this.minTimeBetweenResolutionsMs=null!=(g=d["grpc.dns_min_time_between_resolutions_ms"])?g:q,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(null!==this.ipResult){this.returnedIpResult||(p("Returning IP address for target "+(0,l.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(null===this.dnsHostname)p("Failed to parse DNS address "+(0,l.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:h.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,l.uriToString)(this.target)}`,metadata:new i.Metadata})}),this.stopNextResolutionTimer();else{if(null!==this.pendingLookupPromise)return;p("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let a=this.dnsHostname;this.pendingLookupPromise=s(a,{all:!0}),this.pendingLookupPromise.then(a=>{if(null===this.pendingLookupPromise)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let b=a.filter(a=>4===a.family),c=a.filter(a=>6===a.family);this.latestLookupResult=t(c,b).map(a=>({host:a.address,port:+this.port}));let d="["+this.latestLookupResult.map(a=>a.host+":"+a.port).join(",")+"]";if(p("Resolved addresses for target "+(0,l.uriToString)(this.target)+": "+d),0===this.latestLookupResult.length)return void this.listener.onError(this.defaultResolutionError);this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},a=>{null!==this.pendingLookupPromise&&(p("Resolution error for target "+(0,l.uriToString)(this.target)+": "+a.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&null===this.pendingTxtPromise&&(this.pendingTxtPromise=r(a),this.pendingTxtPromise.then(a=>{if(null!==this.pendingTxtPromise){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,g.extractAndSelectServiceConfig)(a,this.percentage)}catch(a){this.latestServiceConfigError={code:h.Status.UNAVAILABLE,details:`Parsing service config failed with error ${a.message}`,metadata:new i.Metadata}}null!==this.latestLookupResult&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},a=>{}))}}startNextResolutionTimer(){var a,b;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=null==(b=(a=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)?void 0:b.call(a),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){null===this.pendingLookupPromise&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){null===this.pendingLookupPromise&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?p('resolution update delayed by "min time between resolutions" rate limit'):p("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(a){return a.path}}b.setup=function(){(0,d.registerResolver)("dns",u),(0,d.registerDefaultScheme)("dns")}},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19609:(a,b,c)=>{"use strict";q={value:!0},q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=q=b.ex=q=q=q=q=q=q=b.OS=b.z3=void 0;let d=c(85842);q={enumerable:!0,get:function(){return d.CallCredentials}};let e=c(58130);q={enumerable:!0,get:function(){return e.ChannelImplementation}};let f=c(62262);q={enumerable:!0,get:function(){return f.CompressionAlgorithms}};let g=c(13678);q={enumerable:!0,get:function(){return g.ConnectivityState}};let h=c(46401);q={enumerable:!0,get:function(){return h.ChannelCredentials}};let i=c(71446);q={enumerable:!0,get:function(){return i.Client}};let j=c(74216);q={enumerable:!0,get:function(){return j.LogVerbosity}},q={enumerable:!0,get:function(){return j.Status}},q={enumerable:!0,get:function(){return j.Propagate}};let k=c(49152),l=c(93131);Object.defineProperty(b,"ex",{enumerable:!0,get:function(){return l.loadPackageDefinition}}),q={enumerable:!0,get:function(){return l.makeClientConstructor}},q={enumerable:!0,get:function(){return l.makeClientConstructor}};let m=c(39316);Object.defineProperty(b,"OS",{enumerable:!0,get:function(){return m.Metadata}});let n=c(93026);q={enumerable:!0,get:function(){return n.Server}};let o=c(4369);q={enumerable:!0,get:function(){return o.ServerCredentials}};let p=c(66565);q={enumerable:!0,get:function(){return p.StatusBuilder}},b.z3={combineChannelCredentials:(a,...b)=>b.reduce((a,b)=>a.compose(b),a),combineCallCredentials:(a,...b)=>b.reduce((a,b)=>a.compose(b),a),createInsecure:h.ChannelCredentials.createInsecure,createSsl:h.ChannelCredentials.createSsl,createFromSecureContext:h.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:d.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:d.CallCredentials.createFromGoogleCredential,createEmpty:d.CallCredentials.createEmpty},q=a=>a.close(),q=(a,b,c)=>a.waitForReady(b,c),q=(a,b)=>{throw Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")},q=(a,b,c)=>{throw Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")},q=a=>{k.setLogger(a)},q=a=>{k.setLoggerVerbosity(a)};var q=a=>i.Client.prototype.getChannel.call(a),r=c(26207);q={enumerable:!0,get:function(){return r.ListenerBuilder}},q={enumerable:!0,get:function(){return r.RequesterBuilder}},q={enumerable:!0,get:function(){return r.InterceptingCall}},q={enumerable:!0,get:function(){return r.InterceptorConfigurationError}};var s=c(16050);q={enumerable:!0,get:function(){return s.getChannelzServiceDefinition}},q={enumerable:!0,get:function(){return s.getChannelzHandlers}};var t=c(72342);q={enumerable:!0,get:function(){return t.addAdminServicesToServer}},q=c(80275);let u=c(19109),v=c(98356),w=c(92217),x=c(91043),y=c(72888),z=c(9827),A=c(16050);(()=>{u.setup(),v.setup(),w.setup(),x.setup(),y.setup(),z.setup(),A.setup()})()},19771:a=>{"use strict";a.exports=require("process")},20407:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.getNextCallNumber=void 0;let c=0;b.getNextCallNumber=function(){return c++}},21314:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.CompressionFilterFactory=b.CompressionFilter=void 0;let d=c(74075),e=c(62262),f=c(74216),g=c(6775),h=c(49152),i=a=>"number"==typeof a&&"string"==typeof e.CompressionAlgorithms[a];class j{async writeMessage(a,b){let c=a;b&&(c=await this.compressMessage(c));let d=Buffer.allocUnsafe(c.length+5);return d.writeUInt8(+!!b,0),d.writeUInt32BE(c.length,1),c.copy(d,5),d}async readMessage(a){let b=1===a.readUInt8(0),c=a.slice(5);return b&&(c=await this.decompressMessage(c)),c}}class k extends j{async compressMessage(a){return a}async writeMessage(a,b){let c=Buffer.allocUnsafe(a.length+5);return c.writeUInt8(0,0),c.writeUInt32BE(a.length,1),a.copy(c,5),c}decompressMessage(a){return Promise.reject(Error('Received compressed message but "grpc-encoding" header was identity'))}}class l extends j{constructor(a){super(),this.maxRecvMessageLength=a}compressMessage(a){return new Promise((b,c)=>{d.deflate(a,(a,d)=>{a?c(a):b(d)})})}decompressMessage(a){return new Promise((b,c)=>{let e=0,g=[],h=d.createInflate();h.on("data",a=>{g.push(a),e+=a.byteLength,-1!==this.maxRecvMessageLength&&e>this.maxRecvMessageLength&&(h.destroy(),c({code:f.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),h.on("end",()=>{b(Buffer.concat(g))}),h.write(a),h.end()})}}class m extends j{constructor(a){super(),this.maxRecvMessageLength=a}compressMessage(a){return new Promise((b,c)=>{d.gzip(a,(a,d)=>{a?c(a):b(d)})})}decompressMessage(a){return new Promise((b,c)=>{let e=0,g=[],h=d.createGunzip();h.on("data",a=>{g.push(a),e+=a.byteLength,-1!==this.maxRecvMessageLength&&e>this.maxRecvMessageLength&&(h.destroy(),c({code:f.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),h.on("end",()=>{b(Buffer.concat(g))}),h.write(a),h.end()})}}class n extends j{constructor(a){super(),this.compressionName=a}compressMessage(a){return Promise.reject(Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(a){return Promise.reject(Error(`Compression method not supported: ${this.compressionName}`))}}function o(a,b){switch(a){case"identity":return new k;case"deflate":return new l(b);case"gzip":return new m(b);default:return new n(a)}}class p extends g.BaseFilter{constructor(a,b){var c,d;super(),this.sharedFilterConfig=b,this.sendCompression=new k,this.receiveCompression=new k,this.currentCompressionAlgorithm="identity";let g=a["grpc.default_compression_algorithm"];if(this.maxReceiveMessageLength=null!=(c=a["grpc.max_receive_message_length"])?c:f.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,void 0!==g)if(i(g)){let a=e.CompressionAlgorithms[g],c=null==(d=b.serverSupportedEncodingHeader)?void 0:d.split(",");(!c||c.includes(a))&&(this.currentCompressionAlgorithm=a,this.sendCompression=o(this.currentCompressionAlgorithm,-1))}else h.log(f.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${g}`)}async sendMetadata(a){let b=await a;return b.set("grpc-accept-encoding","identity,deflate,gzip"),b.set("accept-encoding","identity"),"identity"===this.currentCompressionAlgorithm?b.remove("grpc-encoding"):b.set("grpc-encoding",this.currentCompressionAlgorithm),b}receiveMetadata(a){let b=a.get("grpc-encoding");if(b.length>0){let a=b[0];"string"==typeof a&&(this.receiveCompression=o(a,this.maxReceiveMessageLength))}a.remove("grpc-encoding");let c=a.get("grpc-accept-encoding")[0];return c&&(this.sharedFilterConfig.serverSupportedEncodingHeader=c,c.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new k,this.currentCompressionAlgorithm="identity")),a.remove("grpc-accept-encoding"),a}async sendMessage(a){var b;let c,d=await a;return c=!(this.sendCompression instanceof k)&&((null!=(b=d.flags)?b:0)&2)==0,{message:await this.sendCompression.writeMessage(d.message,c),flags:d.flags}}async receiveMessage(a){return this.receiveCompression.readMessage(await a)}}b.CompressionFilter=p;class q{constructor(a,b){this.options=b,this.sharedFilterConfig={}}createFilter(){return new p(this.options,this.sharedFilterConfig)}}b.CompressionFilterFactory=q},21820:a=>{"use strict";a.exports=require("os")},23455:(a,b,c)=>{"use strict";a.exports=f;var d=c(72481);((f.prototype=Object.create(d.prototype)).constructor=f).className="Method";var e=c(90290);function f(a,b,c,f,g,h,i,j,k){if(e.isObject(g)?(i=g,g=h=void 0):e.isObject(h)&&(i=h,h=void 0),!(void 0===b||e.isString(b)))throw TypeError("type must be a string");if(!e.isString(c))throw TypeError("requestType must be a string");if(!e.isString(f))throw TypeError("responseType must be a string");d.call(this,a,i),this.type=b||"rpc",this.requestType=c,this.requestStream=!!g||void 0,this.responseType=f,this.responseStream=!!h||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=j,this.parsedOptions=k}f.fromJSON=function(a,b){return new f(a,b.type,b.requestType,b.responseType,b.requestStream,b.responseStream,b.options,b.comment,b.parsedOptions)},f.prototype.toJSON=function(a){var b=!!a&&!!a.keepComments;return e.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",b?this.comment:void 0,"parsedOptions",this.parsedOptions])},f.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),d.prototype.resolve.call(this))}},23464:(a,b,c)=>{"use strict";a.exports=h;var d=c(27791),e=c(18657),f=c(90290);function g(a,b,c,d){return b.delimited?a("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",c,d,(b.id<<3|3)>>>0,(b.id<<3|4)>>>0):a("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",c,d,(b.id<<3|2)>>>0)}function h(a){for(var b,c,h=f.codegen(["m","w"],a.name+"$encode")("if(!w)")("w=Writer.create()"),i=a.fieldsArray.slice().sort(f.compareFieldsById),b=0;b<i.length;++b){var j=i[b].resolve(),k=a._fieldsArray.indexOf(j),l=j.resolvedType instanceof d?"int32":j.type,m=e.basic[l];c="m"+f.safeProp(j.name),j.map?(h("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",c,j.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",c)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(j.id<<3|2)>>>0,8|e.mapKey[j.keyType],j.keyType),void 0===m?h("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",k,c):h(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|m,l,c),h("}")("}")):j.repeated?(h("if(%s!=null&&%s.length){",c,c),j.packed&&void 0!==e.packed[l]?h("w.uint32(%i).fork()",(j.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",c)("w.%s(%s[i])",l,c)("w.ldelim()"):(h("for(var i=0;i<%s.length;++i)",c),void 0===m?g(h,j,k,c+"[i]"):h("w.uint32(%i).%s(%s[i])",(j.id<<3|m)>>>0,l,c)),h("}")):(j.optional&&h("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",c,j.name),void 0===m?g(h,j,k,c):h("w.uint32(%i).%s(%s)",(j.id<<3|m)>>>0,l,c))}return h("return w")}},24286:a=>{"use strict";function b(a){return"undefined"!=typeof Float32Array?!function(){var b=new Float32Array([-0]),c=new Uint8Array(b.buffer),d=128===c[3];function e(a,d,e){b[0]=a,d[e]=c[0],d[e+1]=c[1],d[e+2]=c[2],d[e+3]=c[3]}function f(a,d,e){b[0]=a,d[e]=c[3],d[e+1]=c[2],d[e+2]=c[1],d[e+3]=c[0]}function g(a,d){return c[0]=a[d],c[1]=a[d+1],c[2]=a[d+2],c[3]=a[d+3],b[0]}function h(a,d){return c[3]=a[d],c[2]=a[d+1],c[1]=a[d+2],c[0]=a[d+3],b[0]}a.writeFloatLE=d?e:f,a.writeFloatBE=d?f:e,a.readFloatLE=d?g:h,a.readFloatBE=d?h:g}():!function(){function b(a,b,c,d){var e=+(b<0);if(e&&(b=-b),0===b)a(1/b>0?0:0x80000000,c,d);else if(isNaN(b))a(0x7fc00000,c,d);else if(b>34028234663852886e22)a((e<<31|0x7f800000)>>>0,c,d);else if(b<11754943508222875e-54)a((e<<31|Math.round(b/1401298464324817e-60))>>>0,c,d);else{var f=Math.floor(Math.log(b)/Math.LN2),g=8388607&Math.round(b*Math.pow(2,-f)*8388608);a((e<<31|f+127<<23|g)>>>0,c,d)}}function g(a,b,c){var d=a(b,c),e=(d>>31)*2+1,f=d>>>23&255,g=8388607&d;return 255===f?g?NaN:1/0*e:0===f?1401298464324817e-60*e*g:e*Math.pow(2,f-150)*(g+8388608)}a.writeFloatLE=b.bind(null,c),a.writeFloatBE=b.bind(null,d),a.readFloatLE=g.bind(null,e),a.readFloatBE=g.bind(null,f)}(),"undefined"!=typeof Float64Array?!function(){var b=new Float64Array([-0]),c=new Uint8Array(b.buffer),d=128===c[7];function e(a,d,e){b[0]=a,d[e]=c[0],d[e+1]=c[1],d[e+2]=c[2],d[e+3]=c[3],d[e+4]=c[4],d[e+5]=c[5],d[e+6]=c[6],d[e+7]=c[7]}function f(a,d,e){b[0]=a,d[e]=c[7],d[e+1]=c[6],d[e+2]=c[5],d[e+3]=c[4],d[e+4]=c[3],d[e+5]=c[2],d[e+6]=c[1],d[e+7]=c[0]}function g(a,d){return c[0]=a[d],c[1]=a[d+1],c[2]=a[d+2],c[3]=a[d+3],c[4]=a[d+4],c[5]=a[d+5],c[6]=a[d+6],c[7]=a[d+7],b[0]}function h(a,d){return c[7]=a[d],c[6]=a[d+1],c[5]=a[d+2],c[4]=a[d+3],c[3]=a[d+4],c[2]=a[d+5],c[1]=a[d+6],c[0]=a[d+7],b[0]}a.writeDoubleLE=d?e:f,a.writeDoubleBE=d?f:e,a.readDoubleLE=d?g:h,a.readDoubleBE=d?h:g}():!function(){function b(a,b,c,d,e,f){var g,h=+(d<0);if(h&&(d=-d),0===d)a(0,e,f+b),a(1/d>0?0:0x80000000,e,f+c);else if(isNaN(d))a(0,e,f+b),a(0x7ff80000,e,f+c);else if(d>17976931348623157e292)a(0,e,f+b),a((h<<31|0x7ff00000)>>>0,e,f+c);else if(d<22250738585072014e-324)a((g=d/5e-324)>>>0,e,f+b),a((h<<31|g/0x100000000)>>>0,e,f+c);else{var i=Math.floor(Math.log(d)/Math.LN2);1024===i&&(i=1023),a(0x10000000000000*(g=d*Math.pow(2,-i))>>>0,e,f+b),a((h<<31|i+1023<<20|1048576*g&1048575)>>>0,e,f+c)}}function g(a,b,c,d,e){var f=a(d,e+b),g=a(d,e+c),h=(g>>31)*2+1,i=g>>>20&2047,j=0x100000000*(1048575&g)+f;return 2047===i?j?NaN:1/0*h:0===i?5e-324*h*j:h*Math.pow(2,i-1075)*(j+0x10000000000000)}a.writeDoubleLE=b.bind(null,c,0,4),a.writeDoubleBE=b.bind(null,d,4,0),a.readDoubleLE=g.bind(null,e,0,4),a.readDoubleBE=g.bind(null,f,4,0)}(),a}function c(a,b,c){b[c]=255&a,b[c+1]=a>>>8&255,b[c+2]=a>>>16&255,b[c+3]=a>>>24}function d(a,b,c){b[c]=a>>>24,b[c+1]=a>>>16&255,b[c+2]=a>>>8&255,b[c+3]=255&a}function e(a,b){return(a[b]|a[b+1]<<8|a[b+2]<<16|a[b+3]<<24)>>>0}function f(a,b){return(a[b]<<24|a[b+1]<<16|a[b+2]<<8|a[b+3])>>>0}a.exports=b(b)},25811:(a,b,c)=>{"use strict";a.exports=h;var d=c(26991);((h.prototype=Object.create(d.prototype)).constructor=h).className="Service";var e=c(23455),f=c(90290),g=c(74915);function h(a,b){d.call(this,a,b),this.methods={},this._methodsArray=null}function i(a){return a._methodsArray=null,a}h.fromJSON=function(a,b){var c=new h(a,b.options);if(b.methods)for(var d=Object.keys(b.methods),f=0;f<d.length;++f)c.add(e.fromJSON(d[f],b.methods[d[f]]));return b.nested&&c.addJSON(b.nested),b.edition&&(c._edition=b.edition),c.comment=b.comment,c._defaultEdition="proto3",c},h.prototype.toJSON=function(a){var b=d.prototype.toJSON.call(this,a),c=!!a&&!!a.keepComments;return f.toObject(["edition",this._editionToJSON(),"options",b&&b.options||void 0,"methods",d.arrayToJSON(this.methodsArray,a)||{},"nested",b&&b.nested||void 0,"comment",c?this.comment:void 0])},Object.defineProperty(h.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=f.toArray(this.methods))}}),h.prototype.get=function(a){return this.methods[a]||d.prototype.get.call(this,a)},h.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;d.prototype.resolve.call(this);for(var a=this.methodsArray,b=0;b<a.length;++b)a[b].resolve();return this},h.prototype._resolveFeaturesRecursive=function(a){return this._needsRecursiveFeatureResolution&&(a=this._edition||a,d.prototype._resolveFeaturesRecursive.call(this,a),this.methodsArray.forEach(b=>{b._resolveFeaturesRecursive(a)})),this},h.prototype.add=function(a){if(this.get(a.name))throw Error("duplicate name '"+a.name+"' in "+this);return a instanceof e?(this.methods[a.name]=a,a.parent=this,i(this)):d.prototype.add.call(this,a)},h.prototype.remove=function(a){if(a instanceof e){if(this.methods[a.name]!==a)throw Error(a+" is not a member of "+this);return delete this.methods[a.name],a.parent=null,i(this)}return d.prototype.remove.call(this,a)},h.prototype.create=function(a,b,c){for(var d,e=new g.Service(a,b,c),h=0;h<this.methodsArray.length;++h){var i=f.lcFirst((d=this._methodsArray[h]).resolve().name).replace(/[^$\w_]/g,"");e[i]=f.codegen(["r","c"],f.isReserved(i)?i+"_":i)("return this.rpcCall(m,q,s,r,c)")({m:d,q:d.resolvedRequestType.ctor,s:d.resolvedResponseType.ctor})}return e}},26207:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.getInterceptingCall=b.InterceptingCall=b.RequesterBuilder=b.ListenerBuilder=b.InterceptorConfigurationError=void 0;let d=c(39316),e=c(32663),f=c(74216),g=c(42503);class h extends Error{constructor(a){super(a),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,h)}}b.InterceptorConfigurationError=h;class i{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(a){return this.metadata=a,this}withOnReceiveMessage(a){return this.message=a,this}withOnReceiveStatus(a){return this.status=a,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}}b.ListenerBuilder=i;class j{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(a){return this.start=a,this}withSendMessage(a){return this.message=a,this}withHalfClose(a){return this.halfClose=a,this}withCancel(a){return this.cancel=a,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}}b.RequesterBuilder=j;let k={onReceiveMetadata:(a,b)=>{b(a)},onReceiveMessage:(a,b)=>{b(a)},onReceiveStatus:(a,b)=>{b(a)}},l={start:(a,b,c)=>{c(a,b)},sendMessage:(a,b)=>{b(a)},halfClose:a=>{a()},cancel:a=>{a()}};class m{constructor(a,b){var c,d,e,f;this.nextCall=a,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,b?this.requester={start:null!=(c=b.start)?c:l.start,sendMessage:null!=(d=b.sendMessage)?d:l.sendMessage,halfClose:null!=(e=b.halfClose)?e:l.halfClose,cancel:null!=(f=b.cancel)?f:l.cancel}:this.requester=l}cancelWithStatus(a,b){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(a,b)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(a,b){var c,d,f,g,h,i;let j={onReceiveMetadata:null!=(d=null==(c=null==b?void 0:b.onReceiveMetadata)?void 0:c.bind(b))?d:a=>{},onReceiveMessage:null!=(g=null==(f=null==b?void 0:b.onReceiveMessage)?void 0:f.bind(b))?g:a=>{},onReceiveStatus:null!=(i=null==(h=null==b?void 0:b.onReceiveStatus)?void 0:h.bind(b))?i:a=>{}};this.processingMetadata=!0,this.requester.start(a,j,(a,b)=>{var c,d,f;let g;if(this.processingMetadata=!1,(0,e.isInterceptingListener)(b))g=b;else{let a={onReceiveMetadata:null!=(c=b.onReceiveMetadata)?c:k.onReceiveMetadata,onReceiveMessage:null!=(d=b.onReceiveMessage)?d:k.onReceiveMessage,onReceiveStatus:null!=(f=b.onReceiveStatus)?f:k.onReceiveStatus};g=new e.InterceptingListenerImpl(a,j)}this.nextCall.start(a,g),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(a,b){this.processingMessage=!0,this.requester.sendMessage(b,c=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=a,this.pendingMessage=b):(this.nextCall.sendMessageWithContext(a,c),this.processPendingHalfClose())})}sendMessage(a){this.sendMessageWithContext({},a)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}}function n(a,b,c){var d,e;let f=null!=(d=c.deadline)?d:1/0,g=c.host,h=null!=(e=c.parent)?e:null,i=c.propagate_flags,j=c.credentials,k=a.createCall(b,f,g,h,i);return j&&k.setCredentials(j),k}b.InterceptingCall=m;class o{constructor(a,b){this.call=a,this.methodDefinition=b}cancelWithStatus(a,b){this.call.cancelWithStatus(a,b)}getPeer(){return this.call.getPeer()}sendMessageWithContext(a,b){let c;try{c=this.methodDefinition.requestSerialize(b)}catch(a){this.call.cancelWithStatus(f.Status.INTERNAL,`Request message serialization failure: ${(0,g.getErrorMessage)(a)}`);return}this.call.sendMessageWithContext(a,c)}sendMessage(a){this.sendMessageWithContext({},a)}start(a,b){let c=null;this.call.start(a,{onReceiveMetadata:a=>{var c;null==(c=null==b?void 0:b.onReceiveMetadata)||c.call(b,a)},onReceiveMessage:a=>{var e;let h;try{h=this.methodDefinition.responseDeserialize(a)}catch(a){c={code:f.Status.INTERNAL,details:`Response message parsing error: ${(0,g.getErrorMessage)(a)}`,metadata:new d.Metadata},this.call.cancelWithStatus(c.code,c.details);return}null==(e=null==b?void 0:b.onReceiveMessage)||e.call(b,h)},onReceiveStatus:a=>{var d,e;c?null==(d=null==b?void 0:b.onReceiveStatus)||d.call(b,c):null==(e=null==b?void 0:b.onReceiveStatus)||e.call(b,a)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}}class p extends o{constructor(a,b){super(a,b)}start(a,b){var c,d;let e=!1,f={onReceiveMetadata:null!=(d=null==(c=null==b?void 0:b.onReceiveMetadata)?void 0:c.bind(b))?d:a=>{},onReceiveMessage:a=>{var c;e=!0,null==(c=null==b?void 0:b.onReceiveMessage)||c.call(b,a)},onReceiveStatus:a=>{var c,d;e||null==(c=null==b?void 0:b.onReceiveMessage)||c.call(b,null),null==(d=null==b?void 0:b.onReceiveStatus)||d.call(b,a)}};super.start(a,f),this.call.startRead()}}class q extends o{}function r(a,b,c){let d=n(a,c.path,b);return c.responseStream?new q(d,c):new p(d,c)}b.getInterceptingCall=function(a,b,c,d){if(a.clientInterceptors.length>0&&a.clientInterceptorProviders.length>0)throw new h("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(a.callInterceptors.length>0&&a.callInterceptorProviders.length>0)throw new h("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let e=[];e=a.callInterceptors.length>0||a.callInterceptorProviders.length>0?[].concat(a.callInterceptors,a.callInterceptorProviders.map(a=>a(b))).filter(a=>a):[].concat(a.clientInterceptors,a.clientInterceptorProviders.map(a=>a(b))).filter(a=>a);let f=Object.assign({},c,{method_definition:b});return e.reduceRight((a,b)=>c=>b(c,a),a=>r(d,a,b))(f)}},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},26740:(a,b,c)=>{"use strict";a.exports=f;var d=c(81165),e=c(32497)("fs");function f(a,b,c){return("function"==typeof b?(c=b,b={}):b||(b={}),c)?!b.xhr&&e&&e.readFile?e.readFile(a,function(d,e){return d&&"undefined"!=typeof XMLHttpRequest?f.xhr(a,b,c):d?c(d):c(null,b.binary?e:e.toString("utf8"))}):f.xhr(a,b,c):d(f,this,a,b)}f.xhr=function(a,b,c){var d=new XMLHttpRequest;d.onreadystatechange=function(){if(4===d.readyState){if(0!==d.status&&200!==d.status)return c(Error("status "+d.status));if(b.binary){var a=d.response;if(!a){a=[];for(var e=0;e<d.responseText.length;++e)a.push(255&d.responseText.charCodeAt(e))}return c(null,"undefined"!=typeof Uint8Array?new Uint8Array(a):a)}return c(null,d.responseText)}},b.binary&&("overrideMimeType"in d&&d.overrideMimeType("text/plain; charset=x-user-defined"),d.responseType="arraybuffer"),d.open("GET",a),d.send()}},26991:(a,b,c)=>{"use strict";a.exports=l;var d,e,f,g=c(72481);((l.prototype=Object.create(g.prototype)).constructor=l).className="Namespace";var h=c(99408),i=c(90290),j=c(67369);function k(a,b){if(a&&a.length){for(var c={},d=0;d<a.length;++d)c[a[d].name]=a[d].toJSON(b);return c}}function l(a,b){g.call(this,a,b),this.nested=void 0,this._nestedArray=null,this._lookupCache={},this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0}function m(a){a._nestedArray=null,a._lookupCache={};for(var b=a;b=b.parent;)b._lookupCache={};return a}l.fromJSON=function(a,b){return new l(a,b.options).addJSON(b.nested)},l.arrayToJSON=k,l.isReservedId=function(a,b){if(a){for(var c=0;c<a.length;++c)if("string"!=typeof a[c]&&a[c][0]<=b&&a[c][1]>b)return!0}return!1},l.isReservedName=function(a,b){if(a){for(var c=0;c<a.length;++c)if(a[c]===b)return!0}return!1},Object.defineProperty(l.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=i.toArray(this.nested))}}),l.prototype.toJSON=function(a){return i.toObject(["options",this.options,"nested",k(this.nestedArray,a)])},l.prototype.addJSON=function(a){var b=this;if(a)for(var c,g=Object.keys(a),i=0;i<g.length;++i)c=a[g[i]],b.add((void 0!==c.fields?d.fromJSON:void 0!==c.values?f.fromJSON:void 0!==c.methods?e.fromJSON:void 0!==c.id?h.fromJSON:l.fromJSON)(g[i],c));return this},l.prototype.get=function(a){return this.nested&&this.nested[a]||null},l.prototype.getEnum=function(a){if(this.nested&&this.nested[a]instanceof f)return this.nested[a].values;throw Error("no such enum: "+a)},l.prototype.add=function(a){if(!(a instanceof h&&void 0!==a.extend||a instanceof d||a instanceof j||a instanceof f||a instanceof e||a instanceof l))throw TypeError("object must be a valid nested object");if(this.nested){var b=this.get(a.name);if(b)if(b instanceof l&&a instanceof l&&!(b instanceof d||b instanceof e)){for(var c=b.nestedArray,g=0;g<c.length;++g)a.add(c[g]);this.remove(b),this.nested||(this.nested={}),a.setOptions(b.options,!0)}else throw Error("duplicate name '"+a.name+"' in "+this)}else this.nested={};this.nested[a.name]=a,this instanceof d||this instanceof e||this instanceof f||this instanceof h||a._edition||(a._edition=a._defaultEdition),this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0;for(var i=this;i=i.parent;)i._needsRecursiveFeatureResolution=!0,i._needsRecursiveResolve=!0;return a.onAdd(this),m(this)},l.prototype.remove=function(a){if(!(a instanceof g))throw TypeError("object must be a ReflectionObject");if(a.parent!==this)throw Error(a+" is not a member of "+this);return delete this.nested[a.name],Object.keys(this.nested).length||(this.nested=void 0),a.onRemove(this),m(this)},l.prototype.define=function(a,b){if(i.isString(a))a=a.split(".");else if(!Array.isArray(a))throw TypeError("illegal path");if(a&&a.length&&""===a[0])throw Error("path must be relative");for(var c=this;a.length>0;){var d=a.shift();if(c.nested&&c.nested[d]){if(!((c=c.nested[d])instanceof l))throw Error("path conflicts with non-namespace objects")}else c.add(c=new l(d))}return b&&c.addJSON(b),c},l.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;this._resolveFeaturesRecursive(this._edition);var a=this.nestedArray,b=0;for(this.resolve();b<a.length;)a[b]instanceof l?a[b++].resolveAll():a[b++].resolve();return this._needsRecursiveResolve=!1,this},l.prototype._resolveFeaturesRecursive=function(a){return this._needsRecursiveFeatureResolution&&(this._needsRecursiveFeatureResolution=!1,a=this._edition||a,g.prototype._resolveFeaturesRecursive.call(this,a),this.nestedArray.forEach(b=>{b._resolveFeaturesRecursive(a)})),this},l.prototype.lookup=function(a,b,c){if("boolean"==typeof b?(c=b,b=void 0):b&&!Array.isArray(b)&&(b=[b]),i.isString(a)&&a.length){if("."===a)return this.root;a=a.split(".")}else if(!a.length)return this;var d=a.join(".");if(""===a[0])return this.root.lookup(a.slice(1),b);var e=this.root._fullyQualifiedObjects&&this.root._fullyQualifiedObjects["."+d];if(e&&(!b||b.indexOf(e.constructor)>-1)||(e=this._lookupImpl(a,d))&&(!b||b.indexOf(e.constructor)>-1))return e;if(c)return null;for(var f=this;f.parent;){if((e=f.parent._lookupImpl(a,d))&&(!b||b.indexOf(e.constructor)>-1))return e;f=f.parent}return null},l.prototype._lookupImpl=function(a,b){if(Object.prototype.hasOwnProperty.call(this._lookupCache,b))return this._lookupCache[b];var c=this.get(a[0]),d=null;if(c)1===a.length?d=c:c instanceof l&&(a=a.slice(1),d=c._lookupImpl(a,a.join(".")));else for(var e=0;e<this.nestedArray.length;++e)this._nestedArray[e]instanceof l&&(c=this._nestedArray[e]._lookupImpl(a,b))&&(d=c);return this._lookupCache[b]=d,d},l.prototype.lookupType=function(a){var b=this.lookup(a,[d]);if(!b)throw Error("no such type: "+a);return b},l.prototype.lookupEnum=function(a){var b=this.lookup(a,[f]);if(!b)throw Error("no such Enum '"+a+"' in "+this);return b},l.prototype.lookupTypeOrEnum=function(a){var b=this.lookup(a,[d,f]);if(!b)throw Error("no such Type or Enum '"+a+"' in "+this);return b},l.prototype.lookupService=function(a){var b=this.lookup(a,[e]);if(!b)throw Error("no such Service '"+a+"' in "+this);return b},l._configure=function(a,b,c){d=a,e=b,f=c}},27203:(a,b)=>{"use strict";var c=b;c.length=function(a){var b=a.length;if(!b)return 0;for(var c=0;--b%4>1&&"="===a.charAt(b);)++c;return Math.ceil(3*a.length)/4-c};for(var d=Array(64),e=Array(123),f=0;f<64;)e[d[f]=f<26?f+65:f<52?f+71:f<62?f-4:f-59|43]=f++;c.encode=function(a,b,c){for(var e,f=null,g=[],h=0,i=0;b<c;){var j=a[b++];switch(i){case 0:g[h++]=d[j>>2],e=(3&j)<<4,i=1;break;case 1:g[h++]=d[e|j>>4],e=(15&j)<<2,i=2;break;case 2:g[h++]=d[e|j>>6],g[h++]=d[63&j],i=0}h>8191&&((f||(f=[])).push(String.fromCharCode.apply(String,g)),h=0)}return(i&&(g[h++]=d[e],g[h++]=61,1===i&&(g[h++]=61)),f)?(h&&f.push(String.fromCharCode.apply(String,g.slice(0,h))),f.join("")):String.fromCharCode.apply(String,g.slice(0,h))};var g="invalid encoding";c.decode=function(a,b,c){for(var d,f=c,h=0,i=0;i<a.length;){var j=a.charCodeAt(i++);if(61===j&&h>1)break;if(void 0===(j=e[j]))throw Error(g);switch(h){case 0:d=j,h=1;break;case 1:b[c++]=d<<2|(48&j)>>4,d=j,h=2;break;case 2:b[c++]=(15&d)<<4|(60&j)>>2,d=j,h=3;break;case 3:b[c++]=(3&d)<<6|j,h=0}}if(1===h)throw Error(g);return c-f},c.test=function(a){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(a)}},27481:a=>{"use strict";a.exports={}},27484:(a,b,c)=>{"use strict";let d,e,f,g,h,i,j,k,l;c.r(b),c.d(b,{default:()=>Rb});var m,n,o,p,q,r,s,t,u,v,w,x=c(21124),y=c(38301),z=c.n(y);let A="173",B=0,C=1,D=2,E=1,F=2,G=3,H=0,I=1,J=2,K=0,L=1,M=2,N=3,O=4,P=5,Q=100,R=101,S=102,T=103,U=104,V=200,W=201,X=202,Y=203,Z=204,$=205,_=206,aa=207,ab=208,ac=209,ad=210,ae=211,af=212,ag=213,ah=214,ai=0,aj=1,ak=2,al=3,am=4,an=5,ao=6,ap=7,aq=0,ar=1,as=2,at=0,au=1,av=2,aw=3,ax=4,ay=5,az=6,aA=7,aB="attached",aC="detached",aD=300,aE=301,aF=302,aG=303,aH=304,aI=306,aJ=1e3,aK=1001,aL=1002,aM=1003,aN=1004,aO=1005,aP=1006,aQ=1007,aR=1008,aS=1009,aT=1010,aU=1011,aV=1012,aW=1013,aX=1014,aY=1015,aZ=1016,a$=1017,a_=1018,a0=1020,a1=35902,a2=1021,a3=1022,a4=1023,a5=1024,a6=1025,a7=1026,a8=1027,a9=1028,ba=1029,bb=1030,bc=1031,bd=1033,be=33776,bf=33777,bg=33778,bh=33779,bi=35840,bj=35841,bk=35842,bl=35843,bm=36196,bn=37492,bo=37496,bp=37808,bq=37809,br=37810,bs=37811,bt=37812,bu=37813,bv=37814,bw=37815,bx=37816,by=37817,bz=37818,bA=37819,bB=37820,bC=37821,bD=36492,bE=36494,bF=36495,bG=36283,bH=36284,bI=36285,bJ=36286,bK=2200,bL=2201,bM=2202,bN=2300,bO=2301,bP=2302,bQ=2400,bR=2401,bS=2402,bT=2500,bU=2501,bV=3200,bW=3201,bX=0,bY=1,bZ="",b$="srgb",b_="srgb-linear",b0="linear",b1="srgb",b2=7680,b3=519,b4=512,b5=513,b6=514,b7=515,b8=516,b9=517,ca=518,cb=519,cc=35044,cd="300 es",ce=2e3,cf=2001;class cg{addEventListener(a,b){void 0===this._listeners&&(this._listeners={});let c=this._listeners;void 0===c[a]&&(c[a]=[]),-1===c[a].indexOf(b)&&c[a].push(b)}hasEventListener(a,b){let c=this._listeners;return void 0!==c&&void 0!==c[a]&&-1!==c[a].indexOf(b)}removeEventListener(a,b){let c=this._listeners;if(void 0===c)return;let d=c[a];if(void 0!==d){let a=d.indexOf(b);-1!==a&&d.splice(a,1)}}dispatchEvent(a){let b=this._listeners;if(void 0===b)return;let c=b[a.type];if(void 0!==c){a.target=this;let b=c.slice(0);for(let c=0,d=b.length;c<d;c++)b[c].call(this,a);a.target=null}}}let ch=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],ci=1234567,cj=Math.PI/180,ck=180/Math.PI;function cl(){let a=0xffffffff*Math.random()|0,b=0xffffffff*Math.random()|0,c=0xffffffff*Math.random()|0,d=0xffffffff*Math.random()|0;return(ch[255&a]+ch[a>>8&255]+ch[a>>16&255]+ch[a>>24&255]+"-"+ch[255&b]+ch[b>>8&255]+"-"+ch[b>>16&15|64]+ch[b>>24&255]+"-"+ch[63&c|128]+ch[c>>8&255]+"-"+ch[c>>16&255]+ch[c>>24&255]+ch[255&d]+ch[d>>8&255]+ch[d>>16&255]+ch[d>>24&255]).toLowerCase()}function cm(a,b,c){return Math.max(b,Math.min(c,a))}function cn(a,b){return(a%b+b)%b}function co(a,b,c){return(1-c)*a+c*b}function cp(a,b){switch(b.constructor){case Float32Array:return a;case Uint32Array:return a/0xffffffff;case Uint16Array:return a/65535;case Uint8Array:return a/255;case Int32Array:return Math.max(a/0x7fffffff,-1);case Int16Array:return Math.max(a/32767,-1);case Int8Array:return Math.max(a/127,-1);default:throw Error("Invalid component type.")}}function cq(a,b){switch(b.constructor){case Float32Array:return a;case Uint32Array:return Math.round(0xffffffff*a);case Uint16Array:return Math.round(65535*a);case Uint8Array:return Math.round(255*a);case Int32Array:return Math.round(0x7fffffff*a);case Int16Array:return Math.round(32767*a);case Int8Array:return Math.round(127*a);default:throw Error("Invalid component type.")}}class cr{constructor(a=0,b=0){cr.prototype.isVector2=!0,this.x=a,this.y=b}get width(){return this.x}set width(a){this.x=a}get height(){return this.y}set height(a){this.y=a}set(a,b){return this.x=a,this.y=b,this}setScalar(a){return this.x=a,this.y=a,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setComponent(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a)}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a)}}clone(){return new this.constructor(this.x,this.y)}copy(a){return this.x=a.x,this.y=a.y,this}add(a){return this.x+=a.x,this.y+=a.y,this}addScalar(a){return this.x+=a,this.y+=a,this}addVectors(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this}addScaledVector(a,b){return this.x+=a.x*b,this.y+=a.y*b,this}sub(a){return this.x-=a.x,this.y-=a.y,this}subScalar(a){return this.x-=a,this.y-=a,this}subVectors(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this}multiply(a){return this.x*=a.x,this.y*=a.y,this}multiplyScalar(a){return this.x*=a,this.y*=a,this}divide(a){return this.x/=a.x,this.y/=a.y,this}divideScalar(a){return this.multiplyScalar(1/a)}applyMatrix3(a){let b=this.x,c=this.y,d=a.elements;return this.x=d[0]*b+d[3]*c+d[6],this.y=d[1]*b+d[4]*c+d[7],this}min(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this}max(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this}clamp(a,b){return this.x=cm(this.x,a.x,b.x),this.y=cm(this.y,a.y,b.y),this}clampScalar(a,b){return this.x=cm(this.x,a,b),this.y=cm(this.y,a,b),this}clampLength(a,b){let c=this.length();return this.divideScalar(c||1).multiplyScalar(cm(c,a,b))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(a){return this.x*a.x+this.y*a.y}cross(a){return this.x*a.y-this.y*a.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(a){let b=Math.sqrt(this.lengthSq()*a.lengthSq());return 0===b?Math.PI/2:Math.acos(cm(this.dot(a)/b,-1,1))}distanceTo(a){return Math.sqrt(this.distanceToSquared(a))}distanceToSquared(a){let b=this.x-a.x,c=this.y-a.y;return b*b+c*c}manhattanDistanceTo(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this}lerpVectors(a,b,c){return this.x=a.x+(b.x-a.x)*c,this.y=a.y+(b.y-a.y)*c,this}equals(a){return a.x===this.x&&a.y===this.y}fromArray(a,b=0){return this.x=a[b],this.y=a[b+1],this}toArray(a=[],b=0){return a[b]=this.x,a[b+1]=this.y,a}fromBufferAttribute(a,b){return this.x=a.getX(b),this.y=a.getY(b),this}rotateAround(a,b){let c=Math.cos(b),d=Math.sin(b),e=this.x-a.x,f=this.y-a.y;return this.x=e*c-f*d+a.x,this.y=e*d+f*c+a.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class cs{constructor(a,b,c,d,e,f,g,h,i){cs.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==a&&this.set(a,b,c,d,e,f,g,h,i)}set(a,b,c,d,e,f,g,h,i){let j=this.elements;return j[0]=a,j[1]=d,j[2]=g,j[3]=b,j[4]=e,j[5]=h,j[6]=c,j[7]=f,j[8]=i,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(a){let b=this.elements,c=a.elements;return b[0]=c[0],b[1]=c[1],b[2]=c[2],b[3]=c[3],b[4]=c[4],b[5]=c[5],b[6]=c[6],b[7]=c[7],b[8]=c[8],this}extractBasis(a,b,c){return a.setFromMatrix3Column(this,0),b.setFromMatrix3Column(this,1),c.setFromMatrix3Column(this,2),this}setFromMatrix4(a){let b=a.elements;return this.set(b[0],b[4],b[8],b[1],b[5],b[9],b[2],b[6],b[10]),this}multiply(a){return this.multiplyMatrices(this,a)}premultiply(a){return this.multiplyMatrices(a,this)}multiplyMatrices(a,b){let c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[3],h=c[6],i=c[1],j=c[4],k=c[7],l=c[2],m=c[5],n=c[8],o=d[0],p=d[3],q=d[6],r=d[1],s=d[4],t=d[7],u=d[2],v=d[5],w=d[8];return e[0]=f*o+g*r+h*u,e[3]=f*p+g*s+h*v,e[6]=f*q+g*t+h*w,e[1]=i*o+j*r+k*u,e[4]=i*p+j*s+k*v,e[7]=i*q+j*t+k*w,e[2]=l*o+m*r+n*u,e[5]=l*p+m*s+n*v,e[8]=l*q+m*t+n*w,this}multiplyScalar(a){let b=this.elements;return b[0]*=a,b[3]*=a,b[6]*=a,b[1]*=a,b[4]*=a,b[7]*=a,b[2]*=a,b[5]*=a,b[8]*=a,this}determinant(){let a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8];return b*f*j-b*g*i-c*e*j+c*g*h+d*e*i-d*f*h}invert(){let a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=j*f-g*i,l=g*h-j*e,m=i*e-f*h,n=b*k+c*l+d*m;if(0===n)return this.set(0,0,0,0,0,0,0,0,0);let o=1/n;return a[0]=k*o,a[1]=(d*i-j*c)*o,a[2]=(g*c-d*f)*o,a[3]=l*o,a[4]=(j*b-d*h)*o,a[5]=(d*e-g*b)*o,a[6]=m*o,a[7]=(c*h-i*b)*o,a[8]=(f*b-c*e)*o,this}transpose(){let a,b=this.elements;return a=b[1],b[1]=b[3],b[3]=a,a=b[2],b[2]=b[6],b[6]=a,a=b[5],b[5]=b[7],b[7]=a,this}getNormalMatrix(a){return this.setFromMatrix4(a).invert().transpose()}transposeIntoArray(a){let b=this.elements;return a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8],this}setUvTransform(a,b,c,d,e,f,g){let h=Math.cos(e),i=Math.sin(e);return this.set(c*h,c*i,-c*(h*f+i*g)+f+a,-d*i,d*h,-d*(-i*f+h*g)+g+b,0,0,1),this}scale(a,b){return this.premultiply(ct.makeScale(a,b)),this}rotate(a){return this.premultiply(ct.makeRotation(-a)),this}translate(a,b){return this.premultiply(ct.makeTranslation(a,b)),this}makeTranslation(a,b){return a.isVector2?this.set(1,0,a.x,0,1,a.y,0,0,1):this.set(1,0,a,0,1,b,0,0,1),this}makeRotation(a){let b=Math.cos(a),c=Math.sin(a);return this.set(b,-c,0,c,b,0,0,0,1),this}makeScale(a,b){return this.set(a,0,0,0,b,0,0,0,1),this}equals(a){let b=this.elements,c=a.elements;for(let a=0;a<9;a++)if(b[a]!==c[a])return!1;return!0}fromArray(a,b=0){for(let c=0;c<9;c++)this.elements[c]=a[c+b];return this}toArray(a=[],b=0){let c=this.elements;return a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a}clone(){return new this.constructor().fromArray(this.elements)}}let ct=new cs;function cu(a){for(let b=a.length-1;b>=0;--b)if(a[b]>=65535)return!0;return!1}let cv={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function cw(a,b){return new cv[a](b)}function cx(a){return document.createElementNS("http://www.w3.org/1999/xhtml",a)}function cy(){let a=cx("canvas");return a.style.display="block",a}let cz={};function cA(a){a in cz||(cz[a]=!0,console.warn(a))}function cB(a,b,c){return new Promise(function(d,e){function f(){switch(a.clientWaitSync(b,a.SYNC_FLUSH_COMMANDS_BIT,0)){case a.WAIT_FAILED:e();break;case a.TIMEOUT_EXPIRED:setTimeout(f,c);break;default:d()}}setTimeout(f,c)})}function cC(a){let b=a.elements;b[2]=.5*b[2]+.5*b[3],b[6]=.5*b[6]+.5*b[7],b[10]=.5*b[10]+.5*b[11],b[14]=.5*b[14]+.5*b[15]}function cD(a){let b=a.elements;-1===b[11]?(b[10]=-b[10]-1,b[14]=-b[14]):(b[10]=-b[10],b[14]=-b[14]+1)}let cE=new cs().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),cF=new cs().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715),cG=function(){let a={enabled:!0,workingColorSpace:b_,spaces:{},convert:function(a,b,c){return!1!==this.enabled&&b!==c&&b&&c&&(this.spaces[b].transfer===b1&&(a.r=cH(a.r),a.g=cH(a.g),a.b=cH(a.b)),this.spaces[b].primaries!==this.spaces[c].primaries&&(a.applyMatrix3(this.spaces[b].toXYZ),a.applyMatrix3(this.spaces[c].fromXYZ)),this.spaces[c].transfer===b1&&(a.r=cI(a.r),a.g=cI(a.g),a.b=cI(a.b))),a},fromWorkingColorSpace:function(a,b){return this.convert(a,this.workingColorSpace,b)},toWorkingColorSpace:function(a,b){return this.convert(a,b,this.workingColorSpace)},getPrimaries:function(a){return this.spaces[a].primaries},getTransfer:function(a){return a===bZ?b0:this.spaces[a].transfer},getLuminanceCoefficients:function(a,b=this.workingColorSpace){return a.fromArray(this.spaces[b].luminanceCoefficients)},define:function(a){Object.assign(this.spaces,a)},_getMatrix:function(a,b,c){return a.copy(this.spaces[b].toXYZ).multiply(this.spaces[c].fromXYZ)},_getDrawingBufferColorSpace:function(a){return this.spaces[a].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(a=this.workingColorSpace){return this.spaces[a].workingColorSpaceConfig.unpackColorSpace}},b=[.64,.33,.3,.6,.15,.06],c=[.2126,.7152,.0722],d=[.3127,.329];return a.define({[b_]:{primaries:b,whitePoint:d,transfer:b0,toXYZ:cE,fromXYZ:cF,luminanceCoefficients:c,workingColorSpaceConfig:{unpackColorSpace:b$},outputColorSpaceConfig:{drawingBufferColorSpace:b$}},[b$]:{primaries:b,whitePoint:d,transfer:b1,toXYZ:cE,fromXYZ:cF,luminanceCoefficients:c,outputColorSpaceConfig:{drawingBufferColorSpace:b$}}}),a}();function cH(a){return a<.04045?.0773993808*a:Math.pow(.9478672986*a+.0521327014,2.4)}function cI(a){return a<.0031308?12.92*a:1.055*Math.pow(a,.41666)-.055}class cJ{static getDataURL(a){let b;if(/^data:/i.test(a.src)||"undefined"==typeof HTMLCanvasElement)return a.src;if(a instanceof HTMLCanvasElement)b=a;else{void 0===d&&(d=cx("canvas")),d.width=a.width,d.height=a.height;let c=d.getContext("2d");a instanceof ImageData?c.putImageData(a,0,0):c.drawImage(a,0,0,a.width,a.height),b=d}return b.toDataURL("image/png")}static sRGBToLinear(a){if("undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&a instanceof ImageBitmap){let b=cx("canvas");b.width=a.width,b.height=a.height;let c=b.getContext("2d");c.drawImage(a,0,0,a.width,a.height);let d=c.getImageData(0,0,a.width,a.height),e=d.data;for(let a=0;a<e.length;a++)e[a]=255*cH(e[a]/255);return c.putImageData(d,0,0),b}if(!a.data)return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),a;{let b=a.data.slice(0);for(let a=0;a<b.length;a++)b instanceof Uint8Array||b instanceof Uint8ClampedArray?b[a]=Math.floor(255*cH(b[a]/255)):b[a]=cH(b[a]);return{data:b,width:a.width,height:a.height}}}}let cK=0;class cL{constructor(a=null){this.isSource=!0,Object.defineProperty(this,"id",{value:cK++}),this.uuid=cl(),this.data=a,this.dataReady=!0,this.version=0}set needsUpdate(a){!0===a&&this.version++}toJSON(a){let b=void 0===a||"string"==typeof a;if(!b&&void 0!==a.images[this.uuid])return a.images[this.uuid];let c={uuid:this.uuid,url:""},d=this.data;if(null!==d){let a;if(Array.isArray(d)){a=[];for(let b=0,c=d.length;b<c;b++)d[b].isDataTexture?a.push(cM(d[b].image)):a.push(cM(d[b]))}else a=cM(d);c.url=a}return b||(a.images[this.uuid]=c),c}}function cM(a){return"undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&a instanceof ImageBitmap?cJ.getDataURL(a):a.data?{data:Array.from(a.data),width:a.width,height:a.height,type:a.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let cN=0;class cO extends cg{constructor(a=cO.DEFAULT_IMAGE,b=cO.DEFAULT_MAPPING,c=aK,d=aK,e=aP,f=aR,g=a4,h=aS,i=cO.DEFAULT_ANISOTROPY,j=bZ){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:cN++}),this.uuid=cl(),this.name="",this.source=new cL(a),this.mipmaps=[],this.mapping=b,this.channel=0,this.wrapS=c,this.wrapT=d,this.magFilter=e,this.minFilter=f,this.anisotropy=i,this.format=g,this.internalFormat=null,this.type=h,this.offset=new cr(0,0),this.repeat=new cr(1,1),this.center=new cr(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new cs,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=j,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(a=null){this.source.data=a}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(a){return this.name=a.name,this.source=a.source,this.mipmaps=a.mipmaps.slice(0),this.mapping=a.mapping,this.channel=a.channel,this.wrapS=a.wrapS,this.wrapT=a.wrapT,this.magFilter=a.magFilter,this.minFilter=a.minFilter,this.anisotropy=a.anisotropy,this.format=a.format,this.internalFormat=a.internalFormat,this.type=a.type,this.offset.copy(a.offset),this.repeat.copy(a.repeat),this.center.copy(a.center),this.rotation=a.rotation,this.matrixAutoUpdate=a.matrixAutoUpdate,this.matrix.copy(a.matrix),this.generateMipmaps=a.generateMipmaps,this.premultiplyAlpha=a.premultiplyAlpha,this.flipY=a.flipY,this.unpackAlignment=a.unpackAlignment,this.colorSpace=a.colorSpace,this.renderTarget=a.renderTarget,this.isRenderTargetTexture=a.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(a.userData)),this.needsUpdate=!0,this}toJSON(a){let b=void 0===a||"string"==typeof a;if(!b&&void 0!==a.textures[this.uuid])return a.textures[this.uuid];let c={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(a).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(c.userData=this.userData),b||(a.textures[this.uuid]=c),c}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(a){if(this.mapping!==aD)return a;if(a.applyMatrix3(this.matrix),a.x<0||a.x>1)switch(this.wrapS){case aJ:a.x=a.x-Math.floor(a.x);break;case aK:a.x=a.x<0?0:1;break;case aL:1===Math.abs(Math.floor(a.x)%2)?a.x=Math.ceil(a.x)-a.x:a.x=a.x-Math.floor(a.x)}if(a.y<0||a.y>1)switch(this.wrapT){case aJ:a.y=a.y-Math.floor(a.y);break;case aK:a.y=a.y<0?0:1;break;case aL:1===Math.abs(Math.floor(a.y)%2)?a.y=Math.ceil(a.y)-a.y:a.y=a.y-Math.floor(a.y)}return this.flipY&&(a.y=1-a.y),a}set needsUpdate(a){!0===a&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(a){!0===a&&this.pmremVersion++}}cO.DEFAULT_IMAGE=null,cO.DEFAULT_MAPPING=aD,cO.DEFAULT_ANISOTROPY=1;class cP{constructor(a=0,b=0,c=0,d=1){cP.prototype.isVector4=!0,this.x=a,this.y=b,this.z=c,this.w=d}get width(){return this.z}set width(a){this.z=a}get height(){return this.w}set height(a){this.w=a}set(a,b,c,d){return this.x=a,this.y=b,this.z=c,this.w=d,this}setScalar(a){return this.x=a,this.y=a,this.z=a,this.w=a,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setZ(a){return this.z=a,this}setW(a){return this.w=a,this}setComponent(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a)}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=void 0!==a.w?a.w:1,this}add(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this.w+=a.w,this}addScalar(a){return this.x+=a,this.y+=a,this.z+=a,this.w+=a,this}addVectors(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this.w=a.w+b.w,this}addScaledVector(a,b){return this.x+=a.x*b,this.y+=a.y*b,this.z+=a.z*b,this.w+=a.w*b,this}sub(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this.w-=a.w,this}subScalar(a){return this.x-=a,this.y-=a,this.z-=a,this.w-=a,this}subVectors(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this.w=a.w-b.w,this}multiply(a){return this.x*=a.x,this.y*=a.y,this.z*=a.z,this.w*=a.w,this}multiplyScalar(a){return this.x*=a,this.y*=a,this.z*=a,this.w*=a,this}applyMatrix4(a){let b=this.x,c=this.y,d=this.z,e=this.w,f=a.elements;return this.x=f[0]*b+f[4]*c+f[8]*d+f[12]*e,this.y=f[1]*b+f[5]*c+f[9]*d+f[13]*e,this.z=f[2]*b+f[6]*c+f[10]*d+f[14]*e,this.w=f[3]*b+f[7]*c+f[11]*d+f[15]*e,this}divide(a){return this.x/=a.x,this.y/=a.y,this.z/=a.z,this.w/=a.w,this}divideScalar(a){return this.multiplyScalar(1/a)}setAxisAngleFromQuaternion(a){this.w=2*Math.acos(a.w);let b=Math.sqrt(1-a.w*a.w);return b<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b),this}setAxisAngleFromRotationMatrix(a){let b,c,d,e,f=.01,g=.1,h=a.elements,i=h[0],j=h[4],k=h[8],l=h[1],m=h[5],n=h[9],o=h[2],p=h[6],q=h[10];if(Math.abs(j-l)<f&&Math.abs(k-o)<f&&Math.abs(n-p)<f){if(Math.abs(j+l)<g&&Math.abs(k+o)<g&&Math.abs(n+p)<g&&Math.abs(i+m+q-3)<g)return this.set(1,0,0,0),this;b=Math.PI;let a=(i+1)/2,h=(m+1)/2,r=(q+1)/2,s=(j+l)/4,t=(k+o)/4,u=(n+p)/4;return a>h&&a>r?a<f?(c=0,d=.707106781,e=.707106781):(d=s/(c=Math.sqrt(a)),e=t/c):h>r?h<f?(c=.707106781,d=0,e=.707106781):(c=s/(d=Math.sqrt(h)),e=u/d):r<f?(c=.707106781,d=.707106781,e=0):(c=t/(e=Math.sqrt(r)),d=u/e),this.set(c,d,e,b),this}let r=Math.sqrt((p-n)*(p-n)+(k-o)*(k-o)+(l-j)*(l-j));return .001>Math.abs(r)&&(r=1),this.x=(p-n)/r,this.y=(k-o)/r,this.z=(l-j)/r,this.w=Math.acos((i+m+q-1)/2),this}setFromMatrixPosition(a){let b=a.elements;return this.x=b[12],this.y=b[13],this.z=b[14],this.w=b[15],this}min(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this.w=Math.min(this.w,a.w),this}max(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this.w=Math.max(this.w,a.w),this}clamp(a,b){return this.x=cm(this.x,a.x,b.x),this.y=cm(this.y,a.y,b.y),this.z=cm(this.z,a.z,b.z),this.w=cm(this.w,a.w,b.w),this}clampScalar(a,b){return this.x=cm(this.x,a,b),this.y=cm(this.y,a,b),this.z=cm(this.z,a,b),this.w=cm(this.w,a,b),this}clampLength(a,b){let c=this.length();return this.divideScalar(c||1).multiplyScalar(cm(c,a,b))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this.w+=(a.w-this.w)*b,this}lerpVectors(a,b,c){return this.x=a.x+(b.x-a.x)*c,this.y=a.y+(b.y-a.y)*c,this.z=a.z+(b.z-a.z)*c,this.w=a.w+(b.w-a.w)*c,this}equals(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w}fromArray(a,b=0){return this.x=a[b],this.y=a[b+1],this.z=a[b+2],this.w=a[b+3],this}toArray(a=[],b=0){return a[b]=this.x,a[b+1]=this.y,a[b+2]=this.z,a[b+3]=this.w,a}fromBufferAttribute(a,b){return this.x=a.getX(b),this.y=a.getY(b),this.z=a.getZ(b),this.w=a.getW(b),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class cQ extends cg{constructor(a=1,b=1,c={}){super(),this.isRenderTarget=!0,this.width=a,this.height=b,this.depth=1,this.scissor=new cP(0,0,a,b),this.scissorTest=!1,this.viewport=new cP(0,0,a,b);let d=new cO({width:a,height:b,depth:1},(c=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:aP,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},c)).mapping,c.wrapS,c.wrapT,c.magFilter,c.minFilter,c.format,c.type,c.anisotropy,c.colorSpace);d.flipY=!1,d.generateMipmaps=c.generateMipmaps,d.internalFormat=c.internalFormat,this.textures=[];let e=c.count;for(let a=0;a<e;a++)this.textures[a]=d.clone(),this.textures[a].isRenderTargetTexture=!0,this.textures[a].renderTarget=this;this.depthBuffer=c.depthBuffer,this.stencilBuffer=c.stencilBuffer,this.resolveDepthBuffer=c.resolveDepthBuffer,this.resolveStencilBuffer=c.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=c.depthTexture,this.samples=c.samples}get texture(){return this.textures[0]}set texture(a){this.textures[0]=a}set depthTexture(a){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==a&&(a.renderTarget=this),this._depthTexture=a}get depthTexture(){return this._depthTexture}setSize(a,b,c=1){if(this.width!==a||this.height!==b||this.depth!==c){this.width=a,this.height=b,this.depth=c;for(let d=0,e=this.textures.length;d<e;d++)this.textures[d].image.width=a,this.textures[d].image.height=b,this.textures[d].image.depth=c;this.dispose()}this.viewport.set(0,0,a,b),this.scissor.set(0,0,a,b)}clone(){return new this.constructor().copy(this)}copy(a){this.width=a.width,this.height=a.height,this.depth=a.depth,this.scissor.copy(a.scissor),this.scissorTest=a.scissorTest,this.viewport.copy(a.viewport),this.textures.length=0;for(let b=0,c=a.textures.length;b<c;b++)this.textures[b]=a.textures[b].clone(),this.textures[b].isRenderTargetTexture=!0,this.textures[b].renderTarget=this;let b=Object.assign({},a.texture.image);return this.texture.source=new cL(b),this.depthBuffer=a.depthBuffer,this.stencilBuffer=a.stencilBuffer,this.resolveDepthBuffer=a.resolveDepthBuffer,this.resolveStencilBuffer=a.resolveStencilBuffer,null!==a.depthTexture&&(this.depthTexture=a.depthTexture.clone()),this.samples=a.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class cR extends cQ{constructor(a=1,b=1,c={}){super(a,b,c),this.isWebGLRenderTarget=!0}}class cS extends cO{constructor(a=null,b=1,c=1,d=1){super(null),this.isDataArrayTexture=!0,this.image={data:a,width:b,height:c,depth:d},this.magFilter=aM,this.minFilter=aM,this.wrapR=aK,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(a){this.layerUpdates.add(a)}clearLayerUpdates(){this.layerUpdates.clear()}}class cT extends cO{constructor(a=null,b=1,c=1,d=1){super(null),this.isData3DTexture=!0,this.image={data:a,width:b,height:c,depth:d},this.magFilter=aM,this.minFilter=aM,this.wrapR=aK,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class cU{constructor(a=0,b=0,c=0,d=1){this.isQuaternion=!0,this._x=a,this._y=b,this._z=c,this._w=d}static slerpFlat(a,b,c,d,e,f,g){let h=c[d+0],i=c[d+1],j=c[d+2],k=c[d+3],l=e[f+0],m=e[f+1],n=e[f+2],o=e[f+3];if(0===g){a[b+0]=h,a[b+1]=i,a[b+2]=j,a[b+3]=k;return}if(1===g){a[b+0]=l,a[b+1]=m,a[b+2]=n,a[b+3]=o;return}if(k!==o||h!==l||i!==m||j!==n){let a=1-g,b=h*l+i*m+j*n+k*o,c=b>=0?1:-1,d=1-b*b;if(d>Number.EPSILON){let e=Math.sqrt(d),f=Math.atan2(e,b*c);a=Math.sin(a*f)/e,g=Math.sin(g*f)/e}let e=g*c;if(h=h*a+l*e,i=i*a+m*e,j=j*a+n*e,k=k*a+o*e,a===1-g){let a=1/Math.sqrt(h*h+i*i+j*j+k*k);h*=a,i*=a,j*=a,k*=a}}a[b]=h,a[b+1]=i,a[b+2]=j,a[b+3]=k}static multiplyQuaternionsFlat(a,b,c,d,e,f){let g=c[d],h=c[d+1],i=c[d+2],j=c[d+3],k=e[f],l=e[f+1],m=e[f+2],n=e[f+3];return a[b]=g*n+j*k+h*m-i*l,a[b+1]=h*n+j*l+i*k-g*m,a[b+2]=i*n+j*m+g*l-h*k,a[b+3]=j*n-g*k-h*l-i*m,a}get x(){return this._x}set x(a){this._x=a,this._onChangeCallback()}get y(){return this._y}set y(a){this._y=a,this._onChangeCallback()}get z(){return this._z}set z(a){this._z=a,this._onChangeCallback()}get w(){return this._w}set w(a){this._w=a,this._onChangeCallback()}set(a,b,c,d){return this._x=a,this._y=b,this._z=c,this._w=d,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(a){return this._x=a.x,this._y=a.y,this._z=a.z,this._w=a.w,this._onChangeCallback(),this}setFromEuler(a,b=!0){let c=a._x,d=a._y,e=a._z,f=a._order,g=Math.cos,h=Math.sin,i=g(c/2),j=g(d/2),k=g(e/2),l=h(c/2),m=h(d/2),n=h(e/2);switch(f){case"XYZ":this._x=l*j*k+i*m*n,this._y=i*m*k-l*j*n,this._z=i*j*n+l*m*k,this._w=i*j*k-l*m*n;break;case"YXZ":this._x=l*j*k+i*m*n,this._y=i*m*k-l*j*n,this._z=i*j*n-l*m*k,this._w=i*j*k+l*m*n;break;case"ZXY":this._x=l*j*k-i*m*n,this._y=i*m*k+l*j*n,this._z=i*j*n+l*m*k,this._w=i*j*k-l*m*n;break;case"ZYX":this._x=l*j*k-i*m*n,this._y=i*m*k+l*j*n,this._z=i*j*n-l*m*k,this._w=i*j*k+l*m*n;break;case"YZX":this._x=l*j*k+i*m*n,this._y=i*m*k+l*j*n,this._z=i*j*n-l*m*k,this._w=i*j*k-l*m*n;break;case"XZY":this._x=l*j*k-i*m*n,this._y=i*m*k-l*j*n,this._z=i*j*n+l*m*k,this._w=i*j*k+l*m*n;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+f)}return!0===b&&this._onChangeCallback(),this}setFromAxisAngle(a,b){let c=b/2,d=Math.sin(c);return this._x=a.x*d,this._y=a.y*d,this._z=a.z*d,this._w=Math.cos(c),this._onChangeCallback(),this}setFromRotationMatrix(a){let b=a.elements,c=b[0],d=b[4],e=b[8],f=b[1],g=b[5],h=b[9],i=b[2],j=b[6],k=b[10],l=c+g+k;if(l>0){let a=.5/Math.sqrt(l+1);this._w=.25/a,this._x=(j-h)*a,this._y=(e-i)*a,this._z=(f-d)*a}else if(c>g&&c>k){let a=2*Math.sqrt(1+c-g-k);this._w=(j-h)/a,this._x=.25*a,this._y=(d+f)/a,this._z=(e+i)/a}else if(g>k){let a=2*Math.sqrt(1+g-c-k);this._w=(e-i)/a,this._x=(d+f)/a,this._y=.25*a,this._z=(h+j)/a}else{let a=2*Math.sqrt(1+k-c-g);this._w=(f-d)/a,this._x=(e+i)/a,this._y=(h+j)/a,this._z=.25*a}return this._onChangeCallback(),this}setFromUnitVectors(a,b){let c=a.dot(b)+1;return c<Number.EPSILON?(c=0,Math.abs(a.x)>Math.abs(a.z)?(this._x=-a.y,this._y=a.x,this._z=0):(this._x=0,this._y=-a.z,this._z=a.y)):(this._x=a.y*b.z-a.z*b.y,this._y=a.z*b.x-a.x*b.z,this._z=a.x*b.y-a.y*b.x),this._w=c,this.normalize()}angleTo(a){return 2*Math.acos(Math.abs(cm(this.dot(a),-1,1)))}rotateTowards(a,b){let c=this.angleTo(a);if(0===c)return this;let d=Math.min(1,b/c);return this.slerp(a,d),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let a=this.length();return 0===a?(this._x=0,this._y=0,this._z=0,this._w=1):(a=1/a,this._x=this._x*a,this._y=this._y*a,this._z=this._z*a,this._w=this._w*a),this._onChangeCallback(),this}multiply(a){return this.multiplyQuaternions(this,a)}premultiply(a){return this.multiplyQuaternions(a,this)}multiplyQuaternions(a,b){let c=a._x,d=a._y,e=a._z,f=a._w,g=b._x,h=b._y,i=b._z,j=b._w;return this._x=c*j+f*g+d*i-e*h,this._y=d*j+f*h+e*g-c*i,this._z=e*j+f*i+c*h-d*g,this._w=f*j-c*g-d*h-e*i,this._onChangeCallback(),this}slerp(a,b){if(0===b)return this;if(1===b)return this.copy(a);let c=this._x,d=this._y,e=this._z,f=this._w,g=f*a._w+c*a._x+d*a._y+e*a._z;if(g<0?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,g=-g):this.copy(a),g>=1)return this._w=f,this._x=c,this._y=d,this._z=e,this;let h=1-g*g;if(h<=Number.EPSILON){let a=1-b;return this._w=a*f+b*this._w,this._x=a*c+b*this._x,this._y=a*d+b*this._y,this._z=a*e+b*this._z,this.normalize(),this}let i=Math.sqrt(h),j=Math.atan2(i,g),k=Math.sin((1-b)*j)/i,l=Math.sin(b*j)/i;return this._w=f*k+this._w*l,this._x=c*k+this._x*l,this._y=d*k+this._y*l,this._z=e*k+this._z*l,this._onChangeCallback(),this}slerpQuaternions(a,b,c){return this.copy(a).slerp(b,c)}random(){let a=2*Math.PI*Math.random(),b=2*Math.PI*Math.random(),c=Math.random(),d=Math.sqrt(1-c),e=Math.sqrt(c);return this.set(d*Math.sin(a),d*Math.cos(a),e*Math.sin(b),e*Math.cos(b))}equals(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w}fromArray(a,b=0){return this._x=a[b],this._y=a[b+1],this._z=a[b+2],this._w=a[b+3],this._onChangeCallback(),this}toArray(a=[],b=0){return a[b]=this._x,a[b+1]=this._y,a[b+2]=this._z,a[b+3]=this._w,a}fromBufferAttribute(a,b){return this._x=a.getX(b),this._y=a.getY(b),this._z=a.getZ(b),this._w=a.getW(b),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(a){return this._onChangeCallback=a,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class cV{constructor(a=0,b=0,c=0){cV.prototype.isVector3=!0,this.x=a,this.y=b,this.z=c}set(a,b,c){return void 0===c&&(c=this.z),this.x=a,this.y=b,this.z=c,this}setScalar(a){return this.x=a,this.y=a,this.z=a,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setZ(a){return this.z=a,this}setComponent(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a)}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+a)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(a){return this.x=a.x,this.y=a.y,this.z=a.z,this}add(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this}addScalar(a){return this.x+=a,this.y+=a,this.z+=a,this}addVectors(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this}addScaledVector(a,b){return this.x+=a.x*b,this.y+=a.y*b,this.z+=a.z*b,this}sub(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this}subScalar(a){return this.x-=a,this.y-=a,this.z-=a,this}subVectors(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this}multiply(a){return this.x*=a.x,this.y*=a.y,this.z*=a.z,this}multiplyScalar(a){return this.x*=a,this.y*=a,this.z*=a,this}multiplyVectors(a,b){return this.x=a.x*b.x,this.y=a.y*b.y,this.z=a.z*b.z,this}applyEuler(a){return this.applyQuaternion(cX.setFromEuler(a))}applyAxisAngle(a,b){return this.applyQuaternion(cX.setFromAxisAngle(a,b))}applyMatrix3(a){let b=this.x,c=this.y,d=this.z,e=a.elements;return this.x=e[0]*b+e[3]*c+e[6]*d,this.y=e[1]*b+e[4]*c+e[7]*d,this.z=e[2]*b+e[5]*c+e[8]*d,this}applyNormalMatrix(a){return this.applyMatrix3(a).normalize()}applyMatrix4(a){let b=this.x,c=this.y,d=this.z,e=a.elements,f=1/(e[3]*b+e[7]*c+e[11]*d+e[15]);return this.x=(e[0]*b+e[4]*c+e[8]*d+e[12])*f,this.y=(e[1]*b+e[5]*c+e[9]*d+e[13])*f,this.z=(e[2]*b+e[6]*c+e[10]*d+e[14])*f,this}applyQuaternion(a){let b=this.x,c=this.y,d=this.z,e=a.x,f=a.y,g=a.z,h=a.w,i=2*(f*d-g*c),j=2*(g*b-e*d),k=2*(e*c-f*b);return this.x=b+h*i+f*k-g*j,this.y=c+h*j+g*i-e*k,this.z=d+h*k+e*j-f*i,this}project(a){return this.applyMatrix4(a.matrixWorldInverse).applyMatrix4(a.projectionMatrix)}unproject(a){return this.applyMatrix4(a.projectionMatrixInverse).applyMatrix4(a.matrixWorld)}transformDirection(a){let b=this.x,c=this.y,d=this.z,e=a.elements;return this.x=e[0]*b+e[4]*c+e[8]*d,this.y=e[1]*b+e[5]*c+e[9]*d,this.z=e[2]*b+e[6]*c+e[10]*d,this.normalize()}divide(a){return this.x/=a.x,this.y/=a.y,this.z/=a.z,this}divideScalar(a){return this.multiplyScalar(1/a)}min(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this}max(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this}clamp(a,b){return this.x=cm(this.x,a.x,b.x),this.y=cm(this.y,a.y,b.y),this.z=cm(this.z,a.z,b.z),this}clampScalar(a,b){return this.x=cm(this.x,a,b),this.y=cm(this.y,a,b),this.z=cm(this.z,a,b),this}clampLength(a,b){let c=this.length();return this.divideScalar(c||1).multiplyScalar(cm(c,a,b))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(a){return this.x*a.x+this.y*a.y+this.z*a.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this}lerpVectors(a,b,c){return this.x=a.x+(b.x-a.x)*c,this.y=a.y+(b.y-a.y)*c,this.z=a.z+(b.z-a.z)*c,this}cross(a){return this.crossVectors(this,a)}crossVectors(a,b){let c=a.x,d=a.y,e=a.z,f=b.x,g=b.y,h=b.z;return this.x=d*h-e*g,this.y=e*f-c*h,this.z=c*g-d*f,this}projectOnVector(a){let b=a.lengthSq();if(0===b)return this.set(0,0,0);let c=a.dot(this)/b;return this.copy(a).multiplyScalar(c)}projectOnPlane(a){return cW.copy(this).projectOnVector(a),this.sub(cW)}reflect(a){return this.sub(cW.copy(a).multiplyScalar(2*this.dot(a)))}angleTo(a){let b=Math.sqrt(this.lengthSq()*a.lengthSq());return 0===b?Math.PI/2:Math.acos(cm(this.dot(a)/b,-1,1))}distanceTo(a){return Math.sqrt(this.distanceToSquared(a))}distanceToSquared(a){let b=this.x-a.x,c=this.y-a.y,d=this.z-a.z;return b*b+c*c+d*d}manhattanDistanceTo(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)}setFromSpherical(a){return this.setFromSphericalCoords(a.radius,a.phi,a.theta)}setFromSphericalCoords(a,b,c){let d=Math.sin(b)*a;return this.x=d*Math.sin(c),this.y=Math.cos(b)*a,this.z=d*Math.cos(c),this}setFromCylindrical(a){return this.setFromCylindricalCoords(a.radius,a.theta,a.y)}setFromCylindricalCoords(a,b,c){return this.x=a*Math.sin(b),this.y=c,this.z=a*Math.cos(b),this}setFromMatrixPosition(a){let b=a.elements;return this.x=b[12],this.y=b[13],this.z=b[14],this}setFromMatrixScale(a){let b=this.setFromMatrixColumn(a,0).length(),c=this.setFromMatrixColumn(a,1).length(),d=this.setFromMatrixColumn(a,2).length();return this.x=b,this.y=c,this.z=d,this}setFromMatrixColumn(a,b){return this.fromArray(a.elements,4*b)}setFromMatrix3Column(a,b){return this.fromArray(a.elements,3*b)}setFromEuler(a){return this.x=a._x,this.y=a._y,this.z=a._z,this}setFromColor(a){return this.x=a.r,this.y=a.g,this.z=a.b,this}equals(a){return a.x===this.x&&a.y===this.y&&a.z===this.z}fromArray(a,b=0){return this.x=a[b],this.y=a[b+1],this.z=a[b+2],this}toArray(a=[],b=0){return a[b]=this.x,a[b+1]=this.y,a[b+2]=this.z,a}fromBufferAttribute(a,b){return this.x=a.getX(b),this.y=a.getY(b),this.z=a.getZ(b),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let a=Math.random()*Math.PI*2,b=2*Math.random()-1,c=Math.sqrt(1-b*b);return this.x=c*Math.cos(a),this.y=b,this.z=c*Math.sin(a),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}let cW=new cV,cX=new cU;class cY{constructor(a=new cV(Infinity,Infinity,Infinity),b=new cV(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=a,this.max=b}set(a,b){return this.min.copy(a),this.max.copy(b),this}setFromArray(a){this.makeEmpty();for(let b=0,c=a.length;b<c;b+=3)this.expandByPoint(c$.fromArray(a,b));return this}setFromBufferAttribute(a){this.makeEmpty();for(let b=0,c=a.count;b<c;b++)this.expandByPoint(c$.fromBufferAttribute(a,b));return this}setFromPoints(a){this.makeEmpty();for(let b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this}setFromCenterAndSize(a,b){let c=c$.copy(b).multiplyScalar(.5);return this.min.copy(a).sub(c),this.max.copy(a).add(c),this}setFromObject(a,b=!1){return this.makeEmpty(),this.expandByObject(a,b)}clone(){return new this.constructor().copy(this)}copy(a){return this.min.copy(a.min),this.max.copy(a.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=Infinity,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(a){return this.isEmpty()?a.set(0,0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(a){return this.isEmpty()?a.set(0,0,0):a.subVectors(this.max,this.min)}expandByPoint(a){return this.min.min(a),this.max.max(a),this}expandByVector(a){return this.min.sub(a),this.max.add(a),this}expandByScalar(a){return this.min.addScalar(-a),this.max.addScalar(a),this}expandByObject(a,b=!1){a.updateWorldMatrix(!1,!1);let c=a.geometry;if(void 0!==c){let d=c.getAttribute("position");if(!0===b&&void 0!==d&&!0!==a.isInstancedMesh)for(let b=0,c=d.count;b<c;b++)!0===a.isMesh?a.getVertexPosition(b,c$):c$.fromBufferAttribute(d,b),c$.applyMatrix4(a.matrixWorld),this.expandByPoint(c$);else void 0!==a.boundingBox?(null===a.boundingBox&&a.computeBoundingBox(),c_.copy(a.boundingBox)):(null===c.boundingBox&&c.computeBoundingBox(),c_.copy(c.boundingBox)),c_.applyMatrix4(a.matrixWorld),this.union(c_)}let d=a.children;for(let a=0,c=d.length;a<c;a++)this.expandByObject(d[a],b);return this}containsPoint(a){return a.x>=this.min.x&&a.x<=this.max.x&&a.y>=this.min.y&&a.y<=this.max.y&&a.z>=this.min.z&&a.z<=this.max.z}containsBox(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z}getParameter(a,b){return b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(a){return a.max.x>=this.min.x&&a.min.x<=this.max.x&&a.max.y>=this.min.y&&a.min.y<=this.max.y&&a.max.z>=this.min.z&&a.min.z<=this.max.z}intersectsSphere(a){return this.clampPoint(a.center,c$),c$.distanceToSquared(a.center)<=a.radius*a.radius}intersectsPlane(a){let b,c;return a.normal.x>0?(b=a.normal.x*this.min.x,c=a.normal.x*this.max.x):(b=a.normal.x*this.max.x,c=a.normal.x*this.min.x),a.normal.y>0?(b+=a.normal.y*this.min.y,c+=a.normal.y*this.max.y):(b+=a.normal.y*this.max.y,c+=a.normal.y*this.min.y),a.normal.z>0?(b+=a.normal.z*this.min.z,c+=a.normal.z*this.max.z):(b+=a.normal.z*this.max.z,c+=a.normal.z*this.min.z),b<=-a.constant&&c>=-a.constant}intersectsTriangle(a){if(this.isEmpty())return!1;this.getCenter(c6),c7.subVectors(this.max,c6),c0.subVectors(a.a,c6),c1.subVectors(a.b,c6),c2.subVectors(a.c,c6),c3.subVectors(c1,c0),c4.subVectors(c2,c1),c5.subVectors(c0,c2);let b=[0,-c3.z,c3.y,0,-c4.z,c4.y,0,-c5.z,c5.y,c3.z,0,-c3.x,c4.z,0,-c4.x,c5.z,0,-c5.x,-c3.y,c3.x,0,-c4.y,c4.x,0,-c5.y,c5.x,0];return!!da(b,c0,c1,c2,c7)&&!!da(b=[1,0,0,0,1,0,0,0,1],c0,c1,c2,c7)&&(c8.crossVectors(c3,c4),da(b=[c8.x,c8.y,c8.z],c0,c1,c2,c7))}clampPoint(a,b){return b.copy(a).clamp(this.min,this.max)}distanceToPoint(a){return this.clampPoint(a,c$).distanceTo(a)}getBoundingSphere(a){return this.isEmpty()?a.makeEmpty():(this.getCenter(a.center),a.radius=.5*this.getSize(c$).length()),a}intersect(a){return this.min.max(a.min),this.max.min(a.max),this.isEmpty()&&this.makeEmpty(),this}union(a){return this.min.min(a.min),this.max.max(a.max),this}applyMatrix4(a){return this.isEmpty()||(cZ[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(a),cZ[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(a),cZ[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(a),cZ[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(a),cZ[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(a),cZ[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(a),cZ[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(a),cZ[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(a),this.setFromPoints(cZ)),this}translate(a){return this.min.add(a),this.max.add(a),this}equals(a){return a.min.equals(this.min)&&a.max.equals(this.max)}}let cZ=[new cV,new cV,new cV,new cV,new cV,new cV,new cV,new cV],c$=new cV,c_=new cY,c0=new cV,c1=new cV,c2=new cV,c3=new cV,c4=new cV,c5=new cV,c6=new cV,c7=new cV,c8=new cV,c9=new cV;function da(a,b,c,d,e){for(let f=0,g=a.length-3;f<=g;f+=3){c9.fromArray(a,f);let g=e.x*Math.abs(c9.x)+e.y*Math.abs(c9.y)+e.z*Math.abs(c9.z),h=b.dot(c9),i=c.dot(c9),j=d.dot(c9);if(Math.max(-Math.max(h,i,j),Math.min(h,i,j))>g)return!1}return!0}let db=new cY,dc=new cV,dd=new cV;class de{constructor(a=new cV,b=-1){this.isSphere=!0,this.center=a,this.radius=b}set(a,b){return this.center.copy(a),this.radius=b,this}setFromPoints(a,b){let c=this.center;void 0!==b?c.copy(b):db.setFromPoints(a).getCenter(c);let d=0;for(let b=0,e=a.length;b<e;b++)d=Math.max(d,c.distanceToSquared(a[b]));return this.radius=Math.sqrt(d),this}copy(a){return this.center.copy(a.center),this.radius=a.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(a){return a.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(a){return a.distanceTo(this.center)-this.radius}intersectsSphere(a){let b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b}intersectsBox(a){return a.intersectsSphere(this)}intersectsPlane(a){return Math.abs(a.distanceToPoint(this.center))<=this.radius}clampPoint(a,b){let c=this.center.distanceToSquared(a);return b.copy(a),c>this.radius*this.radius&&(b.sub(this.center).normalize(),b.multiplyScalar(this.radius).add(this.center)),b}getBoundingBox(a){return this.isEmpty()?a.makeEmpty():(a.set(this.center,this.center),a.expandByScalar(this.radius)),a}applyMatrix4(a){return this.center.applyMatrix4(a),this.radius=this.radius*a.getMaxScaleOnAxis(),this}translate(a){return this.center.add(a),this}expandByPoint(a){if(this.isEmpty())return this.center.copy(a),this.radius=0,this;dc.subVectors(a,this.center);let b=dc.lengthSq();if(b>this.radius*this.radius){let a=Math.sqrt(b),c=(a-this.radius)*.5;this.center.addScaledVector(dc,c/a),this.radius+=c}return this}union(a){return a.isEmpty()||(this.isEmpty()?this.copy(a):!0===this.center.equals(a.center)?this.radius=Math.max(this.radius,a.radius):(dd.subVectors(a.center,this.center).setLength(a.radius),this.expandByPoint(dc.copy(a.center).add(dd)),this.expandByPoint(dc.copy(a.center).sub(dd)))),this}equals(a){return a.center.equals(this.center)&&a.radius===this.radius}clone(){return new this.constructor().copy(this)}}let df=new cV,dg=new cV,dh=new cV,di=new cV,dj=new cV,dk=new cV,dl=new cV;class dm{constructor(a=new cV,b=new cV(0,0,-1)){this.origin=a,this.direction=b}set(a,b){return this.origin.copy(a),this.direction.copy(b),this}copy(a){return this.origin.copy(a.origin),this.direction.copy(a.direction),this}at(a,b){return b.copy(this.origin).addScaledVector(this.direction,a)}lookAt(a){return this.direction.copy(a).sub(this.origin).normalize(),this}recast(a){return this.origin.copy(this.at(a,df)),this}closestPointToPoint(a,b){b.subVectors(a,this.origin);let c=b.dot(this.direction);return c<0?b.copy(this.origin):b.copy(this.origin).addScaledVector(this.direction,c)}distanceToPoint(a){return Math.sqrt(this.distanceSqToPoint(a))}distanceSqToPoint(a){let b=df.subVectors(a,this.origin).dot(this.direction);return b<0?this.origin.distanceToSquared(a):(df.copy(this.origin).addScaledVector(this.direction,b),df.distanceToSquared(a))}distanceSqToSegment(a,b,c,d){let e,f,g,h;dg.copy(a).add(b).multiplyScalar(.5),dh.copy(b).sub(a).normalize(),di.copy(this.origin).sub(dg);let i=.5*a.distanceTo(b),j=-this.direction.dot(dh),k=di.dot(this.direction),l=-di.dot(dh),m=di.lengthSq(),n=Math.abs(1-j*j);if(n>0)if(e=j*l-k,f=j*k-l,h=i*n,e>=0)if(f>=-h)if(f<=h){let a=1/n;e*=a,f*=a,g=e*(e+j*f+2*k)+f*(j*e+f+2*l)+m}else g=-(e=Math.max(0,-(j*(f=i)+k)))*e+f*(f+2*l)+m;else g=-(e=Math.max(0,-(j*(f=-i)+k)))*e+f*(f+2*l)+m;else f<=-h?(f=(e=Math.max(0,-(-j*i+k)))>0?-i:Math.min(Math.max(-i,-l),i),g=-e*e+f*(f+2*l)+m):f<=h?(e=0,g=(f=Math.min(Math.max(-i,-l),i))*(f+2*l)+m):(f=(e=Math.max(0,-(j*i+k)))>0?i:Math.min(Math.max(-i,-l),i),g=-e*e+f*(f+2*l)+m);else f=j>0?-i:i,g=-(e=Math.max(0,-(j*f+k)))*e+f*(f+2*l)+m;return c&&c.copy(this.origin).addScaledVector(this.direction,e),d&&d.copy(dg).addScaledVector(dh,f),g}intersectSphere(a,b){df.subVectors(a.center,this.origin);let c=df.dot(this.direction),d=df.dot(df)-c*c,e=a.radius*a.radius;if(d>e)return null;let f=Math.sqrt(e-d),g=c-f,h=c+f;return h<0?null:g<0?this.at(h,b):this.at(g,b)}intersectsSphere(a){return this.distanceSqToPoint(a.center)<=a.radius*a.radius}distanceToPlane(a){let b=a.normal.dot(this.direction);if(0===b)return 0===a.distanceToPoint(this.origin)?0:null;let c=-(this.origin.dot(a.normal)+a.constant)/b;return c>=0?c:null}intersectPlane(a,b){let c=this.distanceToPlane(a);return null===c?null:this.at(c,b)}intersectsPlane(a){let b=a.distanceToPoint(this.origin);return!!(0===b||a.normal.dot(this.direction)*b<0)}intersectBox(a,b){let c,d,e,f,g,h,i=1/this.direction.x,j=1/this.direction.y,k=1/this.direction.z,l=this.origin;return(i>=0?(c=(a.min.x-l.x)*i,d=(a.max.x-l.x)*i):(c=(a.max.x-l.x)*i,d=(a.min.x-l.x)*i),j>=0?(e=(a.min.y-l.y)*j,f=(a.max.y-l.y)*j):(e=(a.max.y-l.y)*j,f=(a.min.y-l.y)*j),c>f||e>d||((e>c||isNaN(c))&&(c=e),(f<d||isNaN(d))&&(d=f),k>=0?(g=(a.min.z-l.z)*k,h=(a.max.z-l.z)*k):(g=(a.max.z-l.z)*k,h=(a.min.z-l.z)*k),c>h||g>d||((g>c||c!=c)&&(c=g),(h<d||d!=d)&&(d=h),d<0)))?null:this.at(c>=0?c:d,b)}intersectsBox(a){return null!==this.intersectBox(a,df)}intersectTriangle(a,b,c,d,e){let f;dj.subVectors(b,a),dk.subVectors(c,a),dl.crossVectors(dj,dk);let g=this.direction.dot(dl);if(g>0){if(d)return null;f=1}else{if(!(g<0))return null;f=-1,g=-g}di.subVectors(this.origin,a);let h=f*this.direction.dot(dk.crossVectors(di,dk));if(h<0)return null;let i=f*this.direction.dot(dj.cross(di));if(i<0||h+i>g)return null;let j=-f*di.dot(dl);return j<0?null:this.at(j/g,e)}applyMatrix4(a){return this.origin.applyMatrix4(a),this.direction.transformDirection(a),this}equals(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class dn{constructor(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){dn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==a&&this.set(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p)}set(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){let q=this.elements;return q[0]=a,q[4]=b,q[8]=c,q[12]=d,q[1]=e,q[5]=f,q[9]=g,q[13]=h,q[2]=i,q[6]=j,q[10]=k,q[14]=l,q[3]=m,q[7]=n,q[11]=o,q[15]=p,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new dn().fromArray(this.elements)}copy(a){let b=this.elements,c=a.elements;return b[0]=c[0],b[1]=c[1],b[2]=c[2],b[3]=c[3],b[4]=c[4],b[5]=c[5],b[6]=c[6],b[7]=c[7],b[8]=c[8],b[9]=c[9],b[10]=c[10],b[11]=c[11],b[12]=c[12],b[13]=c[13],b[14]=c[14],b[15]=c[15],this}copyPosition(a){let b=this.elements,c=a.elements;return b[12]=c[12],b[13]=c[13],b[14]=c[14],this}setFromMatrix3(a){let b=a.elements;return this.set(b[0],b[3],b[6],0,b[1],b[4],b[7],0,b[2],b[5],b[8],0,0,0,0,1),this}extractBasis(a,b,c){return a.setFromMatrixColumn(this,0),b.setFromMatrixColumn(this,1),c.setFromMatrixColumn(this,2),this}makeBasis(a,b,c){return this.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1),this}extractRotation(a){let b=this.elements,c=a.elements,d=1/dp.setFromMatrixColumn(a,0).length(),e=1/dp.setFromMatrixColumn(a,1).length(),f=1/dp.setFromMatrixColumn(a,2).length();return b[0]=c[0]*d,b[1]=c[1]*d,b[2]=c[2]*d,b[3]=0,b[4]=c[4]*e,b[5]=c[5]*e,b[6]=c[6]*e,b[7]=0,b[8]=c[8]*f,b[9]=c[9]*f,b[10]=c[10]*f,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this}makeRotationFromEuler(a){let b=this.elements,c=a.x,d=a.y,e=a.z,f=Math.cos(c),g=Math.sin(c),h=Math.cos(d),i=Math.sin(d),j=Math.cos(e),k=Math.sin(e);if("XYZ"===a.order){let a=f*j,c=f*k,d=g*j,e=g*k;b[0]=h*j,b[4]=-h*k,b[8]=i,b[1]=c+d*i,b[5]=a-e*i,b[9]=-g*h,b[2]=e-a*i,b[6]=d+c*i,b[10]=f*h}else if("YXZ"===a.order){let a=h*j,c=h*k,d=i*j,e=i*k;b[0]=a+e*g,b[4]=d*g-c,b[8]=f*i,b[1]=f*k,b[5]=f*j,b[9]=-g,b[2]=c*g-d,b[6]=e+a*g,b[10]=f*h}else if("ZXY"===a.order){let a=h*j,c=h*k,d=i*j,e=i*k;b[0]=a-e*g,b[4]=-f*k,b[8]=d+c*g,b[1]=c+d*g,b[5]=f*j,b[9]=e-a*g,b[2]=-f*i,b[6]=g,b[10]=f*h}else if("ZYX"===a.order){let a=f*j,c=f*k,d=g*j,e=g*k;b[0]=h*j,b[4]=d*i-c,b[8]=a*i+e,b[1]=h*k,b[5]=e*i+a,b[9]=c*i-d,b[2]=-i,b[6]=g*h,b[10]=f*h}else if("YZX"===a.order){let a=f*h,c=f*i,d=g*h,e=g*i;b[0]=h*j,b[4]=e-a*k,b[8]=d*k+c,b[1]=k,b[5]=f*j,b[9]=-g*j,b[2]=-i*j,b[6]=c*k+d,b[10]=a-e*k}else if("XZY"===a.order){let a=f*h,c=f*i,d=g*h,e=g*i;b[0]=h*j,b[4]=-k,b[8]=i*j,b[1]=a*k+e,b[5]=f*j,b[9]=c*k-d,b[2]=d*k-c,b[6]=g*j,b[10]=e*k+a}return b[3]=0,b[7]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this}makeRotationFromQuaternion(a){return this.compose(dr,a,ds)}lookAt(a,b,c){let d=this.elements;return dv.subVectors(a,b),0===dv.lengthSq()&&(dv.z=1),dv.normalize(),dt.crossVectors(c,dv),0===dt.lengthSq()&&(1===Math.abs(c.z)?dv.x+=1e-4:dv.z+=1e-4,dv.normalize(),dt.crossVectors(c,dv)),dt.normalize(),du.crossVectors(dv,dt),d[0]=dt.x,d[4]=du.x,d[8]=dv.x,d[1]=dt.y,d[5]=du.y,d[9]=dv.y,d[2]=dt.z,d[6]=du.z,d[10]=dv.z,this}multiply(a){return this.multiplyMatrices(this,a)}premultiply(a){return this.multiplyMatrices(a,this)}multiplyMatrices(a,b){let c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[4],h=c[8],i=c[12],j=c[1],k=c[5],l=c[9],m=c[13],n=c[2],o=c[6],p=c[10],q=c[14],r=c[3],s=c[7],t=c[11],u=c[15],v=d[0],w=d[4],x=d[8],y=d[12],z=d[1],A=d[5],B=d[9],C=d[13],D=d[2],E=d[6],F=d[10],G=d[14],H=d[3],I=d[7],J=d[11],K=d[15];return e[0]=f*v+g*z+h*D+i*H,e[4]=f*w+g*A+h*E+i*I,e[8]=f*x+g*B+h*F+i*J,e[12]=f*y+g*C+h*G+i*K,e[1]=j*v+k*z+l*D+m*H,e[5]=j*w+k*A+l*E+m*I,e[9]=j*x+k*B+l*F+m*J,e[13]=j*y+k*C+l*G+m*K,e[2]=n*v+o*z+p*D+q*H,e[6]=n*w+o*A+p*E+q*I,e[10]=n*x+o*B+p*F+q*J,e[14]=n*y+o*C+p*G+q*K,e[3]=r*v+s*z+t*D+u*H,e[7]=r*w+s*A+t*E+u*I,e[11]=r*x+s*B+t*F+u*J,e[15]=r*y+s*C+t*G+u*K,this}multiplyScalar(a){let b=this.elements;return b[0]*=a,b[4]*=a,b[8]*=a,b[12]*=a,b[1]*=a,b[5]*=a,b[9]*=a,b[13]*=a,b[2]*=a,b[6]*=a,b[10]*=a,b[14]*=a,b[3]*=a,b[7]*=a,b[11]*=a,b[15]*=a,this}determinant(){let a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],i=a[13],j=a[2],k=a[6],l=a[10],m=a[14],n=a[3],o=a[7];return n*(e*h*k-d*i*k-e*g*l+c*i*l+d*g*m-c*h*m)+o*(b*h*m-b*i*l+e*f*l-d*f*m+d*i*j-e*h*j)+a[11]*(b*i*k-b*g*m-e*f*k+c*f*m+e*g*j-c*i*j)+a[15]*(-d*g*j-b*h*k+b*g*l+d*f*k-c*f*l+c*h*j)}transpose(){let a,b=this.elements;return a=b[1],b[1]=b[4],b[4]=a,a=b[2],b[2]=b[8],b[8]=a,a=b[6],b[6]=b[9],b[9]=a,a=b[3],b[3]=b[12],b[12]=a,a=b[7],b[7]=b[13],b[13]=a,a=b[11],b[11]=b[14],b[14]=a,this}setPosition(a,b,c){let d=this.elements;return a.isVector3?(d[12]=a.x,d[13]=a.y,d[14]=a.z):(d[12]=a,d[13]=b,d[14]=c),this}invert(){let a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14],q=a[15],r=k*p*i-o*l*i+o*h*m-g*p*m-k*h*q+g*l*q,s=n*l*i-j*p*i-n*h*m+f*p*m+j*h*q-f*l*q,t=j*o*i-n*k*i+n*g*m-f*o*m-j*g*q+f*k*q,u=n*k*h-j*o*h-n*g*l+f*o*l+j*g*p-f*k*p,v=b*r+c*s+d*t+e*u;if(0===v)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let w=1/v;return a[0]=r*w,a[1]=(o*l*e-k*p*e-o*d*m+c*p*m+k*d*q-c*l*q)*w,a[2]=(g*p*e-o*h*e+o*d*i-c*p*i-g*d*q+c*h*q)*w,a[3]=(k*h*e-g*l*e-k*d*i+c*l*i+g*d*m-c*h*m)*w,a[4]=s*w,a[5]=(j*p*e-n*l*e+n*d*m-b*p*m-j*d*q+b*l*q)*w,a[6]=(n*h*e-f*p*e-n*d*i+b*p*i+f*d*q-b*h*q)*w,a[7]=(f*l*e-j*h*e+j*d*i-b*l*i-f*d*m+b*h*m)*w,a[8]=t*w,a[9]=(n*k*e-j*o*e-n*c*m+b*o*m+j*c*q-b*k*q)*w,a[10]=(f*o*e-n*g*e+n*c*i-b*o*i-f*c*q+b*g*q)*w,a[11]=(j*g*e-f*k*e-j*c*i+b*k*i+f*c*m-b*g*m)*w,a[12]=u*w,a[13]=(j*o*d-n*k*d+n*c*l-b*o*l-j*c*p+b*k*p)*w,a[14]=(n*g*d-f*o*d-n*c*h+b*o*h+f*c*p-b*g*p)*w,a[15]=(f*k*d-j*g*d+j*c*h-b*k*h-f*c*l+b*g*l)*w,this}scale(a){let b=this.elements,c=a.x,d=a.y,e=a.z;return b[0]*=c,b[4]*=d,b[8]*=e,b[1]*=c,b[5]*=d,b[9]*=e,b[2]*=c,b[6]*=d,b[10]*=e,b[3]*=c,b[7]*=d,b[11]*=e,this}getMaxScaleOnAxis(){let a=this.elements,b=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];return Math.sqrt(Math.max(b,a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))}makeTranslation(a,b,c){return a.isVector3?this.set(1,0,0,a.x,0,1,0,a.y,0,0,1,a.z,0,0,0,1):this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1),this}makeRotationX(a){let b=Math.cos(a),c=Math.sin(a);return this.set(1,0,0,0,0,b,-c,0,0,c,b,0,0,0,0,1),this}makeRotationY(a){let b=Math.cos(a),c=Math.sin(a);return this.set(b,0,c,0,0,1,0,0,-c,0,b,0,0,0,0,1),this}makeRotationZ(a){let b=Math.cos(a),c=Math.sin(a);return this.set(b,-c,0,0,c,b,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(a,b){let c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,g=a.y,h=a.z,i=e*f,j=e*g;return this.set(i*f+c,i*g-d*h,i*h+d*g,0,i*g+d*h,j*g+c,j*h-d*f,0,i*h-d*g,j*h+d*f,e*h*h+c,0,0,0,0,1),this}makeScale(a,b,c){return this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1),this}makeShear(a,b,c,d,e,f){return this.set(1,c,e,0,a,1,f,0,b,d,1,0,0,0,0,1),this}compose(a,b,c){let d=this.elements,e=b._x,f=b._y,g=b._z,h=b._w,i=e+e,j=f+f,k=g+g,l=e*i,m=e*j,n=e*k,o=f*j,p=f*k,q=g*k,r=h*i,s=h*j,t=h*k,u=c.x,v=c.y,w=c.z;return d[0]=(1-(o+q))*u,d[1]=(m+t)*u,d[2]=(n-s)*u,d[3]=0,d[4]=(m-t)*v,d[5]=(1-(l+q))*v,d[6]=(p+r)*v,d[7]=0,d[8]=(n+s)*w,d[9]=(p-r)*w,d[10]=(1-(l+o))*w,d[11]=0,d[12]=a.x,d[13]=a.y,d[14]=a.z,d[15]=1,this}decompose(a,b,c){let d=this.elements,e=dp.set(d[0],d[1],d[2]).length(),f=dp.set(d[4],d[5],d[6]).length(),g=dp.set(d[8],d[9],d[10]).length();0>this.determinant()&&(e=-e),a.x=d[12],a.y=d[13],a.z=d[14],dq.copy(this);let h=1/e,i=1/f,j=1/g;return dq.elements[0]*=h,dq.elements[1]*=h,dq.elements[2]*=h,dq.elements[4]*=i,dq.elements[5]*=i,dq.elements[6]*=i,dq.elements[8]*=j,dq.elements[9]*=j,dq.elements[10]*=j,b.setFromRotationMatrix(dq),c.x=e,c.y=f,c.z=g,this}makePerspective(a,b,c,d,e,f,g=ce){let h,i,j=this.elements,k=2*e/(b-a),l=2*e/(c-d),m=(b+a)/(b-a),n=(c+d)/(c-d);if(g===ce)h=-(f+e)/(f-e),i=-2*f*e/(f-e);else if(g===cf)h=-f/(f-e),i=-f*e/(f-e);else throw Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+g);return j[0]=k,j[4]=0,j[8]=m,j[12]=0,j[1]=0,j[5]=l,j[9]=n,j[13]=0,j[2]=0,j[6]=0,j[10]=h,j[14]=i,j[3]=0,j[7]=0,j[11]=-1,j[15]=0,this}makeOrthographic(a,b,c,d,e,f,g=ce){let h,i,j=this.elements,k=1/(b-a),l=1/(c-d),m=1/(f-e),n=(b+a)*k,o=(c+d)*l;if(g===ce)h=(f+e)*m,i=-2*m;else if(g===cf)h=e*m,i=-1*m;else throw Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+g);return j[0]=2*k,j[4]=0,j[8]=0,j[12]=-n,j[1]=0,j[5]=2*l,j[9]=0,j[13]=-o,j[2]=0,j[6]=0,j[10]=i,j[14]=-h,j[3]=0,j[7]=0,j[11]=0,j[15]=1,this}equals(a){let b=this.elements,c=a.elements;for(let a=0;a<16;a++)if(b[a]!==c[a])return!1;return!0}fromArray(a,b=0){for(let c=0;c<16;c++)this.elements[c]=a[c+b];return this}toArray(a=[],b=0){let c=this.elements;return a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a[b+9]=c[9],a[b+10]=c[10],a[b+11]=c[11],a[b+12]=c[12],a[b+13]=c[13],a[b+14]=c[14],a[b+15]=c[15],a}}let dp=new cV,dq=new dn,dr=new cV(0,0,0),ds=new cV(1,1,1),dt=new cV,du=new cV,dv=new cV,dw=new dn,dx=new cU;class dy{constructor(a=0,b=0,c=0,d=dy.DEFAULT_ORDER){this.isEuler=!0,this._x=a,this._y=b,this._z=c,this._order=d}get x(){return this._x}set x(a){this._x=a,this._onChangeCallback()}get y(){return this._y}set y(a){this._y=a,this._onChangeCallback()}get z(){return this._z}set z(a){this._z=a,this._onChangeCallback()}get order(){return this._order}set order(a){this._order=a,this._onChangeCallback()}set(a,b,c,d=this._order){return this._x=a,this._y=b,this._z=c,this._order=d,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(a){return this._x=a._x,this._y=a._y,this._z=a._z,this._order=a._order,this._onChangeCallback(),this}setFromRotationMatrix(a,b=this._order,c=!0){let d=a.elements,e=d[0],f=d[4],g=d[8],h=d[1],i=d[5],j=d[9],k=d[2],l=d[6],m=d[10];switch(b){case"XYZ":this._y=Math.asin(cm(g,-1,1)),.9999999>Math.abs(g)?(this._x=Math.atan2(-j,m),this._z=Math.atan2(-f,e)):(this._x=Math.atan2(l,i),this._z=0);break;case"YXZ":this._x=Math.asin(-cm(j,-1,1)),.9999999>Math.abs(j)?(this._y=Math.atan2(g,m),this._z=Math.atan2(h,i)):(this._y=Math.atan2(-k,e),this._z=0);break;case"ZXY":this._x=Math.asin(cm(l,-1,1)),.9999999>Math.abs(l)?(this._y=Math.atan2(-k,m),this._z=Math.atan2(-f,i)):(this._y=0,this._z=Math.atan2(h,e));break;case"ZYX":this._y=Math.asin(-cm(k,-1,1)),.9999999>Math.abs(k)?(this._x=Math.atan2(l,m),this._z=Math.atan2(h,e)):(this._x=0,this._z=Math.atan2(-f,i));break;case"YZX":this._z=Math.asin(cm(h,-1,1)),.9999999>Math.abs(h)?(this._x=Math.atan2(-j,i),this._y=Math.atan2(-k,e)):(this._x=0,this._y=Math.atan2(g,m));break;case"XZY":this._z=Math.asin(-cm(f,-1,1)),.9999999>Math.abs(f)?(this._x=Math.atan2(l,i),this._y=Math.atan2(g,e)):(this._x=Math.atan2(-j,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+b)}return this._order=b,!0===c&&this._onChangeCallback(),this}setFromQuaternion(a,b,c){return dw.makeRotationFromQuaternion(a),this.setFromRotationMatrix(dw,b,c)}setFromVector3(a,b=this._order){return this.set(a.x,a.y,a.z,b)}reorder(a){return dx.setFromEuler(this),this.setFromQuaternion(dx,a)}equals(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order}fromArray(a){return this._x=a[0],this._y=a[1],this._z=a[2],void 0!==a[3]&&(this._order=a[3]),this._onChangeCallback(),this}toArray(a=[],b=0){return a[b]=this._x,a[b+1]=this._y,a[b+2]=this._z,a[b+3]=this._order,a}_onChange(a){return this._onChangeCallback=a,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}dy.DEFAULT_ORDER="XYZ";class dz{constructor(){this.mask=1}set(a){this.mask=1<<a>>>0}enable(a){this.mask|=1<<a}enableAll(){this.mask=-1}toggle(a){this.mask^=1<<a}disable(a){this.mask&=~(1<<a)}disableAll(){this.mask=0}test(a){return(this.mask&a.mask)!=0}isEnabled(a){return(this.mask&1<<a)!=0}}let dA=0,dB=new cV,dC=new cU,dD=new dn,dE=new cV,dF=new cV,dG=new cV,dH=new cU,dI=new cV(1,0,0),dJ=new cV(0,1,0),dK=new cV(0,0,1),dL={type:"added"},dM={type:"removed"},dN={type:"childadded",child:null},dO={type:"childremoved",child:null};class dP extends cg{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:dA++}),this.uuid=cl(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=dP.DEFAULT_UP.clone();let a=new cV,b=new dy,c=new cU,d=new cV(1,1,1);function e(){c.setFromEuler(b,!1)}function f(){b.setFromQuaternion(c,void 0,!1)}b._onChange(e),c._onChange(f),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:a},rotation:{configurable:!0,enumerable:!0,value:b},quaternion:{configurable:!0,enumerable:!0,value:c},scale:{configurable:!0,enumerable:!0,value:d},modelViewMatrix:{value:new dn},normalMatrix:{value:new cs}}),this.matrix=new dn,this.matrixWorld=new dn,this.matrixAutoUpdate=dP.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=dP.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new dz,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(a){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(a),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(a){return this.quaternion.premultiply(a),this}setRotationFromAxisAngle(a,b){this.quaternion.setFromAxisAngle(a,b)}setRotationFromEuler(a){this.quaternion.setFromEuler(a,!0)}setRotationFromMatrix(a){this.quaternion.setFromRotationMatrix(a)}setRotationFromQuaternion(a){this.quaternion.copy(a)}rotateOnAxis(a,b){return dC.setFromAxisAngle(a,b),this.quaternion.multiply(dC),this}rotateOnWorldAxis(a,b){return dC.setFromAxisAngle(a,b),this.quaternion.premultiply(dC),this}rotateX(a){return this.rotateOnAxis(dI,a)}rotateY(a){return this.rotateOnAxis(dJ,a)}rotateZ(a){return this.rotateOnAxis(dK,a)}translateOnAxis(a,b){return dB.copy(a).applyQuaternion(this.quaternion),this.position.add(dB.multiplyScalar(b)),this}translateX(a){return this.translateOnAxis(dI,a)}translateY(a){return this.translateOnAxis(dJ,a)}translateZ(a){return this.translateOnAxis(dK,a)}localToWorld(a){return this.updateWorldMatrix(!0,!1),a.applyMatrix4(this.matrixWorld)}worldToLocal(a){return this.updateWorldMatrix(!0,!1),a.applyMatrix4(dD.copy(this.matrixWorld).invert())}lookAt(a,b,c){a.isVector3?dE.copy(a):dE.set(a,b,c);let d=this.parent;this.updateWorldMatrix(!0,!1),dF.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?dD.lookAt(dF,dE,this.up):dD.lookAt(dE,dF,this.up),this.quaternion.setFromRotationMatrix(dD),d&&(dD.extractRotation(d.matrixWorld),dC.setFromRotationMatrix(dD),this.quaternion.premultiply(dC.invert()))}add(a){if(arguments.length>1){for(let a=0;a<arguments.length;a++)this.add(arguments[a]);return this}return a===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",a):a&&a.isObject3D?(a.removeFromParent(),a.parent=this,this.children.push(a),a.dispatchEvent(dL),dN.child=a,this.dispatchEvent(dN),dN.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",a),this}remove(a){if(arguments.length>1){for(let a=0;a<arguments.length;a++)this.remove(arguments[a]);return this}let b=this.children.indexOf(a);return -1!==b&&(a.parent=null,this.children.splice(b,1),a.dispatchEvent(dM),dO.child=a,this.dispatchEvent(dO),dO.child=null),this}removeFromParent(){let a=this.parent;return null!==a&&a.remove(this),this}clear(){return this.remove(...this.children)}attach(a){return this.updateWorldMatrix(!0,!1),dD.copy(this.matrixWorld).invert(),null!==a.parent&&(a.parent.updateWorldMatrix(!0,!1),dD.multiply(a.parent.matrixWorld)),a.applyMatrix4(dD),a.removeFromParent(),a.parent=this,this.children.push(a),a.updateWorldMatrix(!1,!0),a.dispatchEvent(dL),dN.child=a,this.dispatchEvent(dN),dN.child=null,this}getObjectById(a){return this.getObjectByProperty("id",a)}getObjectByName(a){return this.getObjectByProperty("name",a)}getObjectByProperty(a,b){if(this[a]===b)return this;for(let c=0,d=this.children.length;c<d;c++){let d=this.children[c].getObjectByProperty(a,b);if(void 0!==d)return d}}getObjectsByProperty(a,b,c=[]){this[a]===b&&c.push(this);let d=this.children;for(let e=0,f=d.length;e<f;e++)d[e].getObjectsByProperty(a,b,c);return c}getWorldPosition(a){return this.updateWorldMatrix(!0,!1),a.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(a){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(dF,a,dG),a}getWorldScale(a){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(dF,dH,a),a}getWorldDirection(a){this.updateWorldMatrix(!0,!1);let b=this.matrixWorld.elements;return a.set(b[8],b[9],b[10]).normalize()}raycast(){}traverse(a){a(this);let b=this.children;for(let c=0,d=b.length;c<d;c++)b[c].traverse(a)}traverseVisible(a){if(!1===this.visible)return;a(this);let b=this.children;for(let c=0,d=b.length;c<d;c++)b[c].traverseVisible(a)}traverseAncestors(a){let b=this.parent;null!==b&&(a(b),b.traverseAncestors(a))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(a){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||a)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,a=!0);let b=this.children;for(let c=0,d=b.length;c<d;c++)b[c].updateMatrixWorld(a)}updateWorldMatrix(a,b){let c=this.parent;if(!0===a&&null!==c&&c.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===b){let a=this.children;for(let b=0,c=a.length;b<c;b++)a[b].updateWorldMatrix(!1,!0)}}toJSON(a){let b=void 0===a||"string"==typeof a,c={};b&&(a={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},c.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let d={};function e(b,c){return void 0===b[c.uuid]&&(b[c.uuid]=c.toJSON(a)),c.uuid}if(d.uuid=this.uuid,d.type=this.type,""!==this.name&&(d.name=this.name),!0===this.castShadow&&(d.castShadow=!0),!0===this.receiveShadow&&(d.receiveShadow=!0),!1===this.visible&&(d.visible=!1),!1===this.frustumCulled&&(d.frustumCulled=!1),0!==this.renderOrder&&(d.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(d.userData=this.userData),d.layers=this.layers.mask,d.matrix=this.matrix.toArray(),d.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(d.matrixAutoUpdate=!1),this.isInstancedMesh&&(d.type="InstancedMesh",d.count=this.count,d.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(d.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(d.type="BatchedMesh",d.perObjectFrustumCulled=this.perObjectFrustumCulled,d.sortObjects=this.sortObjects,d.drawRanges=this._drawRanges,d.reservedRanges=this._reservedRanges,d.visibility=this._visibility,d.active=this._active,d.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),d.maxInstanceCount=this._maxInstanceCount,d.maxVertexCount=this._maxVertexCount,d.maxIndexCount=this._maxIndexCount,d.geometryInitialized=this._geometryInitialized,d.geometryCount=this._geometryCount,d.matricesTexture=this._matricesTexture.toJSON(a),null!==this._colorsTexture&&(d.colorsTexture=this._colorsTexture.toJSON(a)),null!==this.boundingSphere&&(d.boundingSphere={center:d.boundingSphere.center.toArray(),radius:d.boundingSphere.radius}),null!==this.boundingBox&&(d.boundingBox={min:d.boundingBox.min.toArray(),max:d.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?d.background=this.background.toJSON():this.background.isTexture&&(d.background=this.background.toJSON(a).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(d.environment=this.environment.toJSON(a).uuid);else if(this.isMesh||this.isLine||this.isPoints){d.geometry=e(a.geometries,this.geometry);let b=this.geometry.parameters;if(void 0!==b&&void 0!==b.shapes){let c=b.shapes;if(Array.isArray(c))for(let b=0,d=c.length;b<d;b++){let d=c[b];e(a.shapes,d)}else e(a.shapes,c)}}if(this.isSkinnedMesh&&(d.bindMode=this.bindMode,d.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(e(a.skeletons,this.skeleton),d.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){let b=[];for(let c=0,d=this.material.length;c<d;c++)b.push(e(a.materials,this.material[c]));d.material=b}else d.material=e(a.materials,this.material);if(this.children.length>0){d.children=[];for(let b=0;b<this.children.length;b++)d.children.push(this.children[b].toJSON(a).object)}if(this.animations.length>0){d.animations=[];for(let b=0;b<this.animations.length;b++){let c=this.animations[b];d.animations.push(e(a.animations,c))}}if(b){let b=f(a.geometries),d=f(a.materials),e=f(a.textures),g=f(a.images),h=f(a.shapes),i=f(a.skeletons),j=f(a.animations),k=f(a.nodes);b.length>0&&(c.geometries=b),d.length>0&&(c.materials=d),e.length>0&&(c.textures=e),g.length>0&&(c.images=g),h.length>0&&(c.shapes=h),i.length>0&&(c.skeletons=i),j.length>0&&(c.animations=j),k.length>0&&(c.nodes=k)}return c.object=d,c;function f(a){let b=[];for(let c in a){let d=a[c];delete d.metadata,b.push(d)}return b}}clone(a){return new this.constructor().copy(this,a)}copy(a,b=!0){if(this.name=a.name,this.up.copy(a.up),this.position.copy(a.position),this.rotation.order=a.rotation.order,this.quaternion.copy(a.quaternion),this.scale.copy(a.scale),this.matrix.copy(a.matrix),this.matrixWorld.copy(a.matrixWorld),this.matrixAutoUpdate=a.matrixAutoUpdate,this.matrixWorldAutoUpdate=a.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate,this.layers.mask=a.layers.mask,this.visible=a.visible,this.castShadow=a.castShadow,this.receiveShadow=a.receiveShadow,this.frustumCulled=a.frustumCulled,this.renderOrder=a.renderOrder,this.animations=a.animations.slice(),this.userData=JSON.parse(JSON.stringify(a.userData)),!0===b)for(let b=0;b<a.children.length;b++){let c=a.children[b];this.add(c.clone())}return this}}dP.DEFAULT_UP=new cV(0,1,0),dP.DEFAULT_MATRIX_AUTO_UPDATE=!0,dP.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;let dQ=new cV,dR=new cV,dS=new cV,dT=new cV,dU=new cV,dV=new cV,dW=new cV,dX=new cV,dY=new cV,dZ=new cV,d$=new cP,d_=new cP,d0=new cP;class d1{constructor(a=new cV,b=new cV,c=new cV){this.a=a,this.b=b,this.c=c}static getNormal(a,b,c,d){d.subVectors(c,b),dQ.subVectors(a,b),d.cross(dQ);let e=d.lengthSq();return e>0?d.multiplyScalar(1/Math.sqrt(e)):d.set(0,0,0)}static getBarycoord(a,b,c,d,e){dQ.subVectors(d,b),dR.subVectors(c,b),dS.subVectors(a,b);let f=dQ.dot(dQ),g=dQ.dot(dR),h=dQ.dot(dS),i=dR.dot(dR),j=dR.dot(dS),k=f*i-g*g;if(0===k)return e.set(0,0,0),null;let l=1/k,m=(i*h-g*j)*l,n=(f*j-g*h)*l;return e.set(1-m-n,n,m)}static containsPoint(a,b,c,d){return null!==this.getBarycoord(a,b,c,d,dT)&&dT.x>=0&&dT.y>=0&&dT.x+dT.y<=1}static getInterpolation(a,b,c,d,e,f,g,h){return null===this.getBarycoord(a,b,c,d,dT)?(h.x=0,h.y=0,"z"in h&&(h.z=0),"w"in h&&(h.w=0),null):(h.setScalar(0),h.addScaledVector(e,dT.x),h.addScaledVector(f,dT.y),h.addScaledVector(g,dT.z),h)}static getInterpolatedAttribute(a,b,c,d,e,f){return d$.setScalar(0),d_.setScalar(0),d0.setScalar(0),d$.fromBufferAttribute(a,b),d_.fromBufferAttribute(a,c),d0.fromBufferAttribute(a,d),f.setScalar(0),f.addScaledVector(d$,e.x),f.addScaledVector(d_,e.y),f.addScaledVector(d0,e.z),f}static isFrontFacing(a,b,c,d){return dQ.subVectors(c,b),dR.subVectors(a,b),0>dQ.cross(dR).dot(d)}set(a,b,c){return this.a.copy(a),this.b.copy(b),this.c.copy(c),this}setFromPointsAndIndices(a,b,c,d){return this.a.copy(a[b]),this.b.copy(a[c]),this.c.copy(a[d]),this}setFromAttributeAndIndices(a,b,c,d){return this.a.fromBufferAttribute(a,b),this.b.fromBufferAttribute(a,c),this.c.fromBufferAttribute(a,d),this}clone(){return new this.constructor().copy(this)}copy(a){return this.a.copy(a.a),this.b.copy(a.b),this.c.copy(a.c),this}getArea(){return dQ.subVectors(this.c,this.b),dR.subVectors(this.a,this.b),.5*dQ.cross(dR).length()}getMidpoint(a){return a.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(a){return d1.getNormal(this.a,this.b,this.c,a)}getPlane(a){return a.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(a,b){return d1.getBarycoord(a,this.a,this.b,this.c,b)}getInterpolation(a,b,c,d,e){return d1.getInterpolation(a,this.a,this.b,this.c,b,c,d,e)}containsPoint(a){return d1.containsPoint(a,this.a,this.b,this.c)}isFrontFacing(a){return d1.isFrontFacing(this.a,this.b,this.c,a)}intersectsBox(a){return a.intersectsTriangle(this)}closestPointToPoint(a,b){let c,d,e=this.a,f=this.b,g=this.c;dU.subVectors(f,e),dV.subVectors(g,e),dX.subVectors(a,e);let h=dU.dot(dX),i=dV.dot(dX);if(h<=0&&i<=0)return b.copy(e);dY.subVectors(a,f);let j=dU.dot(dY),k=dV.dot(dY);if(j>=0&&k<=j)return b.copy(f);let l=h*k-j*i;if(l<=0&&h>=0&&j<=0)return c=h/(h-j),b.copy(e).addScaledVector(dU,c);dZ.subVectors(a,g);let m=dU.dot(dZ),n=dV.dot(dZ);if(n>=0&&m<=n)return b.copy(g);let o=m*i-h*n;if(o<=0&&i>=0&&n<=0)return d=i/(i-n),b.copy(e).addScaledVector(dV,d);let p=j*n-m*k;if(p<=0&&k-j>=0&&m-n>=0)return dW.subVectors(g,f),d=(k-j)/(k-j+(m-n)),b.copy(f).addScaledVector(dW,d);let q=1/(p+o+l);return c=o*q,d=l*q,b.copy(e).addScaledVector(dU,c).addScaledVector(dV,d)}equals(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)}}let d2={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32},d3={h:0,s:0,l:0},d4={h:0,s:0,l:0};function d5(a,b,c){return(c<0&&(c+=1),c>1&&(c-=1),c<1/6)?a+(b-a)*6*c:c<.5?b:c<2/3?a+(b-a)*6*(2/3-c):a}class d6{constructor(a,b,c){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(a,b,c)}set(a,b,c){if(void 0===b&&void 0===c){let b=a;b&&b.isColor?this.copy(b):"number"==typeof b?this.setHex(b):"string"==typeof b&&this.setStyle(b)}else this.setRGB(a,b,c);return this}setScalar(a){return this.r=a,this.g=a,this.b=a,this}setHex(a,b=b$){return a=Math.floor(a),this.r=(a>>16&255)/255,this.g=(a>>8&255)/255,this.b=(255&a)/255,cG.toWorkingColorSpace(this,b),this}setRGB(a,b,c,d=cG.workingColorSpace){return this.r=a,this.g=b,this.b=c,cG.toWorkingColorSpace(this,d),this}setHSL(a,b,c,d=cG.workingColorSpace){if(a=cn(a,1),b=cm(b,0,1),c=cm(c,0,1),0===b)this.r=this.g=this.b=c;else{let d=c<=.5?c*(1+b):c+b-c*b,e=2*c-d;this.r=d5(e,d,a+1/3),this.g=d5(e,d,a),this.b=d5(e,d,a-1/3)}return cG.toWorkingColorSpace(this,d),this}setStyle(a,b=b$){let c;function d(b){void 0!==b&&1>parseFloat(b)&&console.warn("THREE.Color: Alpha component of "+a+" will be ignored.")}if(c=/^(\w+)\(([^\)]*)\)/.exec(a)){let e,f=c[1],g=c[2];switch(f){case"rgb":case"rgba":if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(g))return d(e[4]),this.setRGB(Math.min(255,parseInt(e[1],10))/255,Math.min(255,parseInt(e[2],10))/255,Math.min(255,parseInt(e[3],10))/255,b);if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(g))return d(e[4]),this.setRGB(Math.min(100,parseInt(e[1],10))/100,Math.min(100,parseInt(e[2],10))/100,Math.min(100,parseInt(e[3],10))/100,b);break;case"hsl":case"hsla":if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(g))return d(e[4]),this.setHSL(parseFloat(e[1])/360,parseFloat(e[2])/100,parseFloat(e[3])/100,b);break;default:console.warn("THREE.Color: Unknown color model "+a)}}else if(c=/^\#([A-Fa-f\d]+)$/.exec(a)){let d=c[1],e=d.length;if(3===e)return this.setRGB(parseInt(d.charAt(0),16)/15,parseInt(d.charAt(1),16)/15,parseInt(d.charAt(2),16)/15,b);if(6===e)return this.setHex(parseInt(d,16),b);console.warn("THREE.Color: Invalid hex color "+a)}else if(a&&a.length>0)return this.setColorName(a,b);return this}setColorName(a,b=b$){let c=d2[a.toLowerCase()];return void 0!==c?this.setHex(c,b):console.warn("THREE.Color: Unknown color "+a),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(a){return this.r=a.r,this.g=a.g,this.b=a.b,this}copySRGBToLinear(a){return this.r=cH(a.r),this.g=cH(a.g),this.b=cH(a.b),this}copyLinearToSRGB(a){return this.r=cI(a.r),this.g=cI(a.g),this.b=cI(a.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(a=b$){return cG.fromWorkingColorSpace(d7.copy(this),a),65536*Math.round(cm(255*d7.r,0,255))+256*Math.round(cm(255*d7.g,0,255))+Math.round(cm(255*d7.b,0,255))}getHexString(a=b$){return("000000"+this.getHex(a).toString(16)).slice(-6)}getHSL(a,b=cG.workingColorSpace){let c,d;cG.fromWorkingColorSpace(d7.copy(this),b);let e=d7.r,f=d7.g,g=d7.b,h=Math.max(e,f,g),i=Math.min(e,f,g),j=(i+h)/2;if(i===h)c=0,d=0;else{let a=h-i;switch(d=j<=.5?a/(h+i):a/(2-h-i),h){case e:c=(f-g)/a+6*(f<g);break;case f:c=(g-e)/a+2;break;case g:c=(e-f)/a+4}c/=6}return a.h=c,a.s=d,a.l=j,a}getRGB(a,b=cG.workingColorSpace){return cG.fromWorkingColorSpace(d7.copy(this),b),a.r=d7.r,a.g=d7.g,a.b=d7.b,a}getStyle(a=b$){cG.fromWorkingColorSpace(d7.copy(this),a);let b=d7.r,c=d7.g,d=d7.b;return a!==b$?`color(${a} ${b.toFixed(3)} ${c.toFixed(3)} ${d.toFixed(3)})`:`rgb(${Math.round(255*b)},${Math.round(255*c)},${Math.round(255*d)})`}offsetHSL(a,b,c){return this.getHSL(d3),this.setHSL(d3.h+a,d3.s+b,d3.l+c)}add(a){return this.r+=a.r,this.g+=a.g,this.b+=a.b,this}addColors(a,b){return this.r=a.r+b.r,this.g=a.g+b.g,this.b=a.b+b.b,this}addScalar(a){return this.r+=a,this.g+=a,this.b+=a,this}sub(a){return this.r=Math.max(0,this.r-a.r),this.g=Math.max(0,this.g-a.g),this.b=Math.max(0,this.b-a.b),this}multiply(a){return this.r*=a.r,this.g*=a.g,this.b*=a.b,this}multiplyScalar(a){return this.r*=a,this.g*=a,this.b*=a,this}lerp(a,b){return this.r+=(a.r-this.r)*b,this.g+=(a.g-this.g)*b,this.b+=(a.b-this.b)*b,this}lerpColors(a,b,c){return this.r=a.r+(b.r-a.r)*c,this.g=a.g+(b.g-a.g)*c,this.b=a.b+(b.b-a.b)*c,this}lerpHSL(a,b){this.getHSL(d3),a.getHSL(d4);let c=co(d3.h,d4.h,b),d=co(d3.s,d4.s,b),e=co(d3.l,d4.l,b);return this.setHSL(c,d,e),this}setFromVector3(a){return this.r=a.x,this.g=a.y,this.b=a.z,this}applyMatrix3(a){let b=this.r,c=this.g,d=this.b,e=a.elements;return this.r=e[0]*b+e[3]*c+e[6]*d,this.g=e[1]*b+e[4]*c+e[7]*d,this.b=e[2]*b+e[5]*c+e[8]*d,this}equals(a){return a.r===this.r&&a.g===this.g&&a.b===this.b}fromArray(a,b=0){return this.r=a[b],this.g=a[b+1],this.b=a[b+2],this}toArray(a=[],b=0){return a[b]=this.r,a[b+1]=this.g,a[b+2]=this.b,a}fromBufferAttribute(a,b){return this.r=a.getX(b),this.g=a.getY(b),this.b=a.getZ(b),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}let d7=new d6;d6.NAMES=d2;let d8=0;class d9 extends cg{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:d8++}),this.uuid=cl(),this.name="",this.type="Material",this.blending=L,this.side=H,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Z,this.blendDst=$,this.blendEquation=Q,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new d6(0,0,0),this.blendAlpha=0,this.depthFunc=al,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=b3,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=b2,this.stencilZFail=b2,this.stencilZPass=b2,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(a){this._alphaTest>0!=a>0&&this.version++,this._alphaTest=a}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(a){if(void 0!==a)for(let b in a){let c=a[b];if(void 0===c){console.warn(`THREE.Material: parameter '${b}' has value of undefined.`);continue}let d=this[b];if(void 0===d){console.warn(`THREE.Material: '${b}' is not a property of THREE.${this.type}.`);continue}d&&d.isColor?d.set(c):d&&d.isVector3&&c&&c.isVector3?d.copy(c):this[b]=c}}toJSON(a){let b=void 0===a||"string"==typeof a;b&&(a={textures:{},images:{}});let c={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function d(a){let b=[];for(let c in a){let d=a[c];delete d.metadata,b.push(d)}return b}if(c.uuid=this.uuid,c.type=this.type,""!==this.name&&(c.name=this.name),this.color&&this.color.isColor&&(c.color=this.color.getHex()),void 0!==this.roughness&&(c.roughness=this.roughness),void 0!==this.metalness&&(c.metalness=this.metalness),void 0!==this.sheen&&(c.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(c.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(c.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(c.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(c.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(c.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(c.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(c.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(c.shininess=this.shininess),void 0!==this.clearcoat&&(c.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(c.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(c.clearcoatMap=this.clearcoatMap.toJSON(a).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(c.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(a).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(c.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(a).uuid,c.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(c.dispersion=this.dispersion),void 0!==this.iridescence&&(c.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(c.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(c.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(c.iridescenceMap=this.iridescenceMap.toJSON(a).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(c.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(a).uuid),void 0!==this.anisotropy&&(c.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(c.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(c.anisotropyMap=this.anisotropyMap.toJSON(a).uuid),this.map&&this.map.isTexture&&(c.map=this.map.toJSON(a).uuid),this.matcap&&this.matcap.isTexture&&(c.matcap=this.matcap.toJSON(a).uuid),this.alphaMap&&this.alphaMap.isTexture&&(c.alphaMap=this.alphaMap.toJSON(a).uuid),this.lightMap&&this.lightMap.isTexture&&(c.lightMap=this.lightMap.toJSON(a).uuid,c.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(c.aoMap=this.aoMap.toJSON(a).uuid,c.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(c.bumpMap=this.bumpMap.toJSON(a).uuid,c.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(c.normalMap=this.normalMap.toJSON(a).uuid,c.normalMapType=this.normalMapType,c.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(c.displacementMap=this.displacementMap.toJSON(a).uuid,c.displacementScale=this.displacementScale,c.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(c.roughnessMap=this.roughnessMap.toJSON(a).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(c.metalnessMap=this.metalnessMap.toJSON(a).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(c.emissiveMap=this.emissiveMap.toJSON(a).uuid),this.specularMap&&this.specularMap.isTexture&&(c.specularMap=this.specularMap.toJSON(a).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(c.specularIntensityMap=this.specularIntensityMap.toJSON(a).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(c.specularColorMap=this.specularColorMap.toJSON(a).uuid),this.envMap&&this.envMap.isTexture&&(c.envMap=this.envMap.toJSON(a).uuid,void 0!==this.combine&&(c.combine=this.combine)),void 0!==this.envMapRotation&&(c.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(c.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(c.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(c.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(c.gradientMap=this.gradientMap.toJSON(a).uuid),void 0!==this.transmission&&(c.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(c.transmissionMap=this.transmissionMap.toJSON(a).uuid),void 0!==this.thickness&&(c.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(c.thicknessMap=this.thicknessMap.toJSON(a).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(c.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(c.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(c.size=this.size),null!==this.shadowSide&&(c.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(c.sizeAttenuation=this.sizeAttenuation),this.blending!==L&&(c.blending=this.blending),this.side!==H&&(c.side=this.side),!0===this.vertexColors&&(c.vertexColors=!0),this.opacity<1&&(c.opacity=this.opacity),!0===this.transparent&&(c.transparent=!0),this.blendSrc!==Z&&(c.blendSrc=this.blendSrc),this.blendDst!==$&&(c.blendDst=this.blendDst),this.blendEquation!==Q&&(c.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(c.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(c.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(c.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(c.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(c.blendAlpha=this.blendAlpha),this.depthFunc!==al&&(c.depthFunc=this.depthFunc),!1===this.depthTest&&(c.depthTest=this.depthTest),!1===this.depthWrite&&(c.depthWrite=this.depthWrite),!1===this.colorWrite&&(c.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(c.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==b3&&(c.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(c.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(c.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==b2&&(c.stencilFail=this.stencilFail),this.stencilZFail!==b2&&(c.stencilZFail=this.stencilZFail),this.stencilZPass!==b2&&(c.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(c.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(c.rotation=this.rotation),!0===this.polygonOffset&&(c.polygonOffset=!0),0!==this.polygonOffsetFactor&&(c.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(c.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(c.linewidth=this.linewidth),void 0!==this.dashSize&&(c.dashSize=this.dashSize),void 0!==this.gapSize&&(c.gapSize=this.gapSize),void 0!==this.scale&&(c.scale=this.scale),!0===this.dithering&&(c.dithering=!0),this.alphaTest>0&&(c.alphaTest=this.alphaTest),!0===this.alphaHash&&(c.alphaHash=!0),!0===this.alphaToCoverage&&(c.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(c.premultipliedAlpha=!0),!0===this.forceSinglePass&&(c.forceSinglePass=!0),!0===this.wireframe&&(c.wireframe=!0),this.wireframeLinewidth>1&&(c.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(c.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(c.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(c.flatShading=!0),!1===this.visible&&(c.visible=!1),!1===this.toneMapped&&(c.toneMapped=!1),!1===this.fog&&(c.fog=!1),Object.keys(this.userData).length>0&&(c.userData=this.userData),b){let b=d(a.textures),e=d(a.images);b.length>0&&(c.textures=b),e.length>0&&(c.images=e)}return c}clone(){return new this.constructor().copy(this)}copy(a){this.name=a.name,this.blending=a.blending,this.side=a.side,this.vertexColors=a.vertexColors,this.opacity=a.opacity,this.transparent=a.transparent,this.blendSrc=a.blendSrc,this.blendDst=a.blendDst,this.blendEquation=a.blendEquation,this.blendSrcAlpha=a.blendSrcAlpha,this.blendDstAlpha=a.blendDstAlpha,this.blendEquationAlpha=a.blendEquationAlpha,this.blendColor.copy(a.blendColor),this.blendAlpha=a.blendAlpha,this.depthFunc=a.depthFunc,this.depthTest=a.depthTest,this.depthWrite=a.depthWrite,this.stencilWriteMask=a.stencilWriteMask,this.stencilFunc=a.stencilFunc,this.stencilRef=a.stencilRef,this.stencilFuncMask=a.stencilFuncMask,this.stencilFail=a.stencilFail,this.stencilZFail=a.stencilZFail,this.stencilZPass=a.stencilZPass,this.stencilWrite=a.stencilWrite;let b=a.clippingPlanes,c=null;if(null!==b){let a=b.length;c=Array(a);for(let d=0;d!==a;++d)c[d]=b[d].clone()}return this.clippingPlanes=c,this.clipIntersection=a.clipIntersection,this.clipShadows=a.clipShadows,this.shadowSide=a.shadowSide,this.colorWrite=a.colorWrite,this.precision=a.precision,this.polygonOffset=a.polygonOffset,this.polygonOffsetFactor=a.polygonOffsetFactor,this.polygonOffsetUnits=a.polygonOffsetUnits,this.dithering=a.dithering,this.alphaTest=a.alphaTest,this.alphaHash=a.alphaHash,this.alphaToCoverage=a.alphaToCoverage,this.premultipliedAlpha=a.premultipliedAlpha,this.forceSinglePass=a.forceSinglePass,this.visible=a.visible,this.toneMapped=a.toneMapped,this.userData=JSON.parse(JSON.stringify(a.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(a){!0===a&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class ea extends d9{constructor(a){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new d6(0xffffff),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new dy,this.combine=aq,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapRotation.copy(a.envMapRotation),this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.fog=a.fog,this}}let eb=ec();function ec(){let a=new ArrayBuffer(4),b=new Float32Array(a),c=new Uint32Array(a),d=new Uint32Array(512),e=new Uint32Array(512);for(let a=0;a<256;++a){let b=a-127;b<-27?(d[a]=0,d[256|a]=32768,e[a]=24,e[256|a]=24):b<-14?(d[a]=1024>>-b-14,d[256|a]=1024>>-b-14|32768,e[a]=-b-1,e[256|a]=-b-1):b<=15?(d[a]=b+15<<10,d[256|a]=b+15<<10|32768,e[a]=13,e[256|a]=13):b<128?(d[a]=31744,d[256|a]=64512,e[a]=24,e[256|a]=24):(d[a]=31744,d[256|a]=64512,e[a]=13,e[256|a]=13)}let f=new Uint32Array(2048),g=new Uint32Array(64),h=new Uint32Array(64);for(let a=1;a<1024;++a){let b=a<<13,c=0;for(;(8388608&b)==0;)b<<=1,c-=8388608;b&=-8388609,c+=0x38800000,f[a]=b|c}for(let a=1024;a<2048;++a)f[a]=0x38000000+(a-1024<<13);for(let a=1;a<31;++a)g[a]=a<<23;g[31]=0x47800000,g[32]=0x80000000;for(let a=33;a<63;++a)g[a]=0x80000000+(a-32<<23);g[63]=0xc7800000;for(let a=1;a<64;++a)32!==a&&(h[a]=1024);return{floatView:b,uint32View:c,baseTable:d,shiftTable:e,mantissaTable:f,exponentTable:g,offsetTable:h}}let ed=new cV,ee=new cr,ef=0;class eg{constructor(a,b,c=!1){if(Array.isArray(a))throw TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:ef++}),this.name="",this.array=a,this.itemSize=b,this.count=void 0!==a?a.length/b:0,this.normalized=c,this.usage=cc,this.updateRanges=[],this.gpuType=aY,this.version=0}onUploadCallback(){}set needsUpdate(a){!0===a&&this.version++}setUsage(a){return this.usage=a,this}addUpdateRange(a,b){this.updateRanges.push({start:a,count:b})}clearUpdateRanges(){this.updateRanges.length=0}copy(a){return this.name=a.name,this.array=new a.array.constructor(a.array),this.itemSize=a.itemSize,this.count=a.count,this.normalized=a.normalized,this.usage=a.usage,this.gpuType=a.gpuType,this}copyAt(a,b,c){a*=this.itemSize,c*=b.itemSize;for(let d=0,e=this.itemSize;d<e;d++)this.array[a+d]=b.array[c+d];return this}copyArray(a){return this.array.set(a),this}applyMatrix3(a){if(2===this.itemSize)for(let b=0,c=this.count;b<c;b++)ee.fromBufferAttribute(this,b),ee.applyMatrix3(a),this.setXY(b,ee.x,ee.y);else if(3===this.itemSize)for(let b=0,c=this.count;b<c;b++)ed.fromBufferAttribute(this,b),ed.applyMatrix3(a),this.setXYZ(b,ed.x,ed.y,ed.z);return this}applyMatrix4(a){for(let b=0,c=this.count;b<c;b++)ed.fromBufferAttribute(this,b),ed.applyMatrix4(a),this.setXYZ(b,ed.x,ed.y,ed.z);return this}applyNormalMatrix(a){for(let b=0,c=this.count;b<c;b++)ed.fromBufferAttribute(this,b),ed.applyNormalMatrix(a),this.setXYZ(b,ed.x,ed.y,ed.z);return this}transformDirection(a){for(let b=0,c=this.count;b<c;b++)ed.fromBufferAttribute(this,b),ed.transformDirection(a),this.setXYZ(b,ed.x,ed.y,ed.z);return this}set(a,b=0){return this.array.set(a,b),this}getComponent(a,b){let c=this.array[a*this.itemSize+b];return this.normalized&&(c=cp(c,this.array)),c}setComponent(a,b,c){return this.normalized&&(c=cq(c,this.array)),this.array[a*this.itemSize+b]=c,this}getX(a){let b=this.array[a*this.itemSize];return this.normalized&&(b=cp(b,this.array)),b}setX(a,b){return this.normalized&&(b=cq(b,this.array)),this.array[a*this.itemSize]=b,this}getY(a){let b=this.array[a*this.itemSize+1];return this.normalized&&(b=cp(b,this.array)),b}setY(a,b){return this.normalized&&(b=cq(b,this.array)),this.array[a*this.itemSize+1]=b,this}getZ(a){let b=this.array[a*this.itemSize+2];return this.normalized&&(b=cp(b,this.array)),b}setZ(a,b){return this.normalized&&(b=cq(b,this.array)),this.array[a*this.itemSize+2]=b,this}getW(a){let b=this.array[a*this.itemSize+3];return this.normalized&&(b=cp(b,this.array)),b}setW(a,b){return this.normalized&&(b=cq(b,this.array)),this.array[a*this.itemSize+3]=b,this}setXY(a,b,c){return a*=this.itemSize,this.normalized&&(b=cq(b,this.array),c=cq(c,this.array)),this.array[a+0]=b,this.array[a+1]=c,this}setXYZ(a,b,c,d){return a*=this.itemSize,this.normalized&&(b=cq(b,this.array),c=cq(c,this.array),d=cq(d,this.array)),this.array[a+0]=b,this.array[a+1]=c,this.array[a+2]=d,this}setXYZW(a,b,c,d,e){return a*=this.itemSize,this.normalized&&(b=cq(b,this.array),c=cq(c,this.array),d=cq(d,this.array),e=cq(e,this.array)),this.array[a+0]=b,this.array[a+1]=c,this.array[a+2]=d,this.array[a+3]=e,this}onUpload(a){return this.onUploadCallback=a,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let a={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(a.name=this.name),this.usage!==cc&&(a.usage=this.usage),a}}class eh extends eg{constructor(a,b,c){super(new Uint16Array(a),b,c)}}class ei extends eg{constructor(a,b,c){super(new Uint32Array(a),b,c)}}class ej extends eg{constructor(a,b,c){super(new Float32Array(a),b,c)}}let ek=0,el=new dn,em=new dP,en=new cV,eo=new cY,ep=new cY,eq=new cV;class er extends cg{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:ek++}),this.uuid=cl(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(a){return Array.isArray(a)?this.index=new(cu(a)?ei:eh)(a,1):this.index=a,this}setIndirect(a){return this.indirect=a,this}getIndirect(){return this.indirect}getAttribute(a){return this.attributes[a]}setAttribute(a,b){return this.attributes[a]=b,this}deleteAttribute(a){return delete this.attributes[a],this}hasAttribute(a){return void 0!==this.attributes[a]}addGroup(a,b,c=0){this.groups.push({start:a,count:b,materialIndex:c})}clearGroups(){this.groups=[]}setDrawRange(a,b){this.drawRange.start=a,this.drawRange.count=b}applyMatrix4(a){let b=this.attributes.position;void 0!==b&&(b.applyMatrix4(a),b.needsUpdate=!0);let c=this.attributes.normal;if(void 0!==c){let b=new cs().getNormalMatrix(a);c.applyNormalMatrix(b),c.needsUpdate=!0}let d=this.attributes.tangent;return void 0!==d&&(d.transformDirection(a),d.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(a){return el.makeRotationFromQuaternion(a),this.applyMatrix4(el),this}rotateX(a){return el.makeRotationX(a),this.applyMatrix4(el),this}rotateY(a){return el.makeRotationY(a),this.applyMatrix4(el),this}rotateZ(a){return el.makeRotationZ(a),this.applyMatrix4(el),this}translate(a,b,c){return el.makeTranslation(a,b,c),this.applyMatrix4(el),this}scale(a,b,c){return el.makeScale(a,b,c),this.applyMatrix4(el),this}lookAt(a){return em.lookAt(a),em.updateMatrix(),this.applyMatrix4(em.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(en).negate(),this.translate(en.x,en.y,en.z),this}setFromPoints(a){let b=this.getAttribute("position");if(void 0===b){let b=[];for(let c=0,d=a.length;c<d;c++){let d=a[c];b.push(d.x,d.y,d.z||0)}this.setAttribute("position",new ej(b,3))}else{let c=Math.min(a.length,b.count);for(let d=0;d<c;d++){let c=a[d];b.setXYZ(d,c.x,c.y,c.z||0)}a.length>b.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),b.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new cY);let a=this.attributes.position,b=this.morphAttributes.position;if(a&&a.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new cV(-1/0,-1/0,-1/0),new cV(Infinity,Infinity,Infinity));return}if(void 0!==a){if(this.boundingBox.setFromBufferAttribute(a),b)for(let a=0,c=b.length;a<c;a++){let c=b[a];eo.setFromBufferAttribute(c),this.morphTargetsRelative?(eq.addVectors(this.boundingBox.min,eo.min),this.boundingBox.expandByPoint(eq),eq.addVectors(this.boundingBox.max,eo.max),this.boundingBox.expandByPoint(eq)):(this.boundingBox.expandByPoint(eo.min),this.boundingBox.expandByPoint(eo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new de);let a=this.attributes.position,b=this.morphAttributes.position;if(a&&a.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new cV,1/0);return}if(a){let c=this.boundingSphere.center;if(eo.setFromBufferAttribute(a),b)for(let a=0,c=b.length;a<c;a++){let c=b[a];ep.setFromBufferAttribute(c),this.morphTargetsRelative?(eq.addVectors(eo.min,ep.min),eo.expandByPoint(eq),eq.addVectors(eo.max,ep.max),eo.expandByPoint(eq)):(eo.expandByPoint(ep.min),eo.expandByPoint(ep.max))}eo.getCenter(c);let d=0;for(let b=0,e=a.count;b<e;b++)eq.fromBufferAttribute(a,b),d=Math.max(d,c.distanceToSquared(eq));if(b)for(let e=0,f=b.length;e<f;e++){let f=b[e],g=this.morphTargetsRelative;for(let b=0,e=f.count;b<e;b++)eq.fromBufferAttribute(f,b),g&&(en.fromBufferAttribute(a,b),eq.add(en)),d=Math.max(d,c.distanceToSquared(eq))}this.boundingSphere.radius=Math.sqrt(d),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let a=this.index,b=this.attributes;if(null===a||void 0===b.position||void 0===b.normal||void 0===b.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");let c=b.position,d=b.normal,e=b.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new eg(new Float32Array(4*c.count),4));let f=this.getAttribute("tangent"),g=[],h=[];for(let a=0;a<c.count;a++)g[a]=new cV,h[a]=new cV;let i=new cV,j=new cV,k=new cV,l=new cr,m=new cr,n=new cr,o=new cV,p=new cV;function q(a,b,d){i.fromBufferAttribute(c,a),j.fromBufferAttribute(c,b),k.fromBufferAttribute(c,d),l.fromBufferAttribute(e,a),m.fromBufferAttribute(e,b),n.fromBufferAttribute(e,d),j.sub(i),k.sub(i),m.sub(l),n.sub(l);let f=1/(m.x*n.y-n.x*m.y);isFinite(f)&&(o.copy(j).multiplyScalar(n.y).addScaledVector(k,-m.y).multiplyScalar(f),p.copy(k).multiplyScalar(m.x).addScaledVector(j,-n.x).multiplyScalar(f),g[a].add(o),g[b].add(o),g[d].add(o),h[a].add(p),h[b].add(p),h[d].add(p))}let r=this.groups;0===r.length&&(r=[{start:0,count:a.count}]);for(let b=0,c=r.length;b<c;++b){let c=r[b],d=c.start,e=c.count;for(let b=d,c=d+e;b<c;b+=3)q(a.getX(b+0),a.getX(b+1),a.getX(b+2))}let s=new cV,t=new cV,u=new cV,v=new cV;function w(a){u.fromBufferAttribute(d,a),v.copy(u);let b=g[a];s.copy(b),s.sub(u.multiplyScalar(u.dot(b))).normalize(),t.crossVectors(v,b);let c=0>t.dot(h[a])?-1:1;f.setXYZW(a,s.x,s.y,s.z,c)}for(let b=0,c=r.length;b<c;++b){let c=r[b],d=c.start,e=c.count;for(let b=d,c=d+e;b<c;b+=3)w(a.getX(b+0)),w(a.getX(b+1)),w(a.getX(b+2))}}computeVertexNormals(){let a=this.index,b=this.getAttribute("position");if(void 0!==b){let c=this.getAttribute("normal");if(void 0===c)c=new eg(new Float32Array(3*b.count),3),this.setAttribute("normal",c);else for(let a=0,b=c.count;a<b;a++)c.setXYZ(a,0,0,0);let d=new cV,e=new cV,f=new cV,g=new cV,h=new cV,i=new cV,j=new cV,k=new cV;if(a)for(let l=0,m=a.count;l<m;l+=3){let m=a.getX(l+0),n=a.getX(l+1),o=a.getX(l+2);d.fromBufferAttribute(b,m),e.fromBufferAttribute(b,n),f.fromBufferAttribute(b,o),j.subVectors(f,e),k.subVectors(d,e),j.cross(k),g.fromBufferAttribute(c,m),h.fromBufferAttribute(c,n),i.fromBufferAttribute(c,o),g.add(j),h.add(j),i.add(j),c.setXYZ(m,g.x,g.y,g.z),c.setXYZ(n,h.x,h.y,h.z),c.setXYZ(o,i.x,i.y,i.z)}else for(let a=0,g=b.count;a<g;a+=3)d.fromBufferAttribute(b,a+0),e.fromBufferAttribute(b,a+1),f.fromBufferAttribute(b,a+2),j.subVectors(f,e),k.subVectors(d,e),j.cross(k),c.setXYZ(a+0,j.x,j.y,j.z),c.setXYZ(a+1,j.x,j.y,j.z),c.setXYZ(a+2,j.x,j.y,j.z);this.normalizeNormals(),c.needsUpdate=!0}}normalizeNormals(){let a=this.attributes.normal;for(let b=0,c=a.count;b<c;b++)eq.fromBufferAttribute(a,b),eq.normalize(),a.setXYZ(b,eq.x,eq.y,eq.z)}toNonIndexed(){function a(a,b){let c=a.array,d=a.itemSize,e=a.normalized,f=new c.constructor(b.length*d),g=0,h=0;for(let e=0,i=b.length;e<i;e++){g=a.isInterleavedBufferAttribute?b[e]*a.data.stride+a.offset:b[e]*d;for(let a=0;a<d;a++)f[h++]=c[g++]}return new eg(f,d,e)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let b=new er,c=this.index.array,d=this.attributes;for(let e in d){let f=a(d[e],c);b.setAttribute(e,f)}let e=this.morphAttributes;for(let d in e){let f=[],g=e[d];for(let b=0,d=g.length;b<d;b++){let d=a(g[b],c);f.push(d)}b.morphAttributes[d]=f}b.morphTargetsRelative=this.morphTargetsRelative;let f=this.groups;for(let a=0,c=f.length;a<c;a++){let c=f[a];b.addGroup(c.start,c.count,c.materialIndex)}return b}toJSON(){let a={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),Object.keys(this.userData).length>0&&(a.userData=this.userData),void 0!==this.parameters){let b=this.parameters;for(let c in b)void 0!==b[c]&&(a[c]=b[c]);return a}a.data={attributes:{}};let b=this.index;null!==b&&(a.data.index={type:b.array.constructor.name,array:Array.prototype.slice.call(b.array)});let c=this.attributes;for(let b in c){let d=c[b];a.data.attributes[b]=d.toJSON(a.data)}let d={},e=!1;for(let b in this.morphAttributes){let c=this.morphAttributes[b],f=[];for(let b=0,d=c.length;b<d;b++){let d=c[b];f.push(d.toJSON(a.data))}f.length>0&&(d[b]=f,e=!0)}e&&(a.data.morphAttributes=d,a.data.morphTargetsRelative=this.morphTargetsRelative);let f=this.groups;f.length>0&&(a.data.groups=JSON.parse(JSON.stringify(f)));let g=this.boundingSphere;return null!==g&&(a.data.boundingSphere={center:g.center.toArray(),radius:g.radius}),a}clone(){return new this.constructor().copy(this)}copy(a){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let b={};this.name=a.name;let c=a.index;null!==c&&this.setIndex(c.clone(b));let d=a.attributes;for(let a in d){let c=d[a];this.setAttribute(a,c.clone(b))}let e=a.morphAttributes;for(let a in e){let c=[],d=e[a];for(let a=0,e=d.length;a<e;a++)c.push(d[a].clone(b));this.morphAttributes[a]=c}this.morphTargetsRelative=a.morphTargetsRelative;let f=a.groups;for(let a=0,b=f.length;a<b;a++){let b=f[a];this.addGroup(b.start,b.count,b.materialIndex)}let g=a.boundingBox;null!==g&&(this.boundingBox=g.clone());let h=a.boundingSphere;return null!==h&&(this.boundingSphere=h.clone()),this.drawRange.start=a.drawRange.start,this.drawRange.count=a.drawRange.count,this.userData=a.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}let es=new dn,et=new dm,eu=new de,ev=new cV,ew=new cV,ex=new cV,ey=new cV,ez=new cV,eA=new cV,eB=new cV,eC=new cV;class eD extends dP{constructor(a=new er,b=new ea){super(),this.isMesh=!0,this.type="Mesh",this.geometry=a,this.material=b,this.updateMorphTargets()}copy(a,b){return super.copy(a,b),void 0!==a.morphTargetInfluences&&(this.morphTargetInfluences=a.morphTargetInfluences.slice()),void 0!==a.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},a.morphTargetDictionary)),this.material=Array.isArray(a.material)?a.material.slice():a.material,this.geometry=a.geometry,this}updateMorphTargets(){let a=this.geometry.morphAttributes,b=Object.keys(a);if(b.length>0){let c=a[b[0]];if(void 0!==c){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,b=c.length;a<b;a++){let b=c[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[b]=a}}}}getVertexPosition(a,b){let c=this.geometry,d=c.attributes.position,e=c.morphAttributes.position,f=c.morphTargetsRelative;b.fromBufferAttribute(d,a);let g=this.morphTargetInfluences;if(e&&g){eA.set(0,0,0);for(let c=0,d=e.length;c<d;c++){let d=g[c],h=e[c];0!==d&&(ez.fromBufferAttribute(h,a),f?eA.addScaledVector(ez,d):eA.addScaledVector(ez.sub(b),d))}b.add(eA)}return b}raycast(a,b){let c=this.geometry,d=this.material,e=this.matrixWorld;if(void 0!==d)null===c.boundingSphere&&c.computeBoundingSphere(),eu.copy(c.boundingSphere),eu.applyMatrix4(e),et.copy(a.ray).recast(a.near),!1===eu.containsPoint(et.origin)&&(null===et.intersectSphere(eu,ev)||et.origin.distanceToSquared(ev)>(a.far-a.near)**2)||(es.copy(e).invert(),et.copy(a.ray).applyMatrix4(es),(null===c.boundingBox||!1!==et.intersectsBox(c.boundingBox))&&this._computeIntersections(a,b,et))}_computeIntersections(a,b,c){let d,e=this.geometry,f=this.material,g=e.index,h=e.attributes.position,i=e.attributes.uv,j=e.attributes.uv1,k=e.attributes.normal,l=e.groups,m=e.drawRange;if(null!==g)if(Array.isArray(f))for(let e=0,h=l.length;e<h;e++){let h=l[e],n=f[h.materialIndex],o=Math.max(h.start,m.start),p=Math.min(g.count,Math.min(h.start+h.count,m.start+m.count));for(let e=o,f=p;e<f;e+=3){let f=g.getX(e);(d=eF(this,n,a,c,i,j,k,f,g.getX(e+1),g.getX(e+2)))&&(d.faceIndex=Math.floor(e/3),d.face.materialIndex=h.materialIndex,b.push(d))}}else{let e=Math.max(0,m.start),h=Math.min(g.count,m.start+m.count);for(let l=e,m=h;l<m;l+=3){let e=g.getX(l);(d=eF(this,f,a,c,i,j,k,e,g.getX(l+1),g.getX(l+2)))&&(d.faceIndex=Math.floor(l/3),b.push(d))}}else if(void 0!==h)if(Array.isArray(f))for(let e=0,g=l.length;e<g;e++){let g=l[e],n=f[g.materialIndex],o=Math.max(g.start,m.start),p=Math.min(h.count,Math.min(g.start+g.count,m.start+m.count));for(let e=o,f=p;e<f;e+=3)(d=eF(this,n,a,c,i,j,k,e,e+1,e+2))&&(d.faceIndex=Math.floor(e/3),d.face.materialIndex=g.materialIndex,b.push(d))}else{let e=Math.max(0,m.start),g=Math.min(h.count,m.start+m.count);for(let h=e,l=g;h<l;h+=3)(d=eF(this,f,a,c,i,j,k,h,h+1,h+2))&&(d.faceIndex=Math.floor(h/3),b.push(d))}}}function eE(a,b,c,d,e,f,g,h){let i;if(null===(i=b.side===I?d.intersectTriangle(g,f,e,!0,h):d.intersectTriangle(e,f,g,b.side===H,h)))return null;eC.copy(h),eC.applyMatrix4(a.matrixWorld);let j=c.ray.origin.distanceTo(eC);return j<c.near||j>c.far?null:{distance:j,point:eC.clone(),object:a}}function eF(a,b,c,d,e,f,g,h,i,j){a.getVertexPosition(h,ew),a.getVertexPosition(i,ex),a.getVertexPosition(j,ey);let k=eE(a,b,c,d,ew,ex,ey,eB);if(k){let a=new cV;d1.getBarycoord(eB,ew,ex,ey,a),e&&(k.uv=d1.getInterpolatedAttribute(e,h,i,j,a,new cr)),f&&(k.uv1=d1.getInterpolatedAttribute(f,h,i,j,a,new cr)),g&&(k.normal=d1.getInterpolatedAttribute(g,h,i,j,a,new cV),k.normal.dot(d.direction)>0&&k.normal.multiplyScalar(-1));let b={a:h,b:i,c:j,normal:new cV,materialIndex:0};d1.getNormal(ew,ex,ey,b.normal),k.face=b,k.barycoord=a}return k}class eG extends er{constructor(a=1,b=1,c=1,d=1,e=1,f=1){super(),this.type="BoxGeometry",this.parameters={width:a,height:b,depth:c,widthSegments:d,heightSegments:e,depthSegments:f};let g=this;d=Math.floor(d),e=Math.floor(e);let h=[],i=[],j=[],k=[],l=0,m=0;function n(a,b,c,d,e,f,n,o,p,q,r){let s=f/p,t=n/q,u=f/2,v=n/2,w=o/2,x=p+1,y=q+1,z=0,A=0,B=new cV;for(let f=0;f<y;f++){let g=f*t-v;for(let h=0;h<x;h++){let l=h*s-u;B[a]=l*d,B[b]=g*e,B[c]=w,i.push(B.x,B.y,B.z),B[a]=0,B[b]=0,B[c]=o>0?1:-1,j.push(B.x,B.y,B.z),k.push(h/p),k.push(1-f/q),z+=1}}for(let a=0;a<q;a++)for(let b=0;b<p;b++){let c=l+b+x*a,d=l+b+x*(a+1),e=l+(b+1)+x*(a+1),f=l+(b+1)+x*a;h.push(c,d,f),h.push(d,e,f),A+=6}g.addGroup(m,A,r),m+=A,l+=z}n("z","y","x",-1,-1,c,b,a,f=Math.floor(f),e,0),n("z","y","x",1,-1,c,b,-a,f,e,1),n("x","z","y",1,1,a,c,b,d,f,2),n("x","z","y",1,-1,a,c,-b,d,f,3),n("x","y","z",1,-1,a,b,c,d,e,4),n("x","y","z",-1,-1,a,b,-c,d,e,5),this.setIndex(h),this.setAttribute("position",new ej(i,3)),this.setAttribute("normal",new ej(j,3)),this.setAttribute("uv",new ej(k,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new eG(a.width,a.height,a.depth,a.widthSegments,a.heightSegments,a.depthSegments)}}function eH(a){let b={};for(let c in a)for(let d in b[c]={},a[c]){let e=a[c][d];e&&(e.isColor||e.isMatrix3||e.isMatrix4||e.isVector2||e.isVector3||e.isVector4||e.isTexture||e.isQuaternion)?e.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),b[c][d]=null):b[c][d]=e.clone():Array.isArray(e)?b[c][d]=e.slice():b[c][d]=e}return b}function eI(a){let b={};for(let c=0;c<a.length;c++){let d=eH(a[c]);for(let a in d)b[a]=d[a]}return b}function eJ(a){let b=[];for(let c=0;c<a.length;c++)b.push(a[c].clone());return b}function eK(a){let b=a.getRenderTarget();return null===b?a.outputColorSpace:!0===b.isXRRenderTarget?b.texture.colorSpace:cG.workingColorSpace}let eL={clone:eH};var eM="void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",eN="void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";class eO extends d9{constructor(a){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=eM,this.fragmentShader=eN,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==a&&this.setValues(a)}copy(a){return super.copy(a),this.fragmentShader=a.fragmentShader,this.vertexShader=a.vertexShader,this.uniforms=eH(a.uniforms),this.uniformsGroups=eJ(a.uniformsGroups),this.defines=Object.assign({},a.defines),this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.fog=a.fog,this.lights=a.lights,this.clipping=a.clipping,this.extensions=Object.assign({},a.extensions),this.glslVersion=a.glslVersion,this}toJSON(a){let b=super.toJSON(a);for(let c in b.glslVersion=this.glslVersion,b.uniforms={},this.uniforms){let d=this.uniforms[c].value;d&&d.isTexture?b.uniforms[c]={type:"t",value:d.toJSON(a).uuid}:d&&d.isColor?b.uniforms[c]={type:"c",value:d.getHex()}:d&&d.isVector2?b.uniforms[c]={type:"v2",value:d.toArray()}:d&&d.isVector3?b.uniforms[c]={type:"v3",value:d.toArray()}:d&&d.isVector4?b.uniforms[c]={type:"v4",value:d.toArray()}:d&&d.isMatrix3?b.uniforms[c]={type:"m3",value:d.toArray()}:d&&d.isMatrix4?b.uniforms[c]={type:"m4",value:d.toArray()}:b.uniforms[c]={value:d}}Object.keys(this.defines).length>0&&(b.defines=this.defines),b.vertexShader=this.vertexShader,b.fragmentShader=this.fragmentShader,b.lights=this.lights,b.clipping=this.clipping;let c={};for(let a in this.extensions)!0===this.extensions[a]&&(c[a]=!0);return Object.keys(c).length>0&&(b.extensions=c),b}}class eP extends dP{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new dn,this.projectionMatrix=new dn,this.projectionMatrixInverse=new dn,this.coordinateSystem=ce}copy(a,b){return super.copy(a,b),this.matrixWorldInverse.copy(a.matrixWorldInverse),this.projectionMatrix.copy(a.projectionMatrix),this.projectionMatrixInverse.copy(a.projectionMatrixInverse),this.coordinateSystem=a.coordinateSystem,this}getWorldDirection(a){return super.getWorldDirection(a).negate()}updateMatrixWorld(a){super.updateMatrixWorld(a),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(a,b){super.updateWorldMatrix(a,b),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}let eQ=new cV,eR=new cr,eS=new cr;class eT extends eP{constructor(a=50,b=1,c=.1,d=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=a,this.zoom=1,this.near=c,this.far=d,this.focus=10,this.aspect=b,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(a,b){return super.copy(a,b),this.fov=a.fov,this.zoom=a.zoom,this.near=a.near,this.far=a.far,this.focus=a.focus,this.aspect=a.aspect,this.view=null===a.view?null:Object.assign({},a.view),this.filmGauge=a.filmGauge,this.filmOffset=a.filmOffset,this}setFocalLength(a){let b=.5*this.getFilmHeight()/a;this.fov=2*ck*Math.atan(b),this.updateProjectionMatrix()}getFocalLength(){let a=Math.tan(.5*cj*this.fov);return .5*this.getFilmHeight()/a}getEffectiveFOV(){return 2*ck*Math.atan(Math.tan(.5*cj*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(a,b,c){eQ.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),b.set(eQ.x,eQ.y).multiplyScalar(-a/eQ.z),eQ.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),c.set(eQ.x,eQ.y).multiplyScalar(-a/eQ.z)}getViewSize(a,b){return this.getViewBounds(a,eR,eS),b.subVectors(eS,eR)}setViewOffset(a,b,c,d,e,f){this.aspect=a/b,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=a,this.view.fullHeight=b,this.view.offsetX=c,this.view.offsetY=d,this.view.width=e,this.view.height=f,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let a=this.near,b=a*Math.tan(.5*cj*this.fov)/this.zoom,c=2*b,d=this.aspect*c,e=-.5*d,f=this.view;if(null!==this.view&&this.view.enabled){let a=f.fullWidth,g=f.fullHeight;e+=f.offsetX*d/a,b-=f.offsetY*c/g,d*=f.width/a,c*=f.height/g}let g=this.filmOffset;0!==g&&(e+=a*g/this.getFilmWidth()),this.projectionMatrix.makePerspective(e,e+d,b,b-c,a,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(a){let b=super.toJSON(a);return b.object.fov=this.fov,b.object.zoom=this.zoom,b.object.near=this.near,b.object.far=this.far,b.object.focus=this.focus,b.object.aspect=this.aspect,null!==this.view&&(b.object.view=Object.assign({},this.view)),b.object.filmGauge=this.filmGauge,b.object.filmOffset=this.filmOffset,b}}let eU=-90,eV=1;class eW extends dP{constructor(a,b,c){super(),this.type="CubeCamera",this.renderTarget=c,this.coordinateSystem=null,this.activeMipmapLevel=0;let d=new eT(eU,eV,a,b);d.layers=this.layers,this.add(d);let e=new eT(eU,eV,a,b);e.layers=this.layers,this.add(e);let f=new eT(eU,eV,a,b);f.layers=this.layers,this.add(f);let g=new eT(eU,eV,a,b);g.layers=this.layers,this.add(g);let h=new eT(eU,eV,a,b);h.layers=this.layers,this.add(h);let i=new eT(eU,eV,a,b);i.layers=this.layers,this.add(i)}updateCoordinateSystem(){let a=this.coordinateSystem,b=this.children.concat(),[c,d,e,f,g,h]=b;for(let a of b)this.remove(a);if(a===ce)c.up.set(0,1,0),c.lookAt(1,0,0),d.up.set(0,1,0),d.lookAt(-1,0,0),e.up.set(0,0,-1),e.lookAt(0,1,0),f.up.set(0,0,1),f.lookAt(0,-1,0),g.up.set(0,1,0),g.lookAt(0,0,1),h.up.set(0,1,0),h.lookAt(0,0,-1);else if(a===cf)c.up.set(0,-1,0),c.lookAt(-1,0,0),d.up.set(0,-1,0),d.lookAt(1,0,0),e.up.set(0,0,1),e.lookAt(0,1,0),f.up.set(0,0,-1),f.lookAt(0,-1,0),g.up.set(0,-1,0),g.lookAt(0,0,1),h.up.set(0,-1,0),h.lookAt(0,0,-1);else throw Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+a);for(let a of b)this.add(a),a.updateMatrixWorld()}update(a,b){null===this.parent&&this.updateMatrixWorld();let{renderTarget:c,activeMipmapLevel:d}=this;this.coordinateSystem!==a.coordinateSystem&&(this.coordinateSystem=a.coordinateSystem,this.updateCoordinateSystem());let[e,f,g,h,i,j]=this.children,k=a.getRenderTarget(),l=a.getActiveCubeFace(),m=a.getActiveMipmapLevel(),n=a.xr.enabled;a.xr.enabled=!1;let o=c.texture.generateMipmaps;c.texture.generateMipmaps=!1,a.setRenderTarget(c,0,d),a.render(b,e),a.setRenderTarget(c,1,d),a.render(b,f),a.setRenderTarget(c,2,d),a.render(b,g),a.setRenderTarget(c,3,d),a.render(b,h),a.setRenderTarget(c,4,d),a.render(b,i),c.texture.generateMipmaps=o,a.setRenderTarget(c,5,d),a.render(b,j),a.setRenderTarget(k,l,m),a.xr.enabled=n,c.texture.needsPMREMUpdate=!0}}class eX extends cO{constructor(a,b,c,d,e,f,g,h,i,j){super(a=void 0!==a?a:[],b=void 0!==b?b:aE,c,d,e,f,g,h,i,j),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(a){this.image=a}}class eY extends cR{constructor(a=1,b={}){super(a,a,b),this.isWebGLCubeRenderTarget=!0;let c={width:a,height:a,depth:1},d=[c,c,c,c,c,c];this.texture=new eX(d,b.mapping,b.wrapS,b.wrapT,b.magFilter,b.minFilter,b.format,b.type,b.anisotropy,b.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==b.generateMipmaps&&b.generateMipmaps,this.texture.minFilter=void 0!==b.minFilter?b.minFilter:aP}fromEquirectangularTexture(a,b){this.texture.type=b.type,this.texture.colorSpace=b.colorSpace,this.texture.generateMipmaps=b.generateMipmaps,this.texture.minFilter=b.minFilter,this.texture.magFilter=b.magFilter;let c={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},d=new eG(5,5,5),e=new eO({name:"CubemapFromEquirect",uniforms:eH(c.uniforms),vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,side:I,blending:K});e.uniforms.tEquirect.value=b;let f=new eD(d,e),g=b.minFilter;return b.minFilter===aR&&(b.minFilter=aP),new eW(1,10,this).update(a,f),b.minFilter=g,f.geometry.dispose(),f.material.dispose(),this}clear(a,b,c,d){let e=a.getRenderTarget();for(let e=0;e<6;e++)a.setRenderTarget(this,e),a.clear(b,c,d);a.setRenderTarget(e)}}class eZ extends dP{constructor(){super(),this.isGroup=!0,this.type="Group"}}let e$={type:"move"};class e_{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new eZ,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new eZ,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new cV,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new cV),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new eZ,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new cV,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new cV),this._grip}dispatchEvent(a){return null!==this._targetRay&&this._targetRay.dispatchEvent(a),null!==this._grip&&this._grip.dispatchEvent(a),null!==this._hand&&this._hand.dispatchEvent(a),this}connect(a){if(a&&a.hand){let b=this._hand;if(b)for(let c of a.hand.values())this._getHandJoint(b,c)}return this.dispatchEvent({type:"connected",data:a}),this}disconnect(a){return this.dispatchEvent({type:"disconnected",data:a}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(a,b,c){let d=null,e=null,f=null,g=this._targetRay,h=this._grip,i=this._hand;if(a&&"visible-blurred"!==b.session.visibilityState){if(i&&a.hand){for(let d of(f=!0,a.hand.values())){let a=b.getJointPose(d,c),e=this._getHandJoint(i,d);null!==a&&(e.matrix.fromArray(a.transform.matrix),e.matrix.decompose(e.position,e.rotation,e.scale),e.matrixWorldNeedsUpdate=!0,e.jointRadius=a.radius),e.visible=null!==a}let d=i.joints["index-finger-tip"],e=i.joints["thumb-tip"],g=d.position.distanceTo(e.position),h=.02,j=.005;i.inputState.pinching&&g>h+j?(i.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:a.handedness,target:this})):!i.inputState.pinching&&g<=h-j&&(i.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:a.handedness,target:this}))}else null!==h&&a.gripSpace&&null!==(e=b.getPose(a.gripSpace,c))&&(h.matrix.fromArray(e.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.matrixWorldNeedsUpdate=!0,e.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(e.linearVelocity)):h.hasLinearVelocity=!1,e.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(e.angularVelocity)):h.hasAngularVelocity=!1);null!==g&&(null===(d=b.getPose(a.targetRaySpace,c))&&null!==e&&(d=e),null!==d&&(g.matrix.fromArray(d.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.matrixWorldNeedsUpdate=!0,d.linearVelocity?(g.hasLinearVelocity=!0,g.linearVelocity.copy(d.linearVelocity)):g.hasLinearVelocity=!1,d.angularVelocity?(g.hasAngularVelocity=!0,g.angularVelocity.copy(d.angularVelocity)):g.hasAngularVelocity=!1,this.dispatchEvent(e$)))}return null!==g&&(g.visible=null!==d),null!==h&&(h.visible=null!==e),null!==i&&(i.visible=null!==f),this}_getHandJoint(a,b){if(void 0===a.joints[b.jointName]){let c=new eZ;c.matrixAutoUpdate=!1,c.visible=!1,a.joints[b.jointName]=c,a.add(c)}return a.joints[b.jointName]}}class e0{constructor(a,b=25e-5){this.isFogExp2=!0,this.name="",this.color=new d6(a),this.density=b}clone(){return new e0(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class e1{constructor(a,b=1,c=1e3){this.isFog=!0,this.name="",this.color=new d6(a),this.near=b,this.far=c}clone(){return new e1(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class e2 extends dP{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new dy,this.environmentIntensity=1,this.environmentRotation=new dy,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(a,b){return super.copy(a,b),null!==a.background&&(this.background=a.background.clone()),null!==a.environment&&(this.environment=a.environment.clone()),null!==a.fog&&(this.fog=a.fog.clone()),this.backgroundBlurriness=a.backgroundBlurriness,this.backgroundIntensity=a.backgroundIntensity,this.backgroundRotation.copy(a.backgroundRotation),this.environmentIntensity=a.environmentIntensity,this.environmentRotation.copy(a.environmentRotation),null!==a.overrideMaterial&&(this.overrideMaterial=a.overrideMaterial.clone()),this.matrixAutoUpdate=a.matrixAutoUpdate,this}toJSON(a){let b=super.toJSON(a);return null!==this.fog&&(b.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(b.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(b.object.backgroundIntensity=this.backgroundIntensity),b.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(b.object.environmentIntensity=this.environmentIntensity),b.object.environmentRotation=this.environmentRotation.toArray(),b}}class e3{constructor(a,b){this.isInterleavedBuffer=!0,this.array=a,this.stride=b,this.count=void 0!==a?a.length/b:0,this.usage=cc,this.updateRanges=[],this.version=0,this.uuid=cl()}onUploadCallback(){}set needsUpdate(a){!0===a&&this.version++}setUsage(a){return this.usage=a,this}addUpdateRange(a,b){this.updateRanges.push({start:a,count:b})}clearUpdateRanges(){this.updateRanges.length=0}copy(a){return this.array=new a.array.constructor(a.array),this.count=a.count,this.stride=a.stride,this.usage=a.usage,this}copyAt(a,b,c){a*=this.stride,c*=b.stride;for(let d=0,e=this.stride;d<e;d++)this.array[a+d]=b.array[c+d];return this}set(a,b=0){return this.array.set(a,b),this}clone(a){void 0===a.arrayBuffers&&(a.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=cl()),void 0===a.arrayBuffers[this.array.buffer._uuid]&&(a.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let b=new this.array.constructor(a.arrayBuffers[this.array.buffer._uuid]),c=new this.constructor(b,this.stride);return c.setUsage(this.usage),c}onUpload(a){return this.onUploadCallback=a,this}toJSON(a){return void 0===a.arrayBuffers&&(a.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=cl()),void 0===a.arrayBuffers[this.array.buffer._uuid]&&(a.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}let e4=new cV;class e5{constructor(a,b,c,d=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=a,this.itemSize=b,this.offset=c,this.normalized=d}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(a){this.data.needsUpdate=a}applyMatrix4(a){for(let b=0,c=this.data.count;b<c;b++)e4.fromBufferAttribute(this,b),e4.applyMatrix4(a),this.setXYZ(b,e4.x,e4.y,e4.z);return this}applyNormalMatrix(a){for(let b=0,c=this.count;b<c;b++)e4.fromBufferAttribute(this,b),e4.applyNormalMatrix(a),this.setXYZ(b,e4.x,e4.y,e4.z);return this}transformDirection(a){for(let b=0,c=this.count;b<c;b++)e4.fromBufferAttribute(this,b),e4.transformDirection(a),this.setXYZ(b,e4.x,e4.y,e4.z);return this}getComponent(a,b){let c=this.array[a*this.data.stride+this.offset+b];return this.normalized&&(c=cp(c,this.array)),c}setComponent(a,b,c){return this.normalized&&(c=cq(c,this.array)),this.data.array[a*this.data.stride+this.offset+b]=c,this}setX(a,b){return this.normalized&&(b=cq(b,this.array)),this.data.array[a*this.data.stride+this.offset]=b,this}setY(a,b){return this.normalized&&(b=cq(b,this.array)),this.data.array[a*this.data.stride+this.offset+1]=b,this}setZ(a,b){return this.normalized&&(b=cq(b,this.array)),this.data.array[a*this.data.stride+this.offset+2]=b,this}setW(a,b){return this.normalized&&(b=cq(b,this.array)),this.data.array[a*this.data.stride+this.offset+3]=b,this}getX(a){let b=this.data.array[a*this.data.stride+this.offset];return this.normalized&&(b=cp(b,this.array)),b}getY(a){let b=this.data.array[a*this.data.stride+this.offset+1];return this.normalized&&(b=cp(b,this.array)),b}getZ(a){let b=this.data.array[a*this.data.stride+this.offset+2];return this.normalized&&(b=cp(b,this.array)),b}getW(a){let b=this.data.array[a*this.data.stride+this.offset+3];return this.normalized&&(b=cp(b,this.array)),b}setXY(a,b,c){return a=a*this.data.stride+this.offset,this.normalized&&(b=cq(b,this.array),c=cq(c,this.array)),this.data.array[a+0]=b,this.data.array[a+1]=c,this}setXYZ(a,b,c,d){return a=a*this.data.stride+this.offset,this.normalized&&(b=cq(b,this.array),c=cq(c,this.array),d=cq(d,this.array)),this.data.array[a+0]=b,this.data.array[a+1]=c,this.data.array[a+2]=d,this}setXYZW(a,b,c,d,e){return a=a*this.data.stride+this.offset,this.normalized&&(b=cq(b,this.array),c=cq(c,this.array),d=cq(d,this.array),e=cq(e,this.array)),this.data.array[a+0]=b,this.data.array[a+1]=c,this.data.array[a+2]=d,this.data.array[a+3]=e,this}clone(a){if(void 0!==a)return void 0===a.interleavedBuffers&&(a.interleavedBuffers={}),void 0===a.interleavedBuffers[this.data.uuid]&&(a.interleavedBuffers[this.data.uuid]=this.data.clone(a)),new e5(a.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized);{console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let a=[];for(let b=0;b<this.count;b++){let c=b*this.data.stride+this.offset;for(let b=0;b<this.itemSize;b++)a.push(this.data.array[c+b])}return new eg(new this.array.constructor(a),this.itemSize,this.normalized)}}toJSON(a){if(void 0!==a)return void 0===a.interleavedBuffers&&(a.interleavedBuffers={}),void 0===a.interleavedBuffers[this.data.uuid]&&(a.interleavedBuffers[this.data.uuid]=this.data.toJSON(a)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized};{console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let a=[];for(let b=0;b<this.count;b++){let c=b*this.data.stride+this.offset;for(let b=0;b<this.itemSize;b++)a.push(this.data.array[c+b])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:a,normalized:this.normalized}}}}class e6 extends d9{constructor(a){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new d6(0xffffff),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.alphaMap=a.alphaMap,this.rotation=a.rotation,this.sizeAttenuation=a.sizeAttenuation,this.fog=a.fog,this}}let e7=new cV,e8=new cV,e9=new cV,fa=new cr,fb=new cr,fc=new dn,fd=new cV,fe=new cV,ff=new cV,fg=new cr,fh=new cr,fi=new cr;function fj(a,b,c,d,e,f){fa.subVectors(a,c).addScalar(.5).multiply(d),void 0!==e?(fb.x=f*fa.x-e*fa.y,fb.y=e*fa.x+f*fa.y):fb.copy(fa),a.copy(b),a.x+=fb.x,a.y+=fb.y,a.applyMatrix4(fc)}let fk=new cV,fl=new cV,fm=new cV,fn=new cP,fo=new cP,fp=new cV,fq=new dn,fr=new cV,fs=new de,ft=new dn,fu=new dm;class fv extends dP{constructor(){super(),this.isBone=!0,this.type="Bone"}}class fw extends cO{constructor(a=null,b=1,c=1,d,e,f,g,h,i=aM,j=aM,k,l){super(null,f,g,h,i,j,d,e,k,l),this.isDataTexture=!0,this.image={data:a,width:b,height:c},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}let fx=new dn,fy=new dn;class fz{constructor(a=[],b=[]){this.uuid=cl(),this.bones=a.slice(0),this.boneInverses=b,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){let a=this.bones,b=this.boneInverses;if(this.boneMatrices=new Float32Array(16*a.length),0===b.length)this.calculateInverses();else if(a.length!==b.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let a=0,b=this.bones.length;a<b;a++)this.boneInverses.push(new dn)}}calculateInverses(){this.boneInverses.length=0;for(let a=0,b=this.bones.length;a<b;a++){let b=new dn;this.bones[a]&&b.copy(this.bones[a].matrixWorld).invert(),this.boneInverses.push(b)}}pose(){for(let a=0,b=this.bones.length;a<b;a++){let b=this.bones[a];b&&b.matrixWorld.copy(this.boneInverses[a]).invert()}for(let a=0,b=this.bones.length;a<b;a++){let b=this.bones[a];b&&(b.parent&&b.parent.isBone?(b.matrix.copy(b.parent.matrixWorld).invert(),b.matrix.multiply(b.matrixWorld)):b.matrix.copy(b.matrixWorld),b.matrix.decompose(b.position,b.quaternion,b.scale))}}update(){let a=this.bones,b=this.boneInverses,c=this.boneMatrices,d=this.boneTexture;for(let d=0,e=a.length;d<e;d++){let e=a[d]?a[d].matrixWorld:fy;fx.multiplyMatrices(e,b[d]),fx.toArray(c,16*d)}null!==d&&(d.needsUpdate=!0)}clone(){return new fz(this.bones,this.boneInverses)}computeBoneTexture(){let a=Math.sqrt(4*this.bones.length),b=new Float32Array((a=Math.max(a=4*Math.ceil(a/4),4))*a*4);b.set(this.boneMatrices);let c=new fw(b,a,a,a4,aY);return c.needsUpdate=!0,this.boneMatrices=b,this.boneTexture=c,this}getBoneByName(a){for(let b=0,c=this.bones.length;b<c;b++){let c=this.bones[b];if(c.name===a)return c}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(a,b){this.uuid=a.uuid;for(let c=0,d=a.bones.length;c<d;c++){let d=a.bones[c],e=b[d];void 0===e&&(console.warn("THREE.Skeleton: No bone found with UUID:",d),e=new fv),this.bones.push(e),this.boneInverses.push(new dn().fromArray(a.boneInverses[c]))}return this.init(),this}toJSON(){let a={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};a.uuid=this.uuid;let b=this.bones,c=this.boneInverses;for(let d=0,e=b.length;d<e;d++){let e=b[d];a.bones.push(e.uuid);let f=c[d];a.boneInverses.push(f.toArray())}return a}}class fA extends eg{constructor(a,b,c,d=1){super(a,b,c),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=d}copy(a){return super.copy(a),this.meshPerAttribute=a.meshPerAttribute,this}toJSON(){let a=super.toJSON();return a.meshPerAttribute=this.meshPerAttribute,a.isInstancedBufferAttribute=!0,a}}let fB=new dn,fC=new dn,fD=[],fE=new cY,fF=new dn,fG=new eD,fH=new de,fI=new cV,fJ=new cV,fK=new cs;class fL{constructor(a=new cV(1,0,0),b=0){this.isPlane=!0,this.normal=a,this.constant=b}set(a,b){return this.normal.copy(a),this.constant=b,this}setComponents(a,b,c,d){return this.normal.set(a,b,c),this.constant=d,this}setFromNormalAndCoplanarPoint(a,b){return this.normal.copy(a),this.constant=-b.dot(this.normal),this}setFromCoplanarPoints(a,b,c){let d=fI.subVectors(c,b).cross(fJ.subVectors(a,b)).normalize();return this.setFromNormalAndCoplanarPoint(d,a),this}copy(a){return this.normal.copy(a.normal),this.constant=a.constant,this}normalize(){let a=1/this.normal.length();return this.normal.multiplyScalar(a),this.constant*=a,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(a){return this.normal.dot(a)+this.constant}distanceToSphere(a){return this.distanceToPoint(a.center)-a.radius}projectPoint(a,b){return b.copy(a).addScaledVector(this.normal,-this.distanceToPoint(a))}intersectLine(a,b){let c=a.delta(fI),d=this.normal.dot(c);if(0===d)return 0===this.distanceToPoint(a.start)?b.copy(a.start):null;let e=-(a.start.dot(this.normal)+this.constant)/d;return e<0||e>1?null:b.copy(a.start).addScaledVector(c,e)}intersectsLine(a){let b=this.distanceToPoint(a.start),c=this.distanceToPoint(a.end);return b<0&&c>0||c<0&&b>0}intersectsBox(a){return a.intersectsPlane(this)}intersectsSphere(a){return a.intersectsPlane(this)}coplanarPoint(a){return a.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(a,b){let c=b||fK.getNormalMatrix(a),d=this.coplanarPoint(fI).applyMatrix4(a),e=this.normal.applyMatrix3(c).normalize();return this.constant=-d.dot(e),this}translate(a){return this.constant-=a.dot(this.normal),this}equals(a){return a.normal.equals(this.normal)&&a.constant===this.constant}clone(){return new this.constructor().copy(this)}}let fM=new de,fN=new cV;class fO{constructor(a=new fL,b=new fL,c=new fL,d=new fL,e=new fL,f=new fL){this.planes=[a,b,c,d,e,f]}set(a,b,c,d,e,f){let g=this.planes;return g[0].copy(a),g[1].copy(b),g[2].copy(c),g[3].copy(d),g[4].copy(e),g[5].copy(f),this}copy(a){let b=this.planes;for(let c=0;c<6;c++)b[c].copy(a.planes[c]);return this}setFromProjectionMatrix(a,b=ce){let c=this.planes,d=a.elements,e=d[0],f=d[1],g=d[2],h=d[3],i=d[4],j=d[5],k=d[6],l=d[7],m=d[8],n=d[9],o=d[10],p=d[11],q=d[12],r=d[13],s=d[14],t=d[15];if(c[0].setComponents(h-e,l-i,p-m,t-q).normalize(),c[1].setComponents(h+e,l+i,p+m,t+q).normalize(),c[2].setComponents(h+f,l+j,p+n,t+r).normalize(),c[3].setComponents(h-f,l-j,p-n,t-r).normalize(),c[4].setComponents(h-g,l-k,p-o,t-s).normalize(),b===ce)c[5].setComponents(h+g,l+k,p+o,t+s).normalize();else if(b===cf)c[5].setComponents(g,k,o,s).normalize();else throw Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+b);return this}intersectsObject(a){if(void 0!==a.boundingSphere)null===a.boundingSphere&&a.computeBoundingSphere(),fM.copy(a.boundingSphere).applyMatrix4(a.matrixWorld);else{let b=a.geometry;null===b.boundingSphere&&b.computeBoundingSphere(),fM.copy(b.boundingSphere).applyMatrix4(a.matrixWorld)}return this.intersectsSphere(fM)}intersectsSprite(a){return fM.center.set(0,0,0),fM.radius=.7071067811865476,fM.applyMatrix4(a.matrixWorld),this.intersectsSphere(fM)}intersectsSphere(a){let b=this.planes,c=a.center,d=-a.radius;for(let a=0;a<6;a++)if(b[a].distanceToPoint(c)<d)return!1;return!0}intersectsBox(a){let b=this.planes;for(let c=0;c<6;c++){let d=b[c];if(fN.x=d.normal.x>0?a.max.x:a.min.x,fN.y=d.normal.y>0?a.max.y:a.min.y,fN.z=d.normal.z>0?a.max.z:a.min.z,0>d.distanceToPoint(fN))return!1}return!0}containsPoint(a){let b=this.planes;for(let c=0;c<6;c++)if(0>b[c].distanceToPoint(a))return!1;return!0}clone(){return new this.constructor().copy(this)}}function fP(a,b){return a-b}function fQ(a,b){return a.z-b.z}function fR(a,b){return b.z-a.z}class fS{constructor(){this.index=0,this.pool=[],this.list=[]}push(a,b,c,d){let e=this.pool,f=this.list;this.index>=e.length&&e.push({start:-1,count:-1,z:-1,index:-1});let g=e[this.index];f.push(g),this.index++,g.start=a,g.count=b,g.z=c,g.index=d}reset(){this.list.length=0,this.index=0}}let fT=new dn,fU=new d6(1,1,1),fV=new fO,fW=new cY,fX=new de,fY=new cV,fZ=new cV,f$=new cV,f_=new fS,f0=new eD,f1=[];function f2(a,b,c=0){let d=b.itemSize;if(a.isInterleavedBufferAttribute||a.array.constructor!==b.array.constructor){let e=a.count;for(let f=0;f<e;f++)for(let e=0;e<d;e++)b.setComponent(f+c,e,a.getComponent(f,e))}else b.array.set(a.array,c*d);b.needsUpdate=!0}function f3(a,b){if(a.constructor!==b.constructor){let c=Math.min(a.length,b.length);for(let d=0;d<c;d++)b[d]=a[d]}else{let c=Math.min(a.length,b.length);b.set(new a.constructor(a.buffer,0,c))}}class f4 extends d9{constructor(a){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new d6(0xffffff),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.linewidth=a.linewidth,this.linecap=a.linecap,this.linejoin=a.linejoin,this.fog=a.fog,this}}let f5=new cV,f6=new cV,f7=new dn,f8=new dm,f9=new de,ga=new cV,gb=new cV;class gc extends dP{constructor(a=new er,b=new f4){super(),this.isLine=!0,this.type="Line",this.geometry=a,this.material=b,this.updateMorphTargets()}copy(a,b){return super.copy(a,b),this.material=Array.isArray(a.material)?a.material.slice():a.material,this.geometry=a.geometry,this}computeLineDistances(){let a=this.geometry;if(null===a.index){let b=a.attributes.position,c=[0];for(let a=1,d=b.count;a<d;a++)f5.fromBufferAttribute(b,a-1),f6.fromBufferAttribute(b,a),c[a]=c[a-1],c[a]+=f5.distanceTo(f6);a.setAttribute("lineDistance",new ej(c,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(a,b){let c=this.geometry,d=this.matrixWorld,e=a.params.Line.threshold,f=c.drawRange;if(null===c.boundingSphere&&c.computeBoundingSphere(),f9.copy(c.boundingSphere),f9.applyMatrix4(d),f9.radius+=e,!1===a.ray.intersectsSphere(f9))return;f7.copy(d).invert(),f8.copy(a.ray).applyMatrix4(f7);let g=e/((this.scale.x+this.scale.y+this.scale.z)/3),h=g*g,i=this.isLineSegments?2:1,j=c.index,k=c.attributes.position;if(null!==j){let c=Math.max(0,f.start),d=Math.min(j.count,f.start+f.count);for(let e=c,f=d-1;e<f;e+=i){let c=gd(this,a,f8,h,j.getX(e),j.getX(e+1),e);c&&b.push(c)}if(this.isLineLoop){let e=gd(this,a,f8,h,j.getX(d-1),j.getX(c),d-1);e&&b.push(e)}}else{let c=Math.max(0,f.start),d=Math.min(k.count,f.start+f.count);for(let e=c,f=d-1;e<f;e+=i){let c=gd(this,a,f8,h,e,e+1,e);c&&b.push(c)}if(this.isLineLoop){let e=gd(this,a,f8,h,d-1,c,d-1);e&&b.push(e)}}}updateMorphTargets(){let a=this.geometry.morphAttributes,b=Object.keys(a);if(b.length>0){let c=a[b[0]];if(void 0!==c){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,b=c.length;a<b;a++){let b=c[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[b]=a}}}}}function gd(a,b,c,d,e,f,g){let h=a.geometry.attributes.position;if(f5.fromBufferAttribute(h,e),f6.fromBufferAttribute(h,f),c.distanceSqToSegment(f5,f6,ga,gb)>d)return;ga.applyMatrix4(a.matrixWorld);let i=b.ray.origin.distanceTo(ga);if(!(i<b.near)&&!(i>b.far))return{distance:i,point:gb.clone().applyMatrix4(a.matrixWorld),index:g,face:null,faceIndex:null,barycoord:null,object:a}}let ge=new cV,gf=new cV;class gg extends d9{constructor(a){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new d6(0xffffff),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.alphaMap=a.alphaMap,this.size=a.size,this.sizeAttenuation=a.sizeAttenuation,this.fog=a.fog,this}}let gh=new dn,gi=new dm,gj=new de,gk=new cV;class gl extends dP{constructor(a=new er,b=new gg){super(),this.isPoints=!0,this.type="Points",this.geometry=a,this.material=b,this.updateMorphTargets()}copy(a,b){return super.copy(a,b),this.material=Array.isArray(a.material)?a.material.slice():a.material,this.geometry=a.geometry,this}raycast(a,b){let c=this.geometry,d=this.matrixWorld,e=a.params.Points.threshold,f=c.drawRange;if(null===c.boundingSphere&&c.computeBoundingSphere(),gj.copy(c.boundingSphere),gj.applyMatrix4(d),gj.radius+=e,!1===a.ray.intersectsSphere(gj))return;gh.copy(d).invert(),gi.copy(a.ray).applyMatrix4(gh);let g=e/((this.scale.x+this.scale.y+this.scale.z)/3),h=g*g,i=c.index,j=c.attributes.position;if(null!==i){let c=Math.max(0,f.start),e=Math.min(i.count,f.start+f.count);for(let f=c,g=e;f<g;f++){let c=i.getX(f);gk.fromBufferAttribute(j,c),gm(gk,c,h,d,a,b,this)}}else{let c=Math.max(0,f.start),e=Math.min(j.count,f.start+f.count);for(let f=c,g=e;f<g;f++)gk.fromBufferAttribute(j,f),gm(gk,f,h,d,a,b,this)}}updateMorphTargets(){let a=this.geometry.morphAttributes,b=Object.keys(a);if(b.length>0){let c=a[b[0]];if(void 0!==c){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,b=c.length;a<b;a++){let b=c[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[b]=a}}}}}function gm(a,b,c,d,e,f,g){let h=gi.distanceSqToPoint(a);if(h<c){let c=new cV;gi.closestPointToPoint(a,c),c.applyMatrix4(d);let i=e.ray.origin.distanceTo(c);if(i<e.near||i>e.far)return;f.push({distance:i,distanceToRay:Math.sqrt(h),point:c,index:b,face:null,faceIndex:null,barycoord:null,object:g})}}class gn extends cO{constructor(a,b,c,d,e,f,g,h,i,j=a7){if(j!==a7&&j!==a8)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===c&&j===a7&&(c=aX),void 0===c&&j===a8&&(c=a0),super(null,d,e,f,g,h,j,c,i),this.isDepthTexture=!0,this.image={width:a,height:b},this.magFilter=void 0!==g?g:aM,this.minFilter=void 0!==h?h:aM,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(a){return super.copy(a),this.compareFunction=a.compareFunction,this}toJSON(a){let b=super.toJSON(a);return null!==this.compareFunction&&(b.compareFunction=this.compareFunction),b}}class go{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(a,b){let c=this.getUtoTmapping(a);return this.getPoint(c,b)}getPoints(a=5){let b=[];for(let c=0;c<=a;c++)b.push(this.getPoint(c/a));return b}getSpacedPoints(a=5){let b=[];for(let c=0;c<=a;c++)b.push(this.getPointAt(c/a));return b}getLength(){let a=this.getLengths();return a[a.length-1]}getLengths(a=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let b=[],c,d=this.getPoint(0),e=0;b.push(0);for(let f=1;f<=a;f++)b.push(e+=(c=this.getPoint(f/a)).distanceTo(d)),d=c;return this.cacheArcLengths=b,b}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(a,b){let c,d=this.getLengths(),e=0,f=d.length;c=b||a*d[f-1];let g=0,h=f-1,i;for(;g<=h;)if((i=d[e=Math.floor(g+(h-g)/2)]-c)<0)g=e+1;else if(i>0)h=e-1;else{h=e;break}if(d[e=h]===c)return e/(f-1);let j=d[e],k=d[e+1]-j;return(e+(c-j)/k)/(f-1)}getTangent(a,b){let c=a-1e-4,d=a+1e-4;c<0&&(c=0),d>1&&(d=1);let e=this.getPoint(c),f=this.getPoint(d),g=b||(e.isVector2?new cr:new cV);return g.copy(f).sub(e).normalize(),g}getTangentAt(a,b){let c=this.getUtoTmapping(a);return this.getTangent(c,b)}computeFrenetFrames(a,b){let c=new cV,d=[],e=[],f=[],g=new cV,h=new dn;for(let b=0;b<=a;b++){let c=b/a;d[b]=this.getTangentAt(c,new cV)}e[0]=new cV,f[0]=new cV;let i=Number.MAX_VALUE,j=Math.abs(d[0].x),k=Math.abs(d[0].y),l=Math.abs(d[0].z);j<=i&&(i=j,c.set(1,0,0)),k<=i&&(i=k,c.set(0,1,0)),l<=i&&c.set(0,0,1),g.crossVectors(d[0],c).normalize(),e[0].crossVectors(d[0],g),f[0].crossVectors(d[0],e[0]);for(let b=1;b<=a;b++){if(e[b]=e[b-1].clone(),f[b]=f[b-1].clone(),g.crossVectors(d[b-1],d[b]),g.length()>Number.EPSILON){g.normalize();let a=Math.acos(cm(d[b-1].dot(d[b]),-1,1));e[b].applyMatrix4(h.makeRotationAxis(g,a))}f[b].crossVectors(d[b],e[b])}if(!0===b){let b=Math.acos(cm(e[0].dot(e[a]),-1,1));b/=a,d[0].dot(g.crossVectors(e[0],e[a]))>0&&(b=-b);for(let c=1;c<=a;c++)e[c].applyMatrix4(h.makeRotationAxis(d[c],b*c)),f[c].crossVectors(d[c],e[c])}return{tangents:d,normals:e,binormals:f}}clone(){return new this.constructor().copy(this)}copy(a){return this.arcLengthDivisions=a.arcLengthDivisions,this}toJSON(){let a={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return a.arcLengthDivisions=this.arcLengthDivisions,a.type=this.type,a}fromJSON(a){return this.arcLengthDivisions=a.arcLengthDivisions,this}}class gp extends go{constructor(a=0,b=0,c=1,d=1,e=0,f=2*Math.PI,g=!1,h=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=a,this.aY=b,this.xRadius=c,this.yRadius=d,this.aStartAngle=e,this.aEndAngle=f,this.aClockwise=g,this.aRotation=h}getPoint(a,b=new cr){let c=b,d=2*Math.PI,e=this.aEndAngle-this.aStartAngle,f=Math.abs(e)<Number.EPSILON;for(;e<0;)e+=d;for(;e>d;)e-=d;e<Number.EPSILON&&(e=f?0:d),!0!==this.aClockwise||f||(e===d?e=-d:e-=d);let g=this.aStartAngle+a*e,h=this.aX+this.xRadius*Math.cos(g),i=this.aY+this.yRadius*Math.sin(g);if(0!==this.aRotation){let a=Math.cos(this.aRotation),b=Math.sin(this.aRotation),c=h-this.aX,d=i-this.aY;h=c*a-d*b+this.aX,i=c*b+d*a+this.aY}return c.set(h,i)}copy(a){return super.copy(a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this}toJSON(){let a=super.toJSON();return a.aX=this.aX,a.aY=this.aY,a.xRadius=this.xRadius,a.yRadius=this.yRadius,a.aStartAngle=this.aStartAngle,a.aEndAngle=this.aEndAngle,a.aClockwise=this.aClockwise,a.aRotation=this.aRotation,a}fromJSON(a){return super.fromJSON(a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this}}class gq extends gp{constructor(a,b,c,d,e,f){super(a,b,c,c,d,e,f),this.isArcCurve=!0,this.type="ArcCurve"}}function gr(){let a=0,b=0,c=0,d=0;function e(e,f,g,h){a=e,b=g,c=-3*e+3*f-2*g-h,d=2*e-2*f+g+h}return{initCatmullRom:function(a,b,c,d,f){e(b,c,f*(c-a),f*(d-b))},initNonuniformCatmullRom:function(a,b,c,d,f,g,h){let i=(b-a)/f-(c-a)/(f+g)+(c-b)/g,j=(c-b)/g-(d-b)/(g+h)+(d-c)/h;e(b,c,i*=g,j*=g)},calc:function(e){let f=e*e,g=f*e;return a+b*e+c*f+d*g}}}let gs=new cV,gt=new gr,gu=new gr,gv=new gr;class gw extends go{constructor(a=[],b=!1,c="centripetal",d=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=a,this.closed=b,this.curveType=c,this.tension=d}getPoint(a,b=new cV){let c,d,e=b,f=this.points,g=f.length,h=(g-!this.closed)*a,i=Math.floor(h),j=h-i;this.closed?i+=i>0?0:(Math.floor(Math.abs(i)/g)+1)*g:0===j&&i===g-1&&(i=g-2,j=1),this.closed||i>0?c=f[(i-1)%g]:(gs.subVectors(f[0],f[1]).add(f[0]),c=gs);let k=f[i%g],l=f[(i+1)%g];if(this.closed||i+2<g?d=f[(i+2)%g]:(gs.subVectors(f[g-1],f[g-2]).add(f[g-1]),d=gs),"centripetal"===this.curveType||"chordal"===this.curveType){let a="chordal"===this.curveType?.5:.25,b=Math.pow(c.distanceToSquared(k),a),e=Math.pow(k.distanceToSquared(l),a),f=Math.pow(l.distanceToSquared(d),a);e<1e-4&&(e=1),b<1e-4&&(b=e),f<1e-4&&(f=e),gt.initNonuniformCatmullRom(c.x,k.x,l.x,d.x,b,e,f),gu.initNonuniformCatmullRom(c.y,k.y,l.y,d.y,b,e,f),gv.initNonuniformCatmullRom(c.z,k.z,l.z,d.z,b,e,f)}else"catmullrom"===this.curveType&&(gt.initCatmullRom(c.x,k.x,l.x,d.x,this.tension),gu.initCatmullRom(c.y,k.y,l.y,d.y,this.tension),gv.initCatmullRom(c.z,k.z,l.z,d.z,this.tension));return e.set(gt.calc(j),gu.calc(j),gv.calc(j)),e}copy(a){super.copy(a),this.points=[];for(let b=0,c=a.points.length;b<c;b++){let c=a.points[b];this.points.push(c.clone())}return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this}toJSON(){let a=super.toJSON();a.points=[];for(let b=0,c=this.points.length;b<c;b++){let c=this.points[b];a.points.push(c.toArray())}return a.closed=this.closed,a.curveType=this.curveType,a.tension=this.tension,a}fromJSON(a){super.fromJSON(a),this.points=[];for(let b=0,c=a.points.length;b<c;b++){let c=a.points[b];this.points.push(new cV().fromArray(c))}return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this}}function gx(a,b,c,d,e){let f=(d-b)*.5,g=(e-c)*.5,h=a*a;return a*h*(2*c-2*d+f+g)+(-3*c+3*d-2*f-g)*h+f*a+c}function gy(a,b){let c=1-a;return c*c*b}function gz(a,b){return 2*(1-a)*a*b}function gA(a,b){return a*a*b}function gB(a,b,c,d){return gy(a,b)+gz(a,c)+gA(a,d)}function gC(a,b){let c=1-a;return c*c*c*b}function gD(a,b){let c=1-a;return 3*c*c*a*b}function gE(a,b){return 3*(1-a)*a*a*b}function gF(a,b){return a*a*a*b}function gG(a,b,c,d,e){return gC(a,b)+gD(a,c)+gE(a,d)+gF(a,e)}class gH extends go{constructor(a=new cr,b=new cr,c=new cr,d=new cr){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=a,this.v1=b,this.v2=c,this.v3=d}getPoint(a,b=new cr){let c=b,d=this.v0,e=this.v1,f=this.v2,g=this.v3;return c.set(gG(a,d.x,e.x,f.x,g.x),gG(a,d.y,e.y,f.y,g.y)),c}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this}toJSON(){let a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this}}class gI extends go{constructor(a=new cV,b=new cV,c=new cV,d=new cV){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=a,this.v1=b,this.v2=c,this.v3=d}getPoint(a,b=new cV){let c=b,d=this.v0,e=this.v1,f=this.v2,g=this.v3;return c.set(gG(a,d.x,e.x,f.x,g.x),gG(a,d.y,e.y,f.y,g.y),gG(a,d.z,e.z,f.z,g.z)),c}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this}toJSON(){let a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this}}class gJ extends go{constructor(a=new cr,b=new cr){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=a,this.v2=b}getPoint(a,b=new cr){let c=b;return 1===a?c.copy(this.v2):(c.copy(this.v2).sub(this.v1),c.multiplyScalar(a).add(this.v1)),c}getPointAt(a,b){return this.getPoint(a,b)}getTangent(a,b=new cr){return b.subVectors(this.v2,this.v1).normalize()}getTangentAt(a,b){return this.getTangent(a,b)}copy(a){return super.copy(a),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){let a=super.toJSON();return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}}class gK extends go{constructor(a=new cV,b=new cV){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=a,this.v2=b}getPoint(a,b=new cV){let c=b;return 1===a?c.copy(this.v2):(c.copy(this.v2).sub(this.v1),c.multiplyScalar(a).add(this.v1)),c}getPointAt(a,b){return this.getPoint(a,b)}getTangent(a,b=new cV){return b.subVectors(this.v2,this.v1).normalize()}getTangentAt(a,b){return this.getTangent(a,b)}copy(a){return super.copy(a),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){let a=super.toJSON();return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}}class gL extends go{constructor(a=new cr,b=new cr,c=new cr){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=a,this.v1=b,this.v2=c}getPoint(a,b=new cr){let c=b,d=this.v0,e=this.v1,f=this.v2;return c.set(gB(a,d.x,e.x,f.x),gB(a,d.y,e.y,f.y)),c}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){let a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}}class gM extends go{constructor(a=new cV,b=new cV,c=new cV){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=a,this.v1=b,this.v2=c}getPoint(a,b=new cV){let c=b,d=this.v0,e=this.v1,f=this.v2;return c.set(gB(a,d.x,e.x,f.x),gB(a,d.y,e.y,f.y),gB(a,d.z,e.z,f.z)),c}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){let a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}}class gN extends go{constructor(a=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=a}getPoint(a,b=new cr){let c=b,d=this.points,e=(d.length-1)*a,f=Math.floor(e),g=e-f,h=d[0===f?f:f-1],i=d[f],j=d[f>d.length-2?d.length-1:f+1],k=d[f>d.length-3?d.length-1:f+2];return c.set(gx(g,h.x,i.x,j.x,k.x),gx(g,h.y,i.y,j.y,k.y)),c}copy(a){super.copy(a),this.points=[];for(let b=0,c=a.points.length;b<c;b++){let c=a.points[b];this.points.push(c.clone())}return this}toJSON(){let a=super.toJSON();a.points=[];for(let b=0,c=this.points.length;b<c;b++){let c=this.points[b];a.points.push(c.toArray())}return a}fromJSON(a){super.fromJSON(a),this.points=[];for(let b=0,c=a.points.length;b<c;b++){let c=a.points[b];this.points.push(new cr().fromArray(c))}return this}}var gO=Object.freeze({__proto__:null,ArcCurve:gq,CatmullRomCurve3:gw,CubicBezierCurve:gH,CubicBezierCurve3:gI,EllipseCurve:gp,LineCurve:gJ,LineCurve3:gK,QuadraticBezierCurve:gL,QuadraticBezierCurve3:gM,SplineCurve:gN});class gP extends go{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(a){this.curves.push(a)}closePath(){let a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-1].getPoint(1);if(!a.equals(b)){let c=!0===a.isVector2?"LineCurve":"LineCurve3";this.curves.push(new gO[c](b,a))}return this}getPoint(a,b){let c=a*this.getLength(),d=this.getCurveLengths(),e=0;for(;e<d.length;){if(d[e]>=c){let a=d[e]-c,f=this.curves[e],g=f.getLength(),h=0===g?0:1-a/g;return f.getPointAt(h,b)}e++}return null}getLength(){let a=this.getCurveLengths();return a[a.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let a=[],b=0;for(let c=0,d=this.curves.length;c<d;c++)a.push(b+=this.curves[c].getLength());return this.cacheLengths=a,a}getSpacedPoints(a=40){let b=[];for(let c=0;c<=a;c++)b.push(this.getPoint(c/a));return this.autoClose&&b.push(b[0]),b}getPoints(a=12){let b,c=[];for(let d=0,e=this.curves;d<e.length;d++){let f=e[d],g=f.isEllipseCurve?2*a:f.isLineCurve||f.isLineCurve3?1:f.isSplineCurve?a*f.points.length:a,h=f.getPoints(g);for(let a=0;a<h.length;a++){let d=h[a];b&&b.equals(d)||(c.push(d),b=d)}}return this.autoClose&&c.length>1&&!c[c.length-1].equals(c[0])&&c.push(c[0]),c}copy(a){super.copy(a),this.curves=[];for(let b=0,c=a.curves.length;b<c;b++){let c=a.curves[b];this.curves.push(c.clone())}return this.autoClose=a.autoClose,this}toJSON(){let a=super.toJSON();a.autoClose=this.autoClose,a.curves=[];for(let b=0,c=this.curves.length;b<c;b++){let c=this.curves[b];a.curves.push(c.toJSON())}return a}fromJSON(a){super.fromJSON(a),this.autoClose=a.autoClose,this.curves=[];for(let b=0,c=a.curves.length;b<c;b++){let c=a.curves[b];this.curves.push(new gO[c.type]().fromJSON(c))}return this}}class gQ extends gP{constructor(a){super(),this.type="Path",this.currentPoint=new cr,a&&this.setFromPoints(a)}setFromPoints(a){this.moveTo(a[0].x,a[0].y);for(let b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,a[b].y);return this}moveTo(a,b){return this.currentPoint.set(a,b),this}lineTo(a,b){let c=new gJ(this.currentPoint.clone(),new cr(a,b));return this.curves.push(c),this.currentPoint.set(a,b),this}quadraticCurveTo(a,b,c,d){let e=new gL(this.currentPoint.clone(),new cr(a,b),new cr(c,d));return this.curves.push(e),this.currentPoint.set(c,d),this}bezierCurveTo(a,b,c,d,e,f){let g=new gH(this.currentPoint.clone(),new cr(a,b),new cr(c,d),new cr(e,f));return this.curves.push(g),this.currentPoint.set(e,f),this}splineThru(a){let b=new gN([this.currentPoint.clone()].concat(a));return this.curves.push(b),this.currentPoint.copy(a[a.length-1]),this}arc(a,b,c,d,e,f){let g=this.currentPoint.x,h=this.currentPoint.y;return this.absarc(a+g,b+h,c,d,e,f),this}absarc(a,b,c,d,e,f){return this.absellipse(a,b,c,c,d,e,f),this}ellipse(a,b,c,d,e,f,g,h){let i=this.currentPoint.x,j=this.currentPoint.y;return this.absellipse(a+i,b+j,c,d,e,f,g,h),this}absellipse(a,b,c,d,e,f,g,h){let i=new gp(a,b,c,d,e,f,g,h);if(this.curves.length>0){let a=i.getPoint(0);a.equals(this.currentPoint)||this.lineTo(a.x,a.y)}this.curves.push(i);let j=i.getPoint(1);return this.currentPoint.copy(j),this}copy(a){return super.copy(a),this.currentPoint.copy(a.currentPoint),this}toJSON(){let a=super.toJSON();return a.currentPoint=this.currentPoint.toArray(),a}fromJSON(a){return super.fromJSON(a),this.currentPoint.fromArray(a.currentPoint),this}}class gR extends er{constructor(a=[new cr(0,-.5),new cr(.5,0),new cr(0,.5)],b=12,c=0,d=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:a,segments:b,phiStart:c,phiLength:d},b=Math.floor(b),d=cm(d,0,2*Math.PI);let e=[],f=[],g=[],h=[],i=[],j=1/b,k=new cV,l=new cr,m=new cV,n=new cV,o=new cV,p=0,q=0;for(let b=0;b<=a.length-1;b++)switch(b){case 0:p=a[b+1].x-a[b].x,m.x=+(q=a[b+1].y-a[b].y),m.y=-p,m.z=0*q,o.copy(m),m.normalize(),h.push(m.x,m.y,m.z);break;case a.length-1:h.push(o.x,o.y,o.z);break;default:p=a[b+1].x-a[b].x,m.x=+(q=a[b+1].y-a[b].y),m.y=-p,m.z=0*q,n.copy(m),m.x+=o.x,m.y+=o.y,m.z+=o.z,m.normalize(),h.push(m.x,m.y,m.z),o.copy(n)}for(let e=0;e<=b;e++){let m=c+e*j*d,n=Math.sin(m),o=Math.cos(m);for(let c=0;c<=a.length-1;c++){k.x=a[c].x*n,k.y=a[c].y,k.z=a[c].x*o,f.push(k.x,k.y,k.z),l.x=e/b,l.y=c/(a.length-1),g.push(l.x,l.y);let d=h[3*c+0]*n,j=h[3*c+1],m=h[3*c+0]*o;i.push(d,j,m)}}for(let c=0;c<b;c++)for(let b=0;b<a.length-1;b++){let d=b+c*a.length,f=d,g=d+a.length,h=d+a.length+1,i=d+1;e.push(f,g,i),e.push(h,i,g)}this.setIndex(e),this.setAttribute("position",new ej(f,3)),this.setAttribute("uv",new ej(g,2)),this.setAttribute("normal",new ej(i,3))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new gR(a.points,a.segments,a.phiStart,a.phiLength)}}class gS extends gR{constructor(a=1,b=1,c=4,d=8){let e=new gQ;e.absarc(0,-b/2,a,1.5*Math.PI,0),e.absarc(0,b/2,a,0,.5*Math.PI),super(e.getPoints(c),d),this.type="CapsuleGeometry",this.parameters={radius:a,length:b,capSegments:c,radialSegments:d}}static fromJSON(a){return new gS(a.radius,a.length,a.capSegments,a.radialSegments)}}class gT extends er{constructor(a=1,b=32,c=0,d=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d},b=Math.max(3,b);let e=[],f=[],g=[],h=[],i=new cV,j=new cr;f.push(0,0,0),g.push(0,0,1),h.push(.5,.5);for(let e=0,k=3;e<=b;e++,k+=3){let l=c+e/b*d;i.x=a*Math.cos(l),i.y=a*Math.sin(l),f.push(i.x,i.y,i.z),g.push(0,0,1),j.x=(f[k]/a+1)/2,j.y=(f[k+1]/a+1)/2,h.push(j.x,j.y)}for(let a=1;a<=b;a++)e.push(a,a+1,0);this.setIndex(e),this.setAttribute("position",new ej(f,3)),this.setAttribute("normal",new ej(g,3)),this.setAttribute("uv",new ej(h,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new gT(a.radius,a.segments,a.thetaStart,a.thetaLength)}}class gU extends er{constructor(a=1,b=1,c=1,d=32,e=1,f=!1,g=0,h=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:a,radiusBottom:b,height:c,radialSegments:d,heightSegments:e,openEnded:f,thetaStart:g,thetaLength:h};let i=this;d=Math.floor(d),e=Math.floor(e);let j=[],k=[],l=[],m=[],n=0,o=[],p=c/2,q=0;function r(c){let e=n,f=new cr,o=new cV,r=0,s=!0===c?a:b,t=!0===c?1:-1;for(let a=1;a<=d;a++)k.push(0,p*t,0),l.push(0,t,0),m.push(.5,.5),n++;let u=n;for(let a=0;a<=d;a++){let b=a/d*h+g,c=Math.cos(b),e=Math.sin(b);o.x=s*e,o.y=p*t,o.z=s*c,k.push(o.x,o.y,o.z),l.push(0,t,0),f.x=.5*c+.5,f.y=.5*e*t+.5,m.push(f.x,f.y),n++}for(let a=0;a<d;a++){let b=e+a,d=u+a;!0===c?j.push(d,d+1,b):j.push(d+1,d,b),r+=3}i.addGroup(q,r,!0===c?1:2),q+=r}(function f(){let f=new cV,r=new cV,s=0,t=(b-a)/c;for(let i=0;i<=e;i++){let j=[],q=i/e,s=q*(b-a)+a;for(let a=0;a<=d;a++){let b=a/d,e=b*h+g,i=Math.sin(e),o=Math.cos(e);r.x=s*i,r.y=-q*c+p,r.z=s*o,k.push(r.x,r.y,r.z),f.set(i,t,o).normalize(),l.push(f.x,f.y,f.z),m.push(b,1-q),j.push(n++)}o.push(j)}for(let c=0;c<d;c++)for(let d=0;d<e;d++){let f=o[d][c],g=o[d+1][c],h=o[d+1][c+1],i=o[d][c+1];(a>0||0!==d)&&(j.push(f,g,i),s+=3),(b>0||d!==e-1)&&(j.push(g,h,i),s+=3)}i.addGroup(q,s,0),q+=s})(),!1===f&&(a>0&&r(!0),b>0&&r(!1)),this.setIndex(j),this.setAttribute("position",new ej(k,3)),this.setAttribute("normal",new ej(l,3)),this.setAttribute("uv",new ej(m,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new gU(a.radiusTop,a.radiusBottom,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength)}}class gV extends gU{constructor(a=1,b=1,c=32,d=1,e=!1,f=0,g=2*Math.PI){super(0,a,b,c,d,e,f,g),this.type="ConeGeometry",this.parameters={radius:a,height:b,radialSegments:c,heightSegments:d,openEnded:e,thetaStart:f,thetaLength:g}}static fromJSON(a){return new gV(a.radius,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength)}}class gW extends er{constructor(a=[],b=[],c=1,d=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:a,indices:b,radius:c,detail:d};let e=[],f=[];function g(a,b,c,d){let e=d+1,f=[];for(let d=0;d<=e;d++){f[d]=[];let g=a.clone().lerp(c,d/e),h=b.clone().lerp(c,d/e),i=e-d;for(let a=0;a<=i;a++)0===a&&d===e?f[d][a]=g:f[d][a]=g.clone().lerp(h,a/i)}for(let a=0;a<e;a++)for(let b=0;b<2*(e-a)-1;b++){let c=Math.floor(b/2);b%2==0?(k(f[a][c+1]),k(f[a+1][c]),k(f[a][c])):(k(f[a][c+1]),k(f[a+1][c+1]),k(f[a+1][c]))}}function h(a){let b=new cV;for(let c=0;c<e.length;c+=3)b.x=e[c+0],b.y=e[c+1],b.z=e[c+2],b.normalize().multiplyScalar(a),e[c+0]=b.x,e[c+1]=b.y,e[c+2]=b.z}function i(){let a=new cV;for(let b=0;b<e.length;b+=3){a.x=e[b+0],a.y=e[b+1],a.z=e[b+2];let c=o(a)/2/Math.PI+.5,d=p(a)/Math.PI+.5;f.push(c,1-d)}m(),j()}function j(){for(let a=0;a<f.length;a+=6){let b=f[a+0],c=f[a+2],d=f[a+4],e=Math.max(b,c,d),g=Math.min(b,c,d);e>.9&&g<.1&&(b<.2&&(f[a+0]+=1),c<.2&&(f[a+2]+=1),d<.2&&(f[a+4]+=1))}}function k(a){e.push(a.x,a.y,a.z)}function l(b,c){let d=3*b;c.x=a[d+0],c.y=a[d+1],c.z=a[d+2]}function m(){let a=new cV,b=new cV,c=new cV,d=new cV,g=new cr,h=new cr,i=new cr;for(let j=0,k=0;j<e.length;j+=9,k+=6){a.set(e[j+0],e[j+1],e[j+2]),b.set(e[j+3],e[j+4],e[j+5]),c.set(e[j+6],e[j+7],e[j+8]),g.set(f[k+0],f[k+1]),h.set(f[k+2],f[k+3]),i.set(f[k+4],f[k+5]),d.copy(a).add(b).add(c).divideScalar(3);let l=o(d);n(g,k+0,a,l),n(h,k+2,b,l),n(i,k+4,c,l)}}function n(a,b,c,d){d<0&&1===a.x&&(f[b]=a.x-1),0===c.x&&0===c.z&&(f[b]=d/2/Math.PI+.5)}function o(a){return Math.atan2(a.z,-a.x)}function p(a){return Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))}(function a(a){let c=new cV,d=new cV,e=new cV;for(let f=0;f<b.length;f+=3)l(b[f+0],c),l(b[f+1],d),l(b[f+2],e),g(c,d,e,a)})(d),h(c),i(),this.setAttribute("position",new ej(e,3)),this.setAttribute("normal",new ej(e.slice(),3)),this.setAttribute("uv",new ej(f,2)),0===d?this.computeVertexNormals():this.normalizeNormals()}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new gW(a.vertices,a.indices,a.radius,a.details)}}class gX extends gW{constructor(a=1,b=0){let c=(1+Math.sqrt(5))/2,d=1/c;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-d,-c,0,-d,c,0,d,-c,0,d,c,-d,-c,0,-d,c,0,d,-c,0,d,c,0,-c,0,-d,c,0,-d,-c,0,d,c,0,d],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a,b),this.type="DodecahedronGeometry",this.parameters={radius:a,detail:b}}static fromJSON(a){return new gX(a.radius,a.detail)}}let gY=new cV,gZ=new cV,g$=new cV,g_=new d1;class g0 extends er{constructor(a=null,b=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:a,thresholdAngle:b},null!==a){let c=1e4,d=Math.cos(cj*b),e=a.getIndex(),f=a.getAttribute("position"),g=e?e.count:f.count,h=[0,0,0],i=["a","b","c"],j=[,,,],k={},l=[];for(let a=0;a<g;a+=3){e?(h[0]=e.getX(a),h[1]=e.getX(a+1),h[2]=e.getX(a+2)):(h[0]=a,h[1]=a+1,h[2]=a+2);let{a:b,b:g,c:m}=g_;if(b.fromBufferAttribute(f,h[0]),g.fromBufferAttribute(f,h[1]),m.fromBufferAttribute(f,h[2]),g_.getNormal(g$),j[0]=`${Math.round(b.x*c)},${Math.round(b.y*c)},${Math.round(b.z*c)}`,j[1]=`${Math.round(g.x*c)},${Math.round(g.y*c)},${Math.round(g.z*c)}`,j[2]=`${Math.round(m.x*c)},${Math.round(m.y*c)},${Math.round(m.z*c)}`,j[0]!==j[1]&&j[1]!==j[2]&&j[2]!==j[0])for(let a=0;a<3;a++){let b=(a+1)%3,c=j[a],e=j[b],f=g_[i[a]],g=g_[i[b]],m=`${c}_${e}`,n=`${e}_${c}`;n in k&&k[n]?(g$.dot(k[n].normal)<=d&&(l.push(f.x,f.y,f.z),l.push(g.x,g.y,g.z)),k[n]=null):m in k||(k[m]={index0:h[a],index1:h[b],normal:g$.clone()})}}for(let a in k)if(k[a]){let{index0:b,index1:c}=k[a];gY.fromBufferAttribute(f,b),gZ.fromBufferAttribute(f,c),l.push(gY.x,gY.y,gY.z),l.push(gZ.x,gZ.y,gZ.z)}this.setAttribute("position",new ej(l,3))}}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}}class g1 extends gQ{constructor(a){super(a),this.uuid=cl(),this.type="Shape",this.holes=[]}getPointsHoles(a){let b=[];for(let c=0,d=this.holes.length;c<d;c++)b[c]=this.holes[c].getPoints(a);return b}extractPoints(a){return{shape:this.getPoints(a),holes:this.getPointsHoles(a)}}copy(a){super.copy(a),this.holes=[];for(let b=0,c=a.holes.length;b<c;b++){let c=a.holes[b];this.holes.push(c.clone())}return this}toJSON(){let a=super.toJSON();a.uuid=this.uuid,a.holes=[];for(let b=0,c=this.holes.length;b<c;b++){let c=this.holes[b];a.holes.push(c.toJSON())}return a}fromJSON(a){super.fromJSON(a),this.uuid=a.uuid,this.holes=[];for(let b=0,c=a.holes.length;b<c;b++){let c=a.holes[b];this.holes.push(new gQ().fromJSON(c))}return this}}let g2={triangulate:function(a,b,c=2){let d,e,f,g,h,i,j,k=b&&b.length,l=k?b[0]*c:a.length,m=g3(a,0,l,c,!0),n=[];if(!m||m.next===m.prev)return n;if(k&&(m=ha(a,b,m,c)),a.length>80*c){d=f=a[0],e=g=a[1];for(let b=c;b<l;b+=c)h=a[b],i=a[b+1],h<d&&(d=h),i<e&&(e=i),h>f&&(f=h),i>g&&(g=i);j=0!==(j=Math.max(f-d,g-e))?32767/j:0}return g5(m,n,c,d,e,j,0),n}};function g3(a,b,c,d,e){let f,g;if(e===hx(a,b,c,d)>0)for(f=b;f<c;f+=d)g=hu(f,a[f],a[f+1],g);else for(f=c-d;f>=b;f-=d)g=hu(f,a[f],a[f+1],g);return g&&hm(g,g.next)&&(hv(g),g=g.next),g}function g4(a,b){if(!a)return a;b||(b=a);let c=a,d;do if(d=!1,!c.steiner&&(hm(c,c.next)||0===hl(c.prev,c,c.next))){if(hv(c),(c=b=c.prev)===c.next)break;d=!0}else c=c.next;while(d||c!==b);return b}function g5(a,b,c,d,e,f,g){if(!a)return;!g&&f&&hf(a,d,e,f);let h=a,i,j;for(;a.prev!==a.next;){if(i=a.prev,j=a.next,f?g7(a,d,e,f):g6(a)){b.push(i.i/c|0),b.push(a.i/c|0),b.push(j.i/c|0),hv(a),a=j.next,h=j.next;continue}if((a=j)===h){g?1===g?g5(a=g8(g4(a),b,c),b,c,d,e,f,2):2===g&&g9(a,b,c,d,e,f):g5(g4(a),b,c,d,e,f,1);break}}}function g6(a){let b=a.prev,c=a,d=a.next;if(hl(b,c,d)>=0)return!1;let e=b.x,f=c.x,g=d.x,h=b.y,i=c.y,j=d.y,k=e<f?e<g?e:g:f<g?f:g,l=h<i?h<j?h:j:i<j?i:j,m=e>f?e>g?e:g:f>g?f:g,n=h>i?h>j?h:j:i>j?i:j,o=d.next;for(;o!==b;){if(o.x>=k&&o.x<=m&&o.y>=l&&o.y<=n&&hj(e,h,f,i,g,j,o.x,o.y)&&hl(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function g7(a,b,c,d){let e=a.prev,f=a,g=a.next;if(hl(e,f,g)>=0)return!1;let h=e.x,i=f.x,j=g.x,k=e.y,l=f.y,m=g.y,n=h<i?h<j?h:j:i<j?i:j,o=k<l?k<m?k:m:l<m?l:m,p=h>i?h>j?h:j:i>j?i:j,q=k>l?k>m?k:m:l>m?l:m,r=hh(n,o,b,c,d),s=hh(p,q,b,c,d),t=a.prevZ,u=a.nextZ;for(;t&&t.z>=r&&u&&u.z<=s;){if(t.x>=n&&t.x<=p&&t.y>=o&&t.y<=q&&t!==e&&t!==g&&hj(h,k,i,l,j,m,t.x,t.y)&&hl(t.prev,t,t.next)>=0||(t=t.prevZ,u.x>=n&&u.x<=p&&u.y>=o&&u.y<=q&&u!==e&&u!==g&&hj(h,k,i,l,j,m,u.x,u.y)&&hl(u.prev,u,u.next)>=0))return!1;u=u.nextZ}for(;t&&t.z>=r;){if(t.x>=n&&t.x<=p&&t.y>=o&&t.y<=q&&t!==e&&t!==g&&hj(h,k,i,l,j,m,t.x,t.y)&&hl(t.prev,t,t.next)>=0)return!1;t=t.prevZ}for(;u&&u.z<=s;){if(u.x>=n&&u.x<=p&&u.y>=o&&u.y<=q&&u!==e&&u!==g&&hj(h,k,i,l,j,m,u.x,u.y)&&hl(u.prev,u,u.next)>=0)return!1;u=u.nextZ}return!0}function g8(a,b,c){let d=a;do{let e=d.prev,f=d.next.next;!hm(e,f)&&hn(e,d,d.next,f)&&hr(e,f)&&hr(f,e)&&(b.push(e.i/c|0),b.push(d.i/c|0),b.push(f.i/c|0),hv(d),hv(d.next),d=a=f),d=d.next}while(d!==a);return g4(d)}function g9(a,b,c,d,e,f){let g=a;do{let a=g.next.next;for(;a!==g.prev;){if(g.i!==a.i&&hk(g,a)){let h=ht(g,a);g=g4(g,g.next),h=g4(h,h.next),g5(g,b,c,d,e,f,0),g5(h,b,c,d,e,f,0);return}a=a.next}g=g.next}while(g!==a)}function ha(a,b,c,d){let e,f,g,h,i,j=[];for(e=0,f=b.length;e<f;e++)g=b[e]*d,h=e<f-1?b[e+1]*d:a.length,(i=g3(a,g,h,d,!1))===i.next&&(i.steiner=!0),j.push(hi(i));for(j.sort(hb),e=0;e<j.length;e++)c=hc(j[e],c);return c}function hb(a,b){return a.x-b.x}function hc(a,b){let c=hd(a,b);if(!c)return b;let d=ht(c,a);return g4(d,d.next),g4(c,c.next)}function hd(a,b){let c=b,d=-1/0,e,f=a.x,g=a.y;do{if(g<=c.y&&g>=c.next.y&&c.next.y!==c.y){let a=c.x+(g-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(a<=f&&a>d&&(d=a,e=c.x<c.next.x?c:c.next,a===f))return e}c=c.next}while(c!==b);if(!e)return null;let h=e,i=e.x,j=e.y,k=1/0,l;c=e;do f>=c.x&&c.x>=i&&f!==c.x&&hj(g<j?f:d,g,i,j,g<j?d:f,g,c.x,c.y)&&(l=Math.abs(g-c.y)/(f-c.x),hr(c,a)&&(l<k||l===k&&(c.x>e.x||c.x===e.x&&he(e,c)))&&(e=c,k=l)),c=c.next;while(c!==h);return e}function he(a,b){return 0>hl(a.prev,a,b.prev)&&0>hl(b.next,a,a.next)}function hf(a,b,c,d){let e=a;do 0===e.z&&(e.z=hh(e.x,e.y,b,c,d)),e.prevZ=e.prev,e.nextZ=e.next,e=e.next;while(e!==a);e.prevZ.nextZ=null,e.prevZ=null,hg(e)}function hg(a){let b,c,d,e,f,g,h,i,j=1;do{for(c=a,a=null,f=null,g=0;c;){for(g++,d=c,h=0,b=0;b<j&&(h++,d=d.nextZ);b++);for(i=j;h>0||i>0&&d;)0!==h&&(0===i||!d||c.z<=d.z)?(e=c,c=c.nextZ,h--):(e=d,d=d.nextZ,i--),f?f.nextZ=e:a=e,e.prevZ=f,f=e;c=d}f.nextZ=null,j*=2}while(g>1);return a}function hh(a,b,c,d,e){return(a=((a=((a=((a=((a=(a-c)*e|0)|a<<8)&0xff00ff)|a<<4)&0xf0f0f0f)|a<<2)&0x33333333)|a<<1)&0x55555555)|(b=((b=((b=((b=((b=(b-d)*e|0)|b<<8)&0xff00ff)|b<<4)&0xf0f0f0f)|b<<2)&0x33333333)|b<<1)&0x55555555)<<1}function hi(a){let b=a,c=a;do(b.x<c.x||b.x===c.x&&b.y<c.y)&&(c=b),b=b.next;while(b!==a);return c}function hj(a,b,c,d,e,f,g,h){return(e-g)*(b-h)>=(a-g)*(f-h)&&(a-g)*(d-h)>=(c-g)*(b-h)&&(c-g)*(f-h)>=(e-g)*(d-h)}function hk(a,b){return a.next.i!==b.i&&a.prev.i!==b.i&&!hq(a,b)&&(hr(a,b)&&hr(b,a)&&hs(a,b)&&(hl(a.prev,a,b.prev)||hl(a,b.prev,b))||hm(a,b)&&hl(a.prev,a,a.next)>0&&hl(b.prev,b,b.next)>0)}function hl(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function hm(a,b){return a.x===b.x&&a.y===b.y}function hn(a,b,c,d){let e=hp(hl(a,b,c)),f=hp(hl(a,b,d)),g=hp(hl(c,d,a)),h=hp(hl(c,d,b));return!!(e!==f&&g!==h||0===e&&ho(a,c,b)||0===f&&ho(a,d,b)||0===g&&ho(c,a,d)||0===h&&ho(c,b,d))}function ho(a,b,c){return b.x<=Math.max(a.x,c.x)&&b.x>=Math.min(a.x,c.x)&&b.y<=Math.max(a.y,c.y)&&b.y>=Math.min(a.y,c.y)}function hp(a){return a>0?1:a<0?-1:0}function hq(a,b){let c=a;do{if(c.i!==a.i&&c.next.i!==a.i&&c.i!==b.i&&c.next.i!==b.i&&hn(c,c.next,a,b))return!0;c=c.next}while(c!==a);return!1}function hr(a,b){return 0>hl(a.prev,a,a.next)?hl(a,b,a.next)>=0&&hl(a,a.prev,b)>=0:0>hl(a,b,a.prev)||0>hl(a,a.next,b)}function hs(a,b){let c=a,d=!1,e=(a.x+b.x)/2,f=(a.y+b.y)/2;do c.y>f!=c.next.y>f&&c.next.y!==c.y&&e<(c.next.x-c.x)*(f-c.y)/(c.next.y-c.y)+c.x&&(d=!d),c=c.next;while(c!==a);return d}function ht(a,b){let c=new hw(a.i,a.x,a.y),d=new hw(b.i,b.x,b.y),e=a.next,f=b.prev;return a.next=b,b.prev=a,c.next=e,e.prev=c,d.next=c,c.prev=d,f.next=d,d.prev=f,d}function hu(a,b,c,d){let e=new hw(a,b,c);return d?(e.next=d.next,e.prev=d,d.next.prev=e,d.next=e):(e.prev=e,e.next=e),e}function hv(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function hw(a,b,c){this.i=a,this.x=b,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function hx(a,b,c,d){let e=0;for(let f=b,g=c-d;f<c;f+=d)e+=(a[g]-a[f])*(a[f+1]+a[g+1]),g=f;return e}class hy{static area(a){let b=a.length,c=0;for(let d=b-1,e=0;e<b;d=e++)c+=a[d].x*a[e].y-a[e].x*a[d].y;return .5*c}static isClockWise(a){return 0>hy.area(a)}static triangulateShape(a,b){let c=[],d=[],e=[];hz(a),hA(c,a);let f=a.length;b.forEach(hz);for(let a=0;a<b.length;a++)d.push(f),f+=b[a].length,hA(c,b[a]);let g=g2.triangulate(c,d);for(let a=0;a<g.length;a+=3)e.push(g.slice(a,a+3));return e}}function hz(a){let b=a.length;b>2&&a[b-1].equals(a[0])&&a.pop()}function hA(a,b){for(let c=0;c<b.length;c++)a.push(b[c].x),a.push(b[c].y)}class hB extends er{constructor(a=new g1([new cr(.5,.5),new cr(-.5,.5),new cr(-.5,-.5),new cr(.5,-.5)]),b={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:a,options:b},a=Array.isArray(a)?a:[a];let c=this,d=[],e=[];for(let b=0,c=a.length;b<c;b++)f(a[b]);function f(a){let f,g,h,i,j=[],k=void 0!==b.curveSegments?b.curveSegments:12,l=void 0!==b.steps?b.steps:1,m=void 0!==b.depth?b.depth:1,n=void 0===b.bevelEnabled||b.bevelEnabled,o=void 0!==b.bevelThickness?b.bevelThickness:.2,p=void 0!==b.bevelSize?b.bevelSize:o-.1,q=void 0!==b.bevelOffset?b.bevelOffset:0,r=void 0!==b.bevelSegments?b.bevelSegments:3,s=b.extrudePath,t=void 0!==b.UVGenerator?b.UVGenerator:hC,u,v=!1;s&&(u=s.getSpacedPoints(l),v=!0,n=!1,f=s.computeFrenetFrames(l,!1),g=new cV,h=new cV,i=new cV),n||(r=0,o=0,p=0,q=0);let w=a.extractPoints(k),x=w.shape,y=w.holes;if(!hy.isClockWise(x)){x=x.reverse();for(let a=0,b=y.length;a<b;a++){let b=y[a];hy.isClockWise(b)&&(y[a]=b.reverse())}}let z=hy.triangulateShape(x,y),A=x;for(let a=0,b=y.length;a<b;a++){let b=y[a];x=x.concat(b)}function B(a,b,c){return b||console.error("THREE.ExtrudeGeometry: vec does not exist"),a.clone().addScaledVector(b,c)}let C=x.length,D=z.length;function E(a,b,c){let d,e,f,g=a.x-b.x,h=a.y-b.y,i=c.x-a.x,j=c.y-a.y,k=g*g+h*h;if(Math.abs(g*j-h*i)>Number.EPSILON){let l=Math.sqrt(k),m=Math.sqrt(i*i+j*j),n=b.x-h/l,o=b.y+g/l,p=((c.x-j/m-n)*j-(c.y+i/m-o)*i)/(g*j-h*i),q=(d=n+g*p-a.x)*d+(e=o+h*p-a.y)*e;if(q<=2)return new cr(d,e);f=Math.sqrt(q/2)}else{let a=!1;g>Number.EPSILON?i>Number.EPSILON&&(a=!0):g<-Number.EPSILON?i<-Number.EPSILON&&(a=!0):Math.sign(h)===Math.sign(j)&&(a=!0),a?(d=-h,e=g,f=Math.sqrt(k)):(d=g,e=h,f=Math.sqrt(k/2))}return new cr(d/f,e/f)}let F=[];for(let a=0,b=A.length,c=b-1,d=a+1;a<b;a++,c++,d++)c===b&&(c=0),d===b&&(d=0),F[a]=E(A[a],A[c],A[d]);let G=[],H,I=F.concat();for(let a=0,b=y.length;a<b;a++){let b=y[a];H=[];for(let a=0,c=b.length,d=c-1,e=a+1;a<c;a++,d++,e++)d===c&&(d=0),e===c&&(e=0),H[a]=E(b[a],b[d],b[e]);G.push(H),I=I.concat(H)}for(let a=0;a<r;a++){let b=a/r,c=o*Math.cos(b*Math.PI/2),d=p*Math.sin(b*Math.PI/2)+q;for(let a=0,b=A.length;a<b;a++){let b=B(A[a],F[a],d);M(b.x,b.y,-c)}for(let a=0,b=y.length;a<b;a++){let b=y[a];H=G[a];for(let a=0,e=b.length;a<e;a++){let e=B(b[a],H[a],d);M(e.x,e.y,-c)}}}let J=p+q;for(let a=0;a<C;a++){let b=n?B(x[a],I[a],J):x[a];v?(h.copy(f.normals[0]).multiplyScalar(b.x),g.copy(f.binormals[0]).multiplyScalar(b.y),i.copy(u[0]).add(h).add(g),M(i.x,i.y,i.z)):M(b.x,b.y,0)}for(let a=1;a<=l;a++)for(let b=0;b<C;b++){let c=n?B(x[b],I[b],J):x[b];v?(h.copy(f.normals[a]).multiplyScalar(c.x),g.copy(f.binormals[a]).multiplyScalar(c.y),i.copy(u[a]).add(h).add(g),M(i.x,i.y,i.z)):M(c.x,c.y,m/l*a)}for(let a=r-1;a>=0;a--){let b=a/r,c=o*Math.cos(b*Math.PI/2),d=p*Math.sin(b*Math.PI/2)+q;for(let a=0,b=A.length;a<b;a++){let b=B(A[a],F[a],d);M(b.x,b.y,m+c)}for(let a=0,b=y.length;a<b;a++){let b=y[a];H=G[a];for(let a=0,e=b.length;a<e;a++){let e=B(b[a],H[a],d);v?M(e.x,e.y+u[l-1].y,u[l-1].x+c):M(e.x,e.y,m+c)}}}function K(){let a=d.length/3,b=0;L(A,0),b+=A.length;for(let a=0,c=y.length;a<c;a++){let c=y[a];L(c,b),b+=c.length}c.addGroup(a,d.length/3-a,1)}function L(a,b){let c=a.length;for(;--c>=0;){let d=c,e=c-1;e<0&&(e=a.length-1);for(let a=0,c=l+2*r;a<c;a++){let c=C*a,f=C*(a+1);O(b+d+c,b+e+c,b+e+f,b+d+f)}}}function M(a,b,c){j.push(a),j.push(b),j.push(c)}function N(a,b,e){P(a),P(b),P(e);let f=d.length/3,g=t.generateTopUV(c,d,f-3,f-2,f-1);Q(g[0]),Q(g[1]),Q(g[2])}function O(a,b,e,f){P(a),P(b),P(f),P(b),P(e),P(f);let g=d.length/3,h=t.generateSideWallUV(c,d,g-6,g-3,g-2,g-1);Q(h[0]),Q(h[1]),Q(h[3]),Q(h[1]),Q(h[2]),Q(h[3])}function P(a){d.push(j[3*a+0]),d.push(j[3*a+1]),d.push(j[3*a+2])}function Q(a){e.push(a.x),e.push(a.y)}(function a(){let a=d.length/3;if(n){let a=0,b=0*C;for(let a=0;a<D;a++){let c=z[a];N(c[2]+b,c[1]+b,c[0]+b)}b=C*(a=l+2*r);for(let a=0;a<D;a++){let c=z[a];N(c[0]+b,c[1]+b,c[2]+b)}}else{for(let a=0;a<D;a++){let b=z[a];N(b[2],b[1],b[0])}for(let a=0;a<D;a++){let b=z[a];N(b[0]+C*l,b[1]+C*l,b[2]+C*l)}}c.addGroup(a,d.length/3-a,0)})(),K()}this.setAttribute("position",new ej(d,3)),this.setAttribute("uv",new ej(e,2)),this.computeVertexNormals()}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}toJSON(){let a=super.toJSON();return hD(this.parameters.shapes,this.parameters.options,a)}static fromJSON(a,b){let c=[];for(let d=0,e=a.shapes.length;d<e;d++){let e=b[a.shapes[d]];c.push(e)}let d=a.options.extrudePath;return void 0!==d&&(a.options.extrudePath=new gO[d.type]().fromJSON(d)),new hB(c,a.options)}}let hC={generateTopUV:function(a,b,c,d,e){let f=b[3*c],g=b[3*c+1],h=b[3*d],i=b[3*d+1],j=b[3*e],k=b[3*e+1];return[new cr(f,g),new cr(h,i),new cr(j,k)]},generateSideWallUV:function(a,b,c,d,e,f){let g=b[3*c],h=b[3*c+1],i=b[3*c+2],j=b[3*d],k=b[3*d+1],l=b[3*d+2],m=b[3*e],n=b[3*e+1],o=b[3*e+2],p=b[3*f],q=b[3*f+1],r=b[3*f+2];return Math.abs(h-k)<Math.abs(g-j)?[new cr(g,1-i),new cr(j,1-l),new cr(m,1-o),new cr(p,1-r)]:[new cr(h,1-i),new cr(k,1-l),new cr(n,1-o),new cr(q,1-r)]}};function hD(a,b,c){if(c.shapes=[],Array.isArray(a))for(let b=0,d=a.length;b<d;b++){let d=a[b];c.shapes.push(d.uuid)}else c.shapes.push(a.uuid);return c.options=Object.assign({},b),void 0!==b.extrudePath&&(c.options.extrudePath=b.extrudePath.toJSON()),c}class hE extends gW{constructor(a=1,b=0){let c=(1+Math.sqrt(5))/2;super([-1,c,0,1,c,0,-1,-c,0,1,-c,0,0,-1,c,0,1,c,0,-1,-c,0,1,-c,c,0,-1,c,0,1,-c,0,-1,-c,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a,b),this.type="IcosahedronGeometry",this.parameters={radius:a,detail:b}}static fromJSON(a){return new hE(a.radius,a.detail)}}class hF extends gW{constructor(a=1,b=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],a,b),this.type="OctahedronGeometry",this.parameters={radius:a,detail:b}}static fromJSON(a){return new hF(a.radius,a.detail)}}class hG extends er{constructor(a=1,b=1,c=1,d=1){super(),this.type="PlaneGeometry",this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};let e=a/2,f=b/2,g=Math.floor(c),h=Math.floor(d),i=g+1,j=h+1,k=a/g,l=b/h,m=[],n=[],o=[],p=[];for(let a=0;a<j;a++){let b=a*l-f;for(let c=0;c<i;c++){let d=c*k-e;n.push(d,-b,0),o.push(0,0,1),p.push(c/g),p.push(1-a/h)}}for(let a=0;a<h;a++)for(let b=0;b<g;b++){let c=b+i*a,d=b+i*(a+1),e=b+1+i*(a+1),f=b+1+i*a;m.push(c,d,f),m.push(d,e,f)}this.setIndex(m),this.setAttribute("position",new ej(n,3)),this.setAttribute("normal",new ej(o,3)),this.setAttribute("uv",new ej(p,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new hG(a.width,a.height,a.widthSegments,a.heightSegments)}}class hH extends er{constructor(a=.5,b=1,c=32,d=1,e=0,f=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:e,thetaLength:f},c=Math.max(3,c);let g=[],h=[],i=[],j=[],k=a,l=(b-a)/(d=Math.max(1,d)),m=new cV,n=new cr;for(let a=0;a<=d;a++){for(let a=0;a<=c;a++){let d=e+a/c*f;m.x=k*Math.cos(d),m.y=k*Math.sin(d),h.push(m.x,m.y,m.z),i.push(0,0,1),n.x=(m.x/b+1)/2,n.y=(m.y/b+1)/2,j.push(n.x,n.y)}k+=l}for(let a=0;a<d;a++){let b=a*(c+1);for(let a=0;a<c;a++){let d=a+b,e=d,f=d+c+1,h=d+c+2,i=d+1;g.push(e,f,i),g.push(f,h,i)}}this.setIndex(g),this.setAttribute("position",new ej(h,3)),this.setAttribute("normal",new ej(i,3)),this.setAttribute("uv",new ej(j,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new hH(a.innerRadius,a.outerRadius,a.thetaSegments,a.phiSegments,a.thetaStart,a.thetaLength)}}class hI extends er{constructor(a=new g1([new cr(0,.5),new cr(-.5,-.5),new cr(.5,-.5)]),b=12){super(),this.type="ShapeGeometry",this.parameters={shapes:a,curveSegments:b};let c=[],d=[],e=[],f=[],g=0,h=0;if(!1===Array.isArray(a))i(a);else for(let b=0;b<a.length;b++)i(a[b]),this.addGroup(g,h,b),g+=h,h=0;function i(a){let g=d.length/3,i=a.extractPoints(b),j=i.shape,k=i.holes;!1===hy.isClockWise(j)&&(j=j.reverse());for(let a=0,b=k.length;a<b;a++){let b=k[a];!0===hy.isClockWise(b)&&(k[a]=b.reverse())}let l=hy.triangulateShape(j,k);for(let a=0,b=k.length;a<b;a++){let b=k[a];j=j.concat(b)}for(let a=0,b=j.length;a<b;a++){let b=j[a];d.push(b.x,b.y,0),e.push(0,0,1),f.push(b.x,b.y)}for(let a=0,b=l.length;a<b;a++){let b=l[a],d=b[0]+g,e=b[1]+g,f=b[2]+g;c.push(d,e,f),h+=3}}this.setIndex(c),this.setAttribute("position",new ej(d,3)),this.setAttribute("normal",new ej(e,3)),this.setAttribute("uv",new ej(f,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}toJSON(){let a=super.toJSON();return hJ(this.parameters.shapes,a)}static fromJSON(a,b){let c=[];for(let d=0,e=a.shapes.length;d<e;d++){let e=b[a.shapes[d]];c.push(e)}return new hI(c,a.curveSegments)}}function hJ(a,b){if(b.shapes=[],Array.isArray(a))for(let c=0,d=a.length;c<d;c++){let d=a[c];b.shapes.push(d.uuid)}else b.shapes.push(a.uuid);return b}class hK extends er{constructor(a=1,b=32,c=16,d=0,e=2*Math.PI,f=0,g=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:f,thetaLength:g},b=Math.max(3,Math.floor(b)),c=Math.max(2,Math.floor(c));let h=Math.min(f+g,Math.PI),i=0,j=[],k=new cV,l=new cV,m=[],n=[],o=[],p=[];for(let m=0;m<=c;m++){let q=[],r=m/c,s=0;0===m&&0===f?s=.5/b:m===c&&h===Math.PI&&(s=-.5/b);for(let c=0;c<=b;c++){let h=c/b;k.x=-a*Math.cos(d+h*e)*Math.sin(f+r*g),k.y=a*Math.cos(f+r*g),k.z=a*Math.sin(d+h*e)*Math.sin(f+r*g),n.push(k.x,k.y,k.z),l.copy(k).normalize(),o.push(l.x,l.y,l.z),p.push(h+s,1-r),q.push(i++)}j.push(q)}for(let a=0;a<c;a++)for(let d=0;d<b;d++){let b=j[a][d+1],e=j[a][d],g=j[a+1][d],i=j[a+1][d+1];(0!==a||f>0)&&m.push(b,e,i),(a!==c-1||h<Math.PI)&&m.push(e,g,i)}this.setIndex(m),this.setAttribute("position",new ej(n,3)),this.setAttribute("normal",new ej(o,3)),this.setAttribute("uv",new ej(p,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new hK(a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength)}}class hL extends gW{constructor(a=1,b=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],a,b),this.type="TetrahedronGeometry",this.parameters={radius:a,detail:b}}static fromJSON(a){return new hL(a.radius,a.detail)}}class hM extends er{constructor(a=1,b=.4,c=12,d=48,e=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:e},c=Math.floor(c),d=Math.floor(d);let f=[],g=[],h=[],i=[],j=new cV,k=new cV,l=new cV;for(let f=0;f<=c;f++)for(let m=0;m<=d;m++){let n=m/d*e,o=f/c*Math.PI*2;k.x=(a+b*Math.cos(o))*Math.cos(n),k.y=(a+b*Math.cos(o))*Math.sin(n),k.z=b*Math.sin(o),g.push(k.x,k.y,k.z),j.x=a*Math.cos(n),j.y=a*Math.sin(n),l.subVectors(k,j).normalize(),h.push(l.x,l.y,l.z),i.push(m/d),i.push(f/c)}for(let a=1;a<=c;a++)for(let b=1;b<=d;b++){let c=(d+1)*a+b-1,e=(d+1)*(a-1)+b-1,g=(d+1)*(a-1)+b,h=(d+1)*a+b;f.push(c,e,h),f.push(e,g,h)}this.setIndex(f),this.setAttribute("position",new ej(g,3)),this.setAttribute("normal",new ej(h,3)),this.setAttribute("uv",new ej(i,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new hM(a.radius,a.tube,a.radialSegments,a.tubularSegments,a.arc)}}class hN extends er{constructor(a=1,b=.4,c=64,d=8,e=2,f=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:a,tube:b,tubularSegments:c,radialSegments:d,p:e,q:f},c=Math.floor(c),d=Math.floor(d);let g=[],h=[],i=[],j=[],k=new cV,l=new cV,m=new cV,n=new cV,o=new cV,p=new cV,q=new cV;for(let g=0;g<=c;++g){let s=g/c*e*Math.PI*2;r(s,e,f,a,m),r(s+.01,e,f,a,n),p.subVectors(n,m),q.addVectors(n,m),o.crossVectors(p,q),q.crossVectors(o,p),o.normalize(),q.normalize();for(let a=0;a<=d;++a){let e=a/d*Math.PI*2,f=-b*Math.cos(e),n=b*Math.sin(e);k.x=m.x+(f*q.x+n*o.x),k.y=m.y+(f*q.y+n*o.y),k.z=m.z+(f*q.z+n*o.z),h.push(k.x,k.y,k.z),l.subVectors(k,m).normalize(),i.push(l.x,l.y,l.z),j.push(g/c),j.push(a/d)}}for(let a=1;a<=c;a++)for(let b=1;b<=d;b++){let c=(d+1)*(a-1)+(b-1),e=(d+1)*a+(b-1),f=(d+1)*a+b,h=(d+1)*(a-1)+b;g.push(c,e,h),g.push(e,f,h)}function r(a,b,c,d,e){let f=Math.cos(a),g=Math.sin(a),h=c/b*a,i=Math.cos(h);e.x=d*(2+i)*.5*f,e.y=d*(2+i)*g*.5,e.z=d*Math.sin(h)*.5}this.setIndex(g),this.setAttribute("position",new ej(h,3)),this.setAttribute("normal",new ej(i,3)),this.setAttribute("uv",new ej(j,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}static fromJSON(a){return new hN(a.radius,a.tube,a.tubularSegments,a.radialSegments,a.p,a.q)}}class hO extends er{constructor(a=new gM(new cV(-1,-1,0),new cV(-1,1,0),new cV(1,1,0)),b=64,c=1,d=8,e=!1){super(),this.type="TubeGeometry",this.parameters={path:a,tubularSegments:b,radius:c,radialSegments:d,closed:e};let f=a.computeFrenetFrames(b,e);this.tangents=f.tangents,this.normals=f.normals,this.binormals=f.binormals;let g=new cV,h=new cV,i=new cr,j=new cV,k=[],l=[],m=[],n=[];function o(e){j=a.getPointAt(e/b,j);let i=f.normals[e],m=f.binormals[e];for(let a=0;a<=d;a++){let b=a/d*Math.PI*2,e=Math.sin(b),f=-Math.cos(b);h.x=f*i.x+e*m.x,h.y=f*i.y+e*m.y,h.z=f*i.z+e*m.z,h.normalize(),l.push(h.x,h.y,h.z),g.x=j.x+c*h.x,g.y=j.y+c*h.y,g.z=j.z+c*h.z,k.push(g.x,g.y,g.z)}}function p(){for(let a=1;a<=b;a++)for(let b=1;b<=d;b++){let c=(d+1)*(a-1)+(b-1),e=(d+1)*a+(b-1),f=(d+1)*a+b,g=(d+1)*(a-1)+b;n.push(c,e,g),n.push(e,f,g)}}function q(){for(let a=0;a<=b;a++)for(let c=0;c<=d;c++)i.x=a/b,i.y=c/d,m.push(i.x,i.y)}(function a(){for(let a=0;a<b;a++)o(a);o(!1===e?b:0),q(),p()})(),this.setIndex(n),this.setAttribute("position",new ej(k,3)),this.setAttribute("normal",new ej(l,3)),this.setAttribute("uv",new ej(m,2))}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}toJSON(){let a=super.toJSON();return a.path=this.parameters.path.toJSON(),a}static fromJSON(a){return new hO(new gO[a.path.type]().fromJSON(a.path),a.tubularSegments,a.radius,a.radialSegments,a.closed)}}class hP extends er{constructor(a=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:a},null!==a){let b=[],c=new Set,d=new cV,e=new cV;if(null!==a.index){let f=a.attributes.position,g=a.index,h=a.groups;0===h.length&&(h=[{start:0,count:g.count,materialIndex:0}]);for(let a=0,i=h.length;a<i;++a){let i=h[a],j=i.start,k=i.count;for(let a=j,h=j+k;a<h;a+=3)for(let h=0;h<3;h++){let i=g.getX(a+h),j=g.getX(a+(h+1)%3);d.fromBufferAttribute(f,i),e.fromBufferAttribute(f,j),!0===hQ(d,e,c)&&(b.push(d.x,d.y,d.z),b.push(e.x,e.y,e.z))}}}else{let f=a.attributes.position;for(let a=0,g=f.count/3;a<g;a++)for(let g=0;g<3;g++){let h=3*a+g,i=3*a+(g+1)%3;d.fromBufferAttribute(f,h),e.fromBufferAttribute(f,i),!0===hQ(d,e,c)&&(b.push(d.x,d.y,d.z),b.push(e.x,e.y,e.z))}}this.setAttribute("position",new ej(b,3))}}copy(a){return super.copy(a),this.parameters=Object.assign({},a.parameters),this}}function hQ(a,b,c){let d=`${a.x},${a.y},${a.z}-${b.x},${b.y},${b.z}`,e=`${b.x},${b.y},${b.z}-${a.x},${a.y},${a.z}`;return!0!==c.has(d)&&!0!==c.has(e)&&(c.add(d),c.add(e),!0)}class hR extends d9{constructor(a){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new d6(0),this.transparent=!0,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.fog=a.fog,this}}class hS extends eO{constructor(a){super(a),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class hT extends d9{constructor(a){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new d6(0xffffff),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new d6(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bX,this.normalScale=new cr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new dy,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.defines={STANDARD:""},this.color.copy(a.color),this.roughness=a.roughness,this.metalness=a.metalness,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.roughnessMap=a.roughnessMap,this.metalnessMap=a.metalnessMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapRotation.copy(a.envMapRotation),this.envMapIntensity=a.envMapIntensity,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.flatShading=a.flatShading,this.fog=a.fog,this}}class hU extends hT{constructor(a){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new cr(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return cm(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(a){this.ior=(1+.4*a)/(1-.4*a)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new d6(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new d6(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new d6(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(a)}get anisotropy(){return this._anisotropy}set anisotropy(a){this._anisotropy>0!=a>0&&this.version++,this._anisotropy=a}get clearcoat(){return this._clearcoat}set clearcoat(a){this._clearcoat>0!=a>0&&this.version++,this._clearcoat=a}get iridescence(){return this._iridescence}set iridescence(a){this._iridescence>0!=a>0&&this.version++,this._iridescence=a}get dispersion(){return this._dispersion}set dispersion(a){this._dispersion>0!=a>0&&this.version++,this._dispersion=a}get sheen(){return this._sheen}set sheen(a){this._sheen>0!=a>0&&this.version++,this._sheen=a}get transmission(){return this._transmission}set transmission(a){this._transmission>0!=a>0&&this.version++,this._transmission=a}copy(a){return super.copy(a),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=a.anisotropy,this.anisotropyRotation=a.anisotropyRotation,this.anisotropyMap=a.anisotropyMap,this.clearcoat=a.clearcoat,this.clearcoatMap=a.clearcoatMap,this.clearcoatRoughness=a.clearcoatRoughness,this.clearcoatRoughnessMap=a.clearcoatRoughnessMap,this.clearcoatNormalMap=a.clearcoatNormalMap,this.clearcoatNormalScale.copy(a.clearcoatNormalScale),this.dispersion=a.dispersion,this.ior=a.ior,this.iridescence=a.iridescence,this.iridescenceMap=a.iridescenceMap,this.iridescenceIOR=a.iridescenceIOR,this.iridescenceThicknessRange=[...a.iridescenceThicknessRange],this.iridescenceThicknessMap=a.iridescenceThicknessMap,this.sheen=a.sheen,this.sheenColor.copy(a.sheenColor),this.sheenColorMap=a.sheenColorMap,this.sheenRoughness=a.sheenRoughness,this.sheenRoughnessMap=a.sheenRoughnessMap,this.transmission=a.transmission,this.transmissionMap=a.transmissionMap,this.thickness=a.thickness,this.thicknessMap=a.thicknessMap,this.attenuationDistance=a.attenuationDistance,this.attenuationColor.copy(a.attenuationColor),this.specularIntensity=a.specularIntensity,this.specularIntensityMap=a.specularIntensityMap,this.specularColor.copy(a.specularColor),this.specularColorMap=a.specularColorMap,this}}class hV extends d9{constructor(a){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new d6(0xffffff),this.specular=new d6(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new d6(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bX,this.normalScale=new cr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new dy,this.combine=aq,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.specular.copy(a.specular),this.shininess=a.shininess,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapRotation.copy(a.envMapRotation),this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.flatShading=a.flatShading,this.fog=a.fog,this}}class hW extends d9{constructor(a){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new d6(0xffffff),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new d6(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bX,this.normalScale=new cr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.gradientMap=a.gradientMap,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.fog=a.fog,this}}class hX extends d9{constructor(a){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bX,this.normalScale=new cr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(a)}copy(a){return super.copy(a),this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.flatShading=a.flatShading,this}}class hY extends d9{constructor(a){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new d6(0xffffff),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new d6(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bX,this.normalScale=new cr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new dy,this.combine=aq,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapRotation.copy(a.envMapRotation),this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.flatShading=a.flatShading,this.fog=a.fog,this}}class hZ extends d9{constructor(a){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=bV,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(a)}copy(a){return super.copy(a),this.depthPacking=a.depthPacking,this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this}}class h$ extends d9{constructor(a){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(a)}copy(a){return super.copy(a),this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this}}class h_ extends d9{constructor(a){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new d6(0xffffff),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bX,this.normalScale=new cr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(a)}copy(a){return super.copy(a),this.defines={MATCAP:""},this.color.copy(a.color),this.matcap=a.matcap,this.map=a.map,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.flatShading=a.flatShading,this.fog=a.fog,this}}class h0 extends f4{constructor(a){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(a)}copy(a){return super.copy(a),this.scale=a.scale,this.dashSize=a.dashSize,this.gapSize=a.gapSize,this}}function h1(a,b,c){return a&&(c||a.constructor!==b)?"number"==typeof b.BYTES_PER_ELEMENT?new b(a):Array.prototype.slice.call(a):a}function h2(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}function h3(a){function b(b,c){return a[b]-a[c]}let c=a.length,d=Array(c);for(let a=0;a!==c;++a)d[a]=a;return d.sort(b),d}function h4(a,b,c){let d=a.length,e=new a.constructor(d);for(let f=0,g=0;g!==d;++f){let d=c[f]*b;for(let c=0;c!==b;++c)e[g++]=a[d+c]}return e}function h5(a,b,c,d){let e=1,f=a[0];for(;void 0!==f&&void 0===f[d];)f=a[e++];if(void 0===f)return;let g=f[d];if(void 0!==g)if(Array.isArray(g))do void 0!==(g=f[d])&&(b.push(f.time),c.push.apply(c,g)),f=a[e++];while(void 0!==f);else if(void 0!==g.toArray)do void 0!==(g=f[d])&&(b.push(f.time),g.toArray(c,c.length)),f=a[e++];while(void 0!==f);else do void 0!==(g=f[d])&&(b.push(f.time),c.push(g)),f=a[e++];while(void 0!==f)}class h6{constructor(a,b,c,d){this.parameterPositions=a,this._cachedIndex=0,this.resultBuffer=void 0!==d?d:new b.constructor(c),this.sampleValues=b,this.valueSize=c,this.settings=null,this.DefaultSettings_={}}evaluate(a){let b=this.parameterPositions,c=this._cachedIndex,d=b[c],e=b[c-1];a:{b:{let f;c:{d:if(!(a<d)){for(let f=c+2;;){if(void 0===d){if(a<e)break d;return c=b.length,this._cachedIndex=c,this.copySampleValue_(c-1)}if(c===f)break;if(e=d,a<(d=b[++c]))break b}f=b.length;break c}if(!(a>=e)){let g=b[1];a<g&&(c=2,e=g);for(let f=c-2;;){if(void 0===e)return this._cachedIndex=0,this.copySampleValue_(0);if(c===f)break;if(d=e,a>=(e=b[--c-1]))break b}f=c,c=0;break c}break a}for(;c<f;){let d=c+f>>>1;a<b[d]?f=d:c=d+1}if(d=b[c],void 0===(e=b[c-1]))return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===d)return c=b.length,this._cachedIndex=c,this.copySampleValue_(c-1)}this._cachedIndex=c,this.intervalChanged_(c,e,d)}return this.interpolate_(c,e,a,d)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(a){let b=this.resultBuffer,c=this.sampleValues,d=this.valueSize,e=a*d;for(let a=0;a!==d;++a)b[a]=c[e+a];return b}interpolate_(){throw Error("call to abstract method")}intervalChanged_(){}}class h7 extends h6{constructor(a,b,c,d){super(a,b,c,d),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:bQ,endingEnd:bQ}}intervalChanged_(a,b,c){let d=this.parameterPositions,e=a-2,f=a+1,g=d[e],h=d[f];if(void 0===g)switch(this.getSettings_().endingStart){case bR:e=a,g=2*b-c;break;case bS:e=d.length-2,g=b+d[e]-d[e+1];break;default:e=a,g=c}if(void 0===h)switch(this.getSettings_().endingEnd){case bR:f=a,h=2*c-b;break;case bS:f=1,h=c+d[1]-d[0];break;default:f=a-1,h=b}let i=(c-b)*.5,j=this.valueSize;this._weightPrev=i/(b-g),this._weightNext=i/(h-c),this._offsetPrev=e*j,this._offsetNext=f*j}interpolate_(a,b,c,d){let e=this.resultBuffer,f=this.sampleValues,g=this.valueSize,h=a*g,i=h-g,j=this._offsetPrev,k=this._offsetNext,l=this._weightPrev,m=this._weightNext,n=(c-b)/(d-b),o=n*n,p=o*n,q=-l*p+2*l*o-l*n,r=(1+l)*p+(-1.5-2*l)*o+(-.5+l)*n+1,s=(-1-m)*p+(1.5+m)*o+.5*n,t=m*p-m*o;for(let a=0;a!==g;++a)e[a]=q*f[j+a]+r*f[i+a]+s*f[h+a]+t*f[k+a];return e}}class h8 extends h6{constructor(a,b,c,d){super(a,b,c,d)}interpolate_(a,b,c,d){let e=this.resultBuffer,f=this.sampleValues,g=this.valueSize,h=a*g,i=h-g,j=(c-b)/(d-b),k=1-j;for(let a=0;a!==g;++a)e[a]=f[i+a]*k+f[h+a]*j;return e}}class h9 extends h6{constructor(a,b,c,d){super(a,b,c,d)}interpolate_(a){return this.copySampleValue_(a-1)}}class ia{constructor(a,b,c,d){if(void 0===a)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===b||0===b.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+a);this.name=a,this.times=h1(b,this.TimeBufferType),this.values=h1(c,this.ValueBufferType),this.setInterpolation(d||this.DefaultInterpolation)}static toJSON(a){let b,c=a.constructor;if(c.toJSON!==this.toJSON)b=c.toJSON(a);else{b={name:a.name,times:h1(a.times,Array),values:h1(a.values,Array)};let c=a.getInterpolation();c!==a.DefaultInterpolation&&(b.interpolation=c)}return b.type=a.ValueTypeName,b}InterpolantFactoryMethodDiscrete(a){return new h9(this.times,this.values,this.getValueSize(),a)}InterpolantFactoryMethodLinear(a){return new h8(this.times,this.values,this.getValueSize(),a)}InterpolantFactoryMethodSmooth(a){return new h7(this.times,this.values,this.getValueSize(),a)}setInterpolation(a){let b;switch(a){case bN:b=this.InterpolantFactoryMethodDiscrete;break;case bO:b=this.InterpolantFactoryMethodLinear;break;case bP:b=this.InterpolantFactoryMethodSmooth}if(void 0===b){let b="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant)if(a!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(b);return console.warn("THREE.KeyframeTrack:",b),this}return this.createInterpolant=b,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return bN;case this.InterpolantFactoryMethodLinear:return bO;case this.InterpolantFactoryMethodSmooth:return bP}}getValueSize(){return this.values.length/this.times.length}shift(a){if(0!==a){let b=this.times;for(let c=0,d=b.length;c!==d;++c)b[c]+=a}return this}scale(a){if(1!==a){let b=this.times;for(let c=0,d=b.length;c!==d;++c)b[c]*=a}return this}trim(a,b){let c=this.times,d=c.length,e=0,f=d-1;for(;e!==d&&c[e]<a;)++e;for(;-1!==f&&c[f]>b;)--f;if(++f,0!==e||f!==d){e>=f&&(e=(f=Math.max(f,1))-1);let a=this.getValueSize();this.times=c.slice(e,f),this.values=this.values.slice(e*a,f*a)}return this}validate(){let a=!0,b=this.getValueSize();b-Math.floor(b)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),a=!1);let c=this.times,d=this.values,e=c.length;0===e&&(console.error("THREE.KeyframeTrack: Track is empty.",this),a=!1);let f=null;for(let b=0;b!==e;b++){let d=c[b];if("number"==typeof d&&isNaN(d)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,b,d),a=!1;break}if(null!==f&&f>d){console.error("THREE.KeyframeTrack: Out of order keys.",this,b,d,f),a=!1;break}f=d}if(void 0!==d&&h2(d))for(let b=0,c=d.length;b!==c;++b){let c=d[b];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,b,c),a=!1;break}}return a}optimize(){let a=this.times.slice(),b=this.values.slice(),c=this.getValueSize(),d=this.getInterpolation()===bP,e=a.length-1,f=1;for(let g=1;g<e;++g){let e=!1,h=a[g];if(h!==a[g+1]&&(1!==g||h!==a[0]))if(d)e=!0;else{let a=g*c,d=a-c,f=a+c;for(let g=0;g!==c;++g){let c=b[a+g];if(c!==b[d+g]||c!==b[f+g]){e=!0;break}}}if(e){if(g!==f){a[f]=a[g];let d=g*c,e=f*c;for(let a=0;a!==c;++a)b[e+a]=b[d+a]}++f}}if(e>0){a[f]=a[e];for(let a=e*c,d=f*c,g=0;g!==c;++g)b[d+g]=b[a+g];++f}return f!==a.length?(this.times=a.slice(0,f),this.values=b.slice(0,f*c)):(this.times=a,this.values=b),this}clone(){let a=this.times.slice(),b=this.values.slice(),c=new this.constructor(this.name,a,b);return c.createInterpolant=this.createInterpolant,c}}ia.prototype.TimeBufferType=Float32Array,ia.prototype.ValueBufferType=Float32Array,ia.prototype.DefaultInterpolation=bO;class ib extends ia{constructor(a,b,c){super(a,b,c)}}ib.prototype.ValueTypeName="bool",ib.prototype.ValueBufferType=Array,ib.prototype.DefaultInterpolation=bN,ib.prototype.InterpolantFactoryMethodLinear=void 0,ib.prototype.InterpolantFactoryMethodSmooth=void 0;class ic extends ia{}ic.prototype.ValueTypeName="color";class id extends ia{}id.prototype.ValueTypeName="number";class ie extends h6{constructor(a,b,c,d){super(a,b,c,d)}interpolate_(a,b,c,d){let e=this.resultBuffer,f=this.sampleValues,g=this.valueSize,h=(c-b)/(d-b),i=a*g;for(let a=i+g;i!==a;i+=4)cU.slerpFlat(e,0,f,i-g,f,i,h);return e}}class ig extends ia{InterpolantFactoryMethodLinear(a){return new ie(this.times,this.values,this.getValueSize(),a)}}ig.prototype.ValueTypeName="quaternion",ig.prototype.InterpolantFactoryMethodSmooth=void 0;class ih extends ia{constructor(a,b,c){super(a,b,c)}}ih.prototype.ValueTypeName="string",ih.prototype.ValueBufferType=Array,ih.prototype.DefaultInterpolation=bN,ih.prototype.InterpolantFactoryMethodLinear=void 0,ih.prototype.InterpolantFactoryMethodSmooth=void 0;class ii extends ia{}ii.prototype.ValueTypeName="vector";function ij(a){switch(a.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return id;case"vector":case"vector2":case"vector3":case"vector4":return ii;case"color":return ic;case"quaternion":return ig;case"bool":case"boolean":return ib;case"string":return ih}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+a)}function ik(a){if(void 0===a.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");let b=ij(a.type);if(void 0===a.times){let b=[],c=[];h5(a.keys,b,c,"value"),a.times=b,a.values=c}return void 0!==b.parse?b.parse(a):new b(a.name,a.times,a.values,a.interpolation)}let il={enabled:!1,files:{},add:function(a,b){!1!==this.enabled&&(this.files[a]=b)},get:function(a){if(!1!==this.enabled)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}};class im{constructor(a,b,c){let d,e=this,f=!1,g=0,h=0,i=[];this.onStart=void 0,this.onLoad=a,this.onProgress=b,this.onError=c,this.itemStart=function(a){h++,!1===f&&void 0!==e.onStart&&e.onStart(a,g,h),f=!0},this.itemEnd=function(a){g++,void 0!==e.onProgress&&e.onProgress(a,g,h),g===h&&(f=!1,void 0!==e.onLoad&&e.onLoad())},this.itemError=function(a){void 0!==e.onError&&e.onError(a)},this.resolveURL=function(a){return d?d(a):a},this.setURLModifier=function(a){return d=a,this},this.addHandler=function(a,b){return i.push(a,b),this},this.removeHandler=function(a){let b=i.indexOf(a);return -1!==b&&i.splice(b,2),this},this.getHandler=function(a){for(let b=0,c=i.length;b<c;b+=2){let c=i[b],d=i[b+1];if(c.global&&(c.lastIndex=0),c.test(a))return d}return null}}}let io=new im;class ip{constructor(a){this.manager=void 0!==a?a:io,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(a,b){let c=this;return new Promise(function(d,e){c.load(a,d,b,e)})}parse(){}setCrossOrigin(a){return this.crossOrigin=a,this}setWithCredentials(a){return this.withCredentials=a,this}setPath(a){return this.path=a,this}setResourcePath(a){return this.resourcePath=a,this}setRequestHeader(a){return this.requestHeader=a,this}}ip.DEFAULT_MATERIAL_NAME="__DEFAULT";let iq={};class ir extends Error{constructor(a,b){super(a),this.response=b}}class is extends ip{constructor(a){super(a)}load(a,b,c,d){void 0===a&&(a=""),void 0!==this.path&&(a=this.path+a),a=this.manager.resolveURL(a);let e=il.get(a);if(void 0!==e)return this.manager.itemStart(a),setTimeout(()=>{b&&b(e),this.manager.itemEnd(a)},0),e;if(void 0!==iq[a])return void iq[a].push({onLoad:b,onProgress:c,onError:d});iq[a]=[],iq[a].push({onLoad:b,onProgress:c,onError:d});let f=new Request(a,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),g=this.mimeType,h=this.responseType;fetch(f).then(b=>{if(200===b.status||0===b.status){if(0===b.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===b.body||void 0===b.body.getReader)return b;let c=iq[a],d=b.body.getReader(),e=b.headers.get("X-File-Size")||b.headers.get("Content-Length"),f=e?parseInt(e):0,g=0!==f,h=0;return new Response(new ReadableStream({start(a){b();function b(){d.read().then(({done:d,value:e})=>{if(d)a.close();else{let d=new ProgressEvent("progress",{lengthComputable:g,loaded:h+=e.byteLength,total:f});for(let a=0,b=c.length;a<b;a++){let b=c[a];b.onProgress&&b.onProgress(d)}a.enqueue(e),b()}},b=>{a.error(b)})}}}))}throw new ir(`fetch for "${b.url}" responded with ${b.status}: ${b.statusText}`,b)}).then(a=>{switch(h){case"arraybuffer":return a.arrayBuffer();case"blob":return a.blob();case"document":return a.text().then(a=>new DOMParser().parseFromString(a,g));case"json":return a.json();default:if(void 0===g)return a.text();{let b=/charset="?([^;"\s]*)"?/i.exec(g),c=new TextDecoder(b&&b[1]?b[1].toLowerCase():void 0);return a.arrayBuffer().then(a=>c.decode(a))}}}).then(b=>{il.add(a,b);let c=iq[a];delete iq[a];for(let a=0,d=c.length;a<d;a++){let d=c[a];d.onLoad&&d.onLoad(b)}}).catch(b=>{let c=iq[a];if(void 0===c)throw this.manager.itemError(a),b;delete iq[a];for(let a=0,d=c.length;a<d;a++){let d=c[a];d.onError&&d.onError(b)}this.manager.itemError(a)}).finally(()=>{this.manager.itemEnd(a)}),this.manager.itemStart(a)}setResponseType(a){return this.responseType=a,this}setMimeType(a){return this.mimeType=a,this}}class it extends dP{constructor(a,b=1){super(),this.isLight=!0,this.type="Light",this.color=new d6(a),this.intensity=b}dispose(){}copy(a,b){return super.copy(a,b),this.color.copy(a.color),this.intensity=a.intensity,this}toJSON(a){let b=super.toJSON(a);return b.object.color=this.color.getHex(),b.object.intensity=this.intensity,void 0!==this.groundColor&&(b.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(b.object.distance=this.distance),void 0!==this.angle&&(b.object.angle=this.angle),void 0!==this.decay&&(b.object.decay=this.decay),void 0!==this.penumbra&&(b.object.penumbra=this.penumbra),void 0!==this.shadow&&(b.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(b.object.target=this.target.uuid),b}}let iu=new dn,iv=new cV,iw=new cV;class ix{constructor(a){this.camera=a,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new cr(512,512),this.map=null,this.mapPass=null,this.matrix=new dn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new fO,this._frameExtents=new cr(1,1),this._viewportCount=1,this._viewports=[new cP(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(a){let b=this.camera,c=this.matrix;iv.setFromMatrixPosition(a.matrixWorld),b.position.copy(iv),iw.setFromMatrixPosition(a.target.matrixWorld),b.lookAt(iw),b.updateMatrixWorld(),iu.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse),this._frustum.setFromProjectionMatrix(iu),c.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),c.multiply(iu)}getViewport(a){return this._viewports[a]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(a){return this.camera=a.camera.clone(),this.intensity=a.intensity,this.bias=a.bias,this.radius=a.radius,this.mapSize.copy(a.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let a={};return 1!==this.intensity&&(a.intensity=this.intensity),0!==this.bias&&(a.bias=this.bias),0!==this.normalBias&&(a.normalBias=this.normalBias),1!==this.radius&&(a.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(a.mapSize=this.mapSize.toArray()),a.camera=this.camera.toJSON(!1).object,delete a.camera.matrix,a}}class iy extends ix{constructor(){super(new eT(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(a){let b=this.camera,c=2*ck*a.angle*this.focus,d=this.mapSize.width/this.mapSize.height,e=a.distance||b.far;(c!==b.fov||d!==b.aspect||e!==b.far)&&(b.fov=c,b.aspect=d,b.far=e,b.updateProjectionMatrix()),super.updateMatrices(a)}copy(a){return super.copy(a),this.focus=a.focus,this}}let iz=new dn,iA=new cV,iB=new cV;class iC extends ix{constructor(){super(new eT(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new cr(4,2),this._viewportCount=6,this._viewports=[new cP(2,1,1,1),new cP(0,1,1,1),new cP(3,1,1,1),new cP(1,1,1,1),new cP(3,0,1,1),new cP(1,0,1,1)],this._cubeDirections=[new cV(1,0,0),new cV(-1,0,0),new cV(0,0,1),new cV(0,0,-1),new cV(0,1,0),new cV(0,-1,0)],this._cubeUps=[new cV(0,1,0),new cV(0,1,0),new cV(0,1,0),new cV(0,1,0),new cV(0,0,1),new cV(0,0,-1)]}updateMatrices(a,b=0){let c=this.camera,d=this.matrix,e=a.distance||c.far;e!==c.far&&(c.far=e,c.updateProjectionMatrix()),iA.setFromMatrixPosition(a.matrixWorld),c.position.copy(iA),iB.copy(c.position),iB.add(this._cubeDirections[b]),c.up.copy(this._cubeUps[b]),c.lookAt(iB),c.updateMatrixWorld(),d.makeTranslation(-iA.x,-iA.y,-iA.z),iz.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse),this._frustum.setFromProjectionMatrix(iz)}}class iD extends it{constructor(a,b,c=0,d=2){super(a,b),this.isPointLight=!0,this.type="PointLight",this.distance=c,this.decay=d,this.shadow=new iC}get power(){return 4*this.intensity*Math.PI}set power(a){this.intensity=a/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(a,b){return super.copy(a,b),this.distance=a.distance,this.decay=a.decay,this.shadow=a.shadow.clone(),this}}class iE extends eP{constructor(a=-1,b=1,c=1,d=-1,e=.1,f=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=a,this.right=b,this.top=c,this.bottom=d,this.near=e,this.far=f,this.updateProjectionMatrix()}copy(a,b){return super.copy(a,b),this.left=a.left,this.right=a.right,this.top=a.top,this.bottom=a.bottom,this.near=a.near,this.far=a.far,this.zoom=a.zoom,this.view=null===a.view?null:Object.assign({},a.view),this}setViewOffset(a,b,c,d,e,f){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=a,this.view.fullHeight=b,this.view.offsetX=c,this.view.offsetY=d,this.view.width=e,this.view.height=f,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let a=(this.right-this.left)/(2*this.zoom),b=(this.top-this.bottom)/(2*this.zoom),c=(this.right+this.left)/2,d=(this.top+this.bottom)/2,e=c-a,f=c+a,g=d+b,h=d-b;if(null!==this.view&&this.view.enabled){let a=(this.right-this.left)/this.view.fullWidth/this.zoom,b=(this.top-this.bottom)/this.view.fullHeight/this.zoom;e+=a*this.view.offsetX,f=e+a*this.view.width,g-=b*this.view.offsetY,h=g-b*this.view.height}this.projectionMatrix.makeOrthographic(e,f,g,h,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(a){let b=super.toJSON(a);return b.object.zoom=this.zoom,b.object.left=this.left,b.object.right=this.right,b.object.top=this.top,b.object.bottom=this.bottom,b.object.near=this.near,b.object.far=this.far,null!==this.view&&(b.object.view=Object.assign({},this.view)),b}}class iF extends ix{constructor(){super(new iE(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class iG extends it{constructor(a,b){super(a,b),this.isAmbientLight=!0,this.type="AmbientLight"}}class iH{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let a=0;a<9;a++)this.coefficients.push(new cV)}set(a){for(let b=0;b<9;b++)this.coefficients[b].copy(a[b]);return this}zero(){for(let a=0;a<9;a++)this.coefficients[a].set(0,0,0);return this}getAt(a,b){let c=a.x,d=a.y,e=a.z,f=this.coefficients;return b.copy(f[0]).multiplyScalar(.282095),b.addScaledVector(f[1],.488603*d),b.addScaledVector(f[2],.488603*e),b.addScaledVector(f[3],.488603*c),b.addScaledVector(f[4],c*d*1.092548),b.addScaledVector(f[5],d*e*1.092548),b.addScaledVector(f[6],.315392*(3*e*e-1)),b.addScaledVector(f[7],c*e*1.092548),b.addScaledVector(f[8],.546274*(c*c-d*d)),b}getIrradianceAt(a,b){let c=a.x,d=a.y,e=a.z,f=this.coefficients;return b.copy(f[0]).multiplyScalar(.886227),b.addScaledVector(f[1],1.023328*d),b.addScaledVector(f[2],1.023328*e),b.addScaledVector(f[3],1.023328*c),b.addScaledVector(f[4],.858086*c*d),b.addScaledVector(f[5],.858086*d*e),b.addScaledVector(f[6],.743125*e*e-.247708),b.addScaledVector(f[7],.858086*c*e),b.addScaledVector(f[8],.429043*(c*c-d*d)),b}add(a){for(let b=0;b<9;b++)this.coefficients[b].add(a.coefficients[b]);return this}addScaledSH(a,b){for(let c=0;c<9;c++)this.coefficients[c].addScaledVector(a.coefficients[c],b);return this}scale(a){for(let b=0;b<9;b++)this.coefficients[b].multiplyScalar(a);return this}lerp(a,b){for(let c=0;c<9;c++)this.coefficients[c].lerp(a.coefficients[c],b);return this}equals(a){for(let b=0;b<9;b++)if(!this.coefficients[b].equals(a.coefficients[b]))return!1;return!0}copy(a){return this.set(a.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(a,b=0){let c=this.coefficients;for(let d=0;d<9;d++)c[d].fromArray(a,b+3*d);return this}toArray(a=[],b=0){let c=this.coefficients;for(let d=0;d<9;d++)c[d].toArray(a,b+3*d);return a}static getBasisAt(a,b){let c=a.x,d=a.y,e=a.z;b[0]=.282095,b[1]=.488603*d,b[2]=.488603*e,b[3]=.488603*c,b[4]=1.092548*c*d,b[5]=1.092548*d*e,b[6]=.315392*(3*e*e-1),b[7]=1.092548*c*e,b[8]=.546274*(c*c-d*d)}}class iI extends ip{constructor(a){super(a),this.textures={}}load(a,b,c,d){let e=this,f=new is(e.manager);f.setPath(e.path),f.setRequestHeader(e.requestHeader),f.setWithCredentials(e.withCredentials),f.load(a,function(c){try{b(e.parse(JSON.parse(c)))}catch(b){d?d(b):console.error(b),e.manager.itemError(a)}},c,d)}parse(a){let b=this.textures;function c(a){return void 0===b[a]&&console.warn("THREE.MaterialLoader: Undefined texture",a),b[a]}let d=this.createMaterialFromType(a.type);if(void 0!==a.uuid&&(d.uuid=a.uuid),void 0!==a.name&&(d.name=a.name),void 0!==a.color&&void 0!==d.color&&d.color.setHex(a.color),void 0!==a.roughness&&(d.roughness=a.roughness),void 0!==a.metalness&&(d.metalness=a.metalness),void 0!==a.sheen&&(d.sheen=a.sheen),void 0!==a.sheenColor&&(d.sheenColor=new d6().setHex(a.sheenColor)),void 0!==a.sheenRoughness&&(d.sheenRoughness=a.sheenRoughness),void 0!==a.emissive&&void 0!==d.emissive&&d.emissive.setHex(a.emissive),void 0!==a.specular&&void 0!==d.specular&&d.specular.setHex(a.specular),void 0!==a.specularIntensity&&(d.specularIntensity=a.specularIntensity),void 0!==a.specularColor&&void 0!==d.specularColor&&d.specularColor.setHex(a.specularColor),void 0!==a.shininess&&(d.shininess=a.shininess),void 0!==a.clearcoat&&(d.clearcoat=a.clearcoat),void 0!==a.clearcoatRoughness&&(d.clearcoatRoughness=a.clearcoatRoughness),void 0!==a.dispersion&&(d.dispersion=a.dispersion),void 0!==a.iridescence&&(d.iridescence=a.iridescence),void 0!==a.iridescenceIOR&&(d.iridescenceIOR=a.iridescenceIOR),void 0!==a.iridescenceThicknessRange&&(d.iridescenceThicknessRange=a.iridescenceThicknessRange),void 0!==a.transmission&&(d.transmission=a.transmission),void 0!==a.thickness&&(d.thickness=a.thickness),void 0!==a.attenuationDistance&&(d.attenuationDistance=a.attenuationDistance),void 0!==a.attenuationColor&&void 0!==d.attenuationColor&&d.attenuationColor.setHex(a.attenuationColor),void 0!==a.anisotropy&&(d.anisotropy=a.anisotropy),void 0!==a.anisotropyRotation&&(d.anisotropyRotation=a.anisotropyRotation),void 0!==a.fog&&(d.fog=a.fog),void 0!==a.flatShading&&(d.flatShading=a.flatShading),void 0!==a.blending&&(d.blending=a.blending),void 0!==a.combine&&(d.combine=a.combine),void 0!==a.side&&(d.side=a.side),void 0!==a.shadowSide&&(d.shadowSide=a.shadowSide),void 0!==a.opacity&&(d.opacity=a.opacity),void 0!==a.transparent&&(d.transparent=a.transparent),void 0!==a.alphaTest&&(d.alphaTest=a.alphaTest),void 0!==a.alphaHash&&(d.alphaHash=a.alphaHash),void 0!==a.depthFunc&&(d.depthFunc=a.depthFunc),void 0!==a.depthTest&&(d.depthTest=a.depthTest),void 0!==a.depthWrite&&(d.depthWrite=a.depthWrite),void 0!==a.colorWrite&&(d.colorWrite=a.colorWrite),void 0!==a.blendSrc&&(d.blendSrc=a.blendSrc),void 0!==a.blendDst&&(d.blendDst=a.blendDst),void 0!==a.blendEquation&&(d.blendEquation=a.blendEquation),void 0!==a.blendSrcAlpha&&(d.blendSrcAlpha=a.blendSrcAlpha),void 0!==a.blendDstAlpha&&(d.blendDstAlpha=a.blendDstAlpha),void 0!==a.blendEquationAlpha&&(d.blendEquationAlpha=a.blendEquationAlpha),void 0!==a.blendColor&&void 0!==d.blendColor&&d.blendColor.setHex(a.blendColor),void 0!==a.blendAlpha&&(d.blendAlpha=a.blendAlpha),void 0!==a.stencilWriteMask&&(d.stencilWriteMask=a.stencilWriteMask),void 0!==a.stencilFunc&&(d.stencilFunc=a.stencilFunc),void 0!==a.stencilRef&&(d.stencilRef=a.stencilRef),void 0!==a.stencilFuncMask&&(d.stencilFuncMask=a.stencilFuncMask),void 0!==a.stencilFail&&(d.stencilFail=a.stencilFail),void 0!==a.stencilZFail&&(d.stencilZFail=a.stencilZFail),void 0!==a.stencilZPass&&(d.stencilZPass=a.stencilZPass),void 0!==a.stencilWrite&&(d.stencilWrite=a.stencilWrite),void 0!==a.wireframe&&(d.wireframe=a.wireframe),void 0!==a.wireframeLinewidth&&(d.wireframeLinewidth=a.wireframeLinewidth),void 0!==a.wireframeLinecap&&(d.wireframeLinecap=a.wireframeLinecap),void 0!==a.wireframeLinejoin&&(d.wireframeLinejoin=a.wireframeLinejoin),void 0!==a.rotation&&(d.rotation=a.rotation),void 0!==a.linewidth&&(d.linewidth=a.linewidth),void 0!==a.dashSize&&(d.dashSize=a.dashSize),void 0!==a.gapSize&&(d.gapSize=a.gapSize),void 0!==a.scale&&(d.scale=a.scale),void 0!==a.polygonOffset&&(d.polygonOffset=a.polygonOffset),void 0!==a.polygonOffsetFactor&&(d.polygonOffsetFactor=a.polygonOffsetFactor),void 0!==a.polygonOffsetUnits&&(d.polygonOffsetUnits=a.polygonOffsetUnits),void 0!==a.dithering&&(d.dithering=a.dithering),void 0!==a.alphaToCoverage&&(d.alphaToCoverage=a.alphaToCoverage),void 0!==a.premultipliedAlpha&&(d.premultipliedAlpha=a.premultipliedAlpha),void 0!==a.forceSinglePass&&(d.forceSinglePass=a.forceSinglePass),void 0!==a.visible&&(d.visible=a.visible),void 0!==a.toneMapped&&(d.toneMapped=a.toneMapped),void 0!==a.userData&&(d.userData=a.userData),void 0!==a.vertexColors&&("number"==typeof a.vertexColors?d.vertexColors=a.vertexColors>0:d.vertexColors=a.vertexColors),void 0!==a.uniforms)for(let b in a.uniforms){let e=a.uniforms[b];switch(d.uniforms[b]={},e.type){case"t":d.uniforms[b].value=c(e.value);break;case"c":d.uniforms[b].value=new d6().setHex(e.value);break;case"v2":d.uniforms[b].value=new cr().fromArray(e.value);break;case"v3":d.uniforms[b].value=new cV().fromArray(e.value);break;case"v4":d.uniforms[b].value=new cP().fromArray(e.value);break;case"m3":d.uniforms[b].value=new cs().fromArray(e.value);break;case"m4":d.uniforms[b].value=new dn().fromArray(e.value);break;default:d.uniforms[b].value=e.value}}if(void 0!==a.defines&&(d.defines=a.defines),void 0!==a.vertexShader&&(d.vertexShader=a.vertexShader),void 0!==a.fragmentShader&&(d.fragmentShader=a.fragmentShader),void 0!==a.glslVersion&&(d.glslVersion=a.glslVersion),void 0!==a.extensions)for(let b in a.extensions)d.extensions[b]=a.extensions[b];if(void 0!==a.lights&&(d.lights=a.lights),void 0!==a.clipping&&(d.clipping=a.clipping),void 0!==a.size&&(d.size=a.size),void 0!==a.sizeAttenuation&&(d.sizeAttenuation=a.sizeAttenuation),void 0!==a.map&&(d.map=c(a.map)),void 0!==a.matcap&&(d.matcap=c(a.matcap)),void 0!==a.alphaMap&&(d.alphaMap=c(a.alphaMap)),void 0!==a.bumpMap&&(d.bumpMap=c(a.bumpMap)),void 0!==a.bumpScale&&(d.bumpScale=a.bumpScale),void 0!==a.normalMap&&(d.normalMap=c(a.normalMap)),void 0!==a.normalMapType&&(d.normalMapType=a.normalMapType),void 0!==a.normalScale){let b=a.normalScale;!1===Array.isArray(b)&&(b=[b,b]),d.normalScale=new cr().fromArray(b)}return void 0!==a.displacementMap&&(d.displacementMap=c(a.displacementMap)),void 0!==a.displacementScale&&(d.displacementScale=a.displacementScale),void 0!==a.displacementBias&&(d.displacementBias=a.displacementBias),void 0!==a.roughnessMap&&(d.roughnessMap=c(a.roughnessMap)),void 0!==a.metalnessMap&&(d.metalnessMap=c(a.metalnessMap)),void 0!==a.emissiveMap&&(d.emissiveMap=c(a.emissiveMap)),void 0!==a.emissiveIntensity&&(d.emissiveIntensity=a.emissiveIntensity),void 0!==a.specularMap&&(d.specularMap=c(a.specularMap)),void 0!==a.specularIntensityMap&&(d.specularIntensityMap=c(a.specularIntensityMap)),void 0!==a.specularColorMap&&(d.specularColorMap=c(a.specularColorMap)),void 0!==a.envMap&&(d.envMap=c(a.envMap)),void 0!==a.envMapRotation&&d.envMapRotation.fromArray(a.envMapRotation),void 0!==a.envMapIntensity&&(d.envMapIntensity=a.envMapIntensity),void 0!==a.reflectivity&&(d.reflectivity=a.reflectivity),void 0!==a.refractionRatio&&(d.refractionRatio=a.refractionRatio),void 0!==a.lightMap&&(d.lightMap=c(a.lightMap)),void 0!==a.lightMapIntensity&&(d.lightMapIntensity=a.lightMapIntensity),void 0!==a.aoMap&&(d.aoMap=c(a.aoMap)),void 0!==a.aoMapIntensity&&(d.aoMapIntensity=a.aoMapIntensity),void 0!==a.gradientMap&&(d.gradientMap=c(a.gradientMap)),void 0!==a.clearcoatMap&&(d.clearcoatMap=c(a.clearcoatMap)),void 0!==a.clearcoatRoughnessMap&&(d.clearcoatRoughnessMap=c(a.clearcoatRoughnessMap)),void 0!==a.clearcoatNormalMap&&(d.clearcoatNormalMap=c(a.clearcoatNormalMap)),void 0!==a.clearcoatNormalScale&&(d.clearcoatNormalScale=new cr().fromArray(a.clearcoatNormalScale)),void 0!==a.iridescenceMap&&(d.iridescenceMap=c(a.iridescenceMap)),void 0!==a.iridescenceThicknessMap&&(d.iridescenceThicknessMap=c(a.iridescenceThicknessMap)),void 0!==a.transmissionMap&&(d.transmissionMap=c(a.transmissionMap)),void 0!==a.thicknessMap&&(d.thicknessMap=c(a.thicknessMap)),void 0!==a.anisotropyMap&&(d.anisotropyMap=c(a.anisotropyMap)),void 0!==a.sheenColorMap&&(d.sheenColorMap=c(a.sheenColorMap)),void 0!==a.sheenRoughnessMap&&(d.sheenRoughnessMap=c(a.sheenRoughnessMap)),d}setTextures(a){return this.textures=a,this}createMaterialFromType(a){return iI.createMaterialFromType(a)}static createMaterialFromType(a){return new({ShadowMaterial:hR,SpriteMaterial:e6,RawShaderMaterial:hS,ShaderMaterial:eO,PointsMaterial:gg,MeshPhysicalMaterial:hU,MeshStandardMaterial:hT,MeshPhongMaterial:hV,MeshToonMaterial:hW,MeshNormalMaterial:hX,MeshLambertMaterial:hY,MeshDepthMaterial:hZ,MeshDistanceMaterial:h$,MeshBasicMaterial:ea,MeshMatcapMaterial:h_,LineDashedMaterial:h0,LineBasicMaterial:f4,Material:d9})[a]}}class iJ extends er{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(a){return super.copy(a),this.instanceCount=a.instanceCount,this}toJSON(){let a=super.toJSON();return a.instanceCount=this.instanceCount,a.isInstancedBufferGeometry=!0,a}}class iK extends eT{constructor(a=[]){super(),this.isArrayCamera=!0,this.cameras=a,this.index=0}}function iL(){return performance.now()}let iM="\\[\\]\\.:\\/",iN=RegExp("["+iM+"]","g"),iO="[^"+iM+"]",iP="[^"+iM.replace("\\.","")+"]",iQ=/((?:WC+[\/:])*)/.source.replace("WC",iO),iR=/(WCOD+)?/.source.replace("WCOD",iP),iS=RegExp("^"+iQ+iR+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",iO)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",iO)+"$"),iT=["material","materials","bones","map"];class iU{constructor(a,b,c){let d=c||iV.parseTrackName(b);this._targetGroup=a,this._bindings=a.subscribe_(b,d)}getValue(a,b){this.bind();let c=this._targetGroup.nCachedObjects_,d=this._bindings[c];void 0!==d&&d.getValue(a,b)}setValue(a,b){let c=this._bindings;for(let d=this._targetGroup.nCachedObjects_,e=c.length;d!==e;++d)c[d].setValue(a,b)}bind(){let a=this._bindings;for(let b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].bind()}unbind(){let a=this._bindings;for(let b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].unbind()}}class iV{constructor(a,b,c){this.path=b,this.parsedPath=c||iV.parseTrackName(b),this.node=iV.findNode(a,this.parsedPath.nodeName),this.rootNode=a,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(a,b,c){return a&&a.isAnimationObjectGroup?new iV.Composite(a,b,c):new iV(a,b,c)}static sanitizeNodeName(a){return a.replace(/\s/g,"_").replace(iN,"")}static parseTrackName(a){let b=iS.exec(a);if(null===b)throw Error("PropertyBinding: Cannot parse trackName: "+a);let c={nodeName:b[2],objectName:b[3],objectIndex:b[4],propertyName:b[5],propertyIndex:b[6]},d=c.nodeName&&c.nodeName.lastIndexOf(".");if(void 0!==d&&-1!==d){let a=c.nodeName.substring(d+1);-1!==iT.indexOf(a)&&(c.nodeName=c.nodeName.substring(0,d),c.objectName=a)}if(null===c.propertyName||0===c.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+a);return c}static findNode(a,b){if(void 0===b||""===b||"."===b||-1===b||b===a.name||b===a.uuid)return a;if(a.skeleton){let c=a.skeleton.getBoneByName(b);if(void 0!==c)return c}if(a.children){let c=function(a){for(let d=0;d<a.length;d++){let e=a[d];if(e.name===b||e.uuid===b)return e;let f=c(e.children);if(f)return f}return null},d=c(a.children);if(d)return d}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(a,b){a[b]=this.targetObject[this.propertyName]}_getValue_array(a,b){let c=this.resolvedProperty;for(let d=0,e=c.length;d!==e;++d)a[b++]=c[d]}_getValue_arrayElement(a,b){a[b]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(a,b){this.resolvedProperty.toArray(a,b)}_setValue_direct(a,b){this.targetObject[this.propertyName]=a[b]}_setValue_direct_setNeedsUpdate(a,b){this.targetObject[this.propertyName]=a[b],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(a,b){this.targetObject[this.propertyName]=a[b],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(a,b){let c=this.resolvedProperty;for(let d=0,e=c.length;d!==e;++d)c[d]=a[b++]}_setValue_array_setNeedsUpdate(a,b){let c=this.resolvedProperty;for(let d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(a,b){let c=this.resolvedProperty;for(let d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(a,b){this.resolvedProperty[this.propertyIndex]=a[b]}_setValue_arrayElement_setNeedsUpdate(a,b){this.resolvedProperty[this.propertyIndex]=a[b],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(a,b){this.resolvedProperty[this.propertyIndex]=a[b],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(a,b){this.resolvedProperty.fromArray(a,b)}_setValue_fromArray_setNeedsUpdate(a,b){this.resolvedProperty.fromArray(a,b),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(a,b){this.resolvedProperty.fromArray(a,b),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(a,b){this.bind(),this.getValue(a,b)}_setValue_unbound(a,b){this.bind(),this.setValue(a,b)}bind(){let a=this.node,b=this.parsedPath,c=b.objectName,d=b.propertyName,e=b.propertyIndex;if(a||(a=iV.findNode(this.rootNode,b.nodeName),this.node=a),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!a)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(c){let d=b.objectIndex;switch(c){case"materials":if(!a.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!a.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);a=a.material.materials;break;case"bones":if(!a.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);a=a.skeleton.bones;for(let b=0;b<a.length;b++)if(a[b].name===d){d=b;break}break;case"map":if("map"in a){a=a.map;break}if(!a.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!a.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);a=a.material.map;break;default:if(void 0===a[c])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);a=a[c]}if(void 0!==d){if(void 0===a[d])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,a);a=a[d]}}let f=a[d];if(void 0===f)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+b.nodeName+"."+d+" but it wasn't found.",a);let g=this.Versioning.None;this.targetObject=a,!0===a.isMaterial?g=this.Versioning.NeedsUpdate:!0===a.isObject3D&&(g=this.Versioning.MatrixWorldNeedsUpdate);let h=this.BindingType.Direct;if(void 0!==e){if("morphTargetInfluences"===d){if(!a.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!a.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==a.morphTargetDictionary[e]&&(e=a.morphTargetDictionary[e])}h=this.BindingType.ArrayElement,this.resolvedProperty=f,this.propertyIndex=e}else void 0!==f.fromArray&&void 0!==f.toArray?(h=this.BindingType.HasFromToArray,this.resolvedProperty=f):Array.isArray(f)?(h=this.BindingType.EntireArray,this.resolvedProperty=f):this.propertyName=d;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][g]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}iV.Composite=iU,iV.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},iV.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},iV.prototype.GetterByBindingType=[iV.prototype._getValue_direct,iV.prototype._getValue_array,iV.prototype._getValue_arrayElement,iV.prototype._getValue_toArray],iV.prototype.SetterByBindingTypeAndVersioning=[[iV.prototype._setValue_direct,iV.prototype._setValue_direct_setNeedsUpdate,iV.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[iV.prototype._setValue_array,iV.prototype._setValue_array_setNeedsUpdate,iV.prototype._setValue_array_setMatrixWorldNeedsUpdate],[iV.prototype._setValue_arrayElement,iV.prototype._setValue_arrayElement_setNeedsUpdate,iV.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[iV.prototype._setValue_fromArray,iV.prototype._setValue_fromArray_setNeedsUpdate,iV.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];new Float32Array(1);class iW{constructor(a){this.value=a}clone(){return new iW(void 0===this.value.clone?this.value:this.value.clone())}}class iX{constructor(a,b,c,d){iX.prototype.isMatrix2=!0,this.elements=[1,0,0,1],void 0!==a&&this.set(a,b,c,d)}identity(){return this.set(1,0,0,1),this}fromArray(a,b=0){for(let c=0;c<4;c++)this.elements[c]=a[c+b];return this}set(a,b,c,d){let e=this.elements;return e[0]=a,e[2]=b,e[1]=c,e[3]=d,this}}let iY=new cV;function iZ(a,b,c,d){let e=i$(d);switch(c){case a2:case a5:return a*b;case a6:return a*b*2;case a9:case ba:return a*b/e.components*e.byteLength;case bb:case bc:return a*b*2/e.components*e.byteLength;case a3:return a*b*3/e.components*e.byteLength;case a4:case bd:return a*b*4/e.components*e.byteLength;case be:case bf:return Math.floor((a+3)/4)*Math.floor((b+3)/4)*8;case bg:case bh:return Math.floor((a+3)/4)*Math.floor((b+3)/4)*16;case bj:case bl:return Math.max(a,16)*Math.max(b,8)/4;case bi:case bk:return Math.max(a,8)*Math.max(b,8)/2;case bm:case bn:return Math.floor((a+3)/4)*Math.floor((b+3)/4)*8;case bo:case bp:return Math.floor((a+3)/4)*Math.floor((b+3)/4)*16;case bq:return Math.floor((a+4)/5)*Math.floor((b+3)/4)*16;case br:return Math.floor((a+4)/5)*Math.floor((b+4)/5)*16;case bs:return Math.floor((a+5)/6)*Math.floor((b+4)/5)*16;case bt:return Math.floor((a+5)/6)*Math.floor((b+5)/6)*16;case bu:return Math.floor((a+7)/8)*Math.floor((b+4)/5)*16;case bv:return Math.floor((a+7)/8)*Math.floor((b+5)/6)*16;case bw:return Math.floor((a+7)/8)*Math.floor((b+7)/8)*16;case bx:return Math.floor((a+9)/10)*Math.floor((b+4)/5)*16;case by:return Math.floor((a+9)/10)*Math.floor((b+5)/6)*16;case bz:return Math.floor((a+9)/10)*Math.floor((b+7)/8)*16;case bA:return Math.floor((a+9)/10)*Math.floor((b+9)/10)*16;case bB:return Math.floor((a+11)/12)*Math.floor((b+9)/10)*16;case bC:return Math.floor((a+11)/12)*Math.floor((b+11)/12)*16;case bD:case bE:case bF:return Math.ceil(a/4)*Math.ceil(b/4)*16;case bG:case bH:return Math.ceil(a/4)*Math.ceil(b/4)*8;case bI:case bJ:return Math.ceil(a/4)*Math.ceil(b/4)*16}throw Error(`Unable to determine texture byte length for ${c} format.`)}function i$(a){switch(a){case aS:case aT:return{byteLength:1,components:1};case aV:case aU:case aZ:return{byteLength:2,components:1};case a$:case a_:return{byteLength:2,components:4};case aX:case aW:case aY:return{byteLength:4,components:1};case a1:return{byteLength:4,components:3}}throw Error(`Unknown texture type ${a}.`)}function i_(){let a=null,b=!1,c=null,d=null;function e(b,f){c(b,f),d=a.requestAnimationFrame(e)}return{start:function(){!0!==b&&null!==c&&(d=a.requestAnimationFrame(e),b=!0)},stop:function(){a.cancelAnimationFrame(d),b=!1},setAnimationLoop:function(a){c=a},setContext:function(b){a=b}}}function i0(a){let b=new WeakMap;function c(b,c){let d,e=b.array,f=b.usage,g=e.byteLength,h=a.createBuffer();if(a.bindBuffer(c,h),a.bufferData(c,e,f),b.onUploadCallback(),e instanceof Float32Array)d=a.FLOAT;else if(e instanceof Uint16Array)d=b.isFloat16BufferAttribute?a.HALF_FLOAT:a.UNSIGNED_SHORT;else if(e instanceof Int16Array)d=a.SHORT;else if(e instanceof Uint32Array)d=a.UNSIGNED_INT;else if(e instanceof Int32Array)d=a.INT;else if(e instanceof Int8Array)d=a.BYTE;else if(e instanceof Uint8Array)d=a.UNSIGNED_BYTE;else if(e instanceof Uint8ClampedArray)d=a.UNSIGNED_BYTE;else throw Error("THREE.WebGLAttributes: Unsupported buffer data format: "+e);return{buffer:h,type:d,bytesPerElement:e.BYTES_PER_ELEMENT,version:b.version,size:g}}function d(b,c,d){let e=c.array,f=c.updateRanges;if(a.bindBuffer(d,b),0===f.length)a.bufferSubData(d,0,e);else{f.sort((a,b)=>a.start-b.start);let b=0;for(let a=1;a<f.length;a++){let c=f[b],d=f[a];d.start<=c.start+c.count+1?c.count=Math.max(c.count,d.start+d.count-c.start):f[++b]=d}f.length=b+1;for(let b=0,c=f.length;b<c;b++){let c=f[b];a.bufferSubData(d,c.start*e.BYTES_PER_ELEMENT,e,c.start,c.count)}c.clearUpdateRanges()}c.onUploadCallback()}return{get:function(a){return a.isInterleavedBufferAttribute&&(a=a.data),b.get(a)},remove:function(c){c.isInterleavedBufferAttribute&&(c=c.data);let d=b.get(c);d&&(a.deleteBuffer(d.buffer),b.delete(c))},update:function(a,e){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){let c=b.get(a);(!c||c.version<a.version)&&b.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}let f=b.get(a);if(void 0===f)b.set(a,c(a,e));else if(f.version<a.version){if(f.size!==a.array.byteLength)throw Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");d(f.buffer,a,e),f.version=a.version}}}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:A}}));let i1={alphahash_fragment:"#ifdef USE_ALPHAHASH\n	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n	const float ALPHA_HASH_SCALE = 0.05;\n	float hash2D( vec2 value ) {\n		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n	}\n	float hash3D( vec3 value ) {\n		return hash2D( vec2( hash2D( value.xy ), value.z ) );\n	}\n	float getAlphaHashThreshold( vec3 position ) {\n		float maxDeriv = max(\n			length( dFdx( position.xyz ) ),\n			length( dFdy( position.xyz ) )\n		);\n		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n		vec2 pixScales = vec2(\n			exp2( floor( log2( pixScale ) ) ),\n			exp2( ceil( log2( pixScale ) ) )\n		);\n		vec2 alpha = vec2(\n			hash3D( floor( pixScales.x * position.xyz ) ),\n			hash3D( floor( pixScales.y * position.xyz ) )\n		);\n		float lerpFactor = fract( log2( pixScale ) );\n		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n		float a = min( lerpFactor, 1.0 - lerpFactor );\n		vec3 cases = vec3(\n			x * x / ( 2.0 * a * ( 1.0 - a ) ),\n			( x - 0.5 * a ) / ( 1.0 - a ),\n			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n		);\n		float threshold = ( x < ( 1.0 - a ) )\n			? ( ( x < a ) ? cases.x : cases.y )\n			: cases.z;\n		return clamp( threshold , 1.0e-6, 1.0 );\n	}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n	#ifdef ALPHA_TO_COVERAGE\n	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n	if ( diffuseColor.a == 0.0 ) discard;\n	#else\n	if ( diffuseColor.a < alphaTest ) discard;\n	#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n	uniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n	reflectedLight.indirectDiffuse *= ambientOcclusion;\n	#if defined( USE_CLEARCOAT ) \n		clearcoatSpecularIndirect *= ambientOcclusion;\n	#endif\n	#if defined( USE_SHEEN ) \n		sheenSpecularIndirect *= ambientOcclusion;\n	#endif\n	#if defined( USE_ENVMAP ) && defined( STANDARD )\n		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n	#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n	uniform sampler2D aoMap;\n	uniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n	#if ! defined( GL_ANGLE_multi_draw )\n	#define gl_DrawID _gl_DrawID\n	uniform int _gl_DrawID;\n	#endif\n	uniform highp sampler2D batchingTexture;\n	uniform highp usampler2D batchingIdTexture;\n	mat4 getBatchingMatrix( const in float i ) {\n		int size = textureSize( batchingTexture, 0 ).x;\n		int j = int( i ) * 4;\n		int x = j % size;\n		int y = j / size;\n		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n		return mat4( v1, v2, v3, v4 );\n	}\n	float getIndirectIndex( const in int i ) {\n		int size = textureSize( batchingIdTexture, 0 ).x;\n		int x = i % size;\n		int y = i / size;\n		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n	}\n#endif\n#ifdef USE_BATCHING_COLOR\n	uniform sampler2D batchingColorTexture;\n	vec3 getBatchingColor( const in float i ) {\n		int size = textureSize( batchingColorTexture, 0 ).x;\n		int j = int( i );\n		int x = j % size;\n		int y = j / size;\n		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n	}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n	vPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n	vec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n	return 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n	vec3 halfDir = normalize( lightDir + viewDir );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float dotVH = saturate( dot( viewDir, halfDir ) );\n	vec3 F = F_Schlick( specularColor, 1.0, dotVH );\n	float G = G_BlinnPhong_Implicit( );\n	float D = D_BlinnPhong( shininess, dotNH );\n	return F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n	const mat3 XYZ_TO_REC709 = mat3(\n		 3.2404542, -0.9692660,  0.0556434,\n		-1.5371385,  1.8760108, -0.2040259,\n		-0.4985314,  0.0415560,  1.0572252\n	);\n	vec3 Fresnel0ToIor( vec3 fresnel0 ) {\n		vec3 sqrtF0 = sqrt( fresnel0 );\n		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n	}\n	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n	}\n	float IorToFresnel0( float transmittedIor, float incidentIor ) {\n		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n	}\n	vec3 evalSensitivity( float OPD, vec3 shift ) {\n		float phase = 2.0 * PI * OPD * 1.0e-9;\n		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n		xyz /= 1.0685e-7;\n		vec3 rgb = XYZ_TO_REC709 * xyz;\n		return rgb;\n	}\n	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n		vec3 I;\n		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n		float cosTheta2Sq = 1.0 - sinTheta2Sq;\n		if ( cosTheta2Sq < 0.0 ) {\n			return vec3( 1.0 );\n		}\n		float cosTheta2 = sqrt( cosTheta2Sq );\n		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n		float R12 = F_Schlick( R0, 1.0, cosTheta1 );\n		float T121 = 1.0 - R12;\n		float phi12 = 0.0;\n		if ( iridescenceIOR < outsideIOR ) phi12 = PI;\n		float phi21 = PI - phi12;\n		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n		vec3 phi23 = vec3( 0.0 );\n		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n		vec3 phi = vec3( phi21 ) + phi23;\n		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n		vec3 r123 = sqrt( R123 );\n		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n		vec3 C0 = R12 + Rs;\n		I = C0;\n		vec3 Cm = Rs - T121;\n		for ( int m = 1; m <= 2; ++ m ) {\n			Cm *= r123;\n			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n			I += Cm * Sm;\n		}\n		return max( I, vec3( 0.0 ) );\n	}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n	uniform sampler2D bumpMap;\n	uniform float bumpScale;\n	vec2 dHdxy_fwd() {\n		vec2 dSTdx = dFdx( vBumpMapUv );\n		vec2 dSTdy = dFdy( vBumpMapUv );\n		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n		return vec2( dBx, dBy );\n	}\n	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n		vec3 vN = surf_norm;\n		vec3 R1 = cross( vSigmaY, vN );\n		vec3 R2 = cross( vN, vSigmaX );\n		float fDet = dot( vSigmaX, R1 ) * faceDirection;\n		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n		return normalize( abs( fDet ) * surf_norm - vGrad );\n	}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n	vec4 plane;\n	#ifdef ALPHA_TO_COVERAGE\n		float distanceToPlane, distanceGradient;\n		float clipOpacity = 1.0;\n		#pragma unroll_loop_start\n		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n			plane = clippingPlanes[ i ];\n			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n			distanceGradient = fwidth( distanceToPlane ) / 2.0;\n			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n			if ( clipOpacity == 0.0 ) discard;\n		}\n		#pragma unroll_loop_end\n		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n			float unionClipOpacity = 1.0;\n			#pragma unroll_loop_start\n			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n				plane = clippingPlanes[ i ];\n				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n				distanceGradient = fwidth( distanceToPlane ) / 2.0;\n				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n			}\n			#pragma unroll_loop_end\n			clipOpacity *= 1.0 - unionClipOpacity;\n		#endif\n		diffuseColor.a *= clipOpacity;\n		if ( diffuseColor.a == 0.0 ) discard;\n	#else\n		#pragma unroll_loop_start\n		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n			plane = clippingPlanes[ i ];\n			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n		}\n		#pragma unroll_loop_end\n		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n			bool clipped = true;\n			#pragma unroll_loop_start\n			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n				plane = clippingPlanes[ i ];\n				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n			}\n			#pragma unroll_loop_end\n			if ( clipped ) discard;\n		#endif\n	#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n	varying vec3 vClipPosition;\n	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n	varying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n	vClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n	diffuseColor *= vColor;\n#elif defined( USE_COLOR )\n	diffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n	varying vec4 vColor;\n#elif defined( USE_COLOR )\n	varying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n	varying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n	varying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n	vColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n	vColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n	vColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n	vColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n	vColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n	const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n	return fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n	float precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n	float precisionSafeLength( vec3 v ) {\n		float maxComponent = max3( abs( v ) );\n		return length( v / maxComponent ) * maxComponent;\n	}\n#endif\nstruct IncidentLight {\n	vec3 color;\n	vec3 direction;\n	bool visible;\n};\nstruct ReflectedLight {\n	vec3 directDiffuse;\n	vec3 directSpecular;\n	vec3 indirectDiffuse;\n	vec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n	varying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n	mat3 tmp;\n	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n	return tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n	return m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n	return vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n	return RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n	#define cubeUV_minMipLevel 4.0\n	#define cubeUV_minTileSize 16.0\n	float getFace( vec3 direction ) {\n		vec3 absDirection = abs( direction );\n		float face = - 1.0;\n		if ( absDirection.x > absDirection.z ) {\n			if ( absDirection.x > absDirection.y )\n				face = direction.x > 0.0 ? 0.0 : 3.0;\n			else\n				face = direction.y > 0.0 ? 1.0 : 4.0;\n		} else {\n			if ( absDirection.z > absDirection.y )\n				face = direction.z > 0.0 ? 2.0 : 5.0;\n			else\n				face = direction.y > 0.0 ? 1.0 : 4.0;\n		}\n		return face;\n	}\n	vec2 getUV( vec3 direction, float face ) {\n		vec2 uv;\n		if ( face == 0.0 ) {\n			uv = vec2( direction.z, direction.y ) / abs( direction.x );\n		} else if ( face == 1.0 ) {\n			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n		} else if ( face == 2.0 ) {\n			uv = vec2( - direction.x, direction.y ) / abs( direction.z );\n		} else if ( face == 3.0 ) {\n			uv = vec2( - direction.z, direction.y ) / abs( direction.x );\n		} else if ( face == 4.0 ) {\n			uv = vec2( - direction.x, direction.z ) / abs( direction.y );\n		} else {\n			uv = vec2( direction.x, direction.y ) / abs( direction.z );\n		}\n		return 0.5 * ( uv + 1.0 );\n	}\n	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n		float face = getFace( direction );\n		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n		mipInt = max( mipInt, cubeUV_minMipLevel );\n		float faceSize = exp2( mipInt );\n		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n		if ( face > 2.0 ) {\n			uv.y += faceSize;\n			face -= 3.0;\n		}\n		uv.x += face * faceSize;\n		uv.x += filterInt * 3.0 * cubeUV_minTileSize;\n		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n		uv.x *= CUBEUV_TEXEL_WIDTH;\n		uv.y *= CUBEUV_TEXEL_HEIGHT;\n		#ifdef texture2DGradEXT\n			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n		#else\n			return texture2D( envMap, uv ).rgb;\n		#endif\n	}\n	#define cubeUV_r0 1.0\n	#define cubeUV_m0 - 2.0\n	#define cubeUV_r1 0.8\n	#define cubeUV_m1 - 1.0\n	#define cubeUV_r4 0.4\n	#define cubeUV_m4 2.0\n	#define cubeUV_r5 0.305\n	#define cubeUV_m5 3.0\n	#define cubeUV_r6 0.21\n	#define cubeUV_m6 4.0\n	float roughnessToMip( float roughness ) {\n		float mip = 0.0;\n		if ( roughness >= cubeUV_r1 ) {\n			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n		} else if ( roughness >= cubeUV_r4 ) {\n			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n		} else if ( roughness >= cubeUV_r5 ) {\n			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n		} else if ( roughness >= cubeUV_r6 ) {\n			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n		} else {\n			mip = - 2.0 * log2( 1.16 * roughness );		}\n		return mip;\n	}\n	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n		float mipF = fract( mip );\n		float mipInt = floor( mip );\n		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n		if ( mipF == 0.0 ) {\n			return vec4( color0, 1.0 );\n		} else {\n			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n			return vec4( mix( color0, color1, mipF ), 1.0 );\n		}\n	}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n	vec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n	mat3 bm = mat3( batchingMatrix );\n	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n	transformedNormal = bm * transformedNormal;\n	#ifdef USE_TANGENT\n		transformedTangent = bm * transformedTangent;\n	#endif\n#endif\n#ifdef USE_INSTANCING\n	mat3 im = mat3( instanceMatrix );\n	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n	transformedNormal = im * transformedNormal;\n	#ifdef USE_TANGENT\n		transformedTangent = im * transformedTangent;\n	#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n	transformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n	#ifdef FLIP_SIDED\n		transformedTangent = - transformedTangent;\n	#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n	uniform sampler2D displacementMap;\n	uniform float displacementScale;\n	uniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n		emissiveColor = sRGBTransferEOTF( emissiveColor );\n	#endif\n	totalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n	uniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n	return value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n	#ifdef ENV_WORLDPOS\n		vec3 cameraToFrag;\n		if ( isOrthographic ) {\n			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n		} else {\n			cameraToFrag = normalize( vWorldPosition - cameraPosition );\n		}\n		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vec3 reflectVec = reflect( cameraToFrag, worldNormal );\n		#else\n			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n		#endif\n	#else\n		vec3 reflectVec = vReflect;\n	#endif\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n	#else\n		vec4 envColor = vec4( 0.0 );\n	#endif\n	#ifdef ENVMAP_BLENDING_MULTIPLY\n		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_MIX )\n		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_ADD )\n		outgoingLight += envColor.xyz * specularStrength * reflectivity;\n	#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n	uniform float envMapIntensity;\n	uniform float flipEnvMap;\n	uniform mat3 envMapRotation;\n	#ifdef ENVMAP_TYPE_CUBE\n		uniform samplerCube envMap;\n	#else\n		uniform sampler2D envMap;\n	#endif\n	\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n	uniform float reflectivity;\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n		#define ENV_WORLDPOS\n	#endif\n	#ifdef ENV_WORLDPOS\n		varying vec3 vWorldPosition;\n		uniform float refractionRatio;\n	#else\n		varying vec3 vReflect;\n	#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n		#define ENV_WORLDPOS\n	#endif\n	#ifdef ENV_WORLDPOS\n		\n		varying vec3 vWorldPosition;\n	#else\n		varying vec3 vReflect;\n		uniform float refractionRatio;\n	#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n	vec3 getIBLIrradiance( const in vec3 normal ) {\n		#ifdef ENVMAP_TYPE_CUBE_UV\n			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n			return PI * envMapColor.rgb * envMapIntensity;\n		#else\n			return vec3( 0.0 );\n		#endif\n	}\n	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n		#ifdef ENVMAP_TYPE_CUBE_UV\n			vec3 reflectVec = reflect( - viewDir, normal );\n			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n			return envMapColor.rgb * envMapIntensity;\n		#else\n			return vec3( 0.0 );\n		#endif\n	}\n	#ifdef USE_ANISOTROPY\n		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n			#ifdef ENVMAP_TYPE_CUBE_UV\n				vec3 bentNormal = cross( bitangent, viewDir );\n				bentNormal = normalize( cross( bentNormal, bitangent ) );\n				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n				return getIBLRadiance( viewDir, bentNormal, roughness );\n			#else\n				return vec3( 0.0 );\n			#endif\n		}\n	#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n	#ifdef ENV_WORLDPOS\n		vWorldPosition = worldPosition.xyz;\n	#else\n		vec3 cameraToVertex;\n		if ( isOrthographic ) {\n			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n		} else {\n			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n		}\n		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vReflect = reflect( cameraToVertex, worldNormal );\n		#else\n			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n		#endif\n	#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n	vFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n	varying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n	#ifdef FOG_EXP2\n		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n	#else\n		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n	#endif\n	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n	uniform vec3 fogColor;\n	varying float vFogDepth;\n	#ifdef FOG_EXP2\n		uniform float fogDensity;\n	#else\n		uniform float fogNear;\n		uniform float fogFar;\n	#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n	uniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n	float dotNL = dot( normal, lightDirection );\n	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n	#ifdef USE_GRADIENTMAP\n		return vec3( texture2D( gradientMap, coord ).r );\n	#else\n		vec2 fw = fwidth( coord ) * 0.5;\n		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n	#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n	uniform sampler2D lightMap;\n	uniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n	vec3 diffuseColor;\n	float specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_Lambert\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n	uniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n	float x = normal.x, y = normal.y, z = normal.z;\n	vec3 result = shCoefficients[ 0 ] * 0.886227;\n	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n	return result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n	return irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n	vec3 irradiance = ambientLightColor;\n	return irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n	if ( cutoffDistance > 0.0 ) {\n		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n	}\n	return distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n	return smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n	struct DirectionalLight {\n		vec3 direction;\n		vec3 color;\n	};\n	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n		light.color = directionalLight.color;\n		light.direction = directionalLight.direction;\n		light.visible = true;\n	}\n#endif\n#if NUM_POINT_LIGHTS > 0\n	struct PointLight {\n		vec3 position;\n		vec3 color;\n		float distance;\n		float decay;\n	};\n	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n		vec3 lVector = pointLight.position - geometryPosition;\n		light.direction = normalize( lVector );\n		float lightDistance = length( lVector );\n		light.color = pointLight.color;\n		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n		light.visible = ( light.color != vec3( 0.0 ) );\n	}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n	struct SpotLight {\n		vec3 position;\n		vec3 direction;\n		vec3 color;\n		float distance;\n		float decay;\n		float coneCos;\n		float penumbraCos;\n	};\n	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n		vec3 lVector = spotLight.position - geometryPosition;\n		light.direction = normalize( lVector );\n		float angleCos = dot( light.direction, spotLight.direction );\n		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n		if ( spotAttenuation > 0.0 ) {\n			float lightDistance = length( lVector );\n			light.color = spotLight.color * spotAttenuation;\n			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n			light.visible = ( light.color != vec3( 0.0 ) );\n		} else {\n			light.color = vec3( 0.0 );\n			light.visible = false;\n		}\n	}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n	struct RectAreaLight {\n		vec3 color;\n		vec3 position;\n		vec3 halfWidth;\n		vec3 halfHeight;\n	};\n	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;\n	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n	struct HemisphereLight {\n		vec3 direction;\n		vec3 skyColor;\n		vec3 groundColor;\n	};\n	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n		float dotNL = dot( normal, hemiLight.direction );\n		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n		return irradiance;\n	}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n	vec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_Toon\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n	vec3 diffuseColor;\n	vec3 specularColor;\n	float specularShininess;\n	float specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_BlinnPhong\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n	material.ior = ior;\n	#ifdef USE_SPECULAR\n		float specularIntensityFactor = specularIntensity;\n		vec3 specularColorFactor = specularColor;\n		#ifdef USE_SPECULAR_COLORMAP\n			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n		#endif\n		#ifdef USE_SPECULAR_INTENSITYMAP\n			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n		#endif\n		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n	#else\n		float specularIntensityFactor = 1.0;\n		vec3 specularColorFactor = vec3( 1.0 );\n		material.specularF90 = 1.0;\n	#endif\n	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n	material.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n	material.clearcoat = clearcoat;\n	material.clearcoatRoughness = clearcoatRoughness;\n	material.clearcoatF0 = vec3( 0.04 );\n	material.clearcoatF90 = 1.0;\n	#ifdef USE_CLEARCOATMAP\n		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n	#endif\n	#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n	#endif\n	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n	material.clearcoatRoughness += geometryRoughness;\n	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n	material.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n	material.iridescence = iridescence;\n	material.iridescenceIOR = iridescenceIOR;\n	#ifdef USE_IRIDESCENCEMAP\n		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n	#endif\n	#ifdef USE_IRIDESCENCE_THICKNESSMAP\n		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n	#else\n		material.iridescenceThickness = iridescenceThicknessMaximum;\n	#endif\n#endif\n#ifdef USE_SHEEN\n	material.sheenColor = sheenColor;\n	#ifdef USE_SHEEN_COLORMAP\n		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n	#endif\n	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n	#ifdef USE_SHEEN_ROUGHNESSMAP\n		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n	#endif\n#endif\n#ifdef USE_ANISOTROPY\n	#ifdef USE_ANISOTROPYMAP\n		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n	#else\n		vec2 anisotropyV = anisotropyVector;\n	#endif\n	material.anisotropy = length( anisotropyV );\n	if( material.anisotropy == 0.0 ) {\n		anisotropyV = vec2( 1.0, 0.0 );\n	} else {\n		anisotropyV /= material.anisotropy;\n		material.anisotropy = saturate( material.anisotropy );\n	}\n	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n	vec3 diffuseColor;\n	float roughness;\n	vec3 specularColor;\n	float specularF90;\n	float dispersion;\n	#ifdef USE_CLEARCOAT\n		float clearcoat;\n		float clearcoatRoughness;\n		vec3 clearcoatF0;\n		float clearcoatF90;\n	#endif\n	#ifdef USE_IRIDESCENCE\n		float iridescence;\n		float iridescenceIOR;\n		float iridescenceThickness;\n		vec3 iridescenceFresnel;\n		vec3 iridescenceF0;\n	#endif\n	#ifdef USE_SHEEN\n		vec3 sheenColor;\n		float sheenRoughness;\n	#endif\n	#ifdef IOR\n		float ior;\n	#endif\n	#ifdef USE_TRANSMISSION\n		float transmission;\n		float transmissionAlpha;\n		float thickness;\n		float attenuationDistance;\n		vec3 attenuationColor;\n	#endif\n	#ifdef USE_ANISOTROPY\n		float anisotropy;\n		float alphaT;\n		vec3 anisotropyT;\n		vec3 anisotropyB;\n	#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n	float a2 = pow2( alpha );\n	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n	return 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n	float a2 = pow2( alpha );\n	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n	return RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n		float v = 0.5 / ( gv + gl );\n		return saturate(v);\n	}\n	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n		float a2 = alphaT * alphaB;\n		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n		highp float v2 = dot( v, v );\n		float w2 = a2 / v2;\n		return RECIPROCAL_PI * a2 * pow2 ( w2 );\n	}\n#endif\n#ifdef USE_CLEARCOAT\n	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n		vec3 f0 = material.clearcoatF0;\n		float f90 = material.clearcoatF90;\n		float roughness = material.clearcoatRoughness;\n		float alpha = pow2( roughness );\n		vec3 halfDir = normalize( lightDir + viewDir );\n		float dotNL = saturate( dot( normal, lightDir ) );\n		float dotNV = saturate( dot( normal, viewDir ) );\n		float dotNH = saturate( dot( normal, halfDir ) );\n		float dotVH = saturate( dot( viewDir, halfDir ) );\n		vec3 F = F_Schlick( f0, f90, dotVH );\n		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n		float D = D_GGX( alpha, dotNH );\n		return F * ( V * D );\n	}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n	vec3 f0 = material.specularColor;\n	float f90 = material.specularF90;\n	float roughness = material.roughness;\n	float alpha = pow2( roughness );\n	vec3 halfDir = normalize( lightDir + viewDir );\n	float dotNL = saturate( dot( normal, lightDir ) );\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float dotVH = saturate( dot( viewDir, halfDir ) );\n	vec3 F = F_Schlick( f0, f90, dotVH );\n	#ifdef USE_IRIDESCENCE\n		F = mix( F, material.iridescenceFresnel, material.iridescence );\n	#endif\n	#ifdef USE_ANISOTROPY\n		float dotTL = dot( material.anisotropyT, lightDir );\n		float dotTV = dot( material.anisotropyT, viewDir );\n		float dotTH = dot( material.anisotropyT, halfDir );\n		float dotBL = dot( material.anisotropyB, lightDir );\n		float dotBV = dot( material.anisotropyB, viewDir );\n		float dotBH = dot( material.anisotropyB, halfDir );\n		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n	#else\n		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n		float D = D_GGX( alpha, dotNH );\n	#endif\n	return F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n	const float LUT_SIZE = 64.0;\n	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n	const float LUT_BIAS = 0.5 / LUT_SIZE;\n	float dotNV = saturate( dot( N, V ) );\n	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n	uv = uv * LUT_SCALE + LUT_BIAS;\n	return uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n	float l = length( f );\n	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n	float x = dot( v1, v2 );\n	float y = abs( x );\n	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n	float b = 3.4175940 + ( 4.1616724 + y ) * y;\n	float v = a / b;\n	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n	return cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n	vec3 lightNormal = cross( v1, v2 );\n	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n	vec3 T1, T2;\n	T1 = normalize( V - N * dot( V, N ) );\n	T2 = - cross( N, T1 );\n	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n	vec3 coords[ 4 ];\n	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n	coords[ 0 ] = normalize( coords[ 0 ] );\n	coords[ 1 ] = normalize( coords[ 1 ] );\n	coords[ 2 ] = normalize( coords[ 2 ] );\n	coords[ 3 ] = normalize( coords[ 3 ] );\n	vec3 vectorFormFactor = vec3( 0.0 );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n	return vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n	float alpha = pow2( roughness );\n	float invAlpha = 1.0 / alpha;\n	float cos2h = dotNH * dotNH;\n	float sin2h = max( 1.0 - cos2h, 0.0078125 );\n	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n	vec3 halfDir = normalize( lightDir + viewDir );\n	float dotNL = saturate( dot( normal, lightDir ) );\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float D = D_Charlie( sheenRoughness, dotNH );\n	float V = V_Neubelt( dotNV, dotNL );\n	return sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float r2 = roughness * roughness;\n	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n	return saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n	float dotNV = saturate( dot( normal, viewDir ) );\n	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n	vec4 r = roughness * c0 + c1;\n	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n	return fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n	vec2 fab = DFGApprox( normal, viewDir, roughness );\n	return specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n	vec2 fab = DFGApprox( normal, viewDir, roughness );\n	#ifdef USE_IRIDESCENCE\n		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n	#else\n		vec3 Fr = specularColor;\n	#endif\n	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n	float Ess = fab.x + fab.y;\n	float Ems = 1.0 - Ess;\n	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n	singleScatter += FssEss;\n	multiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n		vec3 normal = geometryNormal;\n		vec3 viewDir = geometryViewDir;\n		vec3 position = geometryPosition;\n		vec3 lightPos = rectAreaLight.position;\n		vec3 halfWidth = rectAreaLight.halfWidth;\n		vec3 halfHeight = rectAreaLight.halfHeight;\n		vec3 lightColor = rectAreaLight.color;\n		float roughness = material.roughness;\n		vec3 rectCoords[ 4 ];\n		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n		vec2 uv = LTC_Uv( normal, viewDir, roughness );\n		vec4 t1 = texture2D( ltc_1, uv );\n		vec4 t2 = texture2D( ltc_2, uv );\n		mat3 mInv = mat3(\n			vec3( t1.x, 0, t1.y ),\n			vec3(    0, 1,    0 ),\n			vec3( t1.z, 0, t1.w )\n		);\n		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n	}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	#ifdef USE_CLEARCOAT\n		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n		vec3 ccIrradiance = dotNLcc * directLight.color;\n		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n	#endif\n	#ifdef USE_SHEEN\n		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n	#endif\n	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n	#ifdef USE_CLEARCOAT\n		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n	#endif\n	#ifdef USE_SHEEN\n		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n	#endif\n	vec3 singleScattering = vec3( 0.0 );\n	vec3 multiScattering = vec3( 0.0 );\n	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n	#ifdef USE_IRIDESCENCE\n		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n	#else\n		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n	#endif\n	vec3 totalScattering = singleScattering + multiScattering;\n	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n	reflectedLight.indirectSpecular += radiance * singleScattering;\n	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct				RE_Direct_Physical\n#define RE_Direct_RectArea		RE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular		RE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n	geometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n	float dotNVi = saturate( dot( normal, geometryViewDir ) );\n	if ( material.iridescenceThickness == 0.0 ) {\n		material.iridescence = 0.0;\n	} else {\n		material.iridescence = saturate( material.iridescence );\n	}\n	if ( material.iridescence > 0.0 ) {\n		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n	}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n	PointLight pointLight;\n	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n	PointLightShadow pointLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		pointLight = pointLights[ i ];\n		getPointLightInfo( pointLight, geometryPosition, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n		pointLightShadow = pointLightShadows[ i ];\n		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n	SpotLight spotLight;\n	vec4 spotColor;\n	vec3 spotLightCoord;\n	bool inSpotLightMap;\n	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n	SpotLightShadow spotLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		spotLight = spotLights[ i ];\n		getSpotLightInfo( spotLight, geometryPosition, directLight );\n		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n		#else\n		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n		#endif\n		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n		#endif\n		#undef SPOT_LIGHT_MAP_INDEX\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n		spotLightShadow = spotLightShadows[ i ];\n		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n	DirectionalLight directionalLight;\n	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n	DirectionalLightShadow directionalLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		directionalLight = directionalLights[ i ];\n		getDirectionalLightInfo( directionalLight, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n		directionalLightShadow = directionalLightShadows[ i ];\n		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n	RectAreaLight rectAreaLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n		rectAreaLight = rectAreaLights[ i ];\n		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n	vec3 iblIrradiance = vec3( 0.0 );\n	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n	#if defined( USE_LIGHT_PROBES )\n		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n	#endif\n	#if ( NUM_HEMI_LIGHTS > 0 )\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n		}\n		#pragma unroll_loop_end\n	#endif\n#endif\n#if defined( RE_IndirectSpecular )\n	vec3 radiance = vec3( 0.0 );\n	vec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n	#ifdef USE_LIGHTMAP\n		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n		irradiance += lightMapIrradiance;\n	#endif\n	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n		iblIrradiance += getIBLIrradiance( geometryNormal );\n	#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n	#ifdef USE_ANISOTROPY\n		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n	#else\n		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n	#endif\n	#ifdef USE_CLEARCOAT\n		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n	#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n	uniform float logDepthBufFC;\n	varying float vFragDepth;\n	varying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n	varying float vFragDepth;\n	varying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n	vFragDepth = 1.0 + gl_Position.w;\n	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n	vec4 sampledDiffuseColor = texture2D( map, vMapUv );\n	#ifdef DECODE_VIDEO_TEXTURE\n		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n	#endif\n	diffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n	uniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n	#if defined( USE_POINTS_UV )\n		vec2 uv = vUv;\n	#else\n		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n	#endif\n#endif\n#ifdef USE_MAP\n	diffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n	varying vec2 vUv;\n#else\n	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n		uniform mat3 uvTransform;\n	#endif\n#endif\n#ifdef USE_MAP\n	uniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n	metalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n	uniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n	float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n	}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n	vColor *= morphTargetBaseInfluence;\n	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n		#if defined( USE_COLOR_ALPHA )\n			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n		#elif defined( USE_COLOR )\n			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n		#endif\n	}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n	objectNormal *= morphTargetBaseInfluence;\n	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n	}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n	#ifndef USE_INSTANCING_MORPH\n		uniform float morphTargetBaseInfluence;\n		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n	#endif\n	uniform sampler2DArray morphTargetsTexture;\n	uniform ivec2 morphTargetsTextureSize;\n	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n		int y = texelIndex / morphTargetsTextureSize.x;\n		int x = texelIndex - y * morphTargetsTextureSize.x;\n		ivec3 morphUV = ivec3( x, y, morphTargetIndex );\n		return texelFetch( morphTargetsTexture, morphUV, 0 );\n	}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n	transformed *= morphTargetBaseInfluence;\n	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n	}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n	vec3 fdx = dFdx( vViewPosition );\n	vec3 fdy = dFdy( vViewPosition );\n	vec3 normal = normalize( cross( fdx, fdy ) );\n#else\n	vec3 normal = normalize( vNormal );\n	#ifdef DOUBLE_SIDED\n		normal *= faceDirection;\n	#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n	#ifdef USE_TANGENT\n		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n	#else\n		mat3 tbn = getTangentFrame( - vViewPosition, normal,\n		#if defined( USE_NORMALMAP )\n			vNormalMapUv\n		#elif defined( USE_CLEARCOAT_NORMALMAP )\n			vClearcoatNormalMapUv\n		#else\n			vUv\n		#endif\n		);\n	#endif\n	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n		tbn[0] *= faceDirection;\n		tbn[1] *= faceDirection;\n	#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	#ifdef USE_TANGENT\n		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n	#else\n		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n	#endif\n	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n		tbn2[0] *= faceDirection;\n		tbn2[1] *= faceDirection;\n	#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n	#ifdef FLIP_SIDED\n		normal = - normal;\n	#endif\n	#ifdef DOUBLE_SIDED\n		normal = normal * faceDirection;\n	#endif\n	normal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n	mapN.xy *= normalScale;\n	normal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n	#ifdef USE_TANGENT\n		vTangent = normalize( transformedTangent );\n		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n	#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n	uniform sampler2D normalMap;\n	uniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n	uniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n		vec3 q0 = dFdx( eye_pos.xyz );\n		vec3 q1 = dFdy( eye_pos.xyz );\n		vec2 st0 = dFdx( uv.st );\n		vec2 st1 = dFdy( uv.st );\n		vec3 N = surf_norm;\n		vec3 q1perp = cross( q1, N );\n		vec3 q0perp = cross( N, q0 );\n		vec3 T = q1perp * st0.x + q0perp * st1.x;\n		vec3 B = q1perp * st0.y + q0perp * st1.y;\n		float det = max( dot( T, T ), dot( B, B ) );\n		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n		return mat3( T * scale, B * scale, N );\n	}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n	vec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n	clearcoatMapN.xy *= clearcoatNormalScale;\n	clearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n	uniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	uniform sampler2D clearcoatNormalMap;\n	uniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	uniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n	uniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	uniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n	return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n	return 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n	if( v <= 0.0 )\n		return vec4( 0., 0., 0., 0. );\n	if( v >= 1.0 )\n		return vec4( 1., 1., 1., 1. );\n	float vuf;\n	float af = modf( v * PackFactors.a, vuf );\n	float bf = modf( vuf * ShiftRight8, vuf );\n	float gf = modf( vuf * ShiftRight8, vuf );\n	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n	if( v <= 0.0 )\n		return vec3( 0., 0., 0. );\n	if( v >= 1.0 )\n		return vec3( 1., 1., 1. );\n	float vuf;\n	float bf = modf( v * PackFactors.b, vuf );\n	float gf = modf( vuf * ShiftRight8, vuf );\n	return vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n	if( v <= 0.0 )\n		return vec2( 0., 0. );\n	if( v >= 1.0 )\n		return vec2( 1., 1. );\n	float vuf;\n	float gf = modf( v * 256., vuf );\n	return vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n	return dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n	return dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n	return ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n	return depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n	return ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n	gl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n	mvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n	mvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n	gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n	vec3 dithering( vec3 color ) {\n		float grid_position = rand( gl_FragCoord.xy );\n		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n		return color + dither_shift_RGB;\n	}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n	roughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n	uniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n		struct DirectionalLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n		struct SpotLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n		struct PointLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n			float shadowCameraNear;\n			float shadowCameraFar;\n		};\n		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n	#endif\n	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n	}\n	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n		return unpackRGBATo2Half( texture2D( shadow, uv ) );\n	}\n	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n		float occlusion = 1.0;\n		vec2 distribution = texture2DDistribution( shadow, uv );\n		float hard_shadow = step( compare , distribution.x );\n		if (hard_shadow != 1.0 ) {\n			float distance = compare - distribution.x ;\n			float variance = max( 0.00000, distribution.y * distribution.y );\n			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n		}\n		return occlusion;\n	}\n	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n		float shadow = 1.0;\n		shadowCoord.xyz /= shadowCoord.w;\n		shadowCoord.z += shadowBias;\n		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n		if ( frustumTest ) {\n		#if defined( SHADOWMAP_TYPE_PCF )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx0 = - texelSize.x * shadowRadius;\n			float dy0 = - texelSize.y * shadowRadius;\n			float dx1 = + texelSize.x * shadowRadius;\n			float dy1 = + texelSize.y * shadowRadius;\n			float dx2 = dx0 / 2.0;\n			float dy2 = dy0 / 2.0;\n			float dx3 = dx1 / 2.0;\n			float dy3 = dy1 / 2.0;\n			shadow = (\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n			) * ( 1.0 / 17.0 );\n		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx = texelSize.x;\n			float dy = texelSize.y;\n			vec2 uv = shadowCoord.xy;\n			vec2 f = fract( uv * shadowMapSize + 0.5 );\n			uv -= f * texelSize;\n			shadow = (\n				texture2DCompare( shadowMap, uv, shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n					 f.x ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n					 f.x ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n					 f.y ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n					 f.y ) +\n				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n						  f.x ),\n					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n						  f.x ),\n					 f.y )\n			) * ( 1.0 / 9.0 );\n		#elif defined( SHADOWMAP_TYPE_VSM )\n			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#else\n			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#endif\n		}\n		return mix( 1.0, shadow, shadowIntensity );\n	}\n	vec2 cubeToUV( vec3 v, float texelSizeY ) {\n		vec3 absV = abs( v );\n		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n		absV *= scaleToCube;\n		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n		vec2 planar = v.xy;\n		float almostATexel = 1.5 * texelSizeY;\n		float almostOne = 1.0 - almostATexel;\n		if ( absV.z >= almostOne ) {\n			if ( v.z > 0.0 )\n				planar.x = 4.0 - v.x;\n		} else if ( absV.x >= almostOne ) {\n			float signX = sign( v.x );\n			planar.x = v.z * signX + 2.0 * signX;\n		} else if ( absV.y >= almostOne ) {\n			float signY = sign( v.y );\n			planar.x = v.x + 2.0 * signY + 2.0;\n			planar.y = v.z * signY - 2.0;\n		}\n		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n	}\n	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n		float shadow = 1.0;\n		vec3 lightToPosition = shadowCoord.xyz;\n		\n		float lightToPositionLength = length( lightToPosition );\n		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;\n			vec3 bd3D = normalize( lightToPosition );\n			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n				shadow = (\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n				) * ( 1.0 / 9.0 );\n			#else\n				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n			#endif\n		}\n		return mix( 1.0, shadow, shadowIntensity );\n	}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n		struct DirectionalLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n		struct SpotLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n		struct PointLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n			float shadowCameraNear;\n			float shadowCameraFar;\n		};\n		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n	#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n	vec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n		}\n		#pragma unroll_loop_end\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n		}\n		#pragma unroll_loop_end\n	#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n		shadowWorldPosition = worldPosition;\n		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n		#endif\n		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n	}\n	#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n	float shadow = 1.0;\n	#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n	DirectionalLightShadow directionalLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n		directionalLight = directionalLightShadows[ i ];\n		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n	SpotLightShadow spotLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n		spotLight = spotLightShadows[ i ];\n		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n	PointLightShadow pointLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n		pointLight = pointLightShadows[ i ];\n		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#endif\n	return shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n	mat4 boneMatX = getBoneMatrix( skinIndex.x );\n	mat4 boneMatY = getBoneMatrix( skinIndex.y );\n	mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n	mat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n	uniform mat4 bindMatrix;\n	uniform mat4 bindMatrixInverse;\n	uniform highp sampler2D boneTexture;\n	mat4 getBoneMatrix( const in float i ) {\n		int size = textureSize( boneTexture, 0 ).x;\n		int j = int( i ) * 4;\n		int x = j % size;\n		int y = j / size;\n		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n		return mat4( v1, v2, v3, v4 );\n	}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n	vec4 skinned = vec4( 0.0 );\n	skinned += boneMatX * skinVertex * skinWeight.x;\n	skinned += boneMatY * skinVertex * skinWeight.y;\n	skinned += boneMatZ * skinVertex * skinWeight.z;\n	skinned += boneMatW * skinVertex * skinWeight.w;\n	transformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n	mat4 skinMatrix = mat4( 0.0 );\n	skinMatrix += skinWeight.x * boneMatX;\n	skinMatrix += skinWeight.y * boneMatY;\n	skinMatrix += skinWeight.z * boneMatZ;\n	skinMatrix += skinWeight.w * boneMatW;\n	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n	#ifdef USE_TANGENT\n		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n	#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n	specularStrength = texelSpecular.r;\n#else\n	specularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n	uniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n	return saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n	color *= toneMappingExposure;\n	return saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n	color *= toneMappingExposure;\n	color = max( vec3( 0.0 ), color - 0.004 );\n	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n	return a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n	const mat3 ACESInputMat = mat3(\n		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),\n		vec3( 0.04823, 0.01566, 0.83777 )\n	);\n	const mat3 ACESOutputMat = mat3(\n		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),\n		vec3( -0.07367, -0.00605,  1.07602 )\n	);\n	color *= toneMappingExposure / 0.6;\n	color = ACESInputMat * color;\n	color = RRTAndODTFit( color );\n	color = ACESOutputMat * color;\n	return saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n	vec3( 1.6605, - 0.1246, - 0.0182 ),\n	vec3( - 0.5876, 1.1329, - 0.1006 ),\n	vec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n	vec3( 0.6274, 0.0691, 0.0164 ),\n	vec3( 0.3293, 0.9195, 0.0880 ),\n	vec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n	vec3 x2 = x * x;\n	vec3 x4 = x2 * x2;\n	return + 15.5 * x4 * x2\n		- 40.14 * x4 * x\n		+ 31.96 * x4\n		- 6.868 * x2 * x\n		+ 0.4298 * x2\n		+ 0.1191 * x\n		- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n	const mat3 AgXInsetMatrix = mat3(\n		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n	);\n	const mat3 AgXOutsetMatrix = mat3(\n		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n	);\n	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;\n	color *= toneMappingExposure;\n	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n	color = AgXInsetMatrix * color;\n	color = max( color, 1e-10 );	color = log2( color );\n	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n	color = clamp( color, 0.0, 1.0 );\n	color = agxDefaultContrastApprox( color );\n	color = AgXOutsetMatrix * color;\n	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n	color = clamp( color, 0.0, 1.0 );\n	return color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n	const float StartCompression = 0.8 - 0.04;\n	const float Desaturation = 0.15;\n	color *= toneMappingExposure;\n	float x = min( color.r, min( color.g, color.b ) );\n	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n	color -= offset;\n	float peak = max( color.r, max( color.g, color.b ) );\n	if ( peak < StartCompression ) return color;\n	float d = 1. - StartCompression;\n	float newPeak = 1. - d * d / ( peak + d - StartCompression );\n	color *= newPeak / peak;\n	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n	return mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n	material.transmission = transmission;\n	material.transmissionAlpha = 1.0;\n	material.thickness = thickness;\n	material.attenuationDistance = attenuationDistance;\n	material.attenuationColor = attenuationColor;\n	#ifdef USE_TRANSMISSIONMAP\n		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n	#endif\n	#ifdef USE_THICKNESSMAP\n		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n	#endif\n	vec3 pos = vWorldPosition;\n	vec3 v = normalize( cameraPosition - pos );\n	vec3 n = inverseTransformDirection( normal, viewMatrix );\n	vec4 transmitted = getIBLVolumeRefraction(\n		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n		material.attenuationColor, material.attenuationDistance );\n	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n	uniform float transmission;\n	uniform float thickness;\n	uniform float attenuationDistance;\n	uniform vec3 attenuationColor;\n	#ifdef USE_TRANSMISSIONMAP\n		uniform sampler2D transmissionMap;\n	#endif\n	#ifdef USE_THICKNESSMAP\n		uniform sampler2D thicknessMap;\n	#endif\n	uniform vec2 transmissionSamplerSize;\n	uniform sampler2D transmissionSamplerMap;\n	uniform mat4 modelMatrix;\n	uniform mat4 projectionMatrix;\n	varying vec3 vWorldPosition;\n	float w0( float a ) {\n		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n	}\n	float w1( float a ) {\n		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n	}\n	float w2( float a ){\n		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n	}\n	float w3( float a ) {\n		return ( 1.0 / 6.0 ) * ( a * a * a );\n	}\n	float g0( float a ) {\n		return w0( a ) + w1( a );\n	}\n	float g1( float a ) {\n		return w2( a ) + w3( a );\n	}\n	float h0( float a ) {\n		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n	}\n	float h1( float a ) {\n		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n	}\n	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n		uv = uv * texelSize.zw + 0.5;\n		vec2 iuv = floor( uv );\n		vec2 fuv = fract( uv );\n		float g0x = g0( fuv.x );\n		float g1x = g1( fuv.x );\n		float h0x = h0( fuv.x );\n		float h1x = h1( fuv.x );\n		float h0y = h0( fuv.y );\n		float h1y = h1( fuv.y );\n		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n	}\n	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n		vec2 fLodSizeInv = 1.0 / fLodSize;\n		vec2 cLodSizeInv = 1.0 / cLodSize;\n		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n		return mix( fSample, cSample, fract( lod ) );\n	}\n	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n		vec3 modelScale;\n		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n		return normalize( refractionVector ) * thickness * modelScale;\n	}\n	float applyIorToRoughness( const in float roughness, const in float ior ) {\n		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n	}\n	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n	}\n	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n		if ( isinf( attenuationDistance ) ) {\n			return vec3( 1.0 );\n		} else {\n			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;\n		}\n	}\n	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n		const in vec3 attenuationColor, const in float attenuationDistance ) {\n		vec4 transmittedLight;\n		vec3 transmittance;\n		#ifdef USE_DISPERSION\n			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n			for ( int i = 0; i < 3; i ++ ) {\n				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n				vec3 refractedRayExit = position + transmissionRay;\n				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n				vec2 refractionCoords = ndcPos.xy / ndcPos.w;\n				refractionCoords += 1.0;\n				refractionCoords /= 2.0;\n				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n				transmittedLight[ i ] = transmissionSample[ i ];\n				transmittedLight.a += transmissionSample.a;\n				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n			}\n			transmittedLight.a /= 3.0;\n		#else\n			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n			vec3 refractedRayExit = position + transmissionRay;\n			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n			vec2 refractionCoords = ndcPos.xy / ndcPos.w;\n			refractionCoords += 1.0;\n			refractionCoords /= 2.0;\n			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n		#endif\n		vec3 attenuatedColor = transmittance * transmittedLight.rgb;\n		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n	}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n	varying vec2 vUv;\n#endif\n#ifdef USE_MAP\n	varying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n	varying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n	varying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n	varying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n	varying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n	varying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n	varying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n	varying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n	varying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n	varying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n	varying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	varying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	varying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n	varying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	varying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n	varying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n	varying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n	varying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n	varying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n	varying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n	uniform mat3 transmissionMapTransform;\n	varying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n	uniform mat3 thicknessMapTransform;\n	varying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n	varying vec2 vUv;\n#endif\n#ifdef USE_MAP\n	uniform mat3 mapTransform;\n	varying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n	uniform mat3 alphaMapTransform;\n	varying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n	uniform mat3 lightMapTransform;\n	varying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n	uniform mat3 aoMapTransform;\n	varying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n	uniform mat3 bumpMapTransform;\n	varying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n	uniform mat3 normalMapTransform;\n	varying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n	uniform mat3 displacementMapTransform;\n	varying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n	uniform mat3 emissiveMapTransform;\n	varying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n	uniform mat3 metalnessMapTransform;\n	varying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n	uniform mat3 roughnessMapTransform;\n	varying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n	uniform mat3 anisotropyMapTransform;\n	varying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n	uniform mat3 clearcoatMapTransform;\n	varying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	uniform mat3 clearcoatNormalMapTransform;\n	varying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	uniform mat3 clearcoatRoughnessMapTransform;\n	varying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n	uniform mat3 sheenColorMapTransform;\n	varying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n	uniform mat3 sheenRoughnessMapTransform;\n	varying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n	uniform mat3 iridescenceMapTransform;\n	varying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	uniform mat3 iridescenceThicknessMapTransform;\n	varying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n	uniform mat3 specularMapTransform;\n	varying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n	uniform mat3 specularColorMapTransform;\n	varying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n	uniform mat3 specularIntensityMapTransform;\n	varying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n	uniform mat3 transmissionMapTransform;\n	varying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n	uniform mat3 thicknessMapTransform;\n	varying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n	vUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n	vec4 worldPosition = vec4( transformed, 1.0 );\n	#ifdef USE_BATCHING\n		worldPosition = batchingMatrix * worldPosition;\n	#endif\n	#ifdef USE_INSTANCING\n		worldPosition = instanceMatrix * worldPosition;\n	#endif\n	worldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n	gl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n	vec4 texColor = texture2D( t2D, vUv );\n	#ifdef DECODE_VIDEO_TEXTURE\n		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n	#endif\n	texColor.rgb *= backgroundIntensity;\n	gl_FragColor = texColor;\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n	gl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n	uniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n	uniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n	#elif defined( ENVMAP_TYPE_CUBE_UV )\n		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n	#else\n		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n	#endif\n	texColor.rgb *= backgroundIntensity;\n	gl_FragColor = texColor;\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n	gl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n	gl_FragColor = texColor;\n	gl_FragColor.a *= opacity;\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n	#include <uv_vertex>\n	#include <batching_vertex>\n	#include <skinbase_vertex>\n	#include <morphinstance_vertex>\n	#ifdef USE_DISPLACEMENTMAP\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n	uniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n	vec4 diffuseColor = vec4( 1.0 );\n	#include <clipping_planes_fragment>\n	#if DEPTH_PACKING == 3200\n		diffuseColor.a = opacity;\n	#endif\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <logdepthbuf_fragment>\n	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n	#if DEPTH_PACKING == 3200\n		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n	#elif DEPTH_PACKING == 3201\n		gl_FragColor = packDepthToRGBA( fragCoordZ );\n	#elif DEPTH_PACKING == 3202\n		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n	#elif DEPTH_PACKING == 3203\n		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n	#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <batching_vertex>\n	#include <skinbase_vertex>\n	#include <morphinstance_vertex>\n	#ifdef USE_DISPLACEMENTMAP\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <worldpos_vertex>\n	#include <clipping_planes_vertex>\n	vWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n	vec4 diffuseColor = vec4( 1.0 );\n	#include <clipping_planes_fragment>\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	float dist = length( vWorldPosition - referencePosition );\n	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n	dist = saturate( dist );\n	gl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vec3 direction = normalize( vWorldDirection );\n	vec2 sampleUV = equirectUv( direction );\n	gl_FragColor = texture2D( tEquirect, sampleUV );\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	vLineDistance = scale * lineDistance;\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	if ( mod( vLineDistance, totalSize ) > dashSize ) {\n		discard;\n	}\n	vec3 outgoingLight = vec3( 0.0 );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	outgoingLight = diffuseColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinbase_vertex>\n		#include <skinnormal_vertex>\n		#include <defaultnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <specularmap_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	#ifdef USE_LIGHTMAP\n		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n	#else\n		reflectedLight.indirectDiffuse += vec3( 1.0 );\n	#endif\n	#include <aomap_fragment>\n	reflectedLight.indirectDiffuse *= diffuseColor.rgb;\n	vec3 outgoingLight = reflectedLight.indirectDiffuse;\n	#include <envmap_fragment>\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <specularmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_lambert_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n	vViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	vec3 viewDir = normalize( vViewPosition );\n	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n	vec3 y = cross( viewDir, x );\n	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n	#ifdef USE_MATCAP\n		vec4 matcapColor = texture2D( matcap, uv );\n	#else\n		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n	#endif\n	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n	varying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphinstance_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n	vViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n	varying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n	#include <clipping_planes_fragment>\n	#include <logdepthbuf_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n	#ifdef OPAQUE\n		gl_FragColor.a = 1.0;\n	#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphinstance_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <specularmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_phong_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n	varying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n	vWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n	#define IOR\n	#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n	uniform float ior;\n#endif\n#ifdef USE_SPECULAR\n	uniform float specularIntensity;\n	uniform vec3 specularColor;\n	#ifdef USE_SPECULAR_COLORMAP\n		uniform sampler2D specularColorMap;\n	#endif\n	#ifdef USE_SPECULAR_INTENSITYMAP\n		uniform sampler2D specularIntensityMap;\n	#endif\n#endif\n#ifdef USE_CLEARCOAT\n	uniform float clearcoat;\n	uniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n	uniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n	uniform float iridescence;\n	uniform float iridescenceIOR;\n	uniform float iridescenceThicknessMinimum;\n	uniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n	uniform vec3 sheenColor;\n	uniform float sheenRoughness;\n	#ifdef USE_SHEEN_COLORMAP\n		uniform sampler2D sheenColorMap;\n	#endif\n	#ifdef USE_SHEEN_ROUGHNESSMAP\n		uniform sampler2D sheenRoughnessMap;\n	#endif\n#endif\n#ifdef USE_ANISOTROPY\n	uniform vec2 anisotropyVector;\n	#ifdef USE_ANISOTROPYMAP\n		uniform sampler2D anisotropyMap;\n	#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <roughnessmap_fragment>\n	#include <metalnessmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <clearcoat_normal_fragment_begin>\n	#include <clearcoat_normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_physical_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n	#include <transmission_fragment>\n	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n	#ifdef USE_SHEEN\n		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n	#endif\n	#ifdef USE_CLEARCOAT\n		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n	#endif\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_toon_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n	varying vec2 vUv;\n	uniform mat3 uvTransform;\n#endif\nvoid main() {\n	#ifdef USE_POINTS_UV\n		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n	#endif\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	gl_PointSize = size;\n	#ifdef USE_SIZEATTENUATION\n		bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n	#endif\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	vec3 outgoingLight = vec3( 0.0 );\n	#include <logdepthbuf_fragment>\n	#include <map_particle_fragment>\n	#include <color_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	outgoingLight = diffuseColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphinstance_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n	#include <logdepthbuf_fragment>\n	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	vec4 mvPosition = modelViewMatrix[ 3 ];\n	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n	#ifndef USE_SIZEATTENUATION\n		bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n		if ( isPerspective ) scale *= - mvPosition.z;\n	#endif\n	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n	vec2 rotatedPosition;\n	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n	mvPosition.xy += rotatedPosition;\n	gl_Position = projectionMatrix * mvPosition;\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	vec3 outgoingLight = vec3( 0.0 );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	outgoingLight = diffuseColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n}"},i2={common:{diffuse:{value:new d6(0xffffff)},opacity:{value:1},map:{value:null},mapTransform:{value:new cs},alphaMap:{value:null},alphaMapTransform:{value:new cs},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new cs}},envmap:{envMap:{value:null},envMapRotation:{value:new cs},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new cs}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new cs}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new cs},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new cs},normalScale:{value:new cr(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new cs},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new cs}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new cs}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new cs}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new d6(0xffffff)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new d6(0xffffff)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new cs},alphaTest:{value:0},uvTransform:{value:new cs}},sprite:{diffuse:{value:new d6(0xffffff)},opacity:{value:1},center:{value:new cr(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new cs},alphaMap:{value:null},alphaMapTransform:{value:new cs},alphaTest:{value:0}}},i3={basic:{uniforms:eI([i2.common,i2.specularmap,i2.envmap,i2.aomap,i2.lightmap,i2.fog]),vertexShader:i1.meshbasic_vert,fragmentShader:i1.meshbasic_frag},lambert:{uniforms:eI([i2.common,i2.specularmap,i2.envmap,i2.aomap,i2.lightmap,i2.emissivemap,i2.bumpmap,i2.normalmap,i2.displacementmap,i2.fog,i2.lights,{emissive:{value:new d6(0)}}]),vertexShader:i1.meshlambert_vert,fragmentShader:i1.meshlambert_frag},phong:{uniforms:eI([i2.common,i2.specularmap,i2.envmap,i2.aomap,i2.lightmap,i2.emissivemap,i2.bumpmap,i2.normalmap,i2.displacementmap,i2.fog,i2.lights,{emissive:{value:new d6(0)},specular:{value:new d6(1118481)},shininess:{value:30}}]),vertexShader:i1.meshphong_vert,fragmentShader:i1.meshphong_frag},standard:{uniforms:eI([i2.common,i2.envmap,i2.aomap,i2.lightmap,i2.emissivemap,i2.bumpmap,i2.normalmap,i2.displacementmap,i2.roughnessmap,i2.metalnessmap,i2.fog,i2.lights,{emissive:{value:new d6(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:i1.meshphysical_vert,fragmentShader:i1.meshphysical_frag},toon:{uniforms:eI([i2.common,i2.aomap,i2.lightmap,i2.emissivemap,i2.bumpmap,i2.normalmap,i2.displacementmap,i2.gradientmap,i2.fog,i2.lights,{emissive:{value:new d6(0)}}]),vertexShader:i1.meshtoon_vert,fragmentShader:i1.meshtoon_frag},matcap:{uniforms:eI([i2.common,i2.bumpmap,i2.normalmap,i2.displacementmap,i2.fog,{matcap:{value:null}}]),vertexShader:i1.meshmatcap_vert,fragmentShader:i1.meshmatcap_frag},points:{uniforms:eI([i2.points,i2.fog]),vertexShader:i1.points_vert,fragmentShader:i1.points_frag},dashed:{uniforms:eI([i2.common,i2.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:i1.linedashed_vert,fragmentShader:i1.linedashed_frag},depth:{uniforms:eI([i2.common,i2.displacementmap]),vertexShader:i1.depth_vert,fragmentShader:i1.depth_frag},normal:{uniforms:eI([i2.common,i2.bumpmap,i2.normalmap,i2.displacementmap,{opacity:{value:1}}]),vertexShader:i1.meshnormal_vert,fragmentShader:i1.meshnormal_frag},sprite:{uniforms:eI([i2.sprite,i2.fog]),vertexShader:i1.sprite_vert,fragmentShader:i1.sprite_frag},background:{uniforms:{uvTransform:{value:new cs},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:i1.background_vert,fragmentShader:i1.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new cs}},vertexShader:i1.backgroundCube_vert,fragmentShader:i1.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:i1.cube_vert,fragmentShader:i1.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:i1.equirect_vert,fragmentShader:i1.equirect_frag},distanceRGBA:{uniforms:eI([i2.common,i2.displacementmap,{referencePosition:{value:new cV},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:i1.distanceRGBA_vert,fragmentShader:i1.distanceRGBA_frag},shadow:{uniforms:eI([i2.lights,i2.fog,{color:{value:new d6(0)},opacity:{value:1}}]),vertexShader:i1.shadow_vert,fragmentShader:i1.shadow_frag}};i3.physical={uniforms:eI([i3.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new cs},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new cs},clearcoatNormalScale:{value:new cr(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new cs},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new cs},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new cs},sheen:{value:0},sheenColor:{value:new d6(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new cs},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new cs},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new cs},transmissionSamplerSize:{value:new cr},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new cs},attenuationDistance:{value:0},attenuationColor:{value:new d6(0)},specularColor:{value:new d6(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new cs},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new cs},anisotropyVector:{value:new cr},anisotropyMap:{value:null},anisotropyMapTransform:{value:new cs}}]),vertexShader:i1.meshphysical_vert,fragmentShader:i1.meshphysical_frag};let i4={r:0,b:0,g:0},i5=new dy,i6=new dn;function i7(a,b,c,d,e,f,g){let h,i,j=new d6(0),k=+(!0!==f),l=null,m=0,n=null;function o(a){let d=!0===a.isScene?a.background:null;return d&&d.isTexture&&(d=(a.backgroundBlurriness>0?c:b).get(d)),d}function p(b,c){b.getRGB(i4,eK(a)),d.buffers.color.setClear(i4.r,i4.g,i4.b,c,g)}return{getClearColor:function(){return j},setClearColor:function(a,b=1){j.set(a),p(j,k=b)},getClearAlpha:function(){return k},setClearAlpha:function(a){p(j,k=a)},render:function(b){let c=!1,e=o(b);null===e?p(j,k):e&&e.isColor&&(p(e,1),c=!0);let f=a.xr.getEnvironmentBlendMode();"additive"===f?d.buffers.color.setClear(0,0,0,1,g):"alpha-blend"===f&&d.buffers.color.setClear(0,0,0,0,g),(a.autoClear||c)&&(d.buffers.depth.setTest(!0),d.buffers.depth.setMask(!0),d.buffers.color.setMask(!0),a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil))},addToRenderList:function(b,c){let d=o(c);d&&(d.isCubeTexture||d.mapping===aI)?(void 0===i&&((i=new eD(new eG(1,1,1),new eO({name:"BackgroundCubeMaterial",uniforms:eH(i3.backgroundCube.uniforms),vertexShader:i3.backgroundCube.vertexShader,fragmentShader:i3.backgroundCube.fragmentShader,side:I,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),i.geometry.deleteAttribute("uv"),i.onBeforeRender=function(a,b,c){this.matrixWorld.copyPosition(c.matrixWorld)},Object.defineProperty(i.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),e.update(i)),i5.copy(c.backgroundRotation),i5.x*=-1,i5.y*=-1,i5.z*=-1,d.isCubeTexture&&!1===d.isRenderTargetTexture&&(i5.y*=-1,i5.z*=-1),i.material.uniforms.envMap.value=d,i.material.uniforms.flipEnvMap.value=d.isCubeTexture&&!1===d.isRenderTargetTexture?-1:1,i.material.uniforms.backgroundBlurriness.value=c.backgroundBlurriness,i.material.uniforms.backgroundIntensity.value=c.backgroundIntensity,i.material.uniforms.backgroundRotation.value.setFromMatrix4(i6.makeRotationFromEuler(i5)),i.material.toneMapped=cG.getTransfer(d.colorSpace)!==b1,(l!==d||m!==d.version||n!==a.toneMapping)&&(i.material.needsUpdate=!0,l=d,m=d.version,n=a.toneMapping),i.layers.enableAll(),b.unshift(i,i.geometry,i.material,0,0,null)):d&&d.isTexture&&(void 0===h&&((h=new eD(new hG(2,2),new eO({name:"BackgroundMaterial",uniforms:eH(i3.background.uniforms),vertexShader:i3.background.vertexShader,fragmentShader:i3.background.fragmentShader,side:H,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),e.update(h)),h.material.uniforms.t2D.value=d,h.material.uniforms.backgroundIntensity.value=c.backgroundIntensity,h.material.toneMapped=cG.getTransfer(d.colorSpace)!==b1,!0===d.matrixAutoUpdate&&d.updateMatrix(),h.material.uniforms.uvTransform.value.copy(d.matrix),(l!==d||m!==d.version||n!==a.toneMapping)&&(h.material.needsUpdate=!0,l=d,m=d.version,n=a.toneMapping),h.layers.enableAll(),b.unshift(h,h.geometry,h.material,0,0,null))},dispose:function(){void 0!==i&&(i.geometry.dispose(),i.material.dispose(),i=void 0),void 0!==h&&(h.geometry.dispose(),h.material.dispose(),h=void 0)}}}function i8(a,b){let c=a.getParameter(a.MAX_VERTEX_ATTRIBS),d={},e=l(null),f=e,g=!1;function h(){return a.createVertexArray()}function i(b){return a.bindVertexArray(b)}function j(b){return a.deleteVertexArray(b)}function k(a,b,c){let e=!0===c.wireframe,f=d[a.id];void 0===f&&(f={},d[a.id]=f);let g=f[b.id];void 0===g&&(g={},f[b.id]=g);let i=g[e];return void 0===i&&(i=l(h()),g[e]=i),i}function l(a){let b=[],d=[],e=[];for(let a=0;a<c;a++)b[a]=0,d[a]=0,e[a]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:b,enabledAttributes:d,attributeDivisors:e,object:a,attributes:{},index:null}}function m(a,b,c,d){let e=f.attributes,g=b.attributes,h=0,i=c.getAttributes();for(let b in i)if(i[b].location>=0){let c=e[b],d=g[b];if(void 0===d&&("instanceMatrix"===b&&a.instanceMatrix&&(d=a.instanceMatrix),"instanceColor"===b&&a.instanceColor&&(d=a.instanceColor)),void 0===c||c.attribute!==d||d&&c.data!==d.data)return!0;h++}return f.attributesNum!==h||f.index!==d}function n(a,b,c,d){let e={},g=b.attributes,h=0,i=c.getAttributes();for(let b in i)if(i[b].location>=0){let c=g[b];void 0===c&&("instanceMatrix"===b&&a.instanceMatrix&&(c=a.instanceMatrix),"instanceColor"===b&&a.instanceColor&&(c=a.instanceColor));let d={};d.attribute=c,c&&c.data&&(d.data=c.data),e[b]=d,h++}f.attributes=e,f.attributesNum=h,f.index=d}function o(){let a=f.newAttributes;for(let b=0,c=a.length;b<c;b++)a[b]=0}function p(a){q(a,0)}function q(b,c){let d=f.newAttributes,e=f.enabledAttributes,g=f.attributeDivisors;d[b]=1,0===e[b]&&(a.enableVertexAttribArray(b),e[b]=1),g[b]!==c&&(a.vertexAttribDivisor(b,c),g[b]=c)}function r(){let b=f.newAttributes,c=f.enabledAttributes;for(let d=0,e=c.length;d<e;d++)c[d]!==b[d]&&(a.disableVertexAttribArray(d),c[d]=0)}function s(b,c,d,e,f,g,h){!0===h?a.vertexAttribIPointer(b,c,d,f,g):a.vertexAttribPointer(b,c,d,e,f,g)}function t(c,d,e,f){o();let g=f.attributes,h=e.getAttributes(),i=d.defaultAttributeValues;for(let d in h){let e=h[d];if(e.location>=0){let h=g[d];if(void 0===h&&("instanceMatrix"===d&&c.instanceMatrix&&(h=c.instanceMatrix),"instanceColor"===d&&c.instanceColor&&(h=c.instanceColor)),void 0!==h){let d=h.normalized,g=h.itemSize,i=b.get(h);if(void 0===i)continue;let j=i.buffer,k=i.type,l=i.bytesPerElement,m=k===a.INT||k===a.UNSIGNED_INT||h.gpuType===aW;if(h.isInterleavedBufferAttribute){let b=h.data,i=b.stride,n=h.offset;if(b.isInstancedInterleavedBuffer){for(let a=0;a<e.locationSize;a++)q(e.location+a,b.meshPerAttribute);!0!==c.isInstancedMesh&&void 0===f._maxInstanceCount&&(f._maxInstanceCount=b.meshPerAttribute*b.count)}else for(let a=0;a<e.locationSize;a++)p(e.location+a);a.bindBuffer(a.ARRAY_BUFFER,j);for(let a=0;a<e.locationSize;a++)s(e.location+a,g/e.locationSize,k,d,i*l,(n+g/e.locationSize*a)*l,m)}else{if(h.isInstancedBufferAttribute){for(let a=0;a<e.locationSize;a++)q(e.location+a,h.meshPerAttribute);!0!==c.isInstancedMesh&&void 0===f._maxInstanceCount&&(f._maxInstanceCount=h.meshPerAttribute*h.count)}else for(let a=0;a<e.locationSize;a++)p(e.location+a);a.bindBuffer(a.ARRAY_BUFFER,j);for(let a=0;a<e.locationSize;a++)s(e.location+a,g/e.locationSize,k,d,g*l,g/e.locationSize*a*l,m)}}else if(void 0!==i){let b=i[d];if(void 0!==b)switch(b.length){case 2:a.vertexAttrib2fv(e.location,b);break;case 3:a.vertexAttrib3fv(e.location,b);break;case 4:a.vertexAttrib4fv(e.location,b);break;default:a.vertexAttrib1fv(e.location,b)}}}}r()}function u(){for(let a in v(),d){let b=d[a];for(let a in b){let c=b[a];for(let a in c)j(c[a].object),delete c[a];delete b[a]}delete d[a]}}function v(){w(),g=!0,f!==e&&i((f=e).object)}function w(){e.geometry=null,e.program=null,e.wireframe=!1}return{setup:function(c,d,e,h,j){let l=!1,o=k(h,e,d);f!==o&&i((f=o).object),(l=m(c,h,e,j))&&n(c,h,e,j),null!==j&&b.update(j,a.ELEMENT_ARRAY_BUFFER),(l||g)&&(g=!1,t(c,d,e,h),null!==j&&a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,b.get(j).buffer))},reset:v,resetDefaultState:w,dispose:u,releaseStatesOfGeometry:function(a){if(void 0===d[a.id])return;let b=d[a.id];for(let a in b){let c=b[a];for(let a in c)j(c[a].object),delete c[a];delete b[a]}delete d[a.id]},releaseStatesOfProgram:function(a){for(let b in d){let c=d[b];if(void 0===c[a.id])continue;let e=c[a.id];for(let a in e)j(e[a].object),delete e[a];delete c[a.id]}},initAttributes:o,enableAttribute:p,disableUnusedAttributes:r}}function i9(a,b,c){let d;function e(a){d=a}function f(b,e){a.drawArrays(d,b,e),c.update(e,d,1)}function g(b,e,f){0!==f&&(a.drawArraysInstanced(d,b,e,f),c.update(e,d,f))}function h(a,e,f){if(0===f)return;b.get("WEBGL_multi_draw").multiDrawArraysWEBGL(d,a,0,e,0,f);let g=0;for(let a=0;a<f;a++)g+=e[a];c.update(g,d,1)}function i(a,e,f,h){if(0===f)return;let i=b.get("WEBGL_multi_draw");if(null===i)for(let b=0;b<a.length;b++)g(a[b],e[b],h[b]);else{i.multiDrawArraysInstancedWEBGL(d,a,0,e,0,h,0,f);let b=0;for(let a=0;a<f;a++)b+=e[a]*h[a];c.update(b,d,1)}}this.setMode=e,this.render=f,this.renderInstances=g,this.renderMultiDraw=h,this.renderMultiDrawInstances=i}function ja(a,b,c,d){let e;function f(){if(void 0!==e)return e;if(!0===b.has("EXT_texture_filter_anisotropic")){let c=b.get("EXT_texture_filter_anisotropic");e=a.getParameter(c.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else e=0;return e}function g(b){return b===a4||d.convert(b)===a.getParameter(a.IMPLEMENTATION_COLOR_READ_FORMAT)}function h(c){let e=c===aZ&&(b.has("EXT_color_buffer_half_float")||b.has("EXT_color_buffer_float"));return c===aS||d.convert(c)===a.getParameter(a.IMPLEMENTATION_COLOR_READ_TYPE)||c===aY||!!e}function i(b){if("highp"===b){if(a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.HIGH_FLOAT).precision>0&&a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision>0)return"highp";b="mediump"}return"mediump"===b&&a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.MEDIUM_FLOAT).precision>0&&a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let j=void 0!==c.precision?c.precision:"highp",k=i(j);k!==j&&(console.warn("THREE.WebGLRenderer:",j,"not supported, using",k,"instead."),j=k);let l=!0===c.logarithmicDepthBuffer,m=!0===c.reverseDepthBuffer&&b.has("EXT_clip_control"),n=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS),o=a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),p=a.getParameter(a.MAX_TEXTURE_SIZE),q=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE),r=a.getParameter(a.MAX_VERTEX_ATTRIBS),s=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS),t=a.getParameter(a.MAX_VARYING_VECTORS),u=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS),v=o>0;return{isWebGL2:!0,getMaxAnisotropy:f,getMaxPrecision:i,textureFormatReadable:g,textureTypeReadable:h,precision:j,logarithmicDepthBuffer:l,reverseDepthBuffer:m,maxTextures:n,maxVertexTextures:o,maxTextureSize:p,maxCubemapSize:q,maxAttributes:r,maxVertexUniforms:s,maxVaryings:t,maxFragmentUniforms:u,vertexTextures:v,maxSamples:a.getParameter(a.MAX_SAMPLES)}}function jb(a){let b=this,c=null,d=0,e=!1,f=!1,g=new fL,h=new cs,i={value:null,needsUpdate:!1};function j(){i.value!==c&&(i.value=c,i.needsUpdate=d>0),b.numPlanes=d,b.numIntersection=0}function k(a,c,d,e){let f=null!==a?a.length:0,j=null;if(0!==f){if(j=i.value,!0!==e||null===j){let b=d+4*f,e=c.matrixWorldInverse;h.getNormalMatrix(e),(null===j||j.length<b)&&(j=new Float32Array(b));for(let b=0,c=d;b!==f;++b,c+=4)g.copy(a[b]).applyMatrix4(e,h),g.normal.toArray(j,c),j[c+3]=g.constant}i.value=j,i.needsUpdate=!0}return b.numPlanes=f,b.numIntersection=0,j}this.uniform=i,this.numPlanes=0,this.numIntersection=0,this.init=function(a,b){let c=0!==a.length||b||0!==d||e;return e=b,d=a.length,c},this.beginShadows=function(){f=!0,k(null)},this.endShadows=function(){f=!1},this.setGlobalState=function(a,b){c=k(a,b,0)},this.setState=function(b,g,h){let l=b.clippingPlanes,m=b.clipIntersection,n=b.clipShadows,o=a.get(b);if(e&&null!==l&&0!==l.length&&(!f||n)){let a=f?0:d,b=4*a,e=o.clippingState||null;i.value=e,e=k(l,g,b,h);for(let a=0;a!==b;++a)e[a]=c[a];o.clippingState=e,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=a}else f?k(null):j()}}function jc(a){let b=new WeakMap;function c(a,b){return b===aG?a.mapping=aE:b===aH&&(a.mapping=aF),a}function d(a){let c=a.target;c.removeEventListener("dispose",d);let e=b.get(c);void 0!==e&&(b.delete(c),e.dispose())}return{get:function(e){if(e&&e.isTexture){let f=e.mapping;if(f===aG||f===aH)if(b.has(e))return c(b.get(e).texture,e.mapping);else{let f=e.image;if(!f||!(f.height>0))return null;{let g=new eY(f.height);return g.fromEquirectangularTexture(a,e),b.set(e,g),e.addEventListener("dispose",d),c(g.texture,e.mapping)}}}return e},dispose:function(){b=new WeakMap}}}let jd=4,je=[.125,.215,.35,.446,.526,.582],jf=20,jg=new iE,jh=new d6,ji=null,jj=0,jk=0,jl=!1,jm=(1+Math.sqrt(5))/2,jn=1/jm,jo=[new cV(-jm,jn,0),new cV(jm,jn,0),new cV(-jn,0,jm),new cV(jn,0,jm),new cV(0,jm,-jn),new cV(0,jm,jn),new cV(-1,1,-1),new cV(1,1,-1),new cV(-1,1,1),new cV(1,1,1)];class jp{constructor(a){this._renderer=a,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(a,b=0,c=.1,d=100){ji=this._renderer.getRenderTarget(),jj=this._renderer.getActiveCubeFace(),jk=this._renderer.getActiveMipmapLevel(),jl=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);let e=this._allocateTargets();return e.depthBuffer=!0,this._sceneToCubeUV(a,c,d,e),b>0&&this._blur(e,0,0,b),this._applyPMREM(e),this._cleanup(e),e}fromEquirectangular(a,b=null){return this._fromTexture(a,b)}fromCubemap(a,b=null){return this._fromTexture(a,b)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=jv(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=ju(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(a){this._lodMax=Math.floor(Math.log2(a)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let a=0;a<this._lodPlanes.length;a++)this._lodPlanes[a].dispose()}_cleanup(a){this._renderer.setRenderTarget(ji,jj,jk),this._renderer.xr.enabled=jl,a.scissorTest=!1,js(a,0,0,a.width,a.height)}_fromTexture(a,b){a.mapping===aE||a.mapping===aF?this._setSize(0===a.image.length?16:a.image[0].width||a.image[0].image.width):this._setSize(a.image.width/4),ji=this._renderer.getRenderTarget(),jj=this._renderer.getActiveCubeFace(),jk=this._renderer.getActiveMipmapLevel(),jl=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;let c=b||this._allocateTargets();return this._textureToCubeUV(a,c),this._applyPMREM(c),this._cleanup(c),c}_allocateTargets(){let a=3*Math.max(this._cubeSize,112),b=4*this._cubeSize,c={magFilter:aP,minFilter:aP,generateMipmaps:!1,type:aZ,format:a4,colorSpace:b_,depthBuffer:!1},d=jr(a,b,c);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==a||this._pingPongRenderTarget.height!==b){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=jr(a,b,c);let{_lodMax:d}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=jq(d)),this._blurMaterial=jt(d,a,b)}return d}_compileMaterial(a){let b=new eD(this._lodPlanes[0],a);this._renderer.compile(b,jg)}_sceneToCubeUV(a,b,c,d){let e=new eT(90,1,b,c),f=[1,-1,1,1,1,1],g=[1,1,1,-1,-1,-1],h=this._renderer,i=h.autoClear,j=h.toneMapping;h.getClearColor(jh),h.toneMapping=at,h.autoClear=!1;let k=new ea({name:"PMREM.Background",side:I,depthWrite:!1,depthTest:!1}),l=new eD(new eG,k),m=!1,n=a.background;n?n.isColor&&(k.color.copy(n),a.background=null,m=!0):(k.color.copy(jh),m=!0);for(let b=0;b<6;b++){let c=b%3;0===c?(e.up.set(0,f[b],0),e.lookAt(g[b],0,0)):1===c?(e.up.set(0,0,f[b]),e.lookAt(0,g[b],0)):(e.up.set(0,f[b],0),e.lookAt(0,0,g[b]));let i=this._cubeSize;js(d,c*i,b>2?i:0,i,i),h.setRenderTarget(d),m&&h.render(l,e),h.render(a,e)}l.geometry.dispose(),l.material.dispose(),h.toneMapping=j,h.autoClear=i,a.background=n}_textureToCubeUV(a,b){let c=this._renderer,d=a.mapping===aE||a.mapping===aF;d?(null===this._cubemapMaterial&&(this._cubemapMaterial=jv()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===a.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=ju());let e=d?this._cubemapMaterial:this._equirectMaterial,f=new eD(this._lodPlanes[0],e);e.uniforms.envMap.value=a;let g=this._cubeSize;js(b,0,0,3*g,2*g),c.setRenderTarget(b),c.render(f,jg)}_applyPMREM(a){let b=this._renderer,c=b.autoClear;b.autoClear=!1;let d=this._lodPlanes.length;for(let b=1;b<d;b++){let c=Math.sqrt(this._sigmas[b]*this._sigmas[b]-this._sigmas[b-1]*this._sigmas[b-1]),e=jo[(d-b-1)%jo.length];this._blur(a,b-1,b,c,e)}b.autoClear=c}_blur(a,b,c,d,e){let f=this._pingPongRenderTarget;this._halfBlur(a,f,b,c,d,"latitudinal",e),this._halfBlur(f,a,c,c,d,"longitudinal",e)}_halfBlur(a,b,c,d,e,f,g){let h=this._renderer,i=this._blurMaterial;"latitudinal"!==f&&"longitudinal"!==f&&console.error("blur direction must be either latitudinal or longitudinal!");let j=3,k=new eD(this._lodPlanes[d],i),l=i.uniforms,m=this._sizeLods[c]-1,n=isFinite(e)?Math.PI/(2*m):2*Math.PI/(2*jf-1),o=e/n,p=isFinite(e)?1+Math.floor(j*o):jf;p>jf&&console.warn(`sigmaRadians, ${e}, is too large and will clip, as it requested ${p} samples when the maximum is set to ${jf}`);let q=[],r=0;for(let a=0;a<jf;++a){let b=a/o,c=Math.exp(-b*b/2);q.push(c),0===a?r+=c:a<p&&(r+=2*c)}for(let a=0;a<q.length;a++)q[a]=q[a]/r;l.envMap.value=a.texture,l.samples.value=p,l.weights.value=q,l.latitudinal.value="latitudinal"===f,g&&(l.poleAxis.value=g);let{_lodMax:s}=this;l.dTheta.value=n,l.mipInt.value=s-c;let t=this._sizeLods[d];js(b,3*t*(d>s-jd?d-s+jd:0),4*(this._cubeSize-t),3*t,2*t),h.setRenderTarget(b),h.render(k,jg)}}function jq(a){let b=[],c=[],d=[],e=a,f=a-jd+1+je.length;for(let g=0;g<f;g++){let f=Math.pow(2,e);c.push(f);let h=1/f;g>a-jd?h=je[g-a+jd-1]:0===g&&(h=0),d.push(h);let i=1/(f-2),j=-i,k=1+i,l=[j,j,k,j,k,k,j,j,k,k,j,k],m=6,n=6,o=3,p=2,q=1,r=new Float32Array(108),s=new Float32Array(p*n*m),t=new Float32Array(q*n*m);for(let a=0;a<m;a++){let b=a%3*2/3-1,c=a>2?0:-1,d=[b,c,0,b+2/3,c,0,b+2/3,c+1,0,b,c,0,b+2/3,c+1,0,b,c+1,0];r.set(d,o*n*a),s.set(l,p*n*a);let e=[a,a,a,a,a,a];t.set(e,q*n*a)}let u=new er;u.setAttribute("position",new eg(r,o)),u.setAttribute("uv",new eg(s,p)),u.setAttribute("faceIndex",new eg(t,q)),b.push(u),e>jd&&e--}return{lodPlanes:b,sizeLods:c,sigmas:d}}function jr(a,b,c){let d=new cR(a,b,c);return d.texture.mapping=aI,d.texture.name="PMREM.cubeUv",d.scissorTest=!0,d}function js(a,b,c,d,e){a.viewport.set(b,c,d,e),a.scissor.set(b,c,d,e)}function jt(a,b,c){let d=new Float32Array(jf);return new eO({name:"SphericalGaussianBlur",defines:{n:jf,CUBEUV_TEXEL_WIDTH:1/b,CUBEUV_TEXEL_HEIGHT:1/c,CUBEUV_MAX_MIP:`${a}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:d},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:new cV(0,1,0)}},vertexShader:jw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:K,depthTest:!1,depthWrite:!1})}function ju(){return new eO({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:jw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:K,depthTest:!1,depthWrite:!1})}function jv(){return new eO({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:jw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:K,depthTest:!1,depthWrite:!1})}function jw(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function jx(a){let b=new WeakMap,c=null;function d(a){let b=0,c=6;for(let d=0;d<c;d++)void 0!==a[d]&&b++;return b===c}function e(a){let c=a.target;c.removeEventListener("dispose",e);let d=b.get(c);void 0!==d&&(b.delete(c),d.dispose())}return{get:function(f){if(f&&f.isTexture){let g=f.mapping,h=g===aG||g===aH,i=g===aE||g===aF;if(h||i){let g=b.get(f),j=void 0!==g?g.texture.pmremVersion:0;if(f.isRenderTargetTexture&&f.pmremVersion!==j)return null===c&&(c=new jp(a)),(g=h?c.fromEquirectangular(f,g):c.fromCubemap(f,g)).texture.pmremVersion=f.pmremVersion,b.set(f,g),g.texture;{if(void 0!==g)return g.texture;let j=f.image;return h&&j&&j.height>0||i&&j&&d(j)?(null===c&&(c=new jp(a)),(g=h?c.fromEquirectangular(f):c.fromCubemap(f)).texture.pmremVersion=f.pmremVersion,b.set(f,g),f.addEventListener("dispose",e),g.texture):null}}}return f},dispose:function(){b=new WeakMap,null!==c&&(c.dispose(),c=null)}}}function jy(a){let b={};function c(c){let d;if(void 0!==b[c])return b[c];switch(c){case"WEBGL_depth_texture":d=a.getExtension("WEBGL_depth_texture")||a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":d=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":d=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":d=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:d=a.getExtension(c)}return b[c]=d,d}return{has:function(a){return null!==c(a)},init:function(){c("EXT_color_buffer_float"),c("WEBGL_clip_cull_distance"),c("OES_texture_float_linear"),c("EXT_color_buffer_half_float"),c("WEBGL_multisampled_render_to_texture"),c("WEBGL_render_shared_exponent")},get:function(a){let b=c(a);return null===b&&cA("THREE.WebGLRenderer: "+a+" extension not supported."),b}}}function jz(a,b,c,d){let e={},f=new WeakMap;function g(a){let h=a.target;for(let a in null!==h.index&&b.remove(h.index),h.attributes)b.remove(h.attributes[a]);h.removeEventListener("dispose",g),delete e[h.id];let i=f.get(h);i&&(b.remove(i),f.delete(h)),d.releaseStatesOfGeometry(h),!0===h.isInstancedBufferGeometry&&delete h._maxInstanceCount,c.memory.geometries--}function h(a){let c=[],d=a.index,e=a.attributes.position,g=0;if(null!==d){let a=d.array;g=d.version;for(let b=0,d=a.length;b<d;b+=3){let d=a[b+0],e=a[b+1],f=a[b+2];c.push(d,e,e,f,f,d)}}else{if(void 0===e)return;let a=e.array;g=e.version;for(let b=0,d=a.length/3-1;b<d;b+=3){let a=b+0,d=b+1,e=b+2;c.push(a,d,d,e,e,a)}}let h=new(cu(c)?ei:eh)(c,1);h.version=g;let i=f.get(a);i&&b.remove(i),f.set(a,h)}return{get:function(a,b){return!0===e[b.id]||(b.addEventListener("dispose",g),e[b.id]=!0,c.memory.geometries++),b},update:function(c){let d=c.attributes;for(let c in d)b.update(d[c],a.ARRAY_BUFFER)},getWireframeAttribute:function(a){let b=f.get(a);if(b){let c=a.index;null!==c&&b.version<c.version&&h(a)}else h(a);return f.get(a)}}}function jA(a,b,c){let d,e,f;function g(a){d=a}function h(a){e=a.type,f=a.bytesPerElement}function i(b,g){a.drawElements(d,g,e,b*f),c.update(g,d,1)}function j(b,g,h){0!==h&&(a.drawElementsInstanced(d,g,e,b*f,h),c.update(g,d,h))}function k(a,f,g){if(0===g)return;b.get("WEBGL_multi_draw").multiDrawElementsWEBGL(d,f,0,e,a,0,g);let h=0;for(let a=0;a<g;a++)h+=f[a];c.update(h,d,1)}function l(a,g,h,i){if(0===h)return;let k=b.get("WEBGL_multi_draw");if(null===k)for(let b=0;b<a.length;b++)j(a[b]/f,g[b],i[b]);else{k.multiDrawElementsInstancedWEBGL(d,g,0,e,a,0,i,0,h);let b=0;for(let a=0;a<h;a++)b+=g[a]*i[a];c.update(b,d,1)}}this.setMode=g,this.setIndex=h,this.render=i,this.renderInstances=j,this.renderMultiDraw=k,this.renderMultiDrawInstances=l}function jB(a){let b={frame:0,calls:0,triangles:0,points:0,lines:0};function c(c,d,e){switch(b.calls++,d){case a.TRIANGLES:b.triangles+=c/3*e;break;case a.LINES:b.lines+=c/2*e;break;case a.LINE_STRIP:b.lines+=e*(c-1);break;case a.LINE_LOOP:b.lines+=e*c;break;case a.POINTS:b.points+=e*c;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",d)}}function d(){b.calls=0,b.triangles=0,b.points=0,b.lines=0}return{memory:{geometries:0,textures:0},render:b,programs:null,autoReset:!0,reset:d,update:c}}function jC(a,b,c){let d=new WeakMap,e=new cP;return{update:function(f,g,h){let i=f.morphTargetInfluences,j=g.morphAttributes.position||g.morphAttributes.normal||g.morphAttributes.color,k=void 0!==j?j.length:0,l=d.get(g);if(void 0===l||l.count!==k){void 0!==l&&l.texture.dispose();let a=void 0!==g.morphAttributes.position,c=void 0!==g.morphAttributes.normal,f=void 0!==g.morphAttributes.color,h=g.morphAttributes.position||[],i=g.morphAttributes.normal||[],j=g.morphAttributes.color||[],n=0;!0===a&&(n=1),!0===c&&(n=2),!0===f&&(n=3);let o=g.attributes.position.count*n,p=1;o>b.maxTextureSize&&(p=Math.ceil(o/b.maxTextureSize),o=b.maxTextureSize);let q=new Float32Array(o*p*4*k),r=new cS(q,o,p,k);r.type=aY,r.needsUpdate=!0;let s=4*n;for(let b=0;b<k;b++){let d=h[b],g=i[b],k=j[b],l=o*p*4*b;for(let b=0;b<d.count;b++){let h=b*s;!0===a&&(e.fromBufferAttribute(d,b),q[l+h+0]=e.x,q[l+h+1]=e.y,q[l+h+2]=e.z,q[l+h+3]=0),!0===c&&(e.fromBufferAttribute(g,b),q[l+h+4]=e.x,q[l+h+5]=e.y,q[l+h+6]=e.z,q[l+h+7]=0),!0===f&&(e.fromBufferAttribute(k,b),q[l+h+8]=e.x,q[l+h+9]=e.y,q[l+h+10]=e.z,q[l+h+11]=4===k.itemSize?e.w:1)}}function m(){r.dispose(),d.delete(g),g.removeEventListener("dispose",m)}l={count:k,texture:r,size:new cr(o,p)},d.set(g,l),g.addEventListener("dispose",m)}if(!0===f.isInstancedMesh&&null!==f.morphTexture)h.getUniforms().setValue(a,"morphTexture",f.morphTexture,c);else{let b=0;for(let a=0;a<i.length;a++)b+=i[a];let c=g.morphTargetsRelative?1:1-b;h.getUniforms().setValue(a,"morphTargetBaseInfluence",c),h.getUniforms().setValue(a,"morphTargetInfluences",i)}h.getUniforms().setValue(a,"morphTargetsTexture",l.texture,c),h.getUniforms().setValue(a,"morphTargetsTextureSize",l.size)}}}function jD(a,b,c,d){let e=new WeakMap;function f(a){let b=a.target;b.removeEventListener("dispose",f),c.remove(b.instanceMatrix),null!==b.instanceColor&&c.remove(b.instanceColor)}return{update:function(g){let h=d.render.frame,i=g.geometry,j=b.get(g,i);if(e.get(j)!==h&&(b.update(j),e.set(j,h)),g.isInstancedMesh&&(!1===g.hasEventListener("dispose",f)&&g.addEventListener("dispose",f),e.get(g)!==h&&(c.update(g.instanceMatrix,a.ARRAY_BUFFER),null!==g.instanceColor&&c.update(g.instanceColor,a.ARRAY_BUFFER),e.set(g,h))),g.isSkinnedMesh){let a=g.skeleton;e.get(a)!==h&&(a.update(),e.set(a,h))}return j},dispose:function(){e=new WeakMap}}}let jE=new cO,jF=new gn(1,1),jG=new cS,jH=new cT,jI=new eX,jJ=[],jK=[],jL=new Float32Array(16),jM=new Float32Array(9),jN=new Float32Array(4);function jO(a,b,c){let d=a[0];if(d<=0||d>0)return a;let e=b*c,f=jJ[e];if(void 0===f&&(f=new Float32Array(e),jJ[e]=f),0!==b){d.toArray(f,0);for(let d=1,e=0;d!==b;++d)e+=c,a[d].toArray(f,e)}return f}function jP(a,b){if(a.length!==b.length)return!1;for(let c=0,d=a.length;c<d;c++)if(a[c]!==b[c])return!1;return!0}function jQ(a,b){for(let c=0,d=b.length;c<d;c++)a[c]=b[c]}function jR(a,b){let c=jK[b];void 0===c&&(c=new Int32Array(b),jK[b]=c);for(let d=0;d!==b;++d)c[d]=a.allocateTextureUnit();return c}function jS(a,b){let c=this.cache;c[0]!==b&&(a.uniform1f(this.addr,b),c[0]=b)}function jT(a,b){let c=this.cache;if(void 0!==b.x)(c[0]!==b.x||c[1]!==b.y)&&(a.uniform2f(this.addr,b.x,b.y),c[0]=b.x,c[1]=b.y);else{if(jP(c,b))return;a.uniform2fv(this.addr,b),jQ(c,b)}}function jU(a,b){let c=this.cache;if(void 0!==b.x)(c[0]!==b.x||c[1]!==b.y||c[2]!==b.z)&&(a.uniform3f(this.addr,b.x,b.y,b.z),c[0]=b.x,c[1]=b.y,c[2]=b.z);else if(void 0!==b.r)(c[0]!==b.r||c[1]!==b.g||c[2]!==b.b)&&(a.uniform3f(this.addr,b.r,b.g,b.b),c[0]=b.r,c[1]=b.g,c[2]=b.b);else{if(jP(c,b))return;a.uniform3fv(this.addr,b),jQ(c,b)}}function jV(a,b){let c=this.cache;if(void 0!==b.x)(c[0]!==b.x||c[1]!==b.y||c[2]!==b.z||c[3]!==b.w)&&(a.uniform4f(this.addr,b.x,b.y,b.z,b.w),c[0]=b.x,c[1]=b.y,c[2]=b.z,c[3]=b.w);else{if(jP(c,b))return;a.uniform4fv(this.addr,b),jQ(c,b)}}function jW(a,b){let c=this.cache,d=b.elements;if(void 0===d){if(jP(c,b))return;a.uniformMatrix2fv(this.addr,!1,b),jQ(c,b)}else{if(jP(c,d))return;jN.set(d),a.uniformMatrix2fv(this.addr,!1,jN),jQ(c,d)}}function jX(a,b){let c=this.cache,d=b.elements;if(void 0===d){if(jP(c,b))return;a.uniformMatrix3fv(this.addr,!1,b),jQ(c,b)}else{if(jP(c,d))return;jM.set(d),a.uniformMatrix3fv(this.addr,!1,jM),jQ(c,d)}}function jY(a,b){let c=this.cache,d=b.elements;if(void 0===d){if(jP(c,b))return;a.uniformMatrix4fv(this.addr,!1,b),jQ(c,b)}else{if(jP(c,d))return;jL.set(d),a.uniformMatrix4fv(this.addr,!1,jL),jQ(c,d)}}function jZ(a,b){let c=this.cache;c[0]!==b&&(a.uniform1i(this.addr,b),c[0]=b)}function j$(a,b){let c=this.cache;if(void 0!==b.x)(c[0]!==b.x||c[1]!==b.y)&&(a.uniform2i(this.addr,b.x,b.y),c[0]=b.x,c[1]=b.y);else{if(jP(c,b))return;a.uniform2iv(this.addr,b),jQ(c,b)}}function j_(a,b){let c=this.cache;if(void 0!==b.x)(c[0]!==b.x||c[1]!==b.y||c[2]!==b.z)&&(a.uniform3i(this.addr,b.x,b.y,b.z),c[0]=b.x,c[1]=b.y,c[2]=b.z);else{if(jP(c,b))return;a.uniform3iv(this.addr,b),jQ(c,b)}}function j0(a,b){let c=this.cache;if(void 0!==b.x)(c[0]!==b.x||c[1]!==b.y||c[2]!==b.z||c[3]!==b.w)&&(a.uniform4i(this.addr,b.x,b.y,b.z,b.w),c[0]=b.x,c[1]=b.y,c[2]=b.z,c[3]=b.w);else{if(jP(c,b))return;a.uniform4iv(this.addr,b),jQ(c,b)}}function j1(a,b){let c=this.cache;c[0]!==b&&(a.uniform1ui(this.addr,b),c[0]=b)}function j2(a,b){let c=this.cache;if(void 0!==b.x)(c[0]!==b.x||c[1]!==b.y)&&(a.uniform2ui(this.addr,b.x,b.y),c[0]=b.x,c[1]=b.y);else{if(jP(c,b))return;a.uniform2uiv(this.addr,b),jQ(c,b)}}function j3(a,b){let c=this.cache;if(void 0!==b.x)(c[0]!==b.x||c[1]!==b.y||c[2]!==b.z)&&(a.uniform3ui(this.addr,b.x,b.y,b.z),c[0]=b.x,c[1]=b.y,c[2]=b.z);else{if(jP(c,b))return;a.uniform3uiv(this.addr,b),jQ(c,b)}}function j4(a,b){let c=this.cache;if(void 0!==b.x)(c[0]!==b.x||c[1]!==b.y||c[2]!==b.z||c[3]!==b.w)&&(a.uniform4ui(this.addr,b.x,b.y,b.z,b.w),c[0]=b.x,c[1]=b.y,c[2]=b.z,c[3]=b.w);else{if(jP(c,b))return;a.uniform4uiv(this.addr,b),jQ(c,b)}}function j5(a,b,c){let d,e=this.cache,f=c.allocateTextureUnit();e[0]!==f&&(a.uniform1i(this.addr,f),e[0]=f),this.type===a.SAMPLER_2D_SHADOW?(jF.compareFunction=b7,d=jF):d=jE,c.setTexture2D(b||d,f)}function j6(a,b,c){let d=this.cache,e=c.allocateTextureUnit();d[0]!==e&&(a.uniform1i(this.addr,e),d[0]=e),c.setTexture3D(b||jH,e)}function j7(a,b,c){let d=this.cache,e=c.allocateTextureUnit();d[0]!==e&&(a.uniform1i(this.addr,e),d[0]=e),c.setTextureCube(b||jI,e)}function j8(a,b,c){let d=this.cache,e=c.allocateTextureUnit();d[0]!==e&&(a.uniform1i(this.addr,e),d[0]=e),c.setTexture2DArray(b||jG,e)}function j9(a){switch(a){case 5126:return jS;case 35664:return jT;case 35665:return jU;case 35666:return jV;case 35674:return jW;case 35675:return jX;case 35676:return jY;case 5124:case 35670:return jZ;case 35667:case 35671:return j$;case 35668:case 35672:return j_;case 35669:case 35673:return j0;case 5125:return j1;case 36294:return j2;case 36295:return j3;case 36296:return j4;case 35678:case 36198:case 36298:case 36306:case 35682:return j5;case 35679:case 36299:case 36307:return j6;case 35680:case 36300:case 36308:case 36293:return j7;case 36289:case 36303:case 36311:case 36292:return j8}}function ka(a,b){a.uniform1fv(this.addr,b)}function kb(a,b){let c=jO(b,this.size,2);a.uniform2fv(this.addr,c)}function kc(a,b){let c=jO(b,this.size,3);a.uniform3fv(this.addr,c)}function kd(a,b){let c=jO(b,this.size,4);a.uniform4fv(this.addr,c)}function ke(a,b){let c=jO(b,this.size,4);a.uniformMatrix2fv(this.addr,!1,c)}function kf(a,b){let c=jO(b,this.size,9);a.uniformMatrix3fv(this.addr,!1,c)}function kg(a,b){let c=jO(b,this.size,16);a.uniformMatrix4fv(this.addr,!1,c)}function kh(a,b){a.uniform1iv(this.addr,b)}function ki(a,b){a.uniform2iv(this.addr,b)}function kj(a,b){a.uniform3iv(this.addr,b)}function kk(a,b){a.uniform4iv(this.addr,b)}function kl(a,b){a.uniform1uiv(this.addr,b)}function km(a,b){a.uniform2uiv(this.addr,b)}function kn(a,b){a.uniform3uiv(this.addr,b)}function ko(a,b){a.uniform4uiv(this.addr,b)}function kp(a,b,c){let d=this.cache,e=b.length,f=jR(c,e);jP(d,f)||(a.uniform1iv(this.addr,f),jQ(d,f));for(let a=0;a!==e;++a)c.setTexture2D(b[a]||jE,f[a])}function kq(a,b,c){let d=this.cache,e=b.length,f=jR(c,e);jP(d,f)||(a.uniform1iv(this.addr,f),jQ(d,f));for(let a=0;a!==e;++a)c.setTexture3D(b[a]||jH,f[a])}function kr(a,b,c){let d=this.cache,e=b.length,f=jR(c,e);jP(d,f)||(a.uniform1iv(this.addr,f),jQ(d,f));for(let a=0;a!==e;++a)c.setTextureCube(b[a]||jI,f[a])}function ks(a,b,c){let d=this.cache,e=b.length,f=jR(c,e);jP(d,f)||(a.uniform1iv(this.addr,f),jQ(d,f));for(let a=0;a!==e;++a)c.setTexture2DArray(b[a]||jG,f[a])}function kt(a){switch(a){case 5126:return ka;case 35664:return kb;case 35665:return kc;case 35666:return kd;case 35674:return ke;case 35675:return kf;case 35676:return kg;case 5124:case 35670:return kh;case 35667:case 35671:return ki;case 35668:case 35672:return kj;case 35669:case 35673:return kk;case 5125:return kl;case 36294:return km;case 36295:return kn;case 36296:return ko;case 35678:case 36198:case 36298:case 36306:case 35682:return kp;case 35679:case 36299:case 36307:return kq;case 35680:case 36300:case 36308:case 36293:return kr;case 36289:case 36303:case 36311:case 36292:return ks}}class ku{constructor(a,b,c){this.id=a,this.addr=c,this.cache=[],this.type=b.type,this.setValue=j9(b.type)}}class kv{constructor(a,b,c){this.id=a,this.addr=c,this.cache=[],this.type=b.type,this.size=b.size,this.setValue=kt(b.type)}}class kw{constructor(a){this.id=a,this.seq=[],this.map={}}setValue(a,b,c){let d=this.seq;for(let e=0,f=d.length;e!==f;++e){let f=d[e];f.setValue(a,b[f.id],c)}}}let kx=/(\w+)(\])?(\[|\.)?/g;function ky(a,b){a.seq.push(b),a.map[b.id]=b}function kz(a,b,c){let d=a.name,e=d.length;for(kx.lastIndex=0;;){let f=kx.exec(d),g=kx.lastIndex,h=f[1],i="]"===f[2],j=f[3];if(i&&(h|=0),void 0===j||"["===j&&g+2===e){ky(c,void 0===j?new ku(h,a,b):new kv(h,a,b));break}{let a=c.map[h];void 0===a&&ky(c,a=new kw(h)),c=a}}}class kA{constructor(a,b){this.seq=[],this.map={};let c=a.getProgramParameter(b,a.ACTIVE_UNIFORMS);for(let d=0;d<c;++d){let c=a.getActiveUniform(b,d),e=a.getUniformLocation(b,c.name);kz(c,e,this)}}setValue(a,b,c,d){let e=this.map[b];void 0!==e&&e.setValue(a,c,d)}setOptional(a,b,c){let d=b[c];void 0!==d&&this.setValue(a,c,d)}static upload(a,b,c,d){for(let e=0,f=b.length;e!==f;++e){let f=b[e],g=c[f.id];!1!==g.needsUpdate&&f.setValue(a,g.value,d)}}static seqWithValue(a,b){let c=[];for(let d=0,e=a.length;d!==e;++d){let e=a[d];e.id in b&&c.push(e)}return c}}function kB(a,b,c){let d=a.createShader(b);return a.shaderSource(d,c),a.compileShader(d),d}let kC=37297,kD=0;function kE(a,b){let c=a.split("\n"),d=[],e=Math.max(b-6,0),f=Math.min(b+6,c.length);for(let a=e;a<f;a++){let e=a+1;d.push(`${e===b?">":" "} ${e}: ${c[a]}`)}return d.join("\n")}let kF=new cs;function kG(a){cG._getMatrix(kF,cG.workingColorSpace,a);let b=`mat3( ${kF.elements.map(a=>a.toFixed(4))} )`;switch(cG.getTransfer(a)){case b0:return[b,"LinearTransferOETF"];case b1:return[b,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",a),[b,"LinearTransferOETF"]}}function kH(a,b,c){let d=a.getShaderParameter(b,a.COMPILE_STATUS),e=a.getShaderInfoLog(b).trim();if(d&&""===e)return"";let f=/ERROR: 0:(\d+)/.exec(e);if(!f)return e;{let d=parseInt(f[1]);return c.toUpperCase()+"\n\n"+e+"\n\n"+kE(a.getShaderSource(b),d)}}function kI(a,b){let c=kG(b);return`vec4 ${a}( vec4 value ) {
	return ${c[1]}( vec4( value.rgb * ${c[0]}, value.a ) );
}`}function kJ(a,b){let c;switch(b){case au:c="Linear";break;case av:c="Reinhard";break;case aw:c="Cineon";break;case ax:c="ACESFilmic";break;case az:c="AgX";break;case aA:c="Neutral";break;case ay:c="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",b),c="Linear"}return"vec3 "+a+"( vec3 color ) { return "+c+"ToneMapping( color ); }"}let kK=new cV;function kL(){cG.getLuminanceCoefficients(kK);let a=kK.x.toFixed(4),b=kK.y.toFixed(4),c=kK.z.toFixed(4);return`float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( ${a}, ${b}, ${c} );
	return dot( weights, rgb );
}`}function kM(a){return[a.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",a.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(kP).join("\n")}function kN(a){let b=[];for(let c in a){let d=a[c];!1!==d&&b.push("#define "+c+" "+d)}return b.join("\n")}function kO(a,b){let c={},d=a.getProgramParameter(b,a.ACTIVE_ATTRIBUTES);for(let e=0;e<d;e++){let d=a.getActiveAttrib(b,e),f=d.name,g=1;d.type===a.FLOAT_MAT2&&(g=2),d.type===a.FLOAT_MAT3&&(g=3),d.type===a.FLOAT_MAT4&&(g=4),c[f]={type:d.type,location:a.getAttribLocation(b,f),locationSize:g}}return c}function kP(a){return""!==a}function kQ(a,b){let c=b.numSpotLightShadows+b.numSpotLightMaps-b.numSpotLightShadowsWithMaps;return a.replace(/NUM_DIR_LIGHTS/g,b.numDirLights).replace(/NUM_SPOT_LIGHTS/g,b.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,b.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,c).replace(/NUM_RECT_AREA_LIGHTS/g,b.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,b.numPointLights).replace(/NUM_HEMI_LIGHTS/g,b.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,b.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,b.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,b.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,b.numPointLightShadows)}function kR(a,b){return a.replace(/NUM_CLIPPING_PLANES/g,b.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,b.numClippingPlanes-b.numClipIntersection)}let kS=/^[ \t]*#include +<([\w\d./]+)>/gm;function kT(a){return a.replace(kS,kV)}let kU=new Map;function kV(a,b){let c=i1[b];if(void 0===c){let a=kU.get(b);if(void 0!==a)c=i1[a],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',b,a);else throw Error("Can not resolve #include <"+b+">")}return kT(c)}let kW=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function kX(a){return a.replace(kW,kY)}function kY(a,b,c,d){let e="";for(let a=parseInt(b);a<parseInt(c);a++)e+=d.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return e}function kZ(a){let b=`precision ${a.precision} float;
	precision ${a.precision} int;
	precision ${a.precision} sampler2D;
	precision ${a.precision} samplerCube;
	precision ${a.precision} sampler3D;
	precision ${a.precision} sampler2DArray;
	precision ${a.precision} sampler2DShadow;
	precision ${a.precision} samplerCubeShadow;
	precision ${a.precision} sampler2DArrayShadow;
	precision ${a.precision} isampler2D;
	precision ${a.precision} isampler3D;
	precision ${a.precision} isamplerCube;
	precision ${a.precision} isampler2DArray;
	precision ${a.precision} usampler2D;
	precision ${a.precision} usampler3D;
	precision ${a.precision} usamplerCube;
	precision ${a.precision} usampler2DArray;
	`;return"highp"===a.precision?b+="\n#define HIGH_PRECISION":"mediump"===a.precision?b+="\n#define MEDIUM_PRECISION":"lowp"===a.precision&&(b+="\n#define LOW_PRECISION"),b}function k$(a){let b="SHADOWMAP_TYPE_BASIC";return a.shadowMapType===E?b="SHADOWMAP_TYPE_PCF":a.shadowMapType===F?b="SHADOWMAP_TYPE_PCF_SOFT":a.shadowMapType===G&&(b="SHADOWMAP_TYPE_VSM"),b}function k_(a){let b="ENVMAP_TYPE_CUBE";if(a.envMap)switch(a.envMapMode){case aE:case aF:b="ENVMAP_TYPE_CUBE";break;case aI:b="ENVMAP_TYPE_CUBE_UV"}return b}function k0(a){let b="ENVMAP_MODE_REFLECTION";return a.envMap&&a.envMapMode===aF&&(b="ENVMAP_MODE_REFRACTION"),b}function k1(a){let b="ENVMAP_BLENDING_NONE";if(a.envMap)switch(a.combine){case aq:b="ENVMAP_BLENDING_MULTIPLY";break;case ar:b="ENVMAP_BLENDING_MIX";break;case as:b="ENVMAP_BLENDING_ADD"}return b}function k2(a){let b=a.envMapCubeUVHeight;if(null===b)return null;let c=Math.log2(b)-2;return{texelWidth:1/(3*Math.max(Math.pow(2,c),112)),texelHeight:1/b,maxMip:c}}function k3(a,b,c,d){let e,f,g,h,i=a.getContext(),j=c.defines,k=c.vertexShader,l=c.fragmentShader,m=k$(c),n=k_(c),o=k0(c),p=k1(c),q=k2(c),r=kM(c),s=kN(j),t=i.createProgram(),u=c.glslVersion?"#version "+c.glslVersion+"\n":"";c.isRawShaderMaterial?((e=["#define SHADER_TYPE "+c.shaderType,"#define SHADER_NAME "+c.shaderName,s].filter(kP).join("\n")).length>0&&(e+="\n"),(f=["#define SHADER_TYPE "+c.shaderType,"#define SHADER_NAME "+c.shaderName,s].filter(kP).join("\n")).length>0&&(f+="\n")):(e=[kZ(c),"#define SHADER_TYPE "+c.shaderType,"#define SHADER_NAME "+c.shaderName,s,c.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",c.batching?"#define USE_BATCHING":"",c.batchingColor?"#define USE_BATCHING_COLOR":"",c.instancing?"#define USE_INSTANCING":"",c.instancingColor?"#define USE_INSTANCING_COLOR":"",c.instancingMorph?"#define USE_INSTANCING_MORPH":"",c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+o:"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",c.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",c.displacementMap?"#define USE_DISPLACEMENTMAP":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.anisotropy?"#define USE_ANISOTROPY":"",c.anisotropyMap?"#define USE_ANISOTROPYMAP":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",c.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",c.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.alphaHash?"#define USE_ALPHAHASH":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",c.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",c.mapUv?"#define MAP_UV "+c.mapUv:"",c.alphaMapUv?"#define ALPHAMAP_UV "+c.alphaMapUv:"",c.lightMapUv?"#define LIGHTMAP_UV "+c.lightMapUv:"",c.aoMapUv?"#define AOMAP_UV "+c.aoMapUv:"",c.emissiveMapUv?"#define EMISSIVEMAP_UV "+c.emissiveMapUv:"",c.bumpMapUv?"#define BUMPMAP_UV "+c.bumpMapUv:"",c.normalMapUv?"#define NORMALMAP_UV "+c.normalMapUv:"",c.displacementMapUv?"#define DISPLACEMENTMAP_UV "+c.displacementMapUv:"",c.metalnessMapUv?"#define METALNESSMAP_UV "+c.metalnessMapUv:"",c.roughnessMapUv?"#define ROUGHNESSMAP_UV "+c.roughnessMapUv:"",c.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+c.anisotropyMapUv:"",c.clearcoatMapUv?"#define CLEARCOATMAP_UV "+c.clearcoatMapUv:"",c.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+c.clearcoatNormalMapUv:"",c.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+c.clearcoatRoughnessMapUv:"",c.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+c.iridescenceMapUv:"",c.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+c.iridescenceThicknessMapUv:"",c.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+c.sheenColorMapUv:"",c.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+c.sheenRoughnessMapUv:"",c.specularMapUv?"#define SPECULARMAP_UV "+c.specularMapUv:"",c.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+c.specularColorMapUv:"",c.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+c.specularIntensityMapUv:"",c.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+c.transmissionMapUv:"",c.thicknessMapUv?"#define THICKNESSMAP_UV "+c.thicknessMapUv:"",c.vertexTangents&&!1===c.flatShading?"#define USE_TANGENT":"",c.vertexColors?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUv1s?"#define USE_UV1":"",c.vertexUv2s?"#define USE_UV2":"",c.vertexUv3s?"#define USE_UV3":"",c.pointsUvs?"#define USE_POINTS_UV":"",c.flatShading?"#define FLAT_SHADED":"",c.skinning?"#define USE_SKINNING":"",c.morphTargets?"#define USE_MORPHTARGETS":"",c.morphNormals&&!1===c.flatShading?"#define USE_MORPHNORMALS":"",c.morphColors?"#define USE_MORPHCOLORS":"",c.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+c.morphTextureStride:"",c.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+c.morphTargetsCount:"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+m:"",c.sizeAttenuation?"#define USE_SIZEATTENUATION":"",c.numLightProbes>0?"#define USE_LIGHT_PROBES":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif","\n"].filter(kP).join("\n"),f=[kZ(c),"#define SHADER_TYPE "+c.shaderType,"#define SHADER_NAME "+c.shaderName,s,c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",c.map?"#define USE_MAP":"",c.matcap?"#define USE_MATCAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+n:"",c.envMap?"#define "+o:"",c.envMap?"#define "+p:"",q?"#define CUBEUV_TEXEL_WIDTH "+q.texelWidth:"",q?"#define CUBEUV_TEXEL_HEIGHT "+q.texelHeight:"",q?"#define CUBEUV_MAX_MIP "+q.maxMip+".0":"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",c.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.anisotropy?"#define USE_ANISOTROPY":"",c.anisotropyMap?"#define USE_ANISOTROPYMAP":"",c.clearcoat?"#define USE_CLEARCOAT":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.dispersion?"#define USE_DISPERSION":"",c.iridescence?"#define USE_IRIDESCENCE":"",c.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",c.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",c.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.alphaTest?"#define USE_ALPHATEST":"",c.alphaHash?"#define USE_ALPHAHASH":"",c.sheen?"#define USE_SHEEN":"",c.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",c.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.vertexTangents&&!1===c.flatShading?"#define USE_TANGENT":"",c.vertexColors||c.instancingColor||c.batchingColor?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUv1s?"#define USE_UV1":"",c.vertexUv2s?"#define USE_UV2":"",c.vertexUv3s?"#define USE_UV3":"",c.pointsUvs?"#define USE_POINTS_UV":"",c.gradientMap?"#define USE_GRADIENTMAP":"",c.flatShading?"#define FLAT_SHADED":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+m:"",c.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",c.numLightProbes>0?"#define USE_LIGHT_PROBES":"",c.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",c.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",c.toneMapping!==at?"#define TONE_MAPPING":"",c.toneMapping!==at?i1.tonemapping_pars_fragment:"",c.toneMapping!==at?kJ("toneMapping",c.toneMapping):"",c.dithering?"#define DITHERING":"",c.opaque?"#define OPAQUE":"",i1.colorspace_pars_fragment,kI("linearToOutputTexel",c.outputColorSpace),kL(),c.useDepthPacking?"#define DEPTH_PACKING "+c.depthPacking:"","\n"].filter(kP).join("\n")),k=kR(k=kQ(k=kT(k),c),c),l=kR(l=kQ(l=kT(l),c),c),k=kX(k),l=kX(l),!0!==c.isRawShaderMaterial&&(u="#version 300 es\n",e=[r,"#define attribute in\n#define varying out\n#define texture2D texture"].join("\n")+"\n"+e,f=["#define varying in",c.glslVersion===cd?"":"layout(location = 0) out highp vec4 pc_fragColor;",c.glslVersion===cd?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n#define texture2DLodEXT textureLod\n#define texture2DProjLodEXT textureProjLod\n#define textureCubeLodEXT textureLod\n#define texture2DGradEXT textureGrad\n#define texture2DProjGradEXT textureProjGrad\n#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+f);let v=u+e+k,w=u+f+l,x=kB(i,i.VERTEX_SHADER,v),y=kB(i,i.FRAGMENT_SHADER,w);function z(b){if(a.debug.checkShaderErrors){let c=i.getProgramInfoLog(t).trim(),d=i.getShaderInfoLog(x).trim(),g=i.getShaderInfoLog(y).trim(),h=!0,j=!0;if(!1===i.getProgramParameter(t,i.LINK_STATUS))if(h=!1,"function"==typeof a.debug.onShaderError)a.debug.onShaderError(i,t,x,y);else{let a=kH(i,x,"vertex"),d=kH(i,y,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(t,i.VALIDATE_STATUS)+"\n\nMaterial Name: "+b.name+"\nMaterial Type: "+b.type+"\n\nProgram Info Log: "+c+"\n"+a+"\n"+d)}else""!==c?console.warn("THREE.WebGLProgram: Program Info Log:",c):(""===d||""===g)&&(j=!1);j&&(b.diagnostics={runnable:h,programLog:c,vertexShader:{log:d,prefix:e},fragmentShader:{log:g,prefix:f}})}i.deleteShader(x),i.deleteShader(y),g=new kA(i,t),h=kO(i,t)}i.attachShader(t,x),i.attachShader(t,y),void 0!==c.index0AttributeName?i.bindAttribLocation(t,0,c.index0AttributeName):!0===c.morphTargets&&i.bindAttribLocation(t,0,"position"),i.linkProgram(t),this.getUniforms=function(){return void 0===g&&z(this),g},this.getAttributes=function(){return void 0===h&&z(this),h};let A=!1===c.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===A&&(A=i.getProgramParameter(t,kC)),A},this.destroy=function(){d.releaseStatesOfProgram(this),i.deleteProgram(t),this.program=void 0},this.type=c.shaderType,this.name=c.shaderName,this.id=kD++,this.cacheKey=b,this.usedTimes=1,this.program=t,this.vertexShader=x,this.fragmentShader=y,this}let k4=0;class k5{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(a){let b=a.vertexShader,c=a.fragmentShader,d=this._getShaderStage(b),e=this._getShaderStage(c),f=this._getShaderCacheForMaterial(a);return!1===f.has(d)&&(f.add(d),d.usedTimes++),!1===f.has(e)&&(f.add(e),e.usedTimes++),this}remove(a){for(let b of this.materialCache.get(a))b.usedTimes--,0===b.usedTimes&&this.shaderCache.delete(b.code);return this.materialCache.delete(a),this}getVertexShaderID(a){return this._getShaderStage(a.vertexShader).id}getFragmentShaderID(a){return this._getShaderStage(a.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(a){let b=this.materialCache,c=b.get(a);return void 0===c&&(c=new Set,b.set(a,c)),c}_getShaderStage(a){let b=this.shaderCache,c=b.get(a);return void 0===c&&(c=new k6(a),b.set(a,c)),c}}class k6{constructor(a){this.id=k4++,this.code=a,this.usedTimes=0}}function k7(a,b,c,d,e,f,g){let h=new dz,i=new k5,j=new Set,k=[],l=e.logarithmicDepthBuffer,m=e.vertexTextures,n=e.precision,o={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function p(a){return(j.add(a),0===a)?"uv":`uv${a}`}function q(a,b){a.push(b.precision),a.push(b.outputColorSpace),a.push(b.envMapMode),a.push(b.envMapCubeUVHeight),a.push(b.mapUv),a.push(b.alphaMapUv),a.push(b.lightMapUv),a.push(b.aoMapUv),a.push(b.bumpMapUv),a.push(b.normalMapUv),a.push(b.displacementMapUv),a.push(b.emissiveMapUv),a.push(b.metalnessMapUv),a.push(b.roughnessMapUv),a.push(b.anisotropyMapUv),a.push(b.clearcoatMapUv),a.push(b.clearcoatNormalMapUv),a.push(b.clearcoatRoughnessMapUv),a.push(b.iridescenceMapUv),a.push(b.iridescenceThicknessMapUv),a.push(b.sheenColorMapUv),a.push(b.sheenRoughnessMapUv),a.push(b.specularMapUv),a.push(b.specularColorMapUv),a.push(b.specularIntensityMapUv),a.push(b.transmissionMapUv),a.push(b.thicknessMapUv),a.push(b.combine),a.push(b.fogExp2),a.push(b.sizeAttenuation),a.push(b.morphTargetsCount),a.push(b.morphAttributeCount),a.push(b.numDirLights),a.push(b.numPointLights),a.push(b.numSpotLights),a.push(b.numSpotLightMaps),a.push(b.numHemiLights),a.push(b.numRectAreaLights),a.push(b.numDirLightShadows),a.push(b.numPointLightShadows),a.push(b.numSpotLightShadows),a.push(b.numSpotLightShadowsWithMaps),a.push(b.numLightProbes),a.push(b.shadowMapType),a.push(b.toneMapping),a.push(b.numClippingPlanes),a.push(b.numClipIntersection),a.push(b.depthPacking)}function r(a,b){h.disableAll(),b.supportsVertexTextures&&h.enable(0),b.instancing&&h.enable(1),b.instancingColor&&h.enable(2),b.instancingMorph&&h.enable(3),b.matcap&&h.enable(4),b.envMap&&h.enable(5),b.normalMapObjectSpace&&h.enable(6),b.normalMapTangentSpace&&h.enable(7),b.clearcoat&&h.enable(8),b.iridescence&&h.enable(9),b.alphaTest&&h.enable(10),b.vertexColors&&h.enable(11),b.vertexAlphas&&h.enable(12),b.vertexUv1s&&h.enable(13),b.vertexUv2s&&h.enable(14),b.vertexUv3s&&h.enable(15),b.vertexTangents&&h.enable(16),b.anisotropy&&h.enable(17),b.alphaHash&&h.enable(18),b.batching&&h.enable(19),b.dispersion&&h.enable(20),b.batchingColor&&h.enable(21),a.push(h.mask),h.disableAll(),b.fog&&h.enable(0),b.useFog&&h.enable(1),b.flatShading&&h.enable(2),b.logarithmicDepthBuffer&&h.enable(3),b.reverseDepthBuffer&&h.enable(4),b.skinning&&h.enable(5),b.morphTargets&&h.enable(6),b.morphNormals&&h.enable(7),b.morphColors&&h.enable(8),b.premultipliedAlpha&&h.enable(9),b.shadowMapEnabled&&h.enable(10),b.doubleSided&&h.enable(11),b.flipSided&&h.enable(12),b.useDepthPacking&&h.enable(13),b.dithering&&h.enable(14),b.transmission&&h.enable(15),b.sheen&&h.enable(16),b.opaque&&h.enable(17),b.pointsUvs&&h.enable(18),b.decodeVideoTexture&&h.enable(19),b.decodeVideoTextureEmissive&&h.enable(20),b.alphaToCoverage&&h.enable(21),a.push(h.mask)}return{getParameters:function(f,h,k,q,r){let s,t,u,v,w=q.fog,x=r.geometry,y=f.isMeshStandardMaterial?q.environment:null,z=(f.isMeshStandardMaterial?c:b).get(f.envMap||y),A=z&&z.mapping===aI?z.image.height:null,B=o[f.type];null!==f.precision&&(n=e.getMaxPrecision(f.precision))!==f.precision&&console.warn("THREE.WebGLProgram.getParameters:",f.precision,"not supported, using",n,"instead.");let C=x.morphAttributes.position||x.morphAttributes.normal||x.morphAttributes.color,D=void 0!==C?C.length:0,E=0;if(void 0!==x.morphAttributes.position&&(E=1),void 0!==x.morphAttributes.normal&&(E=2),void 0!==x.morphAttributes.color&&(E=3),B){let a=i3[B];s=a.vertexShader,t=a.fragmentShader}else s=f.vertexShader,t=f.fragmentShader,i.update(f),u=i.getVertexShaderID(f),v=i.getFragmentShaderID(f);let F=a.getRenderTarget(),G=a.state.buffers.depth.getReversed(),H=!0===r.isInstancedMesh,K=!0===r.isBatchedMesh,M=!!f.map,N=!!f.matcap,O=!!z,P=!!f.aoMap,Q=!!f.lightMap,R=!!f.bumpMap,S=!!f.normalMap,T=!!f.displacementMap,U=!!f.emissiveMap,V=!!f.metalnessMap,W=!!f.roughnessMap,X=f.anisotropy>0,Y=f.clearcoat>0,Z=f.dispersion>0,$=f.iridescence>0,_=f.sheen>0,aa=f.transmission>0,ab=X&&!!f.anisotropyMap,ac=Y&&!!f.clearcoatMap,ad=Y&&!!f.clearcoatNormalMap,ae=Y&&!!f.clearcoatRoughnessMap,af=$&&!!f.iridescenceMap,ag=$&&!!f.iridescenceThicknessMap,ah=_&&!!f.sheenColorMap,ai=_&&!!f.sheenRoughnessMap,aj=!!f.specularMap,ak=!!f.specularColorMap,al=!!f.specularIntensityMap,am=aa&&!!f.transmissionMap,an=aa&&!!f.thicknessMap,ao=!!f.gradientMap,ap=!!f.alphaMap,aq=f.alphaTest>0,ar=!!f.alphaHash,as=!!f.extensions,au=at;f.toneMapped&&(null===F||!0===F.isXRRenderTarget)&&(au=a.toneMapping);let av={shaderID:B,shaderType:f.type,shaderName:f.name,vertexShader:s,fragmentShader:t,defines:f.defines,customVertexShaderID:u,customFragmentShaderID:v,isRawShaderMaterial:!0===f.isRawShaderMaterial,glslVersion:f.glslVersion,precision:n,batching:K,batchingColor:K&&null!==r._colorsTexture,instancing:H,instancingColor:H&&null!==r.instanceColor,instancingMorph:H&&null!==r.morphTexture,supportsVertexTextures:m,outputColorSpace:null===F?a.outputColorSpace:!0===F.isXRRenderTarget?F.texture.colorSpace:b_,alphaToCoverage:!!f.alphaToCoverage,map:M,matcap:N,envMap:O,envMapMode:O&&z.mapping,envMapCubeUVHeight:A,aoMap:P,lightMap:Q,bumpMap:R,normalMap:S,displacementMap:m&&T,emissiveMap:U,normalMapObjectSpace:S&&f.normalMapType===bY,normalMapTangentSpace:S&&f.normalMapType===bX,metalnessMap:V,roughnessMap:W,anisotropy:X,anisotropyMap:ab,clearcoat:Y,clearcoatMap:ac,clearcoatNormalMap:ad,clearcoatRoughnessMap:ae,dispersion:Z,iridescence:$,iridescenceMap:af,iridescenceThicknessMap:ag,sheen:_,sheenColorMap:ah,sheenRoughnessMap:ai,specularMap:aj,specularColorMap:ak,specularIntensityMap:al,transmission:aa,transmissionMap:am,thicknessMap:an,gradientMap:ao,opaque:!1===f.transparent&&f.blending===L&&!1===f.alphaToCoverage,alphaMap:ap,alphaTest:aq,alphaHash:ar,combine:f.combine,mapUv:M&&p(f.map.channel),aoMapUv:P&&p(f.aoMap.channel),lightMapUv:Q&&p(f.lightMap.channel),bumpMapUv:R&&p(f.bumpMap.channel),normalMapUv:S&&p(f.normalMap.channel),displacementMapUv:T&&p(f.displacementMap.channel),emissiveMapUv:U&&p(f.emissiveMap.channel),metalnessMapUv:V&&p(f.metalnessMap.channel),roughnessMapUv:W&&p(f.roughnessMap.channel),anisotropyMapUv:ab&&p(f.anisotropyMap.channel),clearcoatMapUv:ac&&p(f.clearcoatMap.channel),clearcoatNormalMapUv:ad&&p(f.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ae&&p(f.clearcoatRoughnessMap.channel),iridescenceMapUv:af&&p(f.iridescenceMap.channel),iridescenceThicknessMapUv:ag&&p(f.iridescenceThicknessMap.channel),sheenColorMapUv:ah&&p(f.sheenColorMap.channel),sheenRoughnessMapUv:ai&&p(f.sheenRoughnessMap.channel),specularMapUv:aj&&p(f.specularMap.channel),specularColorMapUv:ak&&p(f.specularColorMap.channel),specularIntensityMapUv:al&&p(f.specularIntensityMap.channel),transmissionMapUv:am&&p(f.transmissionMap.channel),thicknessMapUv:an&&p(f.thicknessMap.channel),alphaMapUv:ap&&p(f.alphaMap.channel),vertexTangents:!!x.attributes.tangent&&(S||X),vertexColors:f.vertexColors,vertexAlphas:!0===f.vertexColors&&!!x.attributes.color&&4===x.attributes.color.itemSize,pointsUvs:!0===r.isPoints&&!!x.attributes.uv&&(M||ap),fog:!!w,useFog:!0===f.fog,fogExp2:!!w&&w.isFogExp2,flatShading:!0===f.flatShading,sizeAttenuation:!0===f.sizeAttenuation,logarithmicDepthBuffer:l,reverseDepthBuffer:G,skinning:!0===r.isSkinnedMesh,morphTargets:void 0!==x.morphAttributes.position,morphNormals:void 0!==x.morphAttributes.normal,morphColors:void 0!==x.morphAttributes.color,morphTargetsCount:D,morphTextureStride:E,numDirLights:h.directional.length,numPointLights:h.point.length,numSpotLights:h.spot.length,numSpotLightMaps:h.spotLightMap.length,numRectAreaLights:h.rectArea.length,numHemiLights:h.hemi.length,numDirLightShadows:h.directionalShadowMap.length,numPointLightShadows:h.pointShadowMap.length,numSpotLightShadows:h.spotShadowMap.length,numSpotLightShadowsWithMaps:h.numSpotLightShadowsWithMaps,numLightProbes:h.numLightProbes,numClippingPlanes:g.numPlanes,numClipIntersection:g.numIntersection,dithering:f.dithering,shadowMapEnabled:a.shadowMap.enabled&&k.length>0,shadowMapType:a.shadowMap.type,toneMapping:au,decodeVideoTexture:M&&!0===f.map.isVideoTexture&&cG.getTransfer(f.map.colorSpace)===b1,decodeVideoTextureEmissive:U&&!0===f.emissiveMap.isVideoTexture&&cG.getTransfer(f.emissiveMap.colorSpace)===b1,premultipliedAlpha:f.premultipliedAlpha,doubleSided:f.side===J,flipSided:f.side===I,useDepthPacking:f.depthPacking>=0,depthPacking:f.depthPacking||0,index0AttributeName:f.index0AttributeName,extensionClipCullDistance:as&&!0===f.extensions.clipCullDistance&&d.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(as&&!0===f.extensions.multiDraw||K)&&d.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:d.has("KHR_parallel_shader_compile"),customProgramCacheKey:f.customProgramCacheKey()};return av.vertexUv1s=j.has(1),av.vertexUv2s=j.has(2),av.vertexUv3s=j.has(3),j.clear(),av},getProgramCacheKey:function(b){let c=[];if(b.shaderID?c.push(b.shaderID):(c.push(b.customVertexShaderID),c.push(b.customFragmentShaderID)),void 0!==b.defines)for(let a in b.defines)c.push(a),c.push(b.defines[a]);return!1===b.isRawShaderMaterial&&(q(c,b),r(c,b),c.push(a.outputColorSpace)),c.push(b.customProgramCacheKey),c.join()},getUniforms:function(a){let b,c=o[a.type];if(c){let a=i3[c];b=eL.clone(a.uniforms)}else b=a.uniforms;return b},acquireProgram:function(b,c){let d;for(let a=0,b=k.length;a<b;a++){let b=k[a];if(b.cacheKey===c){d=b,++d.usedTimes;break}}return void 0===d&&(d=new k3(a,c,b,f),k.push(d)),d},releaseProgram:function(a){if(0==--a.usedTimes){let b=k.indexOf(a);k[b]=k[k.length-1],k.pop(),a.destroy()}},releaseShaderCache:function(a){i.remove(a)},programs:k,dispose:function(){i.dispose()}}}function k8(){let a=new WeakMap;return{has:function(b){return a.has(b)},get:function(b){let c=a.get(b);return void 0===c&&(c={},a.set(b,c)),c},remove:function(b){a.delete(b)},update:function(b,c,d){a.get(b)[c]=d},dispose:function(){a=new WeakMap}}}function k9(a,b){return a.groupOrder!==b.groupOrder?a.groupOrder-b.groupOrder:a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.material.id!==b.material.id?a.material.id-b.material.id:a.z!==b.z?a.z-b.z:a.id-b.id}function la(a,b){return a.groupOrder!==b.groupOrder?a.groupOrder-b.groupOrder:a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?b.z-a.z:a.id-b.id}function lb(){let a=[],b=0,c=[],d=[],e=[];function f(){b=0,c.length=0,d.length=0,e.length=0}function g(c,d,e,f,g,h){let i=a[b];return void 0===i?(i={id:c.id,object:c,geometry:d,material:e,groupOrder:f,renderOrder:c.renderOrder,z:g,group:h},a[b]=i):(i.id=c.id,i.object=c,i.geometry=d,i.material=e,i.groupOrder=f,i.renderOrder=c.renderOrder,i.z=g,i.group=h),b++,i}function h(a,b,f,h,i,j){let k=g(a,b,f,h,i,j);f.transmission>0?d.push(k):!0===f.transparent?e.push(k):c.push(k)}function i(a,b,f,h,i,j){let k=g(a,b,f,h,i,j);f.transmission>0?d.unshift(k):!0===f.transparent?e.unshift(k):c.unshift(k)}function j(a,b){c.length>1&&c.sort(a||k9),d.length>1&&d.sort(b||la),e.length>1&&e.sort(b||la)}return{opaque:c,transmissive:d,transparent:e,init:f,push:h,unshift:i,finish:function(){for(let c=b,d=a.length;c<d;c++){let b=a[c];if(null===b.id)break;b.id=null,b.object=null,b.geometry=null,b.material=null,b.group=null}},sort:j}}function lc(){let a=new WeakMap;return{get:function(b,c){let d,e=a.get(b);return void 0===e?(d=new lb,a.set(b,[d])):c>=e.length?(d=new lb,e.push(d)):d=e[c],d},dispose:function(){a=new WeakMap}}}function ld(){let a={};return{get:function(b){let c;if(void 0!==a[b.id])return a[b.id];switch(b.type){case"DirectionalLight":c={direction:new cV,color:new d6};break;case"SpotLight":c={position:new cV,direction:new cV,color:new d6,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":c={position:new cV,color:new d6,distance:0,decay:0};break;case"HemisphereLight":c={direction:new cV,skyColor:new d6,groundColor:new d6};break;case"RectAreaLight":c={color:new d6,position:new cV,halfWidth:new cV,halfHeight:new cV}}return a[b.id]=c,c}}}function le(){let a={};return{get:function(b){let c;if(void 0!==a[b.id])return a[b.id];switch(b.type){case"DirectionalLight":case"SpotLight":c={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new cr};break;case"PointLight":c={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new cr,shadowCameraNear:1,shadowCameraFar:1e3}}return a[b.id]=c,c}}}let lf=0;function lg(a,b){return 2*!!b.castShadow-2*!!a.castShadow+ +!!b.map-!!a.map}function lh(a){let b=new ld,c=le(),d={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let a=0;a<9;a++)d.probe.push(new cV);let e=new cV,f=new dn,g=new dn;return{setup:function(e){let f=0,g=0,h=0;for(let a=0;a<9;a++)d.probe[a].set(0,0,0);let i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0;e.sort(lg);for(let a=0,t=e.length;a<t;a++){let t=e[a],u=t.color,v=t.intensity,w=t.distance,x=t.shadow&&t.shadow.map?t.shadow.map.texture:null;if(t.isAmbientLight)f+=u.r*v,g+=u.g*v,h+=u.b*v;else if(t.isLightProbe){for(let a=0;a<9;a++)d.probe[a].addScaledVector(t.sh.coefficients[a],v);s++}else if(t.isDirectionalLight){let a=b.get(t);if(a.color.copy(t.color).multiplyScalar(t.intensity),t.castShadow){let a=t.shadow,b=c.get(t);b.shadowIntensity=a.intensity,b.shadowBias=a.bias,b.shadowNormalBias=a.normalBias,b.shadowRadius=a.radius,b.shadowMapSize=a.mapSize,d.directionalShadow[i]=b,d.directionalShadowMap[i]=x,d.directionalShadowMatrix[i]=t.shadow.matrix,n++}d.directional[i]=a,i++}else if(t.isSpotLight){let a=b.get(t);a.position.setFromMatrixPosition(t.matrixWorld),a.color.copy(u).multiplyScalar(v),a.distance=w,a.coneCos=Math.cos(t.angle),a.penumbraCos=Math.cos(t.angle*(1-t.penumbra)),a.decay=t.decay,d.spot[k]=a;let e=t.shadow;if(t.map&&(d.spotLightMap[q]=t.map,q++,e.updateMatrices(t),t.castShadow&&r++),d.spotLightMatrix[k]=e.matrix,t.castShadow){let a=c.get(t);a.shadowIntensity=e.intensity,a.shadowBias=e.bias,a.shadowNormalBias=e.normalBias,a.shadowRadius=e.radius,a.shadowMapSize=e.mapSize,d.spotShadow[k]=a,d.spotShadowMap[k]=x,p++}k++}else if(t.isRectAreaLight){let a=b.get(t);a.color.copy(u).multiplyScalar(v),a.halfWidth.set(.5*t.width,0,0),a.halfHeight.set(0,.5*t.height,0),d.rectArea[l]=a,l++}else if(t.isPointLight){let a=b.get(t);if(a.color.copy(t.color).multiplyScalar(t.intensity),a.distance=t.distance,a.decay=t.decay,t.castShadow){let a=t.shadow,b=c.get(t);b.shadowIntensity=a.intensity,b.shadowBias=a.bias,b.shadowNormalBias=a.normalBias,b.shadowRadius=a.radius,b.shadowMapSize=a.mapSize,b.shadowCameraNear=a.camera.near,b.shadowCameraFar=a.camera.far,d.pointShadow[j]=b,d.pointShadowMap[j]=x,d.pointShadowMatrix[j]=t.shadow.matrix,o++}d.point[j]=a,j++}else if(t.isHemisphereLight){let a=b.get(t);a.skyColor.copy(t.color).multiplyScalar(v),a.groundColor.copy(t.groundColor).multiplyScalar(v),d.hemi[m]=a,m++}}l>0&&(!0===a.has("OES_texture_float_linear")?(d.rectAreaLTC1=i2.LTC_FLOAT_1,d.rectAreaLTC2=i2.LTC_FLOAT_2):(d.rectAreaLTC1=i2.LTC_HALF_1,d.rectAreaLTC2=i2.LTC_HALF_2)),d.ambient[0]=f,d.ambient[1]=g,d.ambient[2]=h;let t=d.hash;(t.directionalLength!==i||t.pointLength!==j||t.spotLength!==k||t.rectAreaLength!==l||t.hemiLength!==m||t.numDirectionalShadows!==n||t.numPointShadows!==o||t.numSpotShadows!==p||t.numSpotMaps!==q||t.numLightProbes!==s)&&(d.directional.length=i,d.spot.length=k,d.rectArea.length=l,d.point.length=j,d.hemi.length=m,d.directionalShadow.length=n,d.directionalShadowMap.length=n,d.pointShadow.length=o,d.pointShadowMap.length=o,d.spotShadow.length=p,d.spotShadowMap.length=p,d.directionalShadowMatrix.length=n,d.pointShadowMatrix.length=o,d.spotLightMatrix.length=p+q-r,d.spotLightMap.length=q,d.numSpotLightShadowsWithMaps=r,d.numLightProbes=s,t.directionalLength=i,t.pointLength=j,t.spotLength=k,t.rectAreaLength=l,t.hemiLength=m,t.numDirectionalShadows=n,t.numPointShadows=o,t.numSpotShadows=p,t.numSpotMaps=q,t.numLightProbes=s,d.version=lf++)},setupView:function(a,b){let c=0,h=0,i=0,j=0,k=0,l=b.matrixWorldInverse;for(let b=0,m=a.length;b<m;b++){let m=a[b];if(m.isDirectionalLight){let a=d.directional[c];a.direction.setFromMatrixPosition(m.matrixWorld),e.setFromMatrixPosition(m.target.matrixWorld),a.direction.sub(e),a.direction.transformDirection(l),c++}else if(m.isSpotLight){let a=d.spot[i];a.position.setFromMatrixPosition(m.matrixWorld),a.position.applyMatrix4(l),a.direction.setFromMatrixPosition(m.matrixWorld),e.setFromMatrixPosition(m.target.matrixWorld),a.direction.sub(e),a.direction.transformDirection(l),i++}else if(m.isRectAreaLight){let a=d.rectArea[j];a.position.setFromMatrixPosition(m.matrixWorld),a.position.applyMatrix4(l),g.identity(),f.copy(m.matrixWorld),f.premultiply(l),g.extractRotation(f),a.halfWidth.set(.5*m.width,0,0),a.halfHeight.set(0,.5*m.height,0),a.halfWidth.applyMatrix4(g),a.halfHeight.applyMatrix4(g),j++}else if(m.isPointLight){let a=d.point[h];a.position.setFromMatrixPosition(m.matrixWorld),a.position.applyMatrix4(l),h++}else if(m.isHemisphereLight){let a=d.hemi[k];a.direction.setFromMatrixPosition(m.matrixWorld),a.direction.transformDirection(l),k++}}},state:d}}function li(a){let b=new lh(a),c=[],d=[];function e(a){j.camera=a,c.length=0,d.length=0}function f(a){c.push(a)}function g(a){d.push(a)}function h(){b.setup(c)}function i(a){b.setupView(c,a)}let j={lightsArray:c,shadowsArray:d,camera:null,lights:b,transmissionRenderTarget:{}};return{init:e,state:j,setupLights:h,setupLightsView:i,pushLight:f,pushShadow:g}}function lj(a){let b=new WeakMap;return{get:function(c,d=0){let e,f=b.get(c);return void 0===f?(e=new li(a),b.set(c,[e])):d>=f.length?(e=new li(a),f.push(e)):e=f[d],e},dispose:function(){b=new WeakMap}}}let lk="void main() {\n	gl_Position = vec4( position, 1.0 );\n}",ll="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n	const float samples = float( VSM_SAMPLES );\n	float mean = 0.0;\n	float squared_mean = 0.0;\n	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n	for ( float i = 0.0; i < samples; i ++ ) {\n		float uvOffset = uvStart + i * uvStride;\n		#ifdef HORIZONTAL_PASS\n			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n			mean += distribution.x;\n			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n		#else\n			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n			mean += depth;\n			squared_mean += depth * depth;\n		#endif\n	}\n	mean = mean / samples;\n	squared_mean = squared_mean / samples;\n	float std_dev = sqrt( squared_mean - mean * mean );\n	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function lm(a,b,c){let d=new fO,e=new cr,f=new cr,g=new cP,h=new hZ({depthPacking:bW}),i=new h$,j={},k=c.maxTextureSize,l={[H]:I,[I]:H,[J]:J},m=new eO({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new cr},radius:{value:4}},vertexShader:lk,fragmentShader:ll}),n=m.clone();n.defines.HORIZONTAL_PASS=1;let o=new er;o.setAttribute("position",new eg(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let p=new eD(o,m),q=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=E;let r=this.type;function s(c,d){let f=b.update(p);m.defines.VSM_SAMPLES!==c.blurSamples&&(m.defines.VSM_SAMPLES=c.blurSamples,n.defines.VSM_SAMPLES=c.blurSamples,m.needsUpdate=!0,n.needsUpdate=!0),null===c.mapPass&&(c.mapPass=new cR(e.x,e.y)),m.uniforms.shadow_pass.value=c.map.texture,m.uniforms.resolution.value=c.mapSize,m.uniforms.radius.value=c.radius,a.setRenderTarget(c.mapPass),a.clear(),a.renderBufferDirect(d,null,f,m,p,null),n.uniforms.shadow_pass.value=c.mapPass.texture,n.uniforms.resolution.value=c.mapSize,n.uniforms.radius.value=c.radius,a.setRenderTarget(c.map),a.clear(),a.renderBufferDirect(d,null,f,n,p,null)}function t(b,c,d,e){let f=null,g=!0===d.isPointLight?b.customDistanceMaterial:b.customDepthMaterial;if(void 0!==g)f=g;else if(f=!0===d.isPointLight?i:h,a.localClippingEnabled&&!0===c.clipShadows&&Array.isArray(c.clippingPlanes)&&0!==c.clippingPlanes.length||c.displacementMap&&0!==c.displacementScale||c.alphaMap&&c.alphaTest>0||c.map&&c.alphaTest>0){let a=f.uuid,b=c.uuid,d=j[a];void 0===d&&(d={},j[a]=d);let e=d[b];void 0===e&&(e=f.clone(),d[b]=e,c.addEventListener("dispose",v)),f=e}return f.visible=c.visible,f.wireframe=c.wireframe,e===G?f.side=null!==c.shadowSide?c.shadowSide:c.side:f.side=null!==c.shadowSide?c.shadowSide:l[c.side],f.alphaMap=c.alphaMap,f.alphaTest=c.alphaTest,f.map=c.map,f.clipShadows=c.clipShadows,f.clippingPlanes=c.clippingPlanes,f.clipIntersection=c.clipIntersection,f.displacementMap=c.displacementMap,f.displacementScale=c.displacementScale,f.displacementBias=c.displacementBias,f.wireframeLinewidth=c.wireframeLinewidth,f.linewidth=c.linewidth,!0===d.isPointLight&&!0===f.isMeshDistanceMaterial&&(a.properties.get(f).light=d),f}function u(c,e,f,g,h){if(!1===c.visible)return;if(c.layers.test(e.layers)&&(c.isMesh||c.isLine||c.isPoints)&&(c.castShadow||c.receiveShadow&&h===G)&&(!c.frustumCulled||d.intersectsObject(c))){c.modelViewMatrix.multiplyMatrices(f.matrixWorldInverse,c.matrixWorld);let d=b.update(c),i=c.material;if(Array.isArray(i)){let b=d.groups;for(let j=0,k=b.length;j<k;j++){let k=b[j],l=i[k.materialIndex];if(l&&l.visible){let b=t(c,l,g,h);c.onBeforeShadow(a,c,e,f,d,b,k),a.renderBufferDirect(f,null,d,b,c,k),c.onAfterShadow(a,c,e,f,d,b,k)}}}else if(i.visible){let b=t(c,i,g,h);c.onBeforeShadow(a,c,e,f,d,b,null),a.renderBufferDirect(f,null,d,b,c,null),c.onAfterShadow(a,c,e,f,d,b,null)}}let i=c.children;for(let a=0,b=i.length;a<b;a++)u(i[a],e,f,g,h)}function v(a){for(let b in a.target.removeEventListener("dispose",v),j){let c=j[b],d=a.target.uuid;d in c&&(c[d].dispose(),delete c[d])}}this.render=function(b,c,h){if(!1===q.enabled||!1===q.autoUpdate&&!1===q.needsUpdate||0===b.length)return;let i=a.getRenderTarget(),j=a.getActiveCubeFace(),l=a.getActiveMipmapLevel(),m=a.state;m.setBlending(K),m.buffers.color.setClear(1,1,1,1),m.buffers.depth.setTest(!0),m.setScissorTest(!1);let n=r!==G&&this.type===G,o=r===G&&this.type!==G;for(let i=0,j=b.length;i<j;i++){let j=b[i],l=j.shadow;if(void 0===l){console.warn("THREE.WebGLShadowMap:",j,"has no shadow.");continue}if(!1===l.autoUpdate&&!1===l.needsUpdate)continue;e.copy(l.mapSize);let p=l.getFrameExtents();if(e.multiply(p),f.copy(l.mapSize),(e.x>k||e.y>k)&&(e.x>k&&(f.x=Math.floor(k/p.x),e.x=f.x*p.x,l.mapSize.x=f.x),e.y>k&&(f.y=Math.floor(k/p.y),e.y=f.y*p.y,l.mapSize.y=f.y)),null===l.map||!0===n||!0===o){let a=this.type!==G?{minFilter:aM,magFilter:aM}:{};null!==l.map&&l.map.dispose(),l.map=new cR(e.x,e.y,a),l.map.texture.name=j.name+".shadowMap",l.camera.updateProjectionMatrix()}a.setRenderTarget(l.map),a.clear();let q=l.getViewportCount();for(let a=0;a<q;a++){let b=l.getViewport(a);g.set(f.x*b.x,f.y*b.y,f.x*b.z,f.y*b.w),m.viewport(g),l.updateMatrices(j,a),d=l.getFrustum(),u(c,h,l.camera,j,this.type)}!0!==l.isPointLightShadow&&this.type===G&&s(l,h),l.needsUpdate=!1}r=this.type,q.needsUpdate=!1,a.setRenderTarget(i,j,l)}}let ln={[ai]:aj,[ak]:ao,[am]:ap,[al]:an,[aj]:ai,[ao]:ak,[ap]:am,[an]:al};function lo(a,b){function c(){let c=!1,d=!1,e=null,f=null,g=null;return{setReversed:function(a){if(d!==a){let a=b.get("EXT_clip_control");d?a.clipControlEXT(a.LOWER_LEFT_EXT,a.ZERO_TO_ONE_EXT):a.clipControlEXT(a.LOWER_LEFT_EXT,a.NEGATIVE_ONE_TO_ONE_EXT);let c=g;g=null,this.setClear(c)}d=a},getReversed:function(){return d},setTest:function(b){b?aB(a.DEPTH_TEST):aC(a.DEPTH_TEST)},setMask:function(b){e===b||c||(a.depthMask(b),e=b)},setFunc:function(b){if(d&&(b=ln[b]),f!==b){switch(b){case ai:a.depthFunc(a.NEVER);break;case aj:a.depthFunc(a.ALWAYS);break;case ak:a.depthFunc(a.LESS);break;case al:a.depthFunc(a.LEQUAL);break;case am:a.depthFunc(a.EQUAL);break;case an:a.depthFunc(a.GEQUAL);break;case ao:a.depthFunc(a.GREATER);break;case ap:a.depthFunc(a.NOTEQUAL);break;default:a.depthFunc(a.LEQUAL)}f=b}},setLocked:function(a){c=a},setClear:function(b){g!==b&&(d&&(b=1-b),a.clearDepth(b),g=b)},reset:function(){c=!1,e=null,f=null,g=null,d=!1}}}function d(){let b=!1,c=null,d=null,e=null,f=null,g=null,h=null,i=null,j=null;return{setTest:function(c){b||(c?aB(a.STENCIL_TEST):aC(a.STENCIL_TEST))},setMask:function(d){c===d||b||(a.stencilMask(d),c=d)},setFunc:function(b,c,g){(d!==b||e!==c||f!==g)&&(a.stencilFunc(b,c,g),d=b,e=c,f=g)},setOp:function(b,c,d){(g!==b||h!==c||i!==d)&&(a.stencilOp(b,c,d),g=b,h=c,i=d)},setLocked:function(a){b=a},setClear:function(b){j!==b&&(a.clearStencil(b),j=b)},reset:function(){b=!1,c=null,d=null,e=null,f=null,g=null,h=null,i=null,j=null}}}let e=new function(){let b=!1,c=new cP,d=null,e=new cP(0,0,0,0);return{setMask:function(c){d===c||b||(a.colorMask(c,c,c,c),d=c)},setLocked:function(a){b=a},setClear:function(b,d,f,g,h){!0===h&&(b*=g,d*=g,f*=g),c.set(b,d,f,g),!1===e.equals(c)&&(a.clearColor(b,d,f,g),e.copy(c))},reset:function(){b=!1,d=null,e.set(-1,0,0,0)}}},f=new c,g=new d,h=new WeakMap,i=new WeakMap,j={},k={},l=new WeakMap,m=[],n=null,o=!1,p=null,q=null,r=null,s=null,t=null,u=null,v=null,w=new d6(0,0,0),x=0,y=!1,z=null,A=null,E=null,F=null,G=null,H=a.getParameter(a.MAX_COMBINED_TEXTURE_IMAGE_UNITS),aq=!1,ar=0,as=a.getParameter(a.VERSION);-1!==as.indexOf("WebGL")?aq=(ar=parseFloat(/^WebGL (\d)/.exec(as)[1]))>=1:-1!==as.indexOf("OpenGL ES")&&(aq=(ar=parseFloat(/^OpenGL ES (\d)/.exec(as)[1]))>=2);let at=null,au={},av=a.getParameter(a.SCISSOR_BOX),aw=a.getParameter(a.VIEWPORT),ax=new cP().fromArray(av),ay=new cP().fromArray(aw);function az(b,c,d,e){let f=new Uint8Array(4),g=a.createTexture();a.bindTexture(b,g),a.texParameteri(b,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(b,a.TEXTURE_MAG_FILTER,a.NEAREST);for(let g=0;g<d;g++)b===a.TEXTURE_3D||b===a.TEXTURE_2D_ARRAY?a.texImage3D(c,0,a.RGBA,1,1,e,0,a.RGBA,a.UNSIGNED_BYTE,f):a.texImage2D(c+g,0,a.RGBA,1,1,0,a.RGBA,a.UNSIGNED_BYTE,f);return g}let aA={};function aB(b){!0!==j[b]&&(a.enable(b),j[b]=!0)}function aC(b){!1!==j[b]&&(a.disable(b),j[b]=!1)}function aD(b,c){return k[b]!==c&&(a.bindFramebuffer(b,c),k[b]=c,b===a.DRAW_FRAMEBUFFER&&(k[a.FRAMEBUFFER]=c),b===a.FRAMEBUFFER&&(k[a.DRAW_FRAMEBUFFER]=c),!0)}function aE(b,c){let d=m,e=!1;if(b){void 0===(d=l.get(c))&&(d=[],l.set(c,d));let f=b.textures;if(d.length!==f.length||d[0]!==a.COLOR_ATTACHMENT0){for(let b=0,c=f.length;b<c;b++)d[b]=a.COLOR_ATTACHMENT0+b;d.length=f.length,e=!0}}else d[0]!==a.BACK&&(d[0]=a.BACK,e=!0);e&&a.drawBuffers(d)}function aF(b){return n!==b&&(a.useProgram(b),n=b,!0)}aA[a.TEXTURE_2D]=az(a.TEXTURE_2D,a.TEXTURE_2D,1),aA[a.TEXTURE_CUBE_MAP]=az(a.TEXTURE_CUBE_MAP,a.TEXTURE_CUBE_MAP_POSITIVE_X,6),aA[a.TEXTURE_2D_ARRAY]=az(a.TEXTURE_2D_ARRAY,a.TEXTURE_2D_ARRAY,1,1),aA[a.TEXTURE_3D]=az(a.TEXTURE_3D,a.TEXTURE_3D,1,1),e.setClear(0,0,0,1),f.setClear(1),g.setClear(0),aB(a.DEPTH_TEST),f.setFunc(al),aK(!1),aL(C),aB(a.CULL_FACE),aI(K);let aG={[Q]:a.FUNC_ADD,[R]:a.FUNC_SUBTRACT,[S]:a.FUNC_REVERSE_SUBTRACT};aG[T]=a.MIN,aG[U]=a.MAX;let aH={[V]:a.ZERO,[W]:a.ONE,[X]:a.SRC_COLOR,[Z]:a.SRC_ALPHA,[ad]:a.SRC_ALPHA_SATURATE,[ab]:a.DST_COLOR,[_]:a.DST_ALPHA,[Y]:a.ONE_MINUS_SRC_COLOR,[$]:a.ONE_MINUS_SRC_ALPHA,[ac]:a.ONE_MINUS_DST_COLOR,[aa]:a.ONE_MINUS_DST_ALPHA,[ae]:a.CONSTANT_COLOR,[af]:a.ONE_MINUS_CONSTANT_COLOR,[ag]:a.CONSTANT_ALPHA,[ah]:a.ONE_MINUS_CONSTANT_ALPHA};function aI(b,c,d,e,f,g,h,i,j,k){if(b===K){!0===o&&(aC(a.BLEND),o=!1);return}if(!1===o&&(aB(a.BLEND),o=!0),b!==P){if(b!==p||k!==y){if((q!==Q||t!==Q)&&(a.blendEquation(a.FUNC_ADD),q=Q,t=Q),k)switch(b){case L:a.blendFuncSeparate(a.ONE,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);break;case M:a.blendFunc(a.ONE,a.ONE);break;case N:a.blendFuncSeparate(a.ZERO,a.ONE_MINUS_SRC_COLOR,a.ZERO,a.ONE);break;case O:a.blendFuncSeparate(a.ZERO,a.SRC_COLOR,a.ZERO,a.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",b)}else switch(b){case L:a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);break;case M:a.blendFunc(a.SRC_ALPHA,a.ONE);break;case N:a.blendFuncSeparate(a.ZERO,a.ONE_MINUS_SRC_COLOR,a.ZERO,a.ONE);break;case O:a.blendFunc(a.ZERO,a.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",b)}r=null,s=null,u=null,v=null,w.set(0,0,0),x=0,p=b,y=k}return}f=f||c,g=g||d,h=h||e,(c!==q||f!==t)&&(a.blendEquationSeparate(aG[c],aG[f]),q=c,t=f),(d!==r||e!==s||g!==u||h!==v)&&(a.blendFuncSeparate(aH[d],aH[e],aH[g],aH[h]),r=d,s=e,u=g,v=h),(!1===i.equals(w)||j!==x)&&(a.blendColor(i.r,i.g,i.b,j),w.copy(i),x=j),p=b,y=!1}function aJ(b,c){b.side===J?aC(a.CULL_FACE):aB(a.CULL_FACE);let d=b.side===I;c&&(d=!d),aK(d),b.blending===L&&!1===b.transparent?aI(K):aI(b.blending,b.blendEquation,b.blendSrc,b.blendDst,b.blendEquationAlpha,b.blendSrcAlpha,b.blendDstAlpha,b.blendColor,b.blendAlpha,b.premultipliedAlpha),f.setFunc(b.depthFunc),f.setTest(b.depthTest),f.setMask(b.depthWrite),e.setMask(b.colorWrite);let h=b.stencilWrite;g.setTest(h),h&&(g.setMask(b.stencilWriteMask),g.setFunc(b.stencilFunc,b.stencilRef,b.stencilFuncMask),g.setOp(b.stencilFail,b.stencilZFail,b.stencilZPass)),aM(b.polygonOffset,b.polygonOffsetFactor,b.polygonOffsetUnits),!0===b.alphaToCoverage?aB(a.SAMPLE_ALPHA_TO_COVERAGE):aC(a.SAMPLE_ALPHA_TO_COVERAGE)}function aK(b){z!==b&&(b?a.frontFace(a.CW):a.frontFace(a.CCW),z=b)}function aL(b){b!==B?(aB(a.CULL_FACE),b!==A&&(b===C?a.cullFace(a.BACK):b===D?a.cullFace(a.FRONT):a.cullFace(a.FRONT_AND_BACK))):aC(a.CULL_FACE),A=b}function aM(b,c,d){b?(aB(a.POLYGON_OFFSET_FILL),(F!==c||G!==d)&&(a.polygonOffset(c,d),F=c,G=d)):aC(a.POLYGON_OFFSET_FILL)}function aN(b){b?aB(a.SCISSOR_TEST):aC(a.SCISSOR_TEST)}function aO(){a.disable(a.BLEND),a.disable(a.CULL_FACE),a.disable(a.DEPTH_TEST),a.disable(a.POLYGON_OFFSET_FILL),a.disable(a.SCISSOR_TEST),a.disable(a.STENCIL_TEST),a.disable(a.SAMPLE_ALPHA_TO_COVERAGE),a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ONE,a.ZERO),a.blendFuncSeparate(a.ONE,a.ZERO,a.ONE,a.ZERO),a.blendColor(0,0,0,0),a.colorMask(!0,!0,!0,!0),a.clearColor(0,0,0,0),a.depthMask(!0),a.depthFunc(a.LESS),f.setReversed(!1),a.clearDepth(1),a.stencilMask(0xffffffff),a.stencilFunc(a.ALWAYS,0,0xffffffff),a.stencilOp(a.KEEP,a.KEEP,a.KEEP),a.clearStencil(0),a.cullFace(a.BACK),a.frontFace(a.CCW),a.polygonOffset(0,0),a.activeTexture(a.TEXTURE0),a.bindFramebuffer(a.FRAMEBUFFER,null),a.bindFramebuffer(a.DRAW_FRAMEBUFFER,null),a.bindFramebuffer(a.READ_FRAMEBUFFER,null),a.useProgram(null),a.lineWidth(1),a.scissor(0,0,a.canvas.width,a.canvas.height),a.viewport(0,0,a.canvas.width,a.canvas.height),j={},at=null,au={},k={},l=new WeakMap,m=[],n=null,o=!1,p=null,q=null,r=null,s=null,t=null,u=null,v=null,w=new d6(0,0,0),x=0,y=!1,z=null,A=null,E=null,F=null,G=null,ax.set(0,0,a.canvas.width,a.canvas.height),ay.set(0,0,a.canvas.width,a.canvas.height),e.reset(),f.reset(),g.reset()}return{buffers:{color:e,depth:f,stencil:g},enable:aB,disable:aC,bindFramebuffer:aD,drawBuffers:aE,useProgram:aF,setBlending:aI,setMaterial:aJ,setFlipSided:aK,setCullFace:aL,setLineWidth:function(b){b!==E&&(aq&&a.lineWidth(b),E=b)},setPolygonOffset:aM,setScissorTest:aN,activeTexture:function(b){void 0===b&&(b=a.TEXTURE0+H-1),at!==b&&(a.activeTexture(b),at=b)},bindTexture:function(b,c,d){void 0===d&&(d=null===at?a.TEXTURE0+H-1:at);let e=au[d];void 0===e&&(e={type:void 0,texture:void 0},au[d]=e),(e.type!==b||e.texture!==c)&&(at!==d&&(a.activeTexture(d),at=d),a.bindTexture(b,c||aA[b]),e.type=b,e.texture=c)},unbindTexture:function(){let b=au[at];void 0!==b&&void 0!==b.type&&(a.bindTexture(b.type,null),b.type=void 0,b.texture=void 0)},compressedTexImage2D:function(){try{a.compressedTexImage2D.apply(a,arguments)}catch(a){console.error("THREE.WebGLState:",a)}},compressedTexImage3D:function(){try{a.compressedTexImage3D.apply(a,arguments)}catch(a){console.error("THREE.WebGLState:",a)}},texImage2D:function(){try{a.texImage2D.apply(a,arguments)}catch(a){console.error("THREE.WebGLState:",a)}},texImage3D:function(){try{a.texImage3D.apply(a,arguments)}catch(a){console.error("THREE.WebGLState:",a)}},updateUBOMapping:function(b,c){let d=i.get(c);void 0===d&&(d=new WeakMap,i.set(c,d));let e=d.get(b);void 0===e&&(e=a.getUniformBlockIndex(c,b.name),d.set(b,e))},uniformBlockBinding:function(b,c){let d=i.get(c).get(b);h.get(c)!==d&&(a.uniformBlockBinding(c,d,b.__bindingPointIndex),h.set(c,d))},texStorage2D:function(){try{a.texStorage2D.apply(a,arguments)}catch(a){console.error("THREE.WebGLState:",a)}},texStorage3D:function(){try{a.texStorage3D.apply(a,arguments)}catch(a){console.error("THREE.WebGLState:",a)}},texSubImage2D:function(){try{a.texSubImage2D.apply(a,arguments)}catch(a){console.error("THREE.WebGLState:",a)}},texSubImage3D:function(){try{a.texSubImage3D.apply(a,arguments)}catch(a){console.error("THREE.WebGLState:",a)}},compressedTexSubImage2D:function(){try{a.compressedTexSubImage2D.apply(a,arguments)}catch(a){console.error("THREE.WebGLState:",a)}},compressedTexSubImage3D:function(){try{a.compressedTexSubImage3D.apply(a,arguments)}catch(a){console.error("THREE.WebGLState:",a)}},scissor:function(b){!1===ax.equals(b)&&(a.scissor(b.x,b.y,b.z,b.w),ax.copy(b))},viewport:function(b){!1===ay.equals(b)&&(a.viewport(b.x,b.y,b.z,b.w),ay.copy(b))},reset:aO}}function lp(a,b,c,d,e,f,g){let h,i=b.has("WEBGL_multisampled_render_to_texture")?b.get("WEBGL_multisampled_render_to_texture"):null,j="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),k=new cr,l=new WeakMap,m=new WeakMap,n=!1;try{n="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(a){}function o(a,b){return n?new OffscreenCanvas(a,b):cx("canvas")}function p(a,b,c){let d=1,e=ac(a);if((e.width>c||e.height>c)&&(d=c/Math.max(e.width,e.height)),d<1)if("undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&a instanceof ImageBitmap||"undefined"!=typeof VideoFrame&&a instanceof VideoFrame){let c=Math.floor(d*e.width),f=Math.floor(d*e.height);void 0===h&&(h=o(c,f));let g=b?o(c,f):h;return g.width=c,g.height=f,g.getContext("2d").drawImage(a,0,0,c,f),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+c+"x"+f+")."),g}else"data"in a&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+").");return a}function q(a){return a.generateMipmaps}function r(b){a.generateMipmap(b)}function s(b){return b.isWebGLCubeRenderTarget?a.TEXTURE_CUBE_MAP:b.isWebGL3DRenderTarget?a.TEXTURE_3D:b.isWebGLArrayRenderTarget||b.isCompressedArrayTexture?a.TEXTURE_2D_ARRAY:a.TEXTURE_2D}function t(c,d,e,f,g=!1){if(null!==c){if(void 0!==a[c])return a[c];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+c+"'")}let h=d;if(d===a.RED&&(e===a.FLOAT&&(h=a.R32F),e===a.HALF_FLOAT&&(h=a.R16F),e===a.UNSIGNED_BYTE&&(h=a.R8)),d===a.RED_INTEGER&&(e===a.UNSIGNED_BYTE&&(h=a.R8UI),e===a.UNSIGNED_SHORT&&(h=a.R16UI),e===a.UNSIGNED_INT&&(h=a.R32UI),e===a.BYTE&&(h=a.R8I),e===a.SHORT&&(h=a.R16I),e===a.INT&&(h=a.R32I)),d===a.RG&&(e===a.FLOAT&&(h=a.RG32F),e===a.HALF_FLOAT&&(h=a.RG16F),e===a.UNSIGNED_BYTE&&(h=a.RG8)),d===a.RG_INTEGER&&(e===a.UNSIGNED_BYTE&&(h=a.RG8UI),e===a.UNSIGNED_SHORT&&(h=a.RG16UI),e===a.UNSIGNED_INT&&(h=a.RG32UI),e===a.BYTE&&(h=a.RG8I),e===a.SHORT&&(h=a.RG16I),e===a.INT&&(h=a.RG32I)),d===a.RGB_INTEGER&&(e===a.UNSIGNED_BYTE&&(h=a.RGB8UI),e===a.UNSIGNED_SHORT&&(h=a.RGB16UI),e===a.UNSIGNED_INT&&(h=a.RGB32UI),e===a.BYTE&&(h=a.RGB8I),e===a.SHORT&&(h=a.RGB16I),e===a.INT&&(h=a.RGB32I)),d===a.RGBA_INTEGER&&(e===a.UNSIGNED_BYTE&&(h=a.RGBA8UI),e===a.UNSIGNED_SHORT&&(h=a.RGBA16UI),e===a.UNSIGNED_INT&&(h=a.RGBA32UI),e===a.BYTE&&(h=a.RGBA8I),e===a.SHORT&&(h=a.RGBA16I),e===a.INT&&(h=a.RGBA32I)),d===a.RGB&&e===a.UNSIGNED_INT_5_9_9_9_REV&&(h=a.RGB9_E5),d===a.RGBA){let b=g?b0:cG.getTransfer(f);e===a.FLOAT&&(h=a.RGBA32F),e===a.HALF_FLOAT&&(h=a.RGBA16F),e===a.UNSIGNED_BYTE&&(h=b===b1?a.SRGB8_ALPHA8:a.RGBA8),e===a.UNSIGNED_SHORT_4_4_4_4&&(h=a.RGBA4),e===a.UNSIGNED_SHORT_5_5_5_1&&(h=a.RGB5_A1)}return(h===a.R16F||h===a.R32F||h===a.RG16F||h===a.RG32F||h===a.RGBA16F||h===a.RGBA32F)&&b.get("EXT_color_buffer_float"),h}function u(b,c){let d;return b?null===c||c===aX||c===a0?d=a.DEPTH24_STENCIL8:c===aY?d=a.DEPTH32F_STENCIL8:c===aV&&(d=a.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===c||c===aX||c===a0?d=a.DEPTH_COMPONENT24:c===aY?d=a.DEPTH_COMPONENT32F:c===aV&&(d=a.DEPTH_COMPONENT16),d}function v(a,b){return!0===q(a)||a.isFramebufferTexture&&a.minFilter!==aM&&a.minFilter!==aP?Math.log2(Math.max(b.width,b.height))+1:void 0!==a.mipmaps&&a.mipmaps.length>0?a.mipmaps.length:a.isCompressedTexture&&Array.isArray(a.image)?b.mipmaps.length:1}function w(a){let b=a.target;b.removeEventListener("dispose",w),y(b),b.isVideoTexture&&l.delete(b)}function x(a){let b=a.target;b.removeEventListener("dispose",x),A(b)}function y(a){let b=d.get(a);if(void 0===b.__webglInit)return;let c=a.source,e=m.get(c);if(e){let d=e[b.__cacheKey];d.usedTimes--,0===d.usedTimes&&z(a),0===Object.keys(e).length&&m.delete(c)}d.remove(a)}function z(b){let c=d.get(b);a.deleteTexture(c.__webglTexture);let e=b.source,f=m.get(e);delete f[c.__cacheKey],g.memory.textures--}function A(b){let c=d.get(b);if(b.depthTexture&&(b.depthTexture.dispose(),d.remove(b.depthTexture)),b.isWebGLCubeRenderTarget)for(let b=0;b<6;b++){if(Array.isArray(c.__webglFramebuffer[b]))for(let d=0;d<c.__webglFramebuffer[b].length;d++)a.deleteFramebuffer(c.__webglFramebuffer[b][d]);else a.deleteFramebuffer(c.__webglFramebuffer[b]);c.__webglDepthbuffer&&a.deleteRenderbuffer(c.__webglDepthbuffer[b])}else{if(Array.isArray(c.__webglFramebuffer))for(let b=0;b<c.__webglFramebuffer.length;b++)a.deleteFramebuffer(c.__webglFramebuffer[b]);else a.deleteFramebuffer(c.__webglFramebuffer);if(c.__webglDepthbuffer&&a.deleteRenderbuffer(c.__webglDepthbuffer),c.__webglMultisampledFramebuffer&&a.deleteFramebuffer(c.__webglMultisampledFramebuffer),c.__webglColorRenderbuffer)for(let b=0;b<c.__webglColorRenderbuffer.length;b++)c.__webglColorRenderbuffer[b]&&a.deleteRenderbuffer(c.__webglColorRenderbuffer[b]);c.__webglDepthRenderbuffer&&a.deleteRenderbuffer(c.__webglDepthRenderbuffer)}let e=b.textures;for(let b=0,c=e.length;b<c;b++){let c=d.get(e[b]);c.__webglTexture&&(a.deleteTexture(c.__webglTexture),g.memory.textures--),d.remove(e[b])}d.remove(b)}let B=0;function C(){B=0}function D(){let a=B;return a>=e.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+a+" texture units while this GPU supports only "+e.maxTextures),B+=1,a}function E(a){let b=[];return b.push(a.wrapS),b.push(a.wrapT),b.push(a.wrapR||0),b.push(a.magFilter),b.push(a.minFilter),b.push(a.anisotropy),b.push(a.internalFormat),b.push(a.format),b.push(a.type),b.push(a.generateMipmaps),b.push(a.premultiplyAlpha),b.push(a.flipY),b.push(a.unpackAlignment),b.push(a.colorSpace),b.join()}function F(b,e){let f=d.get(b);if(b.isVideoTexture&&aa(b),!1===b.isRenderTargetTexture&&b.version>0&&f.__version!==b.version){let a=b.image;if(null===a)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==a.complete)return void O(f,b,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}c.bindTexture(a.TEXTURE_2D,f.__webglTexture,a.TEXTURE0+e)}function G(b,e){let f=d.get(b);if(b.version>0&&f.__version!==b.version)return void O(f,b,e);c.bindTexture(a.TEXTURE_2D_ARRAY,f.__webglTexture,a.TEXTURE0+e)}function H(b,e){let f=d.get(b);if(b.version>0&&f.__version!==b.version)return void O(f,b,e);c.bindTexture(a.TEXTURE_3D,f.__webglTexture,a.TEXTURE0+e)}function I(b,e){let f=d.get(b);if(b.version>0&&f.__version!==b.version)return void P(f,b,e);c.bindTexture(a.TEXTURE_CUBE_MAP,f.__webglTexture,a.TEXTURE0+e)}let J={[aJ]:a.REPEAT,[aK]:a.CLAMP_TO_EDGE,[aL]:a.MIRRORED_REPEAT},K={[aM]:a.NEAREST,[aN]:a.NEAREST_MIPMAP_NEAREST,[aO]:a.NEAREST_MIPMAP_LINEAR,[aP]:a.LINEAR,[aQ]:a.LINEAR_MIPMAP_NEAREST,[aR]:a.LINEAR_MIPMAP_LINEAR},L={[b4]:a.NEVER,[cb]:a.ALWAYS,[b5]:a.LESS,[b7]:a.LEQUAL,[b6]:a.EQUAL,[ca]:a.GEQUAL,[b8]:a.GREATER,[b9]:a.NOTEQUAL};function M(c,f){if((f.type===aY&&!1===b.has("OES_texture_float_linear")&&(f.magFilter===aP||f.magFilter===aQ||f.magFilter===aO||f.magFilter===aR||f.minFilter===aP||f.minFilter===aQ||f.minFilter===aO||f.minFilter===aR)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),a.texParameteri(c,a.TEXTURE_WRAP_S,J[f.wrapS]),a.texParameteri(c,a.TEXTURE_WRAP_T,J[f.wrapT]),(c===a.TEXTURE_3D||c===a.TEXTURE_2D_ARRAY)&&a.texParameteri(c,a.TEXTURE_WRAP_R,J[f.wrapR]),a.texParameteri(c,a.TEXTURE_MAG_FILTER,K[f.magFilter]),a.texParameteri(c,a.TEXTURE_MIN_FILTER,K[f.minFilter]),f.compareFunction&&(a.texParameteri(c,a.TEXTURE_COMPARE_MODE,a.COMPARE_REF_TO_TEXTURE),a.texParameteri(c,a.TEXTURE_COMPARE_FUNC,L[f.compareFunction])),!0===b.has("EXT_texture_filter_anisotropic"))&&f.magFilter!==aM&&(f.minFilter===aO||f.minFilter===aR)&&(f.type!==aY||!1!==b.has("OES_texture_float_linear"))&&(f.anisotropy>1||d.get(f).__currentAnisotropy)){let g=b.get("EXT_texture_filter_anisotropic");a.texParameterf(c,g.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(f.anisotropy,e.getMaxAnisotropy())),d.get(f).__currentAnisotropy=f.anisotropy}}function N(b,c){let d=!1;void 0===b.__webglInit&&(b.__webglInit=!0,c.addEventListener("dispose",w));let e=c.source,f=m.get(e);void 0===f&&(f={},m.set(e,f));let h=E(c);if(h!==b.__cacheKey){void 0===f[h]&&(f[h]={texture:a.createTexture(),usedTimes:0},g.memory.textures++,d=!0),f[h].usedTimes++;let e=f[b.__cacheKey];void 0!==e&&(f[b.__cacheKey].usedTimes--,0===e.usedTimes&&z(c)),b.__cacheKey=h,b.__webglTexture=f[h].texture}return d}function O(b,g,h){let i=a.TEXTURE_2D;(g.isDataArrayTexture||g.isCompressedArrayTexture)&&(i=a.TEXTURE_2D_ARRAY),g.isData3DTexture&&(i=a.TEXTURE_3D);let j=N(b,g),k=g.source;c.bindTexture(i,b.__webglTexture,a.TEXTURE0+h);let l=d.get(k);if(k.version!==l.__version||!0===j){let b;c.activeTexture(a.TEXTURE0+h);let d=cG.getPrimaries(cG.workingColorSpace),m=g.colorSpace===bZ?null:cG.getPrimaries(g.colorSpace),n=g.colorSpace===bZ||d===m?a.NONE:a.BROWSER_DEFAULT_WEBGL;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,g.flipY),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,g.premultiplyAlpha),a.pixelStorei(a.UNPACK_ALIGNMENT,g.unpackAlignment),a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,n);let o=p(g.image,!1,e.maxTextureSize);o=ab(g,o);let s=f.convert(g.format,g.colorSpace),w=f.convert(g.type),x=t(g.internalFormat,s,w,g.colorSpace,g.isVideoTexture);M(i,g);let y=g.mipmaps,z=!0!==g.isVideoTexture,A=void 0===l.__version||!0===j,B=k.dataReady,C=v(g,o);if(g.isDepthTexture)x=u(g.format===a8,g.type),A&&(z?c.texStorage2D(a.TEXTURE_2D,1,x,o.width,o.height):c.texImage2D(a.TEXTURE_2D,0,x,o.width,o.height,0,s,w,null));else if(g.isDataTexture)if(y.length>0){z&&A&&c.texStorage2D(a.TEXTURE_2D,C,x,y[0].width,y[0].height);for(let d=0,e=y.length;d<e;d++)b=y[d],z?B&&c.texSubImage2D(a.TEXTURE_2D,d,0,0,b.width,b.height,s,w,b.data):c.texImage2D(a.TEXTURE_2D,d,x,b.width,b.height,0,s,w,b.data);g.generateMipmaps=!1}else z?(A&&c.texStorage2D(a.TEXTURE_2D,C,x,o.width,o.height),B&&c.texSubImage2D(a.TEXTURE_2D,0,0,0,o.width,o.height,s,w,o.data)):c.texImage2D(a.TEXTURE_2D,0,x,o.width,o.height,0,s,w,o.data);else if(g.isCompressedTexture)if(g.isCompressedArrayTexture){z&&A&&c.texStorage3D(a.TEXTURE_2D_ARRAY,C,x,y[0].width,y[0].height,o.depth);for(let d=0,e=y.length;d<e;d++)if(b=y[d],g.format!==a4)if(null!==s)if(z){if(B)if(g.layerUpdates.size>0){let e=iZ(b.width,b.height,g.format,g.type);for(let f of g.layerUpdates){let g=b.data.subarray(f*e/b.data.BYTES_PER_ELEMENT,(f+1)*e/b.data.BYTES_PER_ELEMENT);c.compressedTexSubImage3D(a.TEXTURE_2D_ARRAY,d,0,0,f,b.width,b.height,1,s,g)}g.clearLayerUpdates()}else c.compressedTexSubImage3D(a.TEXTURE_2D_ARRAY,d,0,0,0,b.width,b.height,o.depth,s,b.data)}else c.compressedTexImage3D(a.TEXTURE_2D_ARRAY,d,x,b.width,b.height,o.depth,0,b.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else z?B&&c.texSubImage3D(a.TEXTURE_2D_ARRAY,d,0,0,0,b.width,b.height,o.depth,s,w,b.data):c.texImage3D(a.TEXTURE_2D_ARRAY,d,x,b.width,b.height,o.depth,0,s,w,b.data)}else{z&&A&&c.texStorage2D(a.TEXTURE_2D,C,x,y[0].width,y[0].height);for(let d=0,e=y.length;d<e;d++)b=y[d],g.format!==a4?null!==s?z?B&&c.compressedTexSubImage2D(a.TEXTURE_2D,d,0,0,b.width,b.height,s,b.data):c.compressedTexImage2D(a.TEXTURE_2D,d,x,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):z?B&&c.texSubImage2D(a.TEXTURE_2D,d,0,0,b.width,b.height,s,w,b.data):c.texImage2D(a.TEXTURE_2D,d,x,b.width,b.height,0,s,w,b.data)}else if(g.isDataArrayTexture)if(z){if(A&&c.texStorage3D(a.TEXTURE_2D_ARRAY,C,x,o.width,o.height,o.depth),B)if(g.layerUpdates.size>0){let b=iZ(o.width,o.height,g.format,g.type);for(let d of g.layerUpdates){let e=o.data.subarray(d*b/o.data.BYTES_PER_ELEMENT,(d+1)*b/o.data.BYTES_PER_ELEMENT);c.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,d,o.width,o.height,1,s,w,e)}g.clearLayerUpdates()}else c.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,0,o.width,o.height,o.depth,s,w,o.data)}else c.texImage3D(a.TEXTURE_2D_ARRAY,0,x,o.width,o.height,o.depth,0,s,w,o.data);else if(g.isData3DTexture)z?(A&&c.texStorage3D(a.TEXTURE_3D,C,x,o.width,o.height,o.depth),B&&c.texSubImage3D(a.TEXTURE_3D,0,0,0,0,o.width,o.height,o.depth,s,w,o.data)):c.texImage3D(a.TEXTURE_3D,0,x,o.width,o.height,o.depth,0,s,w,o.data);else if(g.isFramebufferTexture){if(A)if(z)c.texStorage2D(a.TEXTURE_2D,C,x,o.width,o.height);else{let b=o.width,d=o.height;for(let e=0;e<C;e++)c.texImage2D(a.TEXTURE_2D,e,x,b,d,0,s,w,null),b>>=1,d>>=1}}else if(y.length>0){if(z&&A){let b=ac(y[0]);c.texStorage2D(a.TEXTURE_2D,C,x,b.width,b.height)}for(let d=0,e=y.length;d<e;d++)b=y[d],z?B&&c.texSubImage2D(a.TEXTURE_2D,d,0,0,s,w,b):c.texImage2D(a.TEXTURE_2D,d,x,s,w,b);g.generateMipmaps=!1}else if(z){if(A){let b=ac(o);c.texStorage2D(a.TEXTURE_2D,C,x,b.width,b.height)}B&&c.texSubImage2D(a.TEXTURE_2D,0,0,0,s,w,o)}else c.texImage2D(a.TEXTURE_2D,0,x,s,w,o);q(g)&&r(i),l.__version=k.version,g.onUpdate&&g.onUpdate(g)}b.__version=g.version}function P(b,g,h){if(6!==g.image.length)return;let i=N(b,g),j=g.source;c.bindTexture(a.TEXTURE_CUBE_MAP,b.__webglTexture,a.TEXTURE0+h);let k=d.get(j);if(j.version!==k.__version||!0===i){let b;c.activeTexture(a.TEXTURE0+h);let d=cG.getPrimaries(cG.workingColorSpace),l=g.colorSpace===bZ?null:cG.getPrimaries(g.colorSpace),m=g.colorSpace===bZ||d===l?a.NONE:a.BROWSER_DEFAULT_WEBGL;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,g.flipY),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,g.premultiplyAlpha),a.pixelStorei(a.UNPACK_ALIGNMENT,g.unpackAlignment),a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,m);let n=g.isCompressedTexture||g.image[0].isCompressedTexture,o=g.image[0]&&g.image[0].isDataTexture,s=[];for(let a=0;a<6;a++)n||o?s[a]=o?g.image[a].image:g.image[a]:s[a]=p(g.image[a],!0,e.maxCubemapSize),s[a]=ab(g,s[a]);let u=s[0],w=f.convert(g.format,g.colorSpace),x=f.convert(g.type),y=t(g.internalFormat,w,x,g.colorSpace),z=!0!==g.isVideoTexture,A=void 0===k.__version||!0===i,B=j.dataReady,C=v(g,u);if(M(a.TEXTURE_CUBE_MAP,g),n){z&&A&&c.texStorage2D(a.TEXTURE_CUBE_MAP,C,y,u.width,u.height);for(let d=0;d<6;d++){b=s[d].mipmaps;for(let e=0;e<b.length;e++){let f=b[e];g.format!==a4?null!==w?z?B&&c.compressedTexSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+d,e,0,0,f.width,f.height,w,f.data):c.compressedTexImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+d,e,y,f.width,f.height,0,f.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):z?B&&c.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+d,e,0,0,f.width,f.height,w,x,f.data):c.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+d,e,y,f.width,f.height,0,w,x,f.data)}}}else{if(b=g.mipmaps,z&&A){b.length>0&&C++;let d=ac(s[0]);c.texStorage2D(a.TEXTURE_CUBE_MAP,C,y,d.width,d.height)}for(let d=0;d<6;d++)if(o){z?B&&c.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+d,0,0,0,s[d].width,s[d].height,w,x,s[d].data):c.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+d,0,y,s[d].width,s[d].height,0,w,x,s[d].data);for(let e=0;e<b.length;e++){let f=b[e].image[d].image;z?B&&c.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+d,e+1,0,0,f.width,f.height,w,x,f.data):c.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+d,e+1,y,f.width,f.height,0,w,x,f.data)}}else{z?B&&c.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+d,0,0,0,w,x,s[d]):c.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+d,0,y,w,x,s[d]);for(let e=0;e<b.length;e++){let f=b[e];z?B&&c.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+d,e+1,0,0,w,x,f.image[d]):c.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+d,e+1,y,w,x,f.image[d])}}}q(g)&&r(a.TEXTURE_CUBE_MAP),k.__version=j.version,g.onUpdate&&g.onUpdate(g)}b.__version=g.version}function Q(b,e,g,h,j,k){let l=f.convert(g.format,g.colorSpace),m=f.convert(g.type),n=t(g.internalFormat,l,m,g.colorSpace),o=d.get(e),p=d.get(g);if(p.__renderTarget=e,!o.__hasExternalTextures){let b=Math.max(1,e.width>>k),d=Math.max(1,e.height>>k);j===a.TEXTURE_3D||j===a.TEXTURE_2D_ARRAY?c.texImage3D(j,k,n,b,d,e.depth,0,l,m,null):c.texImage2D(j,k,n,b,d,0,l,m,null)}c.bindFramebuffer(a.FRAMEBUFFER,b),_(e)?i.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,h,j,p.__webglTexture,0,$(e)):(j===a.TEXTURE_2D||j>=a.TEXTURE_CUBE_MAP_POSITIVE_X&&j<=a.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&a.framebufferTexture2D(a.FRAMEBUFFER,h,j,p.__webglTexture,k),c.bindFramebuffer(a.FRAMEBUFFER,null)}function R(b,c,d){if(a.bindRenderbuffer(a.RENDERBUFFER,b),c.depthBuffer){let e=c.depthTexture,f=e&&e.isDepthTexture?e.type:null,g=u(c.stencilBuffer,f),h=c.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT,j=$(c);_(c)?i.renderbufferStorageMultisampleEXT(a.RENDERBUFFER,j,g,c.width,c.height):d?a.renderbufferStorageMultisample(a.RENDERBUFFER,j,g,c.width,c.height):a.renderbufferStorage(a.RENDERBUFFER,g,c.width,c.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,h,a.RENDERBUFFER,b)}else{let b=c.textures;for(let e=0;e<b.length;e++){let g=b[e],h=f.convert(g.format,g.colorSpace),j=f.convert(g.type),k=t(g.internalFormat,h,j,g.colorSpace),l=$(c);d&&!1===_(c)?a.renderbufferStorageMultisample(a.RENDERBUFFER,l,k,c.width,c.height):_(c)?i.renderbufferStorageMultisampleEXT(a.RENDERBUFFER,l,k,c.width,c.height):a.renderbufferStorage(a.RENDERBUFFER,k,c.width,c.height)}}a.bindRenderbuffer(a.RENDERBUFFER,null)}function S(b,e){if(e&&e.isWebGLCubeRenderTarget)throw Error("Depth Texture with cube render targets is not supported");if(c.bindFramebuffer(a.FRAMEBUFFER,b),!(e.depthTexture&&e.depthTexture.isDepthTexture))throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");let f=d.get(e.depthTexture);f.__renderTarget=e,f.__webglTexture&&e.depthTexture.image.width===e.width&&e.depthTexture.image.height===e.height||(e.depthTexture.image.width=e.width,e.depthTexture.image.height=e.height,e.depthTexture.needsUpdate=!0),F(e.depthTexture,0);let g=f.__webglTexture,h=$(e);if(e.depthTexture.format===a7)_(e)?i.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.TEXTURE_2D,g,0,h):a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.TEXTURE_2D,g,0);else if(e.depthTexture.format===a8)_(e)?i.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,g,0,h):a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,g,0);else throw Error("Unknown depthTexture format")}function T(b){let e=d.get(b),f=!0===b.isWebGLCubeRenderTarget;if(e.__boundDepthTexture!==b.depthTexture){let a=b.depthTexture;if(e.__depthDisposeCallback&&e.__depthDisposeCallback(),a){let b=()=>{delete e.__boundDepthTexture,delete e.__depthDisposeCallback,a.removeEventListener("dispose",b)};a.addEventListener("dispose",b),e.__depthDisposeCallback=b}e.__boundDepthTexture=a}if(b.depthTexture&&!e.__autoAllocateDepthBuffer){if(f)throw Error("target.depthTexture not supported in Cube render targets");S(e.__webglFramebuffer,b)}else if(f){e.__webglDepthbuffer=[];for(let d=0;d<6;d++)if(c.bindFramebuffer(a.FRAMEBUFFER,e.__webglFramebuffer[d]),void 0===e.__webglDepthbuffer[d])e.__webglDepthbuffer[d]=a.createRenderbuffer(),R(e.__webglDepthbuffer[d],b,!1);else{let c=b.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT,f=e.__webglDepthbuffer[d];a.bindRenderbuffer(a.RENDERBUFFER,f),a.framebufferRenderbuffer(a.FRAMEBUFFER,c,a.RENDERBUFFER,f)}}else if(c.bindFramebuffer(a.FRAMEBUFFER,e.__webglFramebuffer),void 0===e.__webglDepthbuffer)e.__webglDepthbuffer=a.createRenderbuffer(),R(e.__webglDepthbuffer,b,!1);else{let c=b.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT,d=e.__webglDepthbuffer;a.bindRenderbuffer(a.RENDERBUFFER,d),a.framebufferRenderbuffer(a.FRAMEBUFFER,c,a.RENDERBUFFER,d)}c.bindFramebuffer(a.FRAMEBUFFER,null)}function U(b,c,e){let f=d.get(b);void 0!==c&&Q(f.__webglFramebuffer,b,b.texture,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,0),void 0!==e&&T(b)}function V(b){let e=b.texture,h=d.get(b),i=d.get(e);b.addEventListener("dispose",x);let j=b.textures,k=!0===b.isWebGLCubeRenderTarget,l=j.length>1;if(!l&&(void 0===i.__webglTexture&&(i.__webglTexture=a.createTexture()),i.__version=e.version,g.memory.textures++),k){h.__webglFramebuffer=[];for(let b=0;b<6;b++)if(e.mipmaps&&e.mipmaps.length>0){h.__webglFramebuffer[b]=[];for(let c=0;c<e.mipmaps.length;c++)h.__webglFramebuffer[b][c]=a.createFramebuffer()}else h.__webglFramebuffer[b]=a.createFramebuffer()}else{if(e.mipmaps&&e.mipmaps.length>0){h.__webglFramebuffer=[];for(let b=0;b<e.mipmaps.length;b++)h.__webglFramebuffer[b]=a.createFramebuffer()}else h.__webglFramebuffer=a.createFramebuffer();if(l)for(let b=0,c=j.length;b<c;b++){let c=d.get(j[b]);void 0===c.__webglTexture&&(c.__webglTexture=a.createTexture(),g.memory.textures++)}if(b.samples>0&&!1===_(b)){h.__webglMultisampledFramebuffer=a.createFramebuffer(),h.__webglColorRenderbuffer=[],c.bindFramebuffer(a.FRAMEBUFFER,h.__webglMultisampledFramebuffer);for(let c=0;c<j.length;c++){let d=j[c];h.__webglColorRenderbuffer[c]=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,h.__webglColorRenderbuffer[c]);let e=f.convert(d.format,d.colorSpace),g=f.convert(d.type),i=t(d.internalFormat,e,g,d.colorSpace,!0===b.isXRRenderTarget),k=$(b);a.renderbufferStorageMultisample(a.RENDERBUFFER,k,i,b.width,b.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+c,a.RENDERBUFFER,h.__webglColorRenderbuffer[c])}a.bindRenderbuffer(a.RENDERBUFFER,null),b.depthBuffer&&(h.__webglDepthRenderbuffer=a.createRenderbuffer(),R(h.__webglDepthRenderbuffer,b,!0)),c.bindFramebuffer(a.FRAMEBUFFER,null)}}if(k){c.bindTexture(a.TEXTURE_CUBE_MAP,i.__webglTexture),M(a.TEXTURE_CUBE_MAP,e);for(let c=0;c<6;c++)if(e.mipmaps&&e.mipmaps.length>0)for(let d=0;d<e.mipmaps.length;d++)Q(h.__webglFramebuffer[c][d],b,e,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+c,d);else Q(h.__webglFramebuffer[c],b,e,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+c,0);q(e)&&r(a.TEXTURE_CUBE_MAP),c.unbindTexture()}else if(l){for(let e=0,f=j.length;e<f;e++){let f=j[e],g=d.get(f);c.bindTexture(a.TEXTURE_2D,g.__webglTexture),M(a.TEXTURE_2D,f),Q(h.__webglFramebuffer,b,f,a.COLOR_ATTACHMENT0+e,a.TEXTURE_2D,0),q(f)&&r(a.TEXTURE_2D)}c.unbindTexture()}else{let d=a.TEXTURE_2D;if((b.isWebGL3DRenderTarget||b.isWebGLArrayRenderTarget)&&(d=b.isWebGL3DRenderTarget?a.TEXTURE_3D:a.TEXTURE_2D_ARRAY),c.bindTexture(d,i.__webglTexture),M(d,e),e.mipmaps&&e.mipmaps.length>0)for(let c=0;c<e.mipmaps.length;c++)Q(h.__webglFramebuffer[c],b,e,a.COLOR_ATTACHMENT0,d,c);else Q(h.__webglFramebuffer,b,e,a.COLOR_ATTACHMENT0,d,0);q(e)&&r(d),c.unbindTexture()}b.depthBuffer&&T(b)}function W(a){let b=a.textures;for(let e=0,f=b.length;e<f;e++){let f=b[e];if(q(f)){let b=s(a),e=d.get(f).__webglTexture;c.bindTexture(b,e),r(b),c.unbindTexture()}}}let X=[],Y=[];function Z(b){if(b.samples>0){if(!1===_(b)){let e=b.textures,f=b.width,g=b.height,h=a.COLOR_BUFFER_BIT,i=b.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT,k=d.get(b),l=e.length>1;if(l)for(let b=0;b<e.length;b++)c.bindFramebuffer(a.FRAMEBUFFER,k.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+b,a.RENDERBUFFER,null),c.bindFramebuffer(a.FRAMEBUFFER,k.__webglFramebuffer),a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0+b,a.TEXTURE_2D,null,0);c.bindFramebuffer(a.READ_FRAMEBUFFER,k.__webglMultisampledFramebuffer),c.bindFramebuffer(a.DRAW_FRAMEBUFFER,k.__webglFramebuffer);for(let c=0;c<e.length;c++){if(b.resolveDepthBuffer&&(b.depthBuffer&&(h|=a.DEPTH_BUFFER_BIT),b.stencilBuffer&&b.resolveStencilBuffer&&(h|=a.STENCIL_BUFFER_BIT)),l){a.framebufferRenderbuffer(a.READ_FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.RENDERBUFFER,k.__webglColorRenderbuffer[c]);let b=d.get(e[c]).__webglTexture;a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,b,0)}a.blitFramebuffer(0,0,f,g,0,0,f,g,h,a.NEAREST),!0===j&&(X.length=0,Y.length=0,X.push(a.COLOR_ATTACHMENT0+c),b.depthBuffer&&!1===b.resolveDepthBuffer&&(X.push(i),Y.push(i),a.invalidateFramebuffer(a.DRAW_FRAMEBUFFER,Y)),a.invalidateFramebuffer(a.READ_FRAMEBUFFER,X))}if(c.bindFramebuffer(a.READ_FRAMEBUFFER,null),c.bindFramebuffer(a.DRAW_FRAMEBUFFER,null),l)for(let b=0;b<e.length;b++){c.bindFramebuffer(a.FRAMEBUFFER,k.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+b,a.RENDERBUFFER,k.__webglColorRenderbuffer[b]);let f=d.get(e[b]).__webglTexture;c.bindFramebuffer(a.FRAMEBUFFER,k.__webglFramebuffer),a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0+b,a.TEXTURE_2D,f,0)}c.bindFramebuffer(a.DRAW_FRAMEBUFFER,k.__webglMultisampledFramebuffer)}else if(b.depthBuffer&&!1===b.resolveDepthBuffer&&j){let c=b.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT;a.invalidateFramebuffer(a.DRAW_FRAMEBUFFER,[c])}}}function $(a){return Math.min(e.maxSamples,a.samples)}function _(a){let c=d.get(a);return a.samples>0&&!0===b.has("WEBGL_multisampled_render_to_texture")&&!1!==c.__useRenderToTexture}function aa(a){let b=g.render.frame;l.get(a)!==b&&(l.set(a,b),a.update())}function ab(a,b){let c=a.colorSpace,d=a.format,e=a.type;return!0===a.isCompressedTexture||!0===a.isVideoTexture||c!==b_&&c!==bZ&&(cG.getTransfer(c)===b1?(d!==a4||e!==aS)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",c)),b}function ac(a){return"undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement?(k.width=a.naturalWidth||a.width,k.height=a.naturalHeight||a.height):"undefined"!=typeof VideoFrame&&a instanceof VideoFrame?(k.width=a.displayWidth,k.height=a.displayHeight):(k.width=a.width,k.height=a.height),k}this.allocateTextureUnit=D,this.resetTextureUnits=C,this.setTexture2D=F,this.setTexture2DArray=G,this.setTexture3D=H,this.setTextureCube=I,this.rebindTextures=U,this.setupRenderTarget=V,this.updateRenderTargetMipmap=W,this.updateMultisampleRenderTarget=Z,this.setupDepthRenderbuffer=T,this.setupFrameBufferTexture=Q,this.useMultisampledRTT=_}function lq(a,b){return{convert:function(c,d=bZ){let e,f=cG.getTransfer(d);if(c===aS)return a.UNSIGNED_BYTE;if(c===a$)return a.UNSIGNED_SHORT_4_4_4_4;if(c===a_)return a.UNSIGNED_SHORT_5_5_5_1;if(c===a1)return a.UNSIGNED_INT_5_9_9_9_REV;if(c===aT)return a.BYTE;if(c===aU)return a.SHORT;if(c===aV)return a.UNSIGNED_SHORT;if(c===aW)return a.INT;if(c===aX)return a.UNSIGNED_INT;if(c===aY)return a.FLOAT;if(c===aZ)return a.HALF_FLOAT;if(c===a2)return a.ALPHA;if(c===a3)return a.RGB;if(c===a4)return a.RGBA;if(c===a5)return a.LUMINANCE;if(c===a6)return a.LUMINANCE_ALPHA;if(c===a7)return a.DEPTH_COMPONENT;if(c===a8)return a.DEPTH_STENCIL;if(c===a9)return a.RED;if(c===ba)return a.RED_INTEGER;if(c===bb)return a.RG;if(c===bc)return a.RG_INTEGER;if(c===bd)return a.RGBA_INTEGER;if(c===be||c===bf||c===bg||c===bh)if(f===b1){if(null===(e=b.get("WEBGL_compressed_texture_s3tc_srgb")))return null;if(c===be)return e.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(c===bf)return e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(c===bg)return e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(c===bh)return e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(null===(e=b.get("WEBGL_compressed_texture_s3tc")))return null;if(c===be)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(c===bf)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(c===bg)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(c===bh)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(c===bi||c===bj||c===bk||c===bl){if(null===(e=b.get("WEBGL_compressed_texture_pvrtc")))return null;if(c===bi)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(c===bj)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(c===bk)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(c===bl)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(c===bm||c===bn||c===bo){if(null===(e=b.get("WEBGL_compressed_texture_etc")))return null;if(c===bm||c===bn)return f===b1?e.COMPRESSED_SRGB8_ETC2:e.COMPRESSED_RGB8_ETC2;if(c===bo)return f===b1?e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:e.COMPRESSED_RGBA8_ETC2_EAC}if(c===bp||c===bq||c===br||c===bs||c===bt||c===bu||c===bv||c===bw||c===bx||c===by||c===bz||c===bA||c===bB||c===bC){if(null===(e=b.get("WEBGL_compressed_texture_astc")))return null;if(c===bp)return f===b1?e.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:e.COMPRESSED_RGBA_ASTC_4x4_KHR;if(c===bq)return f===b1?e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:e.COMPRESSED_RGBA_ASTC_5x4_KHR;if(c===br)return f===b1?e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:e.COMPRESSED_RGBA_ASTC_5x5_KHR;if(c===bs)return f===b1?e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:e.COMPRESSED_RGBA_ASTC_6x5_KHR;if(c===bt)return f===b1?e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:e.COMPRESSED_RGBA_ASTC_6x6_KHR;if(c===bu)return f===b1?e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:e.COMPRESSED_RGBA_ASTC_8x5_KHR;if(c===bv)return f===b1?e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:e.COMPRESSED_RGBA_ASTC_8x6_KHR;if(c===bw)return f===b1?e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:e.COMPRESSED_RGBA_ASTC_8x8_KHR;if(c===bx)return f===b1?e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:e.COMPRESSED_RGBA_ASTC_10x5_KHR;if(c===by)return f===b1?e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:e.COMPRESSED_RGBA_ASTC_10x6_KHR;if(c===bz)return f===b1?e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:e.COMPRESSED_RGBA_ASTC_10x8_KHR;if(c===bA)return f===b1?e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:e.COMPRESSED_RGBA_ASTC_10x10_KHR;if(c===bB)return f===b1?e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:e.COMPRESSED_RGBA_ASTC_12x10_KHR;if(c===bC)return f===b1?e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:e.COMPRESSED_RGBA_ASTC_12x12_KHR}if(c===bD||c===bE||c===bF){if(null===(e=b.get("EXT_texture_compression_bptc")))return null;if(c===bD)return f===b1?e.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:e.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(c===bE)return e.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(c===bF)return e.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(c===bG||c===bH||c===bI||c===bJ){if(null===(e=b.get("EXT_texture_compression_rgtc")))return null;if(c===bD)return e.COMPRESSED_RED_RGTC1_EXT;if(c===bH)return e.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(c===bI)return e.COMPRESSED_RED_GREEN_RGTC2_EXT;if(c===bJ)return e.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return c===a0?a.UNSIGNED_INT_24_8:void 0!==a[c]?a[c]:null}}}let lr=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,ls=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class lt{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(a,b,c){if(null===this.texture){let d=new cO;a.properties.get(d).__webglTexture=b.texture,(b.depthNear!==c.depthNear||b.depthFar!==c.depthFar)&&(this.depthNear=b.depthNear,this.depthFar=b.depthFar),this.texture=d}}getMesh(a){if(null!==this.texture&&null===this.mesh){let b=a.cameras[0].viewport,c=new eO({vertexShader:lr,fragmentShader:ls,uniforms:{depthColor:{value:this.texture},depthWidth:{value:b.z},depthHeight:{value:b.w}}});this.mesh=new eD(new hG(20,20),c)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class lu extends cg{constructor(a,b){super();let c=this,d=null,e=1,f=null,g="local-floor",h=1,i=null,j=null,k=null,l=null,m=null,n=null,o=new lt,p=b.getContextAttributes(),q=null,r=null,s=[],t=[],u=new cr,v=null,w=new eT;w.viewport=new cP;let x=new eT;x.viewport=new cP;let y=[w,x],z=new iK,A=null,B=null;function C(a){let b=t.indexOf(a.inputSource);if(-1===b)return;let c=s[b];void 0!==c&&(c.update(a.inputSource,a.frame,i||f),c.dispatchEvent({type:a.type,data:a.inputSource}))}function D(){d.removeEventListener("select",C),d.removeEventListener("selectstart",C),d.removeEventListener("selectend",C),d.removeEventListener("squeeze",C),d.removeEventListener("squeezestart",C),d.removeEventListener("squeezeend",C),d.removeEventListener("end",D),d.removeEventListener("inputsourceschange",E);for(let a=0;a<s.length;a++){let b=t[a];null!==b&&(t[a]=null,s[a].disconnect(b))}A=null,B=null,o.reset(),a.setRenderTarget(q),m=null,l=null,k=null,d=null,r=null,M.stop(),c.isPresenting=!1,a.setPixelRatio(v),a.setSize(u.width,u.height,!1),c.dispatchEvent({type:"sessionend"})}function E(a){for(let b=0;b<a.removed.length;b++){let c=a.removed[b],d=t.indexOf(c);d>=0&&(t[d]=null,s[d].disconnect(c))}for(let b=0;b<a.added.length;b++){let c=a.added[b],d=t.indexOf(c);if(-1===d){for(let a=0;a<s.length;a++)if(a>=t.length){t.push(c),d=a;break}else if(null===t[a]){t[a]=c,d=a;break}if(-1===d)break}let e=s[d];e&&e.connect(c)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(a){let b=s[a];return void 0===b&&(b=new e_,s[a]=b),b.getTargetRaySpace()},this.getControllerGrip=function(a){let b=s[a];return void 0===b&&(b=new e_,s[a]=b),b.getGripSpace()},this.getHand=function(a){let b=s[a];return void 0===b&&(b=new e_,s[a]=b),b.getHandSpace()},this.setFramebufferScaleFactor=function(a){e=a,!0===c.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(a){g=a,!0===c.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return i||f},this.setReferenceSpace=function(a){i=a},this.getBaseLayer=function(){return null!==l?l:m},this.getBinding=function(){return k},this.getFrame=function(){return n},this.getSession=function(){return d},this.setSession=async function(j){if(null!==(d=j)){if(q=a.getRenderTarget(),d.addEventListener("select",C),d.addEventListener("selectstart",C),d.addEventListener("selectend",C),d.addEventListener("squeeze",C),d.addEventListener("squeezestart",C),d.addEventListener("squeezeend",C),d.addEventListener("end",D),d.addEventListener("inputsourceschange",E),!0!==p.xrCompatible&&await b.makeXRCompatible(),v=a.getPixelRatio(),a.getSize(u),"undefined"!=typeof XRWebGLBinding&&"createProjectionLayer"in XRWebGLBinding.prototype){let c=null,f=null,g=null;p.depth&&(g=p.stencil?b.DEPTH24_STENCIL8:b.DEPTH_COMPONENT24,c=p.stencil?a8:a7,f=p.stencil?a0:aX);let h={colorFormat:b.RGBA8,depthFormat:g,scaleFactor:e};l=(k=new XRWebGLBinding(d,b)).createProjectionLayer(h),d.updateRenderState({layers:[l]}),a.setPixelRatio(1),a.setSize(l.textureWidth,l.textureHeight,!1),r=new cR(l.textureWidth,l.textureHeight,{format:a4,type:aS,depthTexture:new gn(l.textureWidth,l.textureHeight,f,void 0,void 0,void 0,void 0,void 0,void 0,c),stencilBuffer:p.stencil,colorSpace:a.outputColorSpace,samples:4*!!p.antialias,resolveDepthBuffer:!1===l.ignoreDepthValues})}else{let c={antialias:p.antialias,alpha:!0,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:e};m=new XRWebGLLayer(d,b,c),d.updateRenderState({baseLayer:m}),a.setPixelRatio(1),a.setSize(m.framebufferWidth,m.framebufferHeight,!1),r=new cR(m.framebufferWidth,m.framebufferHeight,{format:a4,type:aS,colorSpace:a.outputColorSpace,stencilBuffer:p.stencil})}r.isXRRenderTarget=!0,this.setFoveation(h),i=null,f=await d.requestReferenceSpace(g),M.setContext(d),M.start(),c.isPresenting=!0,c.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==d)return d.environmentBlendMode},this.getDepthTexture=function(){return o.getDepthTexture()};let F=new cV,G=new cV;function H(a,b,c){F.setFromMatrixPosition(b.matrixWorld),G.setFromMatrixPosition(c.matrixWorld);let d=F.distanceTo(G),e=b.projectionMatrix.elements,f=c.projectionMatrix.elements,g=e[14]/(e[10]-1),h=e[14]/(e[10]+1),i=(e[9]+1)/e[5],j=(e[9]-1)/e[5],k=(e[8]-1)/e[0],l=(f[8]+1)/f[0],m=g*k,n=g*l,o=d/(-k+l),p=-(o*k);if(b.matrixWorld.decompose(a.position,a.quaternion,a.scale),a.translateX(p),a.translateZ(o),a.matrixWorld.compose(a.position,a.quaternion,a.scale),a.matrixWorldInverse.copy(a.matrixWorld).invert(),-1===e[10])a.projectionMatrix.copy(b.projectionMatrix),a.projectionMatrixInverse.copy(b.projectionMatrixInverse);else{let b=g+o,c=h+o,e=m-p,f=n+(d-p),k=i*h/c*b,l=j*h/c*b;a.projectionMatrix.makePerspective(e,f,k,l,b,c),a.projectionMatrixInverse.copy(a.projectionMatrix).invert()}}function I(a,b){null===b?a.matrixWorld.copy(a.matrix):a.matrixWorld.multiplyMatrices(b.matrixWorld,a.matrix),a.matrixWorldInverse.copy(a.matrixWorld).invert()}function J(a,b,c){null===c?a.matrix.copy(b.matrixWorld):(a.matrix.copy(c.matrixWorld),a.matrix.invert(),a.matrix.multiply(b.matrixWorld)),a.matrix.decompose(a.position,a.quaternion,a.scale),a.updateMatrixWorld(!0),a.projectionMatrix.copy(b.projectionMatrix),a.projectionMatrixInverse.copy(b.projectionMatrixInverse),a.isPerspectiveCamera&&(a.fov=2*ck*Math.atan(1/a.projectionMatrix.elements[5]),a.zoom=1)}this.updateCamera=function(a){if(null===d)return;let b=a.near,c=a.far;null!==o.texture&&(o.depthNear>0&&(b=o.depthNear),o.depthFar>0&&(c=o.depthFar)),z.near=x.near=w.near=b,z.far=x.far=w.far=c,(A!==z.near||B!==z.far)&&(d.updateRenderState({depthNear:z.near,depthFar:z.far}),A=z.near,B=z.far),w.layers.mask=2|a.layers.mask,x.layers.mask=4|a.layers.mask,z.layers.mask=w.layers.mask|x.layers.mask;let e=a.parent,f=z.cameras;I(z,e);for(let a=0;a<f.length;a++)I(f[a],e);2===f.length?H(z,w,x):z.projectionMatrix.copy(w.projectionMatrix),J(a,z,e)},this.getCamera=function(){return z},this.getFoveation=function(){if(null!==l||null!==m)return h},this.setFoveation=function(a){h=a,null!==l&&(l.fixedFoveation=a),null!==m&&void 0!==m.fixedFoveation&&(m.fixedFoveation=a)},this.hasDepthSensing=function(){return null!==o.texture},this.getDepthSensingMesh=function(){return o.getMesh(z)};let K=null;function L(b,e){if(j=e.getViewerPose(i||f),n=e,null!==j){let b=j.views;null!==m&&(a.setRenderTargetFramebuffer(r,m.framebuffer),a.setRenderTarget(r));let c=!1;b.length!==z.cameras.length&&(z.cameras.length=0,c=!0);for(let d=0;d<b.length;d++){let e=b[d],f=null;if(null!==m)f=m.getViewport(e);else{let b=k.getViewSubImage(l,e);f=b.viewport,0===d&&(a.setRenderTargetTextures(r,b.colorTexture,l.ignoreDepthValues?void 0:b.depthStencilTexture),a.setRenderTarget(r))}let g=y[d];void 0===g&&((g=new eT).layers.enable(d),g.viewport=new cP,y[d]=g),g.matrix.fromArray(e.transform.matrix),g.matrix.decompose(g.position,g.quaternion,g.scale),g.projectionMatrix.fromArray(e.projectionMatrix),g.projectionMatrixInverse.copy(g.projectionMatrix).invert(),g.viewport.set(f.x,f.y,f.width,f.height),0===d&&(z.matrix.copy(g.matrix),z.matrix.decompose(z.position,z.quaternion,z.scale)),!0===c&&z.cameras.push(g)}let e=d.enabledFeatures;if(e&&e.includes("depth-sensing")&&"gpu-optimized"==d.depthUsage&&k){let c=k.getDepthInformation(b[0]);c&&c.isValid&&c.texture&&o.init(a,c,d.renderState)}}for(let a=0;a<s.length;a++){let b=t[a],c=s[a];null!==b&&void 0!==c&&c.update(b,e,i||f)}K&&K(b,e),e.detectedPlanes&&c.dispatchEvent({type:"planesdetected",data:e}),n=null}let M=new i_;M.setAnimationLoop(L),this.setAnimationLoop=function(a){K=a},this.dispose=function(){}}}let lv=new dy,lw=new dn;function lx(a,b){function c(a,b){!0===a.matrixAutoUpdate&&a.updateMatrix(),b.value.copy(a.matrix)}function d(a,d){a.opacity.value=d.opacity,d.color&&a.diffuse.value.copy(d.color),d.emissive&&a.emissive.value.copy(d.emissive).multiplyScalar(d.emissiveIntensity),d.map&&(a.map.value=d.map,c(d.map,a.mapTransform)),d.alphaMap&&(a.alphaMap.value=d.alphaMap,c(d.alphaMap,a.alphaMapTransform)),d.bumpMap&&(a.bumpMap.value=d.bumpMap,c(d.bumpMap,a.bumpMapTransform),a.bumpScale.value=d.bumpScale,d.side===I&&(a.bumpScale.value*=-1)),d.normalMap&&(a.normalMap.value=d.normalMap,c(d.normalMap,a.normalMapTransform),a.normalScale.value.copy(d.normalScale),d.side===I&&a.normalScale.value.negate()),d.displacementMap&&(a.displacementMap.value=d.displacementMap,c(d.displacementMap,a.displacementMapTransform),a.displacementScale.value=d.displacementScale,a.displacementBias.value=d.displacementBias),d.emissiveMap&&(a.emissiveMap.value=d.emissiveMap,c(d.emissiveMap,a.emissiveMapTransform)),d.specularMap&&(a.specularMap.value=d.specularMap,c(d.specularMap,a.specularMapTransform)),d.alphaTest>0&&(a.alphaTest.value=d.alphaTest);let e=b.get(d),f=e.envMap,g=e.envMapRotation;f&&(a.envMap.value=f,lv.copy(g),lv.x*=-1,lv.y*=-1,lv.z*=-1,f.isCubeTexture&&!1===f.isRenderTargetTexture&&(lv.y*=-1,lv.z*=-1),a.envMapRotation.value.setFromMatrix4(lw.makeRotationFromEuler(lv)),a.flipEnvMap.value=f.isCubeTexture&&!1===f.isRenderTargetTexture?-1:1,a.reflectivity.value=d.reflectivity,a.ior.value=d.ior,a.refractionRatio.value=d.refractionRatio),d.lightMap&&(a.lightMap.value=d.lightMap,a.lightMapIntensity.value=d.lightMapIntensity,c(d.lightMap,a.lightMapTransform)),d.aoMap&&(a.aoMap.value=d.aoMap,a.aoMapIntensity.value=d.aoMapIntensity,c(d.aoMap,a.aoMapTransform))}function e(a,b){a.diffuse.value.copy(b.color),a.opacity.value=b.opacity,b.map&&(a.map.value=b.map,c(b.map,a.mapTransform))}function f(a,b){a.dashSize.value=b.dashSize,a.totalSize.value=b.dashSize+b.gapSize,a.scale.value=b.scale}function g(a,b,d,e){a.diffuse.value.copy(b.color),a.opacity.value=b.opacity,a.size.value=b.size*d,a.scale.value=.5*e,b.map&&(a.map.value=b.map,c(b.map,a.uvTransform)),b.alphaMap&&(a.alphaMap.value=b.alphaMap,c(b.alphaMap,a.alphaMapTransform)),b.alphaTest>0&&(a.alphaTest.value=b.alphaTest)}function h(a,b){a.diffuse.value.copy(b.color),a.opacity.value=b.opacity,a.rotation.value=b.rotation,b.map&&(a.map.value=b.map,c(b.map,a.mapTransform)),b.alphaMap&&(a.alphaMap.value=b.alphaMap,c(b.alphaMap,a.alphaMapTransform)),b.alphaTest>0&&(a.alphaTest.value=b.alphaTest)}function i(a,b){a.specular.value.copy(b.specular),a.shininess.value=Math.max(b.shininess,1e-4)}function j(a,b){b.gradientMap&&(a.gradientMap.value=b.gradientMap)}function k(a,b){a.metalness.value=b.metalness,b.metalnessMap&&(a.metalnessMap.value=b.metalnessMap,c(b.metalnessMap,a.metalnessMapTransform)),a.roughness.value=b.roughness,b.roughnessMap&&(a.roughnessMap.value=b.roughnessMap,c(b.roughnessMap,a.roughnessMapTransform)),b.envMap&&(a.envMapIntensity.value=b.envMapIntensity)}function l(a,b,d){a.ior.value=b.ior,b.sheen>0&&(a.sheenColor.value.copy(b.sheenColor).multiplyScalar(b.sheen),a.sheenRoughness.value=b.sheenRoughness,b.sheenColorMap&&(a.sheenColorMap.value=b.sheenColorMap,c(b.sheenColorMap,a.sheenColorMapTransform)),b.sheenRoughnessMap&&(a.sheenRoughnessMap.value=b.sheenRoughnessMap,c(b.sheenRoughnessMap,a.sheenRoughnessMapTransform))),b.clearcoat>0&&(a.clearcoat.value=b.clearcoat,a.clearcoatRoughness.value=b.clearcoatRoughness,b.clearcoatMap&&(a.clearcoatMap.value=b.clearcoatMap,c(b.clearcoatMap,a.clearcoatMapTransform)),b.clearcoatRoughnessMap&&(a.clearcoatRoughnessMap.value=b.clearcoatRoughnessMap,c(b.clearcoatRoughnessMap,a.clearcoatRoughnessMapTransform)),b.clearcoatNormalMap&&(a.clearcoatNormalMap.value=b.clearcoatNormalMap,c(b.clearcoatNormalMap,a.clearcoatNormalMapTransform),a.clearcoatNormalScale.value.copy(b.clearcoatNormalScale),b.side===I&&a.clearcoatNormalScale.value.negate())),b.dispersion>0&&(a.dispersion.value=b.dispersion),b.iridescence>0&&(a.iridescence.value=b.iridescence,a.iridescenceIOR.value=b.iridescenceIOR,a.iridescenceThicknessMinimum.value=b.iridescenceThicknessRange[0],a.iridescenceThicknessMaximum.value=b.iridescenceThicknessRange[1],b.iridescenceMap&&(a.iridescenceMap.value=b.iridescenceMap,c(b.iridescenceMap,a.iridescenceMapTransform)),b.iridescenceThicknessMap&&(a.iridescenceThicknessMap.value=b.iridescenceThicknessMap,c(b.iridescenceThicknessMap,a.iridescenceThicknessMapTransform))),b.transmission>0&&(a.transmission.value=b.transmission,a.transmissionSamplerMap.value=d.texture,a.transmissionSamplerSize.value.set(d.width,d.height),b.transmissionMap&&(a.transmissionMap.value=b.transmissionMap,c(b.transmissionMap,a.transmissionMapTransform)),a.thickness.value=b.thickness,b.thicknessMap&&(a.thicknessMap.value=b.thicknessMap,c(b.thicknessMap,a.thicknessMapTransform)),a.attenuationDistance.value=b.attenuationDistance,a.attenuationColor.value.copy(b.attenuationColor)),b.anisotropy>0&&(a.anisotropyVector.value.set(b.anisotropy*Math.cos(b.anisotropyRotation),b.anisotropy*Math.sin(b.anisotropyRotation)),b.anisotropyMap&&(a.anisotropyMap.value=b.anisotropyMap,c(b.anisotropyMap,a.anisotropyMapTransform))),a.specularIntensity.value=b.specularIntensity,a.specularColor.value.copy(b.specularColor),b.specularColorMap&&(a.specularColorMap.value=b.specularColorMap,c(b.specularColorMap,a.specularColorMapTransform)),b.specularIntensityMap&&(a.specularIntensityMap.value=b.specularIntensityMap,c(b.specularIntensityMap,a.specularIntensityMapTransform))}function m(a,b){b.matcap&&(a.matcap.value=b.matcap)}function n(a,c){let d=b.get(c).light;a.referencePosition.value.setFromMatrixPosition(d.matrixWorld),a.nearDistance.value=d.shadow.camera.near,a.farDistance.value=d.shadow.camera.far}return{refreshFogUniforms:function(b,c){c.color.getRGB(b.fogColor.value,eK(a)),c.isFog?(b.fogNear.value=c.near,b.fogFar.value=c.far):c.isFogExp2&&(b.fogDensity.value=c.density)},refreshMaterialUniforms:function(a,b,c,o,p){b.isMeshBasicMaterial||b.isMeshLambertMaterial?d(a,b):b.isMeshToonMaterial?(d(a,b),j(a,b)):b.isMeshPhongMaterial?(d(a,b),i(a,b)):b.isMeshStandardMaterial?(d(a,b),k(a,b),b.isMeshPhysicalMaterial&&l(a,b,p)):b.isMeshMatcapMaterial?(d(a,b),m(a,b)):b.isMeshDepthMaterial?d(a,b):b.isMeshDistanceMaterial?(d(a,b),n(a,b)):b.isMeshNormalMaterial?d(a,b):b.isLineBasicMaterial?(e(a,b),b.isLineDashedMaterial&&f(a,b)):b.isPointsMaterial?g(a,b,c,o):b.isSpriteMaterial?h(a,b):b.isShadowMaterial?(a.color.value.copy(b.color),a.opacity.value=b.opacity):b.isShaderMaterial&&(b.uniformsNeedUpdate=!1)}}}function ly(a,b,c,d){let e={},f={},g=[],h=a.getParameter(a.MAX_UNIFORM_BUFFER_BINDINGS);function i(b){let c=j();b.__bindingPointIndex=c;let d=a.createBuffer(),e=b.__size,f=b.usage;return a.bindBuffer(a.UNIFORM_BUFFER,d),a.bufferData(a.UNIFORM_BUFFER,e,f),a.bindBuffer(a.UNIFORM_BUFFER,null),a.bindBufferBase(a.UNIFORM_BUFFER,c,d),d}function j(){for(let a=0;a<h;a++)if(-1===g.indexOf(a))return g.push(a),a;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function k(b){let c=e[b.id],d=b.uniforms,f=b.__cache;a.bindBuffer(a.UNIFORM_BUFFER,c);for(let b=0,c=d.length;b<c;b++){let c=Array.isArray(d[b])?d[b]:[d[b]];for(let d=0,e=c.length;d<e;d++){let e=c[d];if(!0===l(e,b,d,f)){let b=e.__offset,c=Array.isArray(e.value)?e.value:[e.value],d=0;for(let f=0;f<c.length;f++){let g=c[f],h=n(g);"number"==typeof g||"boolean"==typeof g?(e.__data[0]=g,a.bufferSubData(a.UNIFORM_BUFFER,b+d,e.__data)):g.isMatrix3?(e.__data[0]=g.elements[0],e.__data[1]=g.elements[1],e.__data[2]=g.elements[2],e.__data[3]=0,e.__data[4]=g.elements[3],e.__data[5]=g.elements[4],e.__data[6]=g.elements[5],e.__data[7]=0,e.__data[8]=g.elements[6],e.__data[9]=g.elements[7],e.__data[10]=g.elements[8],e.__data[11]=0):(g.toArray(e.__data,d),d+=h.storage/Float32Array.BYTES_PER_ELEMENT)}a.bufferSubData(a.UNIFORM_BUFFER,b,e.__data)}}}a.bindBuffer(a.UNIFORM_BUFFER,null)}function l(a,b,c,d){let e=a.value,f=b+"_"+c;if(void 0===d[f])return"number"==typeof e||"boolean"==typeof e?d[f]=e:d[f]=e.clone(),!0;{let a=d[f];if("number"==typeof e||"boolean"==typeof e){if(a!==e)return d[f]=e,!0}else if(!1===a.equals(e))return a.copy(e),!0}return!1}function m(a){let b=a.uniforms,c=0,d=16;for(let a=0,e=b.length;a<e;a++){let e=Array.isArray(b[a])?b[a]:[b[a]];for(let a=0,b=e.length;a<b;a++){let b=e[a],f=Array.isArray(b.value)?b.value:[b.value];for(let a=0,e=f.length;a<e;a++){let e=n(f[a]),g=c%d,h=g%e.boundary,i=g+h;c+=h,0!==i&&d-i<e.storage&&(c+=d-i),b.__data=new Float32Array(e.storage/Float32Array.BYTES_PER_ELEMENT),b.__offset=c,c+=e.storage}}}let e=c%d;return e>0&&(c+=d-e),a.__size=c,a.__cache={},this}function n(a){let b={boundary:0,storage:0};return"number"==typeof a||"boolean"==typeof a?(b.boundary=4,b.storage=4):a.isVector2?(b.boundary=8,b.storage=8):a.isVector3||a.isColor?(b.boundary=16,b.storage=12):a.isVector4?(b.boundary=16,b.storage=16):a.isMatrix3?(b.boundary=48,b.storage=48):a.isMatrix4?(b.boundary=64,b.storage=64):a.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",a),b}function o(b){let c=b.target;c.removeEventListener("dispose",o);let d=g.indexOf(c.__bindingPointIndex);g.splice(d,1),a.deleteBuffer(e[c.id]),delete e[c.id],delete f[c.id]}return{bind:function(a,b){let c=b.program;d.uniformBlockBinding(a,c)},update:function(a,c){let g=e[a.id];void 0===g&&(m(a),g=i(a),e[a.id]=g,a.addEventListener("dispose",o));let h=c.program;d.updateUBOMapping(a,h);let j=b.render.frame;f[a.id]!==j&&(k(a),f[a.id]=j)},dispose:function(){for(let b in e)a.deleteBuffer(e[b]);g=[],e={},f={}}}}class lz{constructor(a={}){let b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,{canvas:B=cy(),context:C=null,depth:D=!0,stencil:E=!1,alpha:F=!1,antialias:G=!1,premultipliedAlpha:K=!0,preserveDrawingBuffer:L=!1,powerPreference:M="default",failIfMajorPerformanceCaveat:N=!1,reverseDepthBuffer:O=!1}=a;if(this.isWebGLRenderer=!0,null!==C){if("undefined"!=typeof WebGLRenderingContext&&C instanceof WebGLRenderingContext)throw Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");b=C.getContextAttributes().alpha}else b=F;let P=new Uint32Array(4),Q=new Int32Array(4),R=null,S=null,T=[],U=[];this.domElement=B,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=b$,this.toneMapping=at,this.toneMappingExposure=1;let V=this,W=!1,X=0,Y=0,Z=null,$=-1,_=null,aa=new cP,ab=new cP,ac=null,ad=new d6(0),ae=0,af=B.width,ag=B.height,ah=1,ai=null,aj=null,ak=new cP(0,0,af,ag),al=new cP(0,0,af,ag),am=!1,an=new fO,ao=!1,ap=!1;this.transmissionResolutionScale=1;let aq=new dn,ar=new dn,as=new cV,au=new cP,av={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0},aw=!1;function ax(){return null===Z?ah:1}let ay=C;function az(a,b){return B.getContext(a,b)}try{let a={alpha:!0,depth:D,stencil:E,antialias:G,premultipliedAlpha:K,preserveDrawingBuffer:L,powerPreference:M,failIfMajorPerformanceCaveat:N};if("setAttribute"in B&&B.setAttribute("data-engine",`three.js r${A}`),B.addEventListener("webglcontextlost",aC,!1),B.addEventListener("webglcontextrestored",aD,!1),B.addEventListener("webglcontextcreationerror",aE,!1),null===ay){let b="webgl2";if(ay=az(b,a),null===ay)if(az(b))throw Error("Error creating WebGL context with your selected attributes.");else throw Error("Error creating WebGL context.")}}catch(a){throw console.error("THREE.WebGLRenderer: "+a.message),a}function aA(){(c=new jy(ay)).init(),x=new lq(ay,c),d=new ja(ay,c,a,x),e=new lo(ay,c),d.reverseDepthBuffer&&O&&e.buffers.depth.setReversed(!0),f=new jB(ay),g=new k8,h=new lp(ay,c,e,g,d,x,f),i=new jc(V),j=new jx(V),k=new i0(ay),y=new i8(ay,k),l=new jz(ay,k,f,y),m=new jD(ay,l,k,f),u=new jC(ay,d,h),r=new jb(g),n=new k7(V,i,j,c,d,y,r),o=new lx(V,g),p=new lc,q=new lj(c),t=new i7(V,i,j,e,m,b,K),s=new lm(V,m,d),z=new ly(ay,f,d,e),v=new i9(ay,c,f),w=new jA(ay,c,f),f.programs=n.programs,V.capabilities=d,V.extensions=c,V.properties=g,V.renderLists=p,V.shadowMap=s,V.state=e,V.info=f}aA();let aB=new lu(V,ay);function aC(a){a.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),W=!0}function aD(){console.log("THREE.WebGLRenderer: Context Restored."),W=!1;let a=f.autoReset,b=s.enabled,c=s.autoUpdate,d=s.needsUpdate,e=s.type;aA(),f.autoReset=a,s.enabled=b,s.autoUpdate=c,s.needsUpdate=d,s.type=e}function aE(a){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",a.statusMessage)}function aF(a){let b=a.target;b.removeEventListener("dispose",aF),aG(b)}function aG(a){aH(a),g.remove(a)}function aH(a){let b=g.get(a).programs;void 0!==b&&(b.forEach(function(a){n.releaseProgram(a)}),a.isShaderMaterial&&n.releaseShaderCache(a))}function aI(a,b,c){!0===a.transparent&&a.side===J&&!1===a.forceSinglePass?(a.side=I,a.needsUpdate=!0,aW(a,b,c),a.side=H,a.needsUpdate=!0,aW(a,b,c),a.side=J):aW(a,b,c)}this.xr=aB,this.getContext=function(){return ay},this.getContextAttributes=function(){return ay.getContextAttributes()},this.forceContextLoss=function(){let a=c.get("WEBGL_lose_context");a&&a.loseContext()},this.forceContextRestore=function(){let a=c.get("WEBGL_lose_context");a&&a.restoreContext()},this.getPixelRatio=function(){return ah},this.setPixelRatio=function(a){void 0!==a&&(ah=a,this.setSize(af,ag,!1))},this.getSize=function(a){return a.set(af,ag)},this.setSize=function(a,b,c=!0){if(aB.isPresenting)return void console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");af=a,ag=b,B.width=Math.floor(a*ah),B.height=Math.floor(b*ah),!0===c&&(B.style.width=a+"px",B.style.height=b+"px"),this.setViewport(0,0,a,b)},this.getDrawingBufferSize=function(a){return a.set(af*ah,ag*ah).floor()},this.setDrawingBufferSize=function(a,b,c){af=a,ag=b,ah=c,B.width=Math.floor(a*c),B.height=Math.floor(b*c),this.setViewport(0,0,a,b)},this.getCurrentViewport=function(a){return a.copy(aa)},this.getViewport=function(a){return a.copy(ak)},this.setViewport=function(a,b,c,d){a.isVector4?ak.set(a.x,a.y,a.z,a.w):ak.set(a,b,c,d),e.viewport(aa.copy(ak).multiplyScalar(ah).round())},this.getScissor=function(a){return a.copy(al)},this.setScissor=function(a,b,c,d){a.isVector4?al.set(a.x,a.y,a.z,a.w):al.set(a,b,c,d),e.scissor(ab.copy(al).multiplyScalar(ah).round())},this.getScissorTest=function(){return am},this.setScissorTest=function(a){e.setScissorTest(am=a)},this.setOpaqueSort=function(a){ai=a},this.setTransparentSort=function(a){aj=a},this.getClearColor=function(a){return a.copy(t.getClearColor())},this.setClearColor=function(){t.setClearColor.apply(t,arguments)},this.getClearAlpha=function(){return t.getClearAlpha()},this.setClearAlpha=function(){t.setClearAlpha.apply(t,arguments)},this.clear=function(a=!0,b=!0,c=!0){let d=0;if(a){let a=!1;if(null!==Z){let b=Z.texture.format;a=b===bd||b===bc||b===ba}if(a){let a=Z.texture.type,b=a===aS||a===aX||a===aV||a===a0||a===a$||a===a_,c=t.getClearColor(),d=t.getClearAlpha(),e=c.r,f=c.g,g=c.b;b?(P[0]=e,P[1]=f,P[2]=g,P[3]=d,ay.clearBufferuiv(ay.COLOR,0,P)):(Q[0]=e,Q[1]=f,Q[2]=g,Q[3]=d,ay.clearBufferiv(ay.COLOR,0,Q))}else d|=ay.COLOR_BUFFER_BIT}b&&(d|=ay.DEPTH_BUFFER_BIT),c&&(d|=ay.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(0xffffffff)),ay.clear(d)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){B.removeEventListener("webglcontextlost",aC,!1),B.removeEventListener("webglcontextrestored",aD,!1),B.removeEventListener("webglcontextcreationerror",aE,!1),t.dispose(),p.dispose(),q.dispose(),g.dispose(),i.dispose(),j.dispose(),m.dispose(),y.dispose(),z.dispose(),n.dispose(),aB.dispose(),aB.removeEventListener("sessionstart",aL),aB.removeEventListener("sessionend",aM),aN.stop()},this.renderBufferDirect=function(a,b,d,f,h,i){let j;null===b&&(b=av);let m=h.isMesh&&0>h.matrixWorld.determinant(),n=a2(a,b,d,f,h);e.setMaterial(f,m);let o=d.index,p=1;if(!0===f.wireframe){if(void 0===(o=l.getWireframeAttribute(d)))return;p=2}let q=d.drawRange,r=d.attributes.position,s=q.start*p,t=(q.start+q.count)*p;null!==i&&(s=Math.max(s,i.start*p),t=Math.min(t,(i.start+i.count)*p)),null!==o?(s=Math.max(s,0),t=Math.min(t,o.count)):null!=r&&(s=Math.max(s,0),t=Math.min(t,r.count));let u=t-s;if(u<0||u===1/0)return;y.setup(h,f,n,d,o);let x=v;if(null!==o&&(j=k.get(o),(x=w).setIndex(j)),h.isMesh)!0===f.wireframe?(e.setLineWidth(f.wireframeLinewidth*ax()),x.setMode(ay.LINES)):x.setMode(ay.TRIANGLES);else if(h.isLine){let a=f.linewidth;void 0===a&&(a=1),e.setLineWidth(a*ax()),h.isLineSegments?x.setMode(ay.LINES):h.isLineLoop?x.setMode(ay.LINE_LOOP):x.setMode(ay.LINE_STRIP)}else h.isPoints?x.setMode(ay.POINTS):h.isSprite&&x.setMode(ay.TRIANGLES);if(h.isBatchedMesh)if(null!==h._multiDrawInstances)x.renderMultiDrawInstances(h._multiDrawStarts,h._multiDrawCounts,h._multiDrawCount,h._multiDrawInstances);else if(c.get("WEBGL_multi_draw"))x.renderMultiDraw(h._multiDrawStarts,h._multiDrawCounts,h._multiDrawCount);else{let a=h._multiDrawStarts,b=h._multiDrawCounts,c=h._multiDrawCount,d=o?k.get(o).bytesPerElement:1,e=g.get(f).currentProgram.getUniforms();for(let f=0;f<c;f++)e.setValue(ay,"_gl_DrawID",f),x.render(a[f]/d,b[f])}else if(h.isInstancedMesh)x.renderInstances(s,u,h.count);else if(d.isInstancedBufferGeometry){let a=void 0!==d._maxInstanceCount?d._maxInstanceCount:1/0,b=Math.min(d.instanceCount,a);x.renderInstances(s,u,b)}else x.render(s,u)},this.compile=function(a,b,c=null){null===c&&(c=a),(S=q.get(c)).init(b),U.push(S),c.traverseVisible(function(a){a.isLight&&a.layers.test(b.layers)&&(S.pushLight(a),a.castShadow&&S.pushShadow(a))}),a!==c&&a.traverseVisible(function(a){a.isLight&&a.layers.test(b.layers)&&(S.pushLight(a),a.castShadow&&S.pushShadow(a))}),S.setupLights();let d=new Set;return a.traverse(function(a){if(!(a.isMesh||a.isPoints||a.isLine||a.isSprite))return;let b=a.material;if(b)if(Array.isArray(b))for(let e=0;e<b.length;e++){let f=b[e];aI(f,c,a),d.add(f)}else aI(b,c,a),d.add(b)}),U.pop(),S=null,d},this.compileAsync=function(a,b,d=null){let e=this.compile(a,b,d);return new Promise(b=>{function d(){if(e.forEach(function(a){g.get(a).currentProgram.isReady()&&e.delete(a)}),0===e.size)return void b(a);setTimeout(d,10)}null!==c.get("KHR_parallel_shader_compile")?d():setTimeout(d,10)})};let aJ=null;function aK(a){aJ&&aJ(a)}function aL(){aN.stop()}function aM(){aN.start()}let aN=new i_;function aO(a,b,c,d){if(!1===a.visible)return;if(a.layers.test(b.layers)){if(a.isGroup)c=a.renderOrder;else if(a.isLOD)!0===a.autoUpdate&&a.update(b);else if(a.isLight)S.pushLight(a),a.castShadow&&S.pushShadow(a);else if(a.isSprite){if(!a.frustumCulled||an.intersectsSprite(a)){d&&au.setFromMatrixPosition(a.matrixWorld).applyMatrix4(ar);let b=m.update(a),e=a.material;e.visible&&R.push(a,b,e,c,au.z,null)}}else if((a.isMesh||a.isLine||a.isPoints)&&(!a.frustumCulled||an.intersectsObject(a))){let b=m.update(a),e=a.material;if(d&&(void 0!==a.boundingSphere?(null===a.boundingSphere&&a.computeBoundingSphere(),au.copy(a.boundingSphere.center)):(null===b.boundingSphere&&b.computeBoundingSphere(),au.copy(b.boundingSphere.center)),au.applyMatrix4(a.matrixWorld).applyMatrix4(ar)),Array.isArray(e)){let d=b.groups;for(let f=0,g=d.length;f<g;f++){let g=d[f],h=e[g.materialIndex];h&&h.visible&&R.push(a,b,h,c,au.z,g)}}else e.visible&&R.push(a,b,e,c,au.z,null)}}let e=a.children;for(let a=0,f=e.length;a<f;a++)aO(e[a],b,c,d)}function aP(a,b,c,d){let f=a.opaque,g=a.transmissive,h=a.transparent;S.setupLightsView(c),!0===ao&&r.setGlobalState(V.clippingPlanes,c),d&&e.viewport(aa.copy(d)),f.length>0&&aT(f,b,c),g.length>0&&aT(g,b,c),h.length>0&&aT(h,b,c),e.buffers.depth.setTest(!0),e.buffers.depth.setMask(!0),e.buffers.color.setMask(!0),e.setPolygonOffset(!1)}function aQ(a,b,d,e){if(null!==(!0===d.isScene?d.overrideMaterial:null))return;void 0===S.state.transmissionRenderTarget[e.id]&&(S.state.transmissionRenderTarget[e.id]=new cR(1,1,{generateMipmaps:!0,type:c.has("EXT_color_buffer_half_float")||c.has("EXT_color_buffer_float")?aZ:aS,minFilter:aR,samples:4,stencilBuffer:E,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:cG.workingColorSpace}));let f=S.state.transmissionRenderTarget[e.id],g=e.viewport||aa;f.setSize(g.z*V.transmissionResolutionScale,g.w*V.transmissionResolutionScale);let i=V.getRenderTarget();V.setRenderTarget(f),V.getClearColor(ad),(ae=V.getClearAlpha())<1&&V.setClearColor(0xffffff,.5),V.clear(),aw&&t.render(d);let j=V.toneMapping;V.toneMapping=at;let k=e.viewport;if(void 0!==e.viewport&&(e.viewport=void 0),S.setupLightsView(e),!0===ao&&r.setGlobalState(V.clippingPlanes,e),aT(a,d,e),h.updateMultisampleRenderTarget(f),h.updateRenderTargetMipmap(f),!1===c.has("WEBGL_multisampled_render_to_texture")){let a=!1;for(let c=0,f=b.length;c<f;c++){let f=b[c],g=f.object,h=f.geometry,i=f.material,j=f.group;if(i.side===J&&g.layers.test(e.layers)){let b=i.side;i.side=I,i.needsUpdate=!0,aU(g,d,e,h,i,j),i.side=b,i.needsUpdate=!0,a=!0}}!0===a&&(h.updateMultisampleRenderTarget(f),h.updateRenderTargetMipmap(f))}V.setRenderTarget(i),V.setClearColor(ad,ae),void 0!==k&&(e.viewport=k),V.toneMapping=j}function aT(a,b,c){let d=!0===b.isScene?b.overrideMaterial:null;for(let e=0,f=a.length;e<f;e++){let f=a[e],g=f.object,h=f.geometry,i=null===d?f.material:d,j=f.group;g.layers.test(c.layers)&&aU(g,b,c,h,i,j)}}function aU(a,b,c,d,e,f){a.onBeforeRender(V,b,c,d,e,f),a.modelViewMatrix.multiplyMatrices(c.matrixWorldInverse,a.matrixWorld),a.normalMatrix.getNormalMatrix(a.modelViewMatrix),e.onBeforeRender(V,b,c,d,a,f),!0===e.transparent&&e.side===J&&!1===e.forceSinglePass?(e.side=I,e.needsUpdate=!0,V.renderBufferDirect(c,b,d,e,a,f),e.side=H,e.needsUpdate=!0,V.renderBufferDirect(c,b,d,e,a,f),e.side=J):V.renderBufferDirect(c,b,d,e,a,f),a.onAfterRender(V,b,c,d,e,f)}function aW(a,b,c){!0!==b.isScene&&(b=av);let d=g.get(a),e=S.state.lights,f=S.state.shadowsArray,h=e.state.version,k=n.getParameters(a,e.state,f,b,c),l=n.getProgramCacheKey(k),m=d.programs;d.environment=a.isMeshStandardMaterial?b.environment:null,d.fog=b.fog,d.envMap=(a.isMeshStandardMaterial?j:i).get(a.envMap||d.environment),d.envMapRotation=null!==d.environment&&null===a.envMap?b.environmentRotation:a.envMapRotation,void 0===m&&(a.addEventListener("dispose",aF),d.programs=m=new Map);let o=m.get(l);if(void 0!==o){if(d.currentProgram===o&&d.lightsStateVersion===h)return a1(a,k),o}else k.uniforms=n.getUniforms(a),a.onBeforeCompile(k,V),o=n.acquireProgram(k,l),m.set(l,o),d.uniforms=k.uniforms;let p=d.uniforms;return(a.isShaderMaterial||a.isRawShaderMaterial)&&!0!==a.clipping||(p.clippingPlanes=r.uniform),a1(a,k),d.needsLights=a4(a),d.lightsStateVersion=h,d.needsLights&&(p.ambientLightColor.value=e.state.ambient,p.lightProbe.value=e.state.probe,p.directionalLights.value=e.state.directional,p.directionalLightShadows.value=e.state.directionalShadow,p.spotLights.value=e.state.spot,p.spotLightShadows.value=e.state.spotShadow,p.rectAreaLights.value=e.state.rectArea,p.ltc_1.value=e.state.rectAreaLTC1,p.ltc_2.value=e.state.rectAreaLTC2,p.pointLights.value=e.state.point,p.pointLightShadows.value=e.state.pointShadow,p.hemisphereLights.value=e.state.hemi,p.directionalShadowMap.value=e.state.directionalShadowMap,p.directionalShadowMatrix.value=e.state.directionalShadowMatrix,p.spotShadowMap.value=e.state.spotShadowMap,p.spotLightMatrix.value=e.state.spotLightMatrix,p.spotLightMap.value=e.state.spotLightMap,p.pointShadowMap.value=e.state.pointShadowMap,p.pointShadowMatrix.value=e.state.pointShadowMatrix),d.currentProgram=o,d.uniformsList=null,o}function aY(a){if(null===a.uniformsList){let b=a.currentProgram.getUniforms();a.uniformsList=kA.seqWithValue(b.seq,a.uniforms)}return a.uniformsList}function a1(a,b){let c=g.get(a);c.outputColorSpace=b.outputColorSpace,c.batching=b.batching,c.batchingColor=b.batchingColor,c.instancing=b.instancing,c.instancingColor=b.instancingColor,c.instancingMorph=b.instancingMorph,c.skinning=b.skinning,c.morphTargets=b.morphTargets,c.morphNormals=b.morphNormals,c.morphColors=b.morphColors,c.morphTargetsCount=b.morphTargetsCount,c.numClippingPlanes=b.numClippingPlanes,c.numIntersection=b.numClipIntersection,c.vertexAlphas=b.vertexAlphas,c.vertexTangents=b.vertexTangents,c.toneMapping=b.toneMapping}function a2(a,b,c,f,k){!0!==b.isScene&&(b=av),h.resetTextureUnits();let l=b.fog,m=f.isMeshStandardMaterial?b.environment:null,n=null===Z?V.outputColorSpace:!0===Z.isXRRenderTarget?Z.texture.colorSpace:b_,p=(f.isMeshStandardMaterial?j:i).get(f.envMap||m),q=!0===f.vertexColors&&!!c.attributes.color&&4===c.attributes.color.itemSize,s=!!c.attributes.tangent&&(!!f.normalMap||f.anisotropy>0),t=!!c.morphAttributes.position,v=!!c.morphAttributes.normal,w=!!c.morphAttributes.color,x=at;f.toneMapped&&(null===Z||!0===Z.isXRRenderTarget)&&(x=V.toneMapping);let y=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,A=void 0!==y?y.length:0,B=g.get(f),C=S.state.lights;if(!0===ao&&(!0===ap||a!==_)){let b=a===_&&f.id===$;r.setState(f,a,b)}let D=!1;f.version===B.__version?B.needsLights&&B.lightsStateVersion!==C.state.version||B.outputColorSpace!==n||k.isBatchedMesh&&!1===B.batching?D=!0:k.isBatchedMesh||!0!==B.batching?k.isBatchedMesh&&!0===B.batchingColor&&null===k.colorTexture||k.isBatchedMesh&&!1===B.batchingColor&&null!==k.colorTexture||k.isInstancedMesh&&!1===B.instancing?D=!0:k.isInstancedMesh||!0!==B.instancing?k.isSkinnedMesh&&!1===B.skinning?D=!0:k.isSkinnedMesh||!0!==B.skinning?k.isInstancedMesh&&!0===B.instancingColor&&null===k.instanceColor||k.isInstancedMesh&&!1===B.instancingColor&&null!==k.instanceColor||k.isInstancedMesh&&!0===B.instancingMorph&&null===k.morphTexture||k.isInstancedMesh&&!1===B.instancingMorph&&null!==k.morphTexture||B.envMap!==p||!0===f.fog&&B.fog!==l||void 0!==B.numClippingPlanes&&(B.numClippingPlanes!==r.numPlanes||B.numIntersection!==r.numIntersection)||B.vertexAlphas!==q||B.vertexTangents!==s||B.morphTargets!==t||B.morphNormals!==v||B.morphColors!==w||B.toneMapping!==x?D=!0:B.morphTargetsCount!==A&&(D=!0):D=!0:D=!0:D=!0:(D=!0,B.__version=f.version);let E=B.currentProgram;!0===D&&(E=aW(f,b,k));let F=!1,G=!1,H=!1,I=E.getUniforms(),J=B.uniforms;if(e.useProgram(E.program)&&(F=!0,G=!0,H=!0),f.id!==$&&($=f.id,G=!0),F||_!==a){e.buffers.depth.getReversed()?(aq.copy(a.projectionMatrix),cC(aq),cD(aq),I.setValue(ay,"projectionMatrix",aq)):I.setValue(ay,"projectionMatrix",a.projectionMatrix),I.setValue(ay,"viewMatrix",a.matrixWorldInverse);let b=I.map.cameraPosition;void 0!==b&&b.setValue(ay,as.setFromMatrixPosition(a.matrixWorld)),d.logarithmicDepthBuffer&&I.setValue(ay,"logDepthBufFC",2/(Math.log(a.far+1)/Math.LN2)),(f.isMeshPhongMaterial||f.isMeshToonMaterial||f.isMeshLambertMaterial||f.isMeshBasicMaterial||f.isMeshStandardMaterial||f.isShaderMaterial)&&I.setValue(ay,"isOrthographic",!0===a.isOrthographicCamera),_!==a&&(_=a,G=!0,H=!0)}if(k.isSkinnedMesh){I.setOptional(ay,k,"bindMatrix"),I.setOptional(ay,k,"bindMatrixInverse");let a=k.skeleton;a&&(null===a.boneTexture&&a.computeBoneTexture(),I.setValue(ay,"boneTexture",a.boneTexture,h))}k.isBatchedMesh&&(I.setOptional(ay,k,"batchingTexture"),I.setValue(ay,"batchingTexture",k._matricesTexture,h),I.setOptional(ay,k,"batchingIdTexture"),I.setValue(ay,"batchingIdTexture",k._indirectTexture,h),I.setOptional(ay,k,"batchingColorTexture"),null!==k._colorsTexture&&I.setValue(ay,"batchingColorTexture",k._colorsTexture,h));let K=c.morphAttributes;if((void 0!==K.position||void 0!==K.normal||void 0!==K.color)&&u.update(k,c,E),(G||B.receiveShadow!==k.receiveShadow)&&(B.receiveShadow=k.receiveShadow,I.setValue(ay,"receiveShadow",k.receiveShadow)),f.isMeshGouraudMaterial&&null!==f.envMap&&(J.envMap.value=p,J.flipEnvMap.value=p.isCubeTexture&&!1===p.isRenderTargetTexture?-1:1),f.isMeshStandardMaterial&&null===f.envMap&&null!==b.environment&&(J.envMapIntensity.value=b.environmentIntensity),G&&(I.setValue(ay,"toneMappingExposure",V.toneMappingExposure),B.needsLights&&a3(J,H),l&&!0===f.fog&&o.refreshFogUniforms(J,l),o.refreshMaterialUniforms(J,f,ah,ag,S.state.transmissionRenderTarget[a.id]),kA.upload(ay,aY(B),J,h)),f.isShaderMaterial&&!0===f.uniformsNeedUpdate&&(kA.upload(ay,aY(B),J,h),f.uniformsNeedUpdate=!1),f.isSpriteMaterial&&I.setValue(ay,"center",k.center),I.setValue(ay,"modelViewMatrix",k.modelViewMatrix),I.setValue(ay,"normalMatrix",k.normalMatrix),I.setValue(ay,"modelMatrix",k.matrixWorld),f.isShaderMaterial||f.isRawShaderMaterial){let a=f.uniformsGroups;for(let b=0,c=a.length;b<c;b++){let c=a[b];z.update(c,E),z.bind(c,E)}}return E}function a3(a,b){a.ambientLightColor.needsUpdate=b,a.lightProbe.needsUpdate=b,a.directionalLights.needsUpdate=b,a.directionalLightShadows.needsUpdate=b,a.pointLights.needsUpdate=b,a.pointLightShadows.needsUpdate=b,a.spotLights.needsUpdate=b,a.spotLightShadows.needsUpdate=b,a.rectAreaLights.needsUpdate=b,a.hemisphereLights.needsUpdate=b}function a4(a){return a.isMeshLambertMaterial||a.isMeshToonMaterial||a.isMeshPhongMaterial||a.isMeshStandardMaterial||a.isShadowMaterial||a.isShaderMaterial&&!0===a.lights}aN.setAnimationLoop(aK),"undefined"!=typeof self&&aN.setContext(self),this.setAnimationLoop=function(a){aJ=a,aB.setAnimationLoop(a),null===a?aN.stop():aN.start()},aB.addEventListener("sessionstart",aL),aB.addEventListener("sessionend",aM),this.render=function(a,b){if(void 0!==b&&!0!==b.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===W)return;if(!0===a.matrixWorldAutoUpdate&&a.updateMatrixWorld(),null===b.parent&&!0===b.matrixWorldAutoUpdate&&b.updateMatrixWorld(),!0===aB.enabled&&!0===aB.isPresenting&&(!0===aB.cameraAutoUpdate&&aB.updateCamera(b),b=aB.getCamera()),!0===a.isScene&&a.onBeforeRender(V,a,b,Z),(S=q.get(a,U.length)).init(b),U.push(S),ar.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse),an.setFromProjectionMatrix(ar),ap=this.localClippingEnabled,ao=r.init(this.clippingPlanes,ap),(R=p.get(a,T.length)).init(),T.push(R),!0===aB.enabled&&!0===aB.isPresenting){let a=V.xr.getDepthSensingMesh();null!==a&&aO(a,b,-1/0,V.sortObjects)}aO(a,b,0,V.sortObjects),R.finish(),!0===V.sortObjects&&R.sort(ai,aj),(aw=!1===aB.enabled||!1===aB.isPresenting||!1===aB.hasDepthSensing())&&t.addToRenderList(R,a),this.info.render.frame++,!0===ao&&r.beginShadows();let c=S.state.shadowsArray;s.render(c,a,b),!0===ao&&r.endShadows(),!0===this.info.autoReset&&this.info.reset();let d=R.opaque,e=R.transmissive;if(S.setupLights(),b.isArrayCamera){let c=b.cameras;if(e.length>0)for(let b=0,f=c.length;b<f;b++)aQ(d,e,a,c[b]);aw&&t.render(a);for(let b=0,d=c.length;b<d;b++){let d=c[b];aP(R,a,d,d.viewport)}}else e.length>0&&aQ(d,e,a,b),aw&&t.render(a),aP(R,a,b);null!==Z&&0===Y&&(h.updateMultisampleRenderTarget(Z),h.updateRenderTargetMipmap(Z)),!0===a.isScene&&a.onAfterRender(V,a,b),y.resetDefaultState(),$=-1,_=null,U.pop(),U.length>0?(S=U[U.length-1],!0===ao&&r.setGlobalState(V.clippingPlanes,S.state.camera)):S=null,T.pop(),R=T.length>0?T[T.length-1]:null},this.getActiveCubeFace=function(){return X},this.getActiveMipmapLevel=function(){return Y},this.getRenderTarget=function(){return Z},this.setRenderTargetTextures=function(a,b,d){g.get(a.texture).__webglTexture=b,g.get(a.depthTexture).__webglTexture=d;let e=g.get(a);e.__hasExternalTextures=!0,e.__autoAllocateDepthBuffer=void 0===d,e.__autoAllocateDepthBuffer||!0!==c.has("WEBGL_multisampled_render_to_texture")||(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),e.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(a,b){let c=g.get(a);c.__webglFramebuffer=b,c.__useDefaultFramebuffer=void 0===b};let a5=ay.createFramebuffer();this.setRenderTarget=function(a,b=0,c=0){Z=a,X=b,Y=c;let d=!0,f=null,i=!1,j=!1;if(a){let k=g.get(a);if(void 0!==k.__useDefaultFramebuffer)e.bindFramebuffer(ay.FRAMEBUFFER,null),d=!1;else if(void 0===k.__webglFramebuffer)h.setupRenderTarget(a);else if(k.__hasExternalTextures)h.rebindTextures(a,g.get(a.texture).__webglTexture,g.get(a.depthTexture).__webglTexture);else if(a.depthBuffer){let b=a.depthTexture;if(k.__boundDepthTexture!==b){if(null!==b&&g.has(b)&&(a.width!==b.image.width||a.height!==b.image.height))throw Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");h.setupDepthRenderbuffer(a)}}let l=a.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(j=!0);let m=g.get(a).__webglFramebuffer;a.isWebGLCubeRenderTarget?(f=Array.isArray(m[b])?m[b][c]:m[b],i=!0):f=a.samples>0&&!1===h.useMultisampledRTT(a)?g.get(a).__webglMultisampledFramebuffer:Array.isArray(m)?m[c]:m,aa.copy(a.viewport),ab.copy(a.scissor),ac=a.scissorTest}else aa.copy(ak).multiplyScalar(ah).floor(),ab.copy(al).multiplyScalar(ah).floor(),ac=am;if(0!==c&&(f=a5),e.bindFramebuffer(ay.FRAMEBUFFER,f)&&d&&e.drawBuffers(a,f),e.viewport(aa),e.scissor(ab),e.setScissorTest(ac),i){let d=g.get(a.texture);ay.framebufferTexture2D(ay.FRAMEBUFFER,ay.COLOR_ATTACHMENT0,ay.TEXTURE_CUBE_MAP_POSITIVE_X+b,d.__webglTexture,c)}else if(j){let d=g.get(a.texture),e=b;ay.framebufferTextureLayer(ay.FRAMEBUFFER,ay.COLOR_ATTACHMENT0,d.__webglTexture,c,e)}else if(null!==a&&0!==c){let b=g.get(a.texture);ay.framebufferTexture2D(ay.FRAMEBUFFER,ay.COLOR_ATTACHMENT0,ay.TEXTURE_2D,b.__webglTexture,c)}$=-1},this.readRenderTargetPixels=function(a,b,c,f,h,i,j){if(!(a&&a.isWebGLRenderTarget))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let k=g.get(a).__webglFramebuffer;if(a.isWebGLCubeRenderTarget&&void 0!==j&&(k=k[j]),k){e.bindFramebuffer(ay.FRAMEBUFFER,k);try{let e=a.texture,g=e.format,j=e.type;if(!d.textureFormatReadable(g))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!d.textureTypeReadable(j))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");b>=0&&b<=a.width-f&&c>=0&&c<=a.height-h&&ay.readPixels(b,c,f,h,x.convert(g),x.convert(j),i)}finally{let a=null!==Z?g.get(Z).__webglFramebuffer:null;e.bindFramebuffer(ay.FRAMEBUFFER,a)}}},this.readRenderTargetPixelsAsync=async function(a,b,c,f,h,i,j){if(!(a&&a.isWebGLRenderTarget))throw Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let k=g.get(a).__webglFramebuffer;if(a.isWebGLCubeRenderTarget&&void 0!==j&&(k=k[j]),k){let j=a.texture,l=j.format,m=j.type;if(!d.textureFormatReadable(l))throw Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!d.textureTypeReadable(m))throw Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(b>=0&&b<=a.width-f&&c>=0&&c<=a.height-h){e.bindFramebuffer(ay.FRAMEBUFFER,k);let a=ay.createBuffer();ay.bindBuffer(ay.PIXEL_PACK_BUFFER,a),ay.bufferData(ay.PIXEL_PACK_BUFFER,i.byteLength,ay.STREAM_READ),ay.readPixels(b,c,f,h,x.convert(l),x.convert(m),0);let d=null!==Z?g.get(Z).__webglFramebuffer:null;e.bindFramebuffer(ay.FRAMEBUFFER,d);let j=ay.fenceSync(ay.SYNC_GPU_COMMANDS_COMPLETE,0);return ay.flush(),await cB(ay,j,4),ay.bindBuffer(ay.PIXEL_PACK_BUFFER,a),ay.getBufferSubData(ay.PIXEL_PACK_BUFFER,0,i),ay.deleteBuffer(a),ay.deleteSync(j),i}throw Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(a,b=null,c=0){!0!==a.isTexture&&(cA("WebGLRenderer: copyFramebufferToTexture function signature has changed."),b=arguments[0]||null,a=arguments[1]);let d=Math.pow(2,-c),f=Math.floor(a.image.width*d),g=Math.floor(a.image.height*d),i=null!==b?b.x:0,j=null!==b?b.y:0;h.setTexture2D(a,0),ay.copyTexSubImage2D(ay.TEXTURE_2D,c,0,0,i,j,f,g),e.unbindTexture()};let a6=ay.createFramebuffer(),a7=ay.createFramebuffer();this.copyTextureToTexture=function(a,b,c=null,d=null,f=0,i=null){let j,k,l,m,n,o,p,q,r,s;!0!==a.isTexture&&(cA("WebGLRenderer: copyTextureToTexture function signature has changed."),d=arguments[0]||null,a=arguments[1],b=arguments[2],i=arguments[3]||0,c=null),null===i&&(0!==f?(cA("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),i=f,f=0):i=0);let t=a.isCompressedTexture?a.mipmaps[i]:a.image;if(null!==c)j=c.max.x-c.min.x,k=c.max.y-c.min.y,l=c.isBox3?c.max.z-c.min.z:1,m=c.min.x,n=c.min.y,o=c.isBox3?c.min.z:0;else{let b=Math.pow(2,-f);j=Math.floor(t.width*b),k=Math.floor(t.height*b),l=a.isDataArrayTexture?t.depth:a.isData3DTexture?Math.floor(t.depth*b):1,m=0,n=0,o=0}null!==d?(p=d.x,q=d.y,r=d.z):(p=0,q=0,r=0);let u=x.convert(b.format),v=x.convert(b.type);b.isData3DTexture?(h.setTexture3D(b,0),s=ay.TEXTURE_3D):b.isDataArrayTexture||b.isCompressedArrayTexture?(h.setTexture2DArray(b,0),s=ay.TEXTURE_2D_ARRAY):(h.setTexture2D(b,0),s=ay.TEXTURE_2D),ay.pixelStorei(ay.UNPACK_FLIP_Y_WEBGL,b.flipY),ay.pixelStorei(ay.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b.premultiplyAlpha),ay.pixelStorei(ay.UNPACK_ALIGNMENT,b.unpackAlignment);let w=ay.getParameter(ay.UNPACK_ROW_LENGTH),y=ay.getParameter(ay.UNPACK_IMAGE_HEIGHT),z=ay.getParameter(ay.UNPACK_SKIP_PIXELS),A=ay.getParameter(ay.UNPACK_SKIP_ROWS),B=ay.getParameter(ay.UNPACK_SKIP_IMAGES);ay.pixelStorei(ay.UNPACK_ROW_LENGTH,t.width),ay.pixelStorei(ay.UNPACK_IMAGE_HEIGHT,t.height),ay.pixelStorei(ay.UNPACK_SKIP_PIXELS,m),ay.pixelStorei(ay.UNPACK_SKIP_ROWS,n),ay.pixelStorei(ay.UNPACK_SKIP_IMAGES,o);let C=a.isDataArrayTexture||a.isData3DTexture,D=b.isDataArrayTexture||b.isData3DTexture;if(a.isDepthTexture){let c=g.get(a),d=g.get(b),h=g.get(c.__renderTarget),s=g.get(d.__renderTarget);e.bindFramebuffer(ay.READ_FRAMEBUFFER,h.__webglFramebuffer),e.bindFramebuffer(ay.DRAW_FRAMEBUFFER,s.__webglFramebuffer);for(let c=0;c<l;c++)C&&(ay.framebufferTextureLayer(ay.READ_FRAMEBUFFER,ay.COLOR_ATTACHMENT0,g.get(a).__webglTexture,f,o+c),ay.framebufferTextureLayer(ay.DRAW_FRAMEBUFFER,ay.COLOR_ATTACHMENT0,g.get(b).__webglTexture,i,r+c)),ay.blitFramebuffer(m,n,j,k,p,q,j,k,ay.DEPTH_BUFFER_BIT,ay.NEAREST);e.bindFramebuffer(ay.READ_FRAMEBUFFER,null),e.bindFramebuffer(ay.DRAW_FRAMEBUFFER,null)}else if(0!==f||a.isRenderTargetTexture||g.has(a)){let c=g.get(a),d=g.get(b);e.bindFramebuffer(ay.READ_FRAMEBUFFER,a6),e.bindFramebuffer(ay.DRAW_FRAMEBUFFER,a7);for(let a=0;a<l;a++)C?ay.framebufferTextureLayer(ay.READ_FRAMEBUFFER,ay.COLOR_ATTACHMENT0,c.__webglTexture,f,o+a):ay.framebufferTexture2D(ay.READ_FRAMEBUFFER,ay.COLOR_ATTACHMENT0,ay.TEXTURE_2D,c.__webglTexture,f),D?ay.framebufferTextureLayer(ay.DRAW_FRAMEBUFFER,ay.COLOR_ATTACHMENT0,d.__webglTexture,i,r+a):ay.framebufferTexture2D(ay.DRAW_FRAMEBUFFER,ay.COLOR_ATTACHMENT0,ay.TEXTURE_2D,d.__webglTexture,i),0!==f?ay.blitFramebuffer(m,n,j,k,p,q,j,k,ay.COLOR_BUFFER_BIT,ay.NEAREST):D?ay.copyTexSubImage3D(s,i,p,q,r+a,m,n,j,k):ay.copyTexSubImage2D(s,i,p,q,m,n,j,k);e.bindFramebuffer(ay.READ_FRAMEBUFFER,null),e.bindFramebuffer(ay.DRAW_FRAMEBUFFER,null)}else D?a.isDataTexture||a.isData3DTexture?ay.texSubImage3D(s,i,p,q,r,j,k,l,u,v,t.data):b.isCompressedArrayTexture?ay.compressedTexSubImage3D(s,i,p,q,r,j,k,l,u,t.data):ay.texSubImage3D(s,i,p,q,r,j,k,l,u,v,t):a.isDataTexture?ay.texSubImage2D(ay.TEXTURE_2D,i,p,q,j,k,u,v,t.data):a.isCompressedTexture?ay.compressedTexSubImage2D(ay.TEXTURE_2D,i,p,q,t.width,t.height,u,t.data):ay.texSubImage2D(ay.TEXTURE_2D,i,p,q,j,k,u,v,t);ay.pixelStorei(ay.UNPACK_ROW_LENGTH,w),ay.pixelStorei(ay.UNPACK_IMAGE_HEIGHT,y),ay.pixelStorei(ay.UNPACK_SKIP_PIXELS,z),ay.pixelStorei(ay.UNPACK_SKIP_ROWS,A),ay.pixelStorei(ay.UNPACK_SKIP_IMAGES,B),0===i&&b.generateMipmaps&&ay.generateMipmap(s),e.unbindTexture()},this.copyTextureToTexture3D=function(a,b,c=null,d=null,e=0){return!0!==a.isTexture&&(cA("WebGLRenderer: copyTextureToTexture3D function signature has changed."),c=arguments[0]||null,d=arguments[1]||null,a=arguments[2],b=arguments[3],e=arguments[4]||0),cA('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(a,b,c,d,e)},this.initRenderTarget=function(a){void 0===g.get(a).__webglFramebuffer&&h.setupRenderTarget(a)},this.initTexture=function(a){a.isCubeTexture?h.setTextureCube(a,0):a.isData3DTexture?h.setTexture3D(a,0):a.isDataArrayTexture||a.isCompressedArrayTexture?h.setTexture2DArray(a,0):h.setTexture2D(a,0),e.unbindTexture()},this.resetState=function(){X=0,Y=0,Z=null,e.reset(),y.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return ce}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(a){this._outputColorSpace=a;let b=this.getContext();b.drawingBufferColorspace=cG._getDrawingBufferColorSpace(a),b.unpackColorSpace=cG._getUnpackColorSpace()}}let lA=()=>{let a=(0,y.useRef)(null),b=(0,y.useRef)({x:0,y:0});return(0,y.useEffect)(()=>{if(!a.current)return;let c=new e2,d=new eT(75,window.innerWidth/window.innerHeight,.1,1e3),e=new lz({antialias:!0,alpha:!0,powerPreference:"high-performance"});e.setSize(window.innerWidth,window.innerHeight),e.setPixelRatio(Math.min(window.devicePixelRatio,2)),a.current.appendChild(e.domElement);let f=180,g=new er,h=new Float32Array(3*f),i=new Float32Array(3*f);for(let a=0;a<f;a++){let b=3*a;h[b]=(Math.random()-.5)*15,h[b+1]=(Math.random()-.5)*15,h[b+2]=(Math.random()-.5)*15,i[b]=(Math.random()-.5)*.005,i[b+1]=(Math.random()-.5)*.005,i[b+2]=(Math.random()-.5)*.005}g.setAttribute("position",new eg(h,3));let j=new gl(g,new gg({size:.04,color:0x99badd,transparent:!0,opacity:.4,blending:M,sizeAttenuation:!0}));c.add(j);let k=[],l=6,m=[new hE(.8,0),new hF(1.2,0),new hL(1,0)];for(let a=0;a<l;a++){let b=new hV({color:0x99badd,wireframe:!0,transparent:!0,opacity:.05,blending:M}),d=new eD(m[a%3],b);d.position.set((Math.random()-.5)*20,(Math.random()-.5)*20,(Math.random()-.5)*10-10),d.rotation.set(Math.random(),Math.random(),Math.random()),c.add(d),k.push(d)}let n=new iG(0xffffff,.4);c.add(n);let o=new iD(0x99badd,1);o.position.set(5,5,5),c.add(o),d.position.z=8;let p=()=>{d.aspect=window.innerWidth/window.innerHeight,d.updateProjectionMatrix(),e.setSize(window.innerWidth,window.innerHeight)},q=a=>{b.current={x:a.clientX/window.innerWidth*2-1,y:-(2*(a.clientY/window.innerHeight))+1}};window.addEventListener("resize",p),window.addEventListener("mousemove",q);let r=()=>{requestAnimationFrame(r);let a=g.attributes.position.array;for(let b=0;b<f;b++){let c=3*b;a[c]+=i[c],a[c+1]+=i[c+1],a[c+2]+=i[c+2],Math.abs(a[c])>10&&(i[c]*=-1),Math.abs(a[c+1])>10&&(i[c+1]*=-1),Math.abs(a[c+2])>10&&(i[c+2]*=-1)}g.attributes.position.needsUpdate=!0,k.forEach((a,b)=>{a.rotation.y+=.002*(b+1)*.2,a.rotation.x+=.001*(b+1)*.2,a.position.y+=.002*Math.sin(.001*Date.now()+b)});let h=1.5*b.current.x,j=1.5*b.current.y;d.position.x+=(h-d.position.x)*.05,d.position.y+=(j-d.position.y)*.05,d.lookAt(0,0,0),e.render(c,d)};return r(),()=>{window.removeEventListener("resize",p),window.removeEventListener("mousemove",q),a.current&&a.current.removeChild(e.domElement)}},[]),(0,x.jsx)("div",{ref:a,className:"fixed inset-0 z-0 pointer-events-none"})};function lB(a,b){-1===a.indexOf(b)&&a.push(b)}function lC(a,b){let c=a.indexOf(b);c>-1&&a.splice(c,1)}class lD{constructor(){this.subscriptions=[]}add(a){return lB(this.subscriptions,a),()=>lC(this.subscriptions,a)}notify(a,b,c){let d=this.subscriptions.length;if(d)if(1===d)this.subscriptions[0](a,b,c);else for(let e=0;e<d;e++){let d=this.subscriptions[e];d&&d(a,b,c)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function lE(a,b){return b?1e3/b*a:0}let lF={},lG=a=>a,lH=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],lI={value:null,addProjectionMetrics:null};function lJ(a,b){let c=new Set,d=new Set,e=!1,f=!1,g=new WeakSet,h={delta:0,timestamp:0,isProcessing:!1},i=0;function j(b){g.has(b)&&(k.schedule(b),a()),i++,b(h)}let k={schedule:(a,b=!1,f=!1)=>{let h=f&&e?c:d;return b&&g.add(a),h.has(a)||h.add(a),a},cancel:a=>{d.delete(a),g.delete(a)},process:a=>{if(h=a,e){f=!0;return}e=!0,[c,d]=[d,c],c.forEach(j),b&&lI.value&&lI.value.frameloop[b].push(i),i=0,c.clear(),e=!1,f&&(f=!1,k.process(a))}};return k}let lK=40;function lL(a,b){let c=!1,d=!0,e={delta:0,timestamp:0,isProcessing:!1},f=()=>c=!0,g=lH.reduce((a,c)=>(a[c]=lJ(f,b?c:void 0),a),{}),{setup:h,read:i,resolveKeyframes:j,preUpdate:k,update:l,preRender:m,render:n,postRender:o}=g,p=()=>{let f=lF.useManualTiming?e.timestamp:performance.now();c=!1,lF.useManualTiming||(e.delta=d?1e3/60:Math.max(Math.min(f-e.timestamp,lK),1)),e.timestamp=f,e.isProcessing=!0,h.process(e),i.process(e),j.process(e),k.process(e),l.process(e),m.process(e),n.process(e),o.process(e),e.isProcessing=!1,c&&b&&(d=!1,a(p))},q=()=>{c=!0,d=!0,e.isProcessing||a(p)};return{schedule:lH.reduce((a,b)=>{let d=g[b];return a[b]=(a,b=!1,e=!1)=>(c||q(),d.schedule(a,b,e)),a},{}),cancel:a=>{for(let b=0;b<lH.length;b++)g[lH[b]].cancel(a)},state:e,steps:g}}let{schedule:lM,cancel:lN,state:lO,steps:lP}=lL("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:lG,!0);function lQ(){g=void 0}let lR={now:()=>(void 0===g&&lR.set(lO.isProcessing||lF.useManualTiming?lO.timestamp:performance.now()),g),set:a=>{g=a,queueMicrotask(lQ)}},lS=30,lT=a=>!isNaN(parseFloat(a)),lU={current:void 0};class lV{constructor(a,b={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=a=>{let b=lR.now();if(this.updatedAt!==b&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(a),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(let a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(a),this.owner=b.owner}setCurrent(a){this.current=a,this.updatedAt=lR.now(),null===this.canTrackVelocity&&void 0!==a&&(this.canTrackVelocity=lT(this.current))}setPrevFrameValue(a=this.current){this.prevFrameValue=a,this.prevUpdatedAt=this.updatedAt}onChange(a){return this.on("change",a)}on(a,b){this.events[a]||(this.events[a]=new lD);let c=this.events[a].add(b);return"change"===a?()=>{c(),lM.read(()=>{this.events.change.getSize()||this.stop()})}:c}clearListeners(){for(let a in this.events)this.events[a].clear()}attach(a,b){this.passiveEffect=a,this.stopPassiveEffect=b}set(a){this.passiveEffect?this.passiveEffect(a,this.updateAndNotify):this.updateAndNotify(a)}setWithVelocity(a,b,c){this.set(b),this.prev=void 0,this.prevFrameValue=a,this.prevUpdatedAt=this.updatedAt-c}jump(a,b=!0){this.updateAndNotify(a),this.prev=a,this.prevUpdatedAt=this.prevFrameValue=void 0,b&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(a){this.dependents||(this.dependents=new Set),this.dependents.add(a)}removeDependent(a){this.dependents&&this.dependents.delete(a)}get(){return lU.current&&lU.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){let a=lR.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||a-this.updatedAt>lS)return 0;let b=Math.min(this.updatedAt-this.prevUpdatedAt,lS);return lE(parseFloat(this.current)-parseFloat(this.prevFrameValue),b)}start(a){return this.stop(),new Promise(b=>{this.hasAnimated=!0,this.animation=a(b),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function lW(a,b){return new lV(a,b)}let lX=(0,y.createContext)({transformPagePoint:a=>a,isStatic:!1,reducedMotion:"never"});function lY(a){let b=(0,y.useRef)(null);return null===b.current&&(b.current=a()),b.current}function lZ(a){let b=lY(()=>lW(a)),{isStatic:c}=(0,y.useContext)(lX);if(c){let[,b]=(0,y.useState)(a)}return b}let l$=a=>!!(a&&a.getVelocity),l_=(a,b)=>c=>b(a(c)),l0=(...a)=>a.reduce(l_),l1=(a,b,c)=>c>b?b:c<a?a:c,l2=a=>1e3*a,l3=a=>a/1e3,l4={layout:0,mainThread:0,waapi:0},l5=()=>{},l6=()=>{},l7=a=>b=>"string"==typeof b&&b.startsWith(a),l8=l7("--"),l9=l7("var(--"),ma=a=>!!l9(a)&&mb.test(a.split("/*")[0].trim()),mb=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function mc(a){return"string"==typeof a&&a.split("/*")[0].includes("var(--")}let md={test:a=>"number"==typeof a,parse:parseFloat,transform:a=>a},me={...md,transform:a=>l1(0,1,a)},mf={...md,default:1},mg=a=>Math.round(1e5*a)/1e5,mh=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function mi(a){return null==a}let mj=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,mk=(a,b)=>c=>!!("string"==typeof c&&mj.test(c)&&c.startsWith(a)||b&&!mi(c)&&Object.prototype.hasOwnProperty.call(c,b)),ml=(a,b,c)=>d=>{if("string"!=typeof d)return d;let[e,f,g,h]=d.match(mh);return{[a]:parseFloat(e),[b]:parseFloat(f),[c]:parseFloat(g),alpha:void 0!==h?parseFloat(h):1}},mm=a=>l1(0,255,a),mn={...md,transform:a=>Math.round(mm(a))},mo={test:mk("rgb","red"),parse:ml("red","green","blue"),transform:({red:a,green:b,blue:c,alpha:d=1})=>"rgba("+mn.transform(a)+", "+mn.transform(b)+", "+mn.transform(c)+", "+mg(me.transform(d))+")"};function mp(a){let b="",c="",d="",e="";return a.length>5?(b=a.substring(1,3),c=a.substring(3,5),d=a.substring(5,7),e=a.substring(7,9)):(b=a.substring(1,2),c=a.substring(2,3),d=a.substring(3,4),e=a.substring(4,5),b+=b,c+=c,d+=d,e+=e),{red:parseInt(b,16),green:parseInt(c,16),blue:parseInt(d,16),alpha:e?parseInt(e,16)/255:1}}let mq={test:mk("#"),parse:mp,transform:mo.transform},mr=a=>({test:b=>"string"==typeof b&&b.endsWith(a)&&1===b.split(" ").length,parse:parseFloat,transform:b=>`${b}${a}`}),ms=mr("deg"),mt=mr("%"),mu=mr("px"),mv=mr("vh"),mw=mr("vw"),mx={...mt,parse:a=>mt.parse(a)/100,transform:a=>mt.transform(100*a)},my={test:mk("hsl","hue"),parse:ml("hue","saturation","lightness"),transform:({hue:a,saturation:b,lightness:c,alpha:d=1})=>"hsla("+Math.round(a)+", "+mt.transform(mg(b))+", "+mt.transform(mg(c))+", "+mg(me.transform(d))+")"},mz={test:a=>mo.test(a)||mq.test(a)||my.test(a),parse:a=>mo.test(a)?mo.parse(a):my.test(a)?my.parse(a):mq.parse(a),transform:a=>"string"==typeof a?a:a.hasOwnProperty("red")?mo.transform(a):my.transform(a),getAnimatableNone:a=>{let b=mz.parse(a);return b.alpha=0,mz.transform(b)}},mA=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu,mB="number",mC="color",mD="var",mE="var(",mF="${}",mG=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function mH(a){let b=a.toString(),c=[],d={color:[],number:[],var:[]},e=[],f=0,g=b.replace(mG,a=>(mz.test(a)?(d.color.push(f),e.push(mC),c.push(mz.parse(a))):a.startsWith(mE)?(d.var.push(f),e.push(mD),c.push(a)):(d.number.push(f),e.push(mB),c.push(parseFloat(a))),++f,mF)).split(mF);return{values:c,split:g,indexes:d,types:e}}function mI(a){return mH(a).values}function mJ(a){let{split:b,types:c}=mH(a),d=b.length;return a=>{let e="";for(let f=0;f<d;f++)if(e+=b[f],void 0!==a[f]){let b=c[f];b===mB?e+=mg(a[f]):b===mC?e+=mz.transform(a[f]):e+=a[f]}return e}}let mK=a=>"number"==typeof a?0:mz.test(a)?mz.getAnimatableNone(a):a;function mL(a){let b=mI(a);return mJ(a)(b.map(mK))}let mM={test:function(a){return isNaN(a)&&"string"==typeof a&&(a.match(mh)?.length||0)+(a.match(mA)?.length||0)>0},parse:mI,createTransformer:mJ,getAnimatableNone:mL};function mN(a,b,c){return(c<0&&(c+=1),c>1&&(c-=1),c<1/6)?a+(b-a)*6*c:c<.5?b:c<2/3?a+(b-a)*(2/3-c)*6:a}function mO({hue:a,saturation:b,lightness:c,alpha:d}){a/=360,c/=100;let e=0,f=0,g=0;if(b/=100){let d=c<.5?c*(1+b):c+b-c*b,h=2*c-d;e=mN(h,d,a+1/3),f=mN(h,d,a),g=mN(h,d,a-1/3)}else e=f=g=c;return{red:Math.round(255*e),green:Math.round(255*f),blue:Math.round(255*g),alpha:d}}function mP(a,b){return c=>c>0?b:a}let mQ=(a,b,c)=>a+(b-a)*c,mR=(a,b,c)=>{let d=a*a,e=c*(b*b-d)+d;return e<0?0:Math.sqrt(e)},mS=[mq,mo,my],mT=a=>mS.find(b=>b.test(a));function mU(a){let b=mT(a);if(l5(!!b,`'${a}' is not an animatable color. Use the equivalent color code instead.`,"color-not-animatable"),!b)return!1;let c=b.parse(a);return b===my&&(c=mO(c)),c}let mV=(a,b)=>{let c=mU(a),d=mU(b);if(!c||!d)return mP(a,b);let e={...c};return a=>(e.red=mR(c.red,d.red,a),e.green=mR(c.green,d.green,a),e.blue=mR(c.blue,d.blue,a),e.alpha=mQ(c.alpha,d.alpha,a),mo.transform(e))},mW=new Set(["none","hidden"]);function mX(a,b){return mW.has(a)?c=>c<=0?a:b:c=>c>=1?b:a}function mY(a,b){return c=>mQ(a,b,c)}function mZ(a){return"number"==typeof a?mY:"string"==typeof a?ma(a)?mP:mz.test(a)?mV:m1:Array.isArray(a)?m$:"object"==typeof a?mz.test(a)?mV:m_:mP}function m$(a,b){let c=[...a],d=c.length,e=a.map((a,c)=>mZ(a)(a,b[c]));return a=>{for(let b=0;b<d;b++)c[b]=e[b](a);return c}}function m_(a,b){let c={...a,...b},d={};for(let e in c)void 0!==a[e]&&void 0!==b[e]&&(d[e]=mZ(a[e])(a[e],b[e]));return a=>{for(let b in d)c[b]=d[b](a);return c}}function m0(a,b){let c=[],d={color:0,var:0,number:0};for(let e=0;e<b.values.length;e++){let f=b.types[e],g=a.indexes[f][d[f]],h=a.values[g]??0;c[e]=h,d[f]++}return c}let m1=(a,b)=>{let c=mM.createTransformer(b),d=mH(a),e=mH(b);return d.indexes.var.length===e.indexes.var.length&&d.indexes.color.length===e.indexes.color.length&&d.indexes.number.length>=e.indexes.number.length?mW.has(a)&&!e.values.length||mW.has(b)&&!d.values.length?mX(a,b):l0(m$(m0(d,e),e.values),c):(l5(!0,`Complex values '${a}' and '${b}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`,"complex-values-different"),mP(a,b))};function m2(a,b,c){return"number"==typeof a&&"number"==typeof b&&"number"==typeof c?mQ(a,b,c):mZ(a)(a,b)}let m3=a=>{let b=({timestamp:b})=>a(b);return{start:(a=!0)=>lM.update(b,a),stop:()=>lN(b),now:()=>lO.isProcessing?lO.timestamp:lR.now()}},m4=(a,b,c=10)=>{let d="",e=Math.max(Math.round(b/c),2);for(let b=0;b<e;b++)d+=Math.round(1e4*a(b/(e-1)))/1e4+", ";return`linear(${d.substring(0,d.length-2)})`},m5=2e4;function m6(a){let b=0,c=50,d=a.next(b);for(;!d.done&&b<m5;)b+=c,d=a.next(b);return b>=m5?1/0:b}function m7(a,b=100,c){let d=c({...a,keyframes:[0,b]}),e=Math.min(m6(d),m5);return{type:"keyframes",ease:a=>d.next(e*a).value/b,duration:l3(e)}}let m8=5;function m9(a,b,c){let d=Math.max(b-m8,0);return lE(c-a(d),b-d)}let na={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},nb=.001;function nc({duration:a=na.duration,bounce:b=na.bounce,velocity:c=na.velocity,mass:d=na.mass}){let e,f;l5(a<=l2(na.maxDuration),"Spring duration must be 10 seconds or less","spring-duration-limit");let g=1-b;g=l1(na.minDamping,na.maxDamping,g),a=l1(na.minDuration,na.maxDuration,l3(a)),g<1?(e=b=>{let d=b*g,e=d*a;return nb-(d-c)/nf(b,g)*Math.exp(-e)},f=b=>{let d=b*g*a,f=d*c+c,h=Math.pow(g,2)*Math.pow(b,2)*a,i=Math.exp(-d),j=nf(Math.pow(b,2),g);return(f-h)*i*(-e(b)+nb>0?-1:1)/j}):(e=b=>-nb+Math.exp(-b*a)*((b-c)*a+1),f=b=>a*a*(c-b)*Math.exp(-b*a));let h=ne(e,f,5/a);if(a=l2(a),isNaN(h))return{stiffness:na.stiffness,damping:na.damping,duration:a};{let b=Math.pow(h,2)*d;return{stiffness:b,damping:2*g*Math.sqrt(d*b),duration:a}}}let nd=12;function ne(a,b,c){let d=c;for(let c=1;c<nd;c++)d-=a(d)/b(d);return d}function nf(a,b){return a*Math.sqrt(1-b*b)}let ng=["duration","bounce"],nh=["stiffness","damping","mass"];function ni(a,b){return b.some(b=>void 0!==a[b])}function nj(a){let b={velocity:na.velocity,stiffness:na.stiffness,damping:na.damping,mass:na.mass,isResolvedFromDuration:!1,...a};if(!ni(a,nh)&&ni(a,ng))if(a.visualDuration){let c=2*Math.PI/(1.2*a.visualDuration),d=c*c,e=2*l1(.05,1,1-(a.bounce||0))*Math.sqrt(d);b={...b,mass:na.mass,stiffness:d,damping:e}}else{let c=nc(a);(b={...b,...c,mass:na.mass}).isResolvedFromDuration=!0}return b}function nk(a=na.visualDuration,b=na.bounce){let c,d="object"!=typeof a?{visualDuration:a,keyframes:[0,1],bounce:b}:a,{restSpeed:e,restDelta:f}=d,g=d.keyframes[0],h=d.keyframes[d.keyframes.length-1],i={done:!1,value:g},{stiffness:j,damping:k,mass:l,duration:m,velocity:n,isResolvedFromDuration:o}=nj({...d,velocity:-l3(d.velocity||0)}),p=n||0,q=k/(2*Math.sqrt(j*l)),r=h-g,s=l3(Math.sqrt(j/l)),t=5>Math.abs(r);if(e||(e=t?na.restSpeed.granular:na.restSpeed.default),f||(f=t?na.restDelta.granular:na.restDelta.default),q<1){let a=nf(s,q);c=b=>h-Math.exp(-q*s*b)*((p+q*s*r)/a*Math.sin(a*b)+r*Math.cos(a*b))}else if(1===q)c=a=>h-Math.exp(-s*a)*(r+(p+s*r)*a);else{let a=s*Math.sqrt(q*q-1);c=b=>{let c=Math.exp(-q*s*b),d=Math.min(a*b,300);return h-c*((p+q*s*r)*Math.sinh(d)+a*r*Math.cosh(d))/a}}let u={calculatedDuration:o&&m||null,next:a=>{let b=c(a);if(o)i.done=a>=m;else{let d=0===a?p:0;q<1&&(d=0===a?l2(p):m9(c,a,b));let g=Math.abs(h-b)<=f;i.done=Math.abs(d)<=e&&g}return i.value=i.done?h:b,i},toString:()=>{let a=Math.min(m6(u),m5),b=m4(b=>u.next(a*b).value,a,30);return a+"ms "+b},toTransition:()=>{}};return u}function nl({keyframes:a,velocity:b=0,power:c=.8,timeConstant:d=325,bounceDamping:e=10,bounceStiffness:f=500,modifyTarget:g,min:h,max:i,restDelta:j=.5,restSpeed:k}){let l,m,n=a[0],o={done:!1,value:n},p=a=>void 0!==h&&a<h||void 0!==i&&a>i,q=a=>void 0===h?i:void 0===i||Math.abs(h-a)<Math.abs(i-a)?h:i,r=c*b,s=n+r,t=void 0===g?s:g(s);t!==s&&(r=t-n);let u=a=>-r*Math.exp(-a/d),v=a=>t+u(a),w=a=>{let b=u(a),c=v(a);o.done=Math.abs(b)<=j,o.value=o.done?t:c},x=a=>{p(o.value)&&(l=a,m=nk({keyframes:[o.value,q(o.value)],velocity:m9(v,a,o.value),damping:e,stiffness:f,restDelta:j,restSpeed:k}))};return x(0),{calculatedDuration:null,next:a=>{let b=!1;return(m||void 0!==l||(b=!0,w(a),x(a)),void 0!==l&&a>=l)?m.next(a-l):(b||w(a),o)}}}nk.applyToOptions=a=>{let b=m7(a,100,nk);return a.ease=b.ease,a.duration=l2(b.duration),a.type="keyframes",a};let nm=(a,b,c)=>(((1-3*c+3*b)*a+(3*c-6*b))*a+3*b)*a,nn=1e-7,no=12;function np(a,b,c,d,e){let f,g,h=0;do(f=nm(g=b+(c-b)/2,d,e)-a)>0?c=g:b=g;while(Math.abs(f)>nn&&++h<no);return g}function nq(a,b,c,d){if(a===b&&c===d)return lG;let e=b=>np(b,0,1,a,c);return a=>0===a||1===a?a:nm(e(a),b,d)}let nr=nq(.42,0,1,1),ns=nq(0,0,.58,1),nt=nq(.42,0,.58,1),nu=a=>Array.isArray(a)&&"number"!=typeof a[0],nv=a=>b=>b<=.5?a(2*b)/2:(2-a(2*(1-b)))/2,nw=a=>b=>1-a(1-b),nx=nq(.33,1.53,.69,.99),ny=nw(nx),nz=nv(ny),nA=a=>(a*=2)<1?.5*ny(a):.5*(2-Math.pow(2,-10*(a-1))),nB=a=>1-Math.sin(Math.acos(a)),nC=nw(nB),nD=nv(nB),nE=a=>Array.isArray(a)&&"number"==typeof a[0],nF={linear:lG,easeIn:nr,easeInOut:nt,easeOut:ns,circIn:nB,circInOut:nD,circOut:nC,backIn:ny,backInOut:nz,backOut:nx,anticipate:nA},nG=a=>"string"==typeof a,nH=a=>{if(nE(a)){l6(4===a.length,"Cubic bezier arrays must contain four numerical values.","cubic-bezier-length");let[b,c,d,e]=a;return nq(b,c,d,e)}return nG(a)?(l6(void 0!==nF[a],`Invalid easing type '${a}'`,"invalid-easing-type"),nF[a]):a},nI=(a,b,c)=>{let d=b-a;return 0===d?1:(c-a)/d};function nJ(a,b,c){let d=[],e=c||lF.mix||m2,f=a.length-1;for(let c=0;c<f;c++){let f=e(a[c],a[c+1]);b&&(f=l0(Array.isArray(b)?b[c]||lG:b,f)),d.push(f)}return d}function nK(a,b,{clamp:c=!0,ease:d,mixer:e}={}){let f=a.length;if(l6(f===b.length,"Both input and output ranges must be the same length","range-length"),1===f)return()=>b[0];if(2===f&&b[0]===b[1])return()=>b[1];let g=a[0]===a[1];a[0]>a[f-1]&&(a=[...a].reverse(),b=[...b].reverse());let h=nJ(b,d,e),i=h.length,j=c=>{if(g&&c<a[0])return b[0];let d=0;if(i>1)for(;d<a.length-2&&!(c<a[d+1]);d++);let e=nI(a[d],a[d+1],c);return h[d](e)};return c?b=>j(l1(a[0],a[f-1],b)):j}function nL(a,b){let c=a[a.length-1];for(let d=1;d<=b;d++){let e=nI(0,b,d);a.push(mQ(c,1,e))}}function nM(a){let b=[0];return nL(b,a.length-1),b}function nN(a,b){return a.map(a=>a*b)}function nO(a,b){return a.map(()=>b||nt).splice(0,a.length-1)}function nP({duration:a=300,keyframes:b,times:c,ease:d="easeInOut"}){let e=nu(d)?d.map(nH):nH(d),f={done:!1,value:b[0]},g=nK(nN(c&&c.length===b.length?c:nM(b),a),b,{ease:Array.isArray(e)?e:nO(b,e)});return{calculatedDuration:a,next:b=>(f.value=g(b),f.done=b>=a,f)}}let nQ=a=>null!==a;function nR(a,{repeat:b,repeatType:c="loop"},d,e=1){let f=a.filter(nQ),g=e<0||b&&"loop"!==c&&b%2==1?0:f.length-1;return g&&void 0!==d?d:f[g]}let nS={decay:nl,inertia:nl,tween:nP,keyframes:nP,spring:nk};function nT(a){"string"==typeof a.type&&(a.type=nS[a.type])}class nU{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(a=>{this.resolve=a})}notifyFinished(){this.resolve()}then(a,b){return this.finished.then(a,b)}}let nV=a=>a/100;class nW extends nU{constructor(a){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{let{motionValue:a}=this.options;a&&a.updatedAt!==lR.now()&&this.tick(lR.now()),this.isStopped=!0,"idle"!==this.state&&(this.teardown(),this.options.onStop?.())},l4.mainThread++,this.options=a,this.initAnimation(),this.play(),!1===a.autoplay&&this.pause()}initAnimation(){let{options:a}=this;nT(a);let{type:b=nP,repeat:c=0,repeatDelay:d=0,repeatType:e,velocity:f=0}=a,{keyframes:g}=a,h=b||nP;h!==nP&&"number"!=typeof g[0]&&(this.mixKeyframes=l0(nV,m2(g[0],g[1])),g=[0,100]);let i=h({...a,keyframes:g});"mirror"===e&&(this.mirroredGenerator=h({...a,keyframes:[...g].reverse(),velocity:-f})),null===i.calculatedDuration&&(i.calculatedDuration=m6(i));let{calculatedDuration:j}=i;this.calculatedDuration=j,this.resolvedDuration=j+d,this.totalDuration=this.resolvedDuration*(c+1)-d,this.generator=i}updateTime(a){let b=Math.round(a-this.startTime)*this.playbackSpeed;null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=b}tick(a,b=!1){let{generator:c,totalDuration:d,mixKeyframes:e,mirroredGenerator:f,resolvedDuration:g,calculatedDuration:h}=this;if(null===this.startTime)return c.next(0);let{delay:i=0,keyframes:j,repeat:k,repeatType:l,repeatDelay:m,type:n,onUpdate:o,finalKeyframe:p}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,a):this.speed<0&&(this.startTime=Math.min(a-d/this.speed,this.startTime)),b?this.currentTime=a:this.updateTime(a);let q=this.currentTime-i*(this.playbackSpeed>=0?1:-1),r=this.playbackSpeed>=0?q<0:q>d;this.currentTime=Math.max(q,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=d);let s=this.currentTime,t=c;if(k){let a=Math.min(this.currentTime,d)/g,b=Math.floor(a),c=a%1;!c&&a>=1&&(c=1),1===c&&b--,(b=Math.min(b,k+1))%2&&("reverse"===l?(c=1-c,m&&(c-=m/g)):"mirror"===l&&(t=f)),s=l1(0,1,c)*g}let u=r?{done:!1,value:j[0]}:t.next(s);e&&(u.value=e(u.value));let{done:v}=u;r||null===h||(v=this.playbackSpeed>=0?this.currentTime>=d:this.currentTime<=0);let w=null===this.holdTime&&("finished"===this.state||"running"===this.state&&v);return w&&n!==nl&&(u.value=nR(j,this.options,p,this.speed)),o&&o(u.value),w&&this.finish(),u}then(a,b){return this.finished.then(a,b)}get duration(){return l3(this.calculatedDuration)}get iterationDuration(){let{delay:a=0}=this.options||{};return this.duration+l3(a)}get time(){return l3(this.currentTime)}set time(a){a=l2(a),this.currentTime=a,null===this.startTime||null!==this.holdTime||0===this.playbackSpeed?this.holdTime=a:this.driver&&(this.startTime=this.driver.now()-a/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(a){this.updateTime(lR.now());let b=this.playbackSpeed!==a;this.playbackSpeed=a,b&&(this.time=l3(this.currentTime))}play(){if(this.isStopped)return;let{driver:a=m3,startTime:b}=this.options;this.driver||(this.driver=a(a=>this.tick(a))),this.options.onPlay?.();let c=this.driver.now();"finished"===this.state?(this.updateFinished(),this.startTime=c):null!==this.holdTime?this.startTime=c-this.holdTime:this.startTime||(this.startTime=b??c),"finished"===this.state&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(lR.now()),this.holdTime=this.currentTime}complete(){"running"!==this.state&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null,l4.mainThread--}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(a){return this.startTime=0,this.tick(a,!0)}attachTimeline(a){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),a.observe(this)}}function nX(a,b,c={}){let d,e=a.get(),f=null,g=e,h="string"==typeof e?e.replace(/[\d.-]/g,""):void 0,i=()=>{f&&(f.stop(),f=null)},j=()=>{i();let b=nZ(a.get()),e=nZ(g);b!==e&&(f=new nW({keyframes:[b,e],velocity:a.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...c,onUpdate:d}))};if(a.attach((b,c)=>{g=b,d=a=>c(nY(a,h)),lM.postRender(()=>{j(),a.events.animationStart?.notify(),f?.then(()=>{a.events.animationComplete?.notify()})})},i),l$(b)){let c=b.on("change",b=>a.set(nY(b,h))),d=a.on("destroy",c);return()=>{c(),d()}}return i}function nY(a,b){return b?a+b:a}function nZ(a){return"number"==typeof a?a:parseFloat(a)}function n$(...a){let b=!Array.isArray(a[0]),c=b?0:-1,d=a[0+c],e=a[1+c],f=nK(e,a[2+c],a[3+c]);return b?f(d):f}let n_="undefined"!=typeof window,n0=n_?y.useLayoutEffect:y.useEffect;function n1(a,b){let c=lZ(b()),d=()=>c.set(b());return d(),n0(()=>{let b=()=>lM.preRender(d,!1,!0),c=a.map(a=>a.on("change",b));return()=>{c.forEach(a=>a()),lN(d)}}),c}function n2(a){lU.current=[],a();let b=n1(lU.current,a);return lU.current=void 0,b}function n3(a,b,c,d){if("function"==typeof a)return n2(a);if(void 0!==c&&!Array.isArray(c)&&"function"!=typeof b)return n5(a,b,c,d);let e=c,f="function"==typeof b?b:n$(b,e,d),g=Array.isArray(a)?n4(a,f):n4([a],([a])=>f(a)),h=Array.isArray(a)?void 0:a.accelerate;return h&&!h.isTransformed&&"function"!=typeof b&&Array.isArray(c)&&d?.clamp!==!1&&(g.accelerate={...h,times:b,keyframes:c,isTransformed:!0,...d?.ease?{ease:d.ease}:{}}),g}function n4(a,b){let c=lY(()=>[]);return n1(a,()=>{c.length=0;let d=a.length;for(let b=0;b<d;b++)c[b]=a[b].get();return b(c)})}function n5(a,b,c,d){let e=lY(()=>Object.keys(c)),f=lY(()=>({}));for(let g of e)f[g]=n3(a,b,c[g],d);return f}function n6(a,b={}){let{isStatic:c}=(0,y.useContext)(lX),d=()=>l$(a)?a.get():a;if(c)return n3(d);let e=lZ(d());return(0,y.useInsertionEffect)(()=>nX(e,a,b),[e,JSON.stringify(b)]),e}function n7(a,b={}){return n6(a,{type:"spring",...b})}let n8=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],n9=new Set(n8),oa=new Set(["brightness","contrast","saturate","opacity"]);function ob(a){let[b,c]=a.slice(0,-1).split("(");if("drop-shadow"===b)return a;let[d]=c.match(mh)||[];if(!d)return a;let e=c.replace(d,""),f=+!!oa.has(b);return d!==c&&(f*=100),b+"("+f+e+")"}let oc=/\b([a-z-]*)\(.*?\)/gu,od={...mM,getAnimatableNone:a=>{let b=a.match(oc);return b?b.map(ob).join(" "):a}},oe={...md,transform:Math.round},of={rotate:ms,rotateX:ms,rotateY:ms,rotateZ:ms,scale:mf,scaleX:mf,scaleY:mf,scaleZ:mf,skew:ms,skewX:ms,skewY:ms,distance:mu,translateX:mu,translateY:mu,translateZ:mu,x:mu,y:mu,z:mu,perspective:mu,transformPerspective:mu,opacity:me,originX:mx,originY:mx,originZ:mu},og={borderWidth:mu,borderTopWidth:mu,borderRightWidth:mu,borderBottomWidth:mu,borderLeftWidth:mu,borderRadius:mu,borderTopLeftRadius:mu,borderTopRightRadius:mu,borderBottomRightRadius:mu,borderBottomLeftRadius:mu,width:mu,maxWidth:mu,height:mu,maxHeight:mu,top:mu,right:mu,bottom:mu,left:mu,inset:mu,insetBlock:mu,insetBlockStart:mu,insetBlockEnd:mu,insetInline:mu,insetInlineStart:mu,insetInlineEnd:mu,padding:mu,paddingTop:mu,paddingRight:mu,paddingBottom:mu,paddingLeft:mu,paddingBlock:mu,paddingBlockStart:mu,paddingBlockEnd:mu,paddingInline:mu,paddingInlineStart:mu,paddingInlineEnd:mu,margin:mu,marginTop:mu,marginRight:mu,marginBottom:mu,marginLeft:mu,marginBlock:mu,marginBlockStart:mu,marginBlockEnd:mu,marginInline:mu,marginInlineStart:mu,marginInlineEnd:mu,fontSize:mu,backgroundPositionX:mu,backgroundPositionY:mu,...of,zIndex:oe,fillOpacity:me,strokeOpacity:me,numOctaves:oe},oh={...og,color:mz,backgroundColor:mz,outlineColor:mz,fill:mz,stroke:mz,borderColor:mz,borderTopColor:mz,borderRightColor:mz,borderBottomColor:mz,borderLeftColor:mz,filter:od,WebkitFilter:od},oi=a=>oh[a],oj=()=>({translate:0,scale:1,origin:0,originPoint:0}),ok=()=>({x:oj(),y:oj()}),ol=()=>({min:0,max:0}),om=()=>({x:ol(),y:ol()}),on=new Set(["width","height","top","left","right","bottom",...n8]),oo=a=>b=>b.test(a),op=[md,mu,mt,ms,mw,mv,{test:a=>"auto"===a,parse:a=>a}],oq=a=>op.find(oo(a)),or=a=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(a),os=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function ot(a){let b=os.exec(a);if(!b)return[,];let[,c,d,e]=b;return[`--${c??d}`,e]}let ou=4;function ov(a,b,c=1){l6(c<=ou,`Max CSS variable fallback depth detected in property "${a}". This may indicate a circular fallback dependency.`,"max-css-var-depth");let[d,e]=ot(a);if(!d)return;let f=window.getComputedStyle(b).getPropertyValue(d);if(f){let a=f.trim();return or(a)?parseFloat(a):a}return ma(e)?ov(e,b,c+1):e}function ow(a){for(let b=1;b<a.length;b++)a[b]??(a[b]=a[b-1])}let ox=a=>180*a/Math.PI,oy=a=>oA(ox(Math.atan2(a[1],a[0]))),oz={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:a=>(Math.abs(a[0])+Math.abs(a[3]))/2,rotate:oy,rotateZ:oy,skewX:a=>ox(Math.atan(a[1])),skewY:a=>ox(Math.atan(a[2])),skew:a=>(Math.abs(a[1])+Math.abs(a[2]))/2},oA=a=>((a%=360)<0&&(a+=360),a),oB=oy,oC=a=>Math.sqrt(a[0]*a[0]+a[1]*a[1]),oD=a=>Math.sqrt(a[4]*a[4]+a[5]*a[5]),oE={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:oC,scaleY:oD,scale:a=>(oC(a)+oD(a))/2,rotateX:a=>oA(ox(Math.atan2(a[6],a[5]))),rotateY:a=>oA(ox(Math.atan2(-a[2],a[0]))),rotateZ:oB,rotate:oB,skewX:a=>ox(Math.atan(a[4])),skewY:a=>ox(Math.atan(a[1])),skew:a=>(Math.abs(a[1])+Math.abs(a[4]))/2};function oF(a){return+!!a.includes("scale")}function oG(a,b){let c,d;if(!a||"none"===a)return oF(b);let e=a.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);if(e)c=oE,d=e;else{let b=a.match(/^matrix\(([-\d.e\s,]+)\)$/u);c=oz,d=b}if(!d)return oF(b);let f=c[b],g=d[1].split(",").map(oI);return"function"==typeof f?f(g):g[f]}let oH=(a,b)=>{let{transform:c="none"}=getComputedStyle(a);return oG(c,b)};function oI(a){return parseFloat(a.trim())}let oJ=a=>a===md||a===mu,oK=new Set(["x","y","z"]),oL=n8.filter(a=>!oK.has(a));function oM(a){let b=[];return oL.forEach(c=>{let d=a.getValue(c);void 0!==d&&(b.push([c,d.get()]),d.set(+!!c.startsWith("scale")))}),b}let oN={width:({x:a},{paddingLeft:b="0",paddingRight:c="0"})=>a.max-a.min-parseFloat(b)-parseFloat(c),height:({y:a},{paddingTop:b="0",paddingBottom:c="0"})=>a.max-a.min-parseFloat(b)-parseFloat(c),top:(a,{top:b})=>parseFloat(b),left:(a,{left:b})=>parseFloat(b),bottom:({y:a},{top:b})=>parseFloat(b)+(a.max-a.min),right:({x:a},{left:b})=>parseFloat(b)+(a.max-a.min),x:(a,{transform:b})=>oG(b,"x"),y:(a,{transform:b})=>oG(b,"y")};oN.translateX=oN.x,oN.translateY=oN.y;let oO=new Set,oP=!1,oQ=!1,oR=!1;function oS(){if(oQ){let a=Array.from(oO).filter(a=>a.needsMeasurement),b=new Set(a.map(a=>a.element)),c=new Map;b.forEach(a=>{let b=oM(a);b.length&&(c.set(a,b),a.render())}),a.forEach(a=>a.measureInitialState()),b.forEach(a=>{a.render();let b=c.get(a);b&&b.forEach(([b,c])=>{a.getValue(b)?.set(c)})}),a.forEach(a=>a.measureEndState()),a.forEach(a=>{void 0!==a.suspendedScrollY&&window.scrollTo(0,a.suspendedScrollY)})}oQ=!1,oP=!1,oO.forEach(a=>a.complete(oR)),oO.clear()}function oT(){oO.forEach(a=>{a.readKeyframes(),a.needsMeasurement&&(oQ=!0)})}function oU(){oR=!0,oT(),oS(),oR=!1}class oV{constructor(a,b,c,d,e,f=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...a],this.onComplete=b,this.name=c,this.motionValue=d,this.element=e,this.isAsync=f}scheduleResolve(){this.state="scheduled",this.isAsync?(oO.add(this),oP||(oP=!0,lM.read(oT),lM.resolveKeyframes(oS))):(this.readKeyframes(),this.complete())}readKeyframes(){let{unresolvedKeyframes:a,name:b,element:c,motionValue:d}=this;if(null===a[0]){let e=d?.get(),f=a[a.length-1];if(void 0!==e)a[0]=e;else if(c&&b){let d=c.readValue(b,f);null!=d&&(a[0]=d)}void 0===a[0]&&(a[0]=f),d&&void 0===e&&d.set(a[0])}ow(a)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(a=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,a),oO.delete(this)}cancel(){"scheduled"===this.state&&(oO.delete(this),this.state="pending")}resume(){"pending"===this.state&&this.scheduleResolve()}}let oW=a=>/^0[^.\s]+$/u.test(a);function oX(a){return"number"==typeof a?0===a:null===a||"none"===a||"0"===a||oW(a)}function oY(a,b){let c=oi(a);return c!==od&&(c=mM),c.getAnimatableNone?c.getAnimatableNone(b):void 0}let oZ=new Set(["auto","none","0"]);function o$(a,b,c){let d,e=0;for(;e<a.length&&!d;){let b=a[e];"string"==typeof b&&!oZ.has(b)&&mH(b).values.length&&(d=a[e]),e++}if(d&&c)for(let e of b)a[e]=oY(c,d)}class o_ extends oV{constructor(a,b,c,d,e){super(a,b,c,d,e,!0)}readKeyframes(){let{unresolvedKeyframes:a,element:b,name:c}=this;if(!b||!b.current)return;super.readKeyframes();for(let c=0;c<a.length;c++){let d=a[c];if("string"==typeof d&&ma(d=d.trim())){let e=ov(d,b.current);void 0!==e&&(a[c]=e),c===a.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!on.has(c)||2!==a.length)return;let[d,e]=a,f=oq(d),g=oq(e);if(mc(d)!==mc(e)&&oN[c]){this.needsMeasurement=!0;return}if(f!==g)if(oJ(f)&&oJ(g))for(let b=0;b<a.length;b++){let c=a[b];"string"==typeof c&&(a[b]=parseFloat(c))}else oN[c]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){let{unresolvedKeyframes:a,name:b}=this,c=[];for(let b=0;b<a.length;b++)(null===a[b]||oX(a[b]))&&c.push(b);c.length&&o$(a,c,b)}measureInitialState(){let{element:a,unresolvedKeyframes:b,name:c}=this;if(!a||!a.current)return;"height"===c&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=oN[c](a.measureViewportBox(),window.getComputedStyle(a.current)),b[0]=this.measuredOrigin;let d=b[b.length-1];void 0!==d&&a.getValue(c,d).jump(d,!1)}measureEndState(){let{element:a,name:b,unresolvedKeyframes:c}=this;if(!a||!a.current)return;let d=a.getValue(b);d&&d.jump(this.measuredOrigin,!1);let e=c.length-1,f=c[e];c[e]=oN[b](a.measureViewportBox(),window.getComputedStyle(a.current)),null!==f&&void 0===this.finalKeyframe&&(this.finalKeyframe=f),this.removedTransforms?.length&&this.removedTransforms.forEach(([b,c])=>{a.getValue(b).set(c)}),this.resolveNoneKeyframes()}}let o0=a=>a.startsWith("--");function o1(a,b,c){o0(b)?a.style.setProperty(b,c):a.style[b]=c}function o2(a){let b;return()=>(void 0===b&&(b=a()),b)}let o3=o2(()=>void 0!==window.ScrollTimeline),o4={},o5=function(a,b){let c=o2(a);return()=>o4[b]??c()}(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(a){return!1}return!0},"linearEasing"),o6=([a,b,c,d])=>`cubic-bezier(${a}, ${b}, ${c}, ${d})`,o7={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:o6([0,.65,.55,1]),circOut:o6([.55,0,1,.45]),backIn:o6([.31,.01,.66,-.59]),backOut:o6([.33,1.53,.69,.99])};function o8(a,b){if(a)return"function"==typeof a?o5()?m4(a,b):"ease-out":nE(a)?o6(a):Array.isArray(a)?a.map(a=>o8(a,b)||o7.easeOut):o7[a]}function o9(a,b,c,{delay:d=0,duration:e=300,repeat:f=0,repeatType:g="loop",ease:h="easeOut",times:i}={},j){let k={[b]:c};i&&(k.offset=i);let l=o8(h,e);Array.isArray(l)&&(k.easing=l),lI.value&&l4.waapi++;let m={delay:d,duration:e,easing:Array.isArray(l)?"linear":l,fill:"both",iterations:f+1,direction:"reverse"===g?"alternate":"normal"};j&&(m.pseudoElement=j);let n=a.animate(k,m);return lI.value&&n.finished.finally(()=>{l4.waapi--}),n}function pa(a){return"function"==typeof a&&"applyToOptions"in a}function pb({type:a,...b}){return pa(a)&&o5()?a.applyToOptions(b):(b.duration??(b.duration=300),b.ease??(b.ease="easeOut"),b)}class pc extends nU{constructor(a){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!a)return;let{element:b,name:c,keyframes:d,pseudoElement:e,allowFlatten:f=!1,finalKeyframe:g,onComplete:h}=a;this.isPseudoElement=!!e,this.allowFlatten=f,this.options=a,l6("string"!=typeof a.type,'Mini animate() doesn\'t support "type" as a string.',"mini-spring");let i=pb(a);this.animation=o9(b,c,d,i,e),!1===i.autoplay&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!e){let a=nR(d,this.options,g,this.speed);this.updateMotionValue?this.updateMotionValue(a):o1(b,c,a),this.animation.cancel()}h?.(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),"finished"===this.state&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch(a){}}stop(){if(this.isStopped)return;this.isStopped=!0;let{state:a}=this;"idle"!==a&&"finished"!==a&&(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){let a=this.options?.element;!this.isPseudoElement&&a?.isConnected&&this.animation.commitStyles?.()}get duration(){return l3(Number(this.animation.effect?.getComputedTiming?.().duration||0))}get iterationDuration(){let{delay:a=0}=this.options||{};return this.duration+l3(a)}get time(){return l3(Number(this.animation.currentTime)||0)}set time(a){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=l2(a)}get speed(){return this.animation.playbackRate}set speed(a){a<0&&(this.finishedTime=null),this.animation.playbackRate=a}get state(){return null!==this.finishedTime?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(a){this.manualStartTime=this.animation.startTime=a}attachTimeline({timeline:a,observe:b}){return(this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,a&&o3())?(this.animation.timeline=a,lG):b(this)}}let pd=new Set(["opacity","clipPath","filter","transform"]),{schedule:pe}=lL(queueMicrotask,!1),pf=[...op,mz,mM],pg=a=>pf.find(oo(a)),ph=new WeakMap;function pi(a){return null!==a&&"object"==typeof a&&"function"==typeof a.start}function pj(a){return"string"==typeof a||Array.isArray(a)}let pk=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],pl=["initial",...pk];function pm(a){return pi(a.animate)||pl.some(b=>pj(a[b]))}function pn(a){return!!(pm(a)||a.variants)}function po(a,b,c){for(let d in b){let e=b[d],f=c[d];if(l$(e))a.addValue(d,e);else if(l$(f))a.addValue(d,lW(e,{owner:a}));else if(f!==e)if(a.hasValue(d)){let b=a.getValue(d);!0===b.liveStyle?b.jump(e):b.hasAnimated||b.set(e)}else{let b=a.getStaticValue(d);a.addValue(d,lW(void 0!==b?b:e,{owner:a}))}}for(let d in c)void 0===b[d]&&a.removeValue(d);return b}let pp={current:null},pq={current:!1},pr="undefined"!=typeof window;function ps(){if(pq.current=!0,pr)if(window.matchMedia){let a=window.matchMedia("(prefers-reduced-motion)"),b=()=>pp.current=a.matches;a.addEventListener("change",b),b()}else pp.current=!1}function pt(a){let b=[{},{}];return a?.values.forEach((a,c)=>{b[0][c]=a.get(),b[1][c]=a.getVelocity()}),b}function pu(a,b,c,d){if("function"==typeof b){let[e,f]=pt(d);b=b(void 0!==c?c:a.custom,e,f)}if("string"==typeof b&&(b=a.variants&&a.variants[b]),"function"==typeof b){let[e,f]=pt(d);b=b(void 0!==c?c:a.custom,e,f)}return b}let pv=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],pw={};function px(a){pw=a}function py(){return pw}class pz{scrapeMotionValuesFromProps(a,b,c){return{}}constructor({parent:a,props:b,presenceContext:c,reducedMotionConfig:d,skipAnimations:e,blockInitialAnimation:f,visualState:g},h={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.shouldSkipAnimations=!1,this.values=new Map,this.KeyframeResolver=oV,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.hasBeenMounted=!1,this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{let a=lR.now();this.renderScheduledAt<a&&(this.renderScheduledAt=a,lM.render(this.render,!1,!0))};let{latestValues:i,renderState:j}=g;this.latestValues=i,this.baseTarget={...i},this.initialValues=b.initial?{...i}:{},this.renderState=j,this.parent=a,this.props=b,this.presenceContext=c,this.depth=a?a.depth+1:0,this.reducedMotionConfig=d,this.skipAnimationsConfig=e,this.options=h,this.blockInitialAnimation=!!f,this.isControllingVariants=pm(b),this.isVariantNode=pn(b),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(a&&a.current);let{willChange:k,...l}=this.scrapeMotionValuesFromProps(b,{},this);for(let a in l){let b=l[a];void 0!==i[a]&&l$(b)&&b.set(i[a])}}mount(a){if(this.hasBeenMounted)for(let a in this.initialValues)this.values.get(a)?.jump(this.initialValues[a]),this.latestValues[a]=this.initialValues[a];this.current=a,ph.set(a,this),this.projection&&!this.projection.instance&&this.projection.mount(a),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,b)=>this.bindToMotionValue(b,a)),"never"===this.reducedMotionConfig?this.shouldReduceMotion=!1:"always"===this.reducedMotionConfig?this.shouldReduceMotion=!0:(pq.current||ps(),this.shouldReduceMotion=pp.current),this.shouldSkipAnimations=this.skipAnimationsConfig??!1,this.parent?.addChild(this),this.update(this.props,this.presenceContext),this.hasBeenMounted=!0}unmount(){for(let a in this.projection&&this.projection.unmount(),lN(this.notifyUpdate),lN(this.render),this.valueSubscriptions.forEach(a=>a()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this),this.events)this.events[a].clear();for(let a in this.features){let b=this.features[a];b&&(b.unmount(),b.isMounted=!1)}this.current=null}addChild(a){this.children.add(a),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(a)}removeChild(a){this.children.delete(a),this.enteringChildren&&this.enteringChildren.delete(a)}bindToMotionValue(a,b){let c;if(this.valueSubscriptions.has(a)&&this.valueSubscriptions.get(a)(),b.accelerate&&pd.has(a)&&this.current instanceof HTMLElement){let{factory:c,keyframes:d,times:e,ease:f,duration:g}=b.accelerate,h=new pc({element:this.current,name:a,keyframes:d,times:e,ease:f,duration:l2(g)}),i=c(h);this.valueSubscriptions.set(a,()=>{i(),h.cancel()});return}let d=n9.has(a);d&&this.onBindTransform&&this.onBindTransform();let e=b.on("change",b=>{this.latestValues[a]=b,this.props.onUpdate&&lM.preRender(this.notifyUpdate),d&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});"undefined"!=typeof window&&window.MotionCheckAppearSync&&(c=window.MotionCheckAppearSync(this,a,b)),this.valueSubscriptions.set(a,()=>{e(),c&&c(),b.owner&&b.stop()})}sortNodePosition(a){return this.current&&this.sortInstanceNodePosition&&this.type===a.type?this.sortInstanceNodePosition(this.current,a.current):0}updateFeatures(){let a="animation";for(a in pw){let b=pw[a];if(!b)continue;let{isEnabled:c,Feature:d}=b;if(!this.features[a]&&d&&c(this.props)&&(this.features[a]=new d(this)),this.features[a]){let b=this.features[a];b.isMounted?b.update():(b.mount(),b.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):om()}getStaticValue(a){return this.latestValues[a]}setStaticValue(a,b){this.latestValues[a]=b}update(a,b){(a.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=a,this.prevPresenceContext=this.presenceContext,this.presenceContext=b;for(let b=0;b<pv.length;b++){let c=pv[b];this.propEventSubscriptions[c]&&(this.propEventSubscriptions[c](),delete this.propEventSubscriptions[c]);let d=a["on"+c];d&&(this.propEventSubscriptions[c]=this.on(c,d))}this.prevMotionValues=po(this,this.scrapeMotionValuesFromProps(a,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(a){return this.props.variants?this.props.variants[a]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(a){let b=this.getClosestVariantNode();if(b)return b.variantChildren&&b.variantChildren.add(a),()=>b.variantChildren.delete(a)}addValue(a,b){let c=this.values.get(a);b!==c&&(c&&this.removeValue(a),this.bindToMotionValue(a,b),this.values.set(a,b),this.latestValues[a]=b.get())}removeValue(a){this.values.delete(a);let b=this.valueSubscriptions.get(a);b&&(b(),this.valueSubscriptions.delete(a)),delete this.latestValues[a],this.removeValueFromRenderState(a,this.renderState)}hasValue(a){return this.values.has(a)}getValue(a,b){if(this.props.values&&this.props.values[a])return this.props.values[a];let c=this.values.get(a);return void 0===c&&void 0!==b&&(c=lW(null===b?void 0:b,{owner:this}),this.addValue(a,c)),c}readValue(a,b){let c=void 0===this.latestValues[a]&&this.current?this.getBaseTargetFromProps(this.props,a)??this.readValueFromInstance(this.current,a,this.options):this.latestValues[a];return null!=c&&("string"==typeof c&&(or(c)||oW(c))?c=parseFloat(c):!pg(c)&&mM.test(b)&&(c=oY(a,b)),this.setBaseTarget(a,l$(c)?c.get():c)),l$(c)?c.get():c}setBaseTarget(a,b){this.baseTarget[a]=b}getBaseTarget(a){let b,{initial:c}=this.props;if("string"==typeof c||"object"==typeof c){let d=pu(this.props,c,this.presenceContext?.custom);d&&(b=d[a])}if(c&&void 0!==b)return b;let d=this.getBaseTargetFromProps(this.props,a);return void 0===d||l$(d)?void 0!==this.initialValues[a]&&void 0===b?void 0:this.baseTarget[a]:d}on(a,b){return this.events[a]||(this.events[a]=new lD),this.events[a].add(b)}notify(a,...b){this.events[a]&&this.events[a].notify(...b)}scheduleRenderMicrotask(){pe.render(this.render)}}class pA extends pz{constructor(){super(...arguments),this.KeyframeResolver=o_}sortInstanceNodePosition(a,b){return 2&a.compareDocumentPosition(b)?1:-1}getBaseTargetFromProps(a,b){let c=a.style;return c?c[b]:void 0}removeValueFromRenderState(a,{vars:b,style:c}){delete b[a],delete c[a]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);let{children:a}=this.props;l$(a)&&(this.childSubscription=a.on("change",a=>{this.current&&(this.current.textContent=`${a}`)}))}}function pB(a){return a.replace(/([A-Z])/g,a=>`-${a.toLowerCase()}`)}let pC=(a,b)=>b&&"number"==typeof a?b.transform(a):a,pD={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},pE=n8.length;function pF(a,b,c){let d="",e=!0;for(let f=0;f<pE;f++){let g=n8[f],h=a[g];if(void 0===h)continue;let i=!0;if("number"==typeof h)i=h===+!!g.startsWith("scale");else{let a=parseFloat(h);i=g.startsWith("scale")?1===a:0===a}if(!i||c){let a=pC(h,og[g]);if(!i){e=!1;let b=pD[g]||g;d+=`${b}(${a}) `}c&&(b[g]=a)}}return d=d.trim(),c?d=c(b,e?"":d):e&&(d="none"),d}function pG(a,b,c){let{style:d,vars:e,transformOrigin:f}=a,g=!1,h=!1;for(let a in b){let c=b[a];if(n9.has(a)){g=!0;continue}if(l8(a)){e[a]=c;continue}{let b=pC(c,og[a]);a.startsWith("origin")?(h=!0,f[a]=b):d[a]=b}}if(!b.transform&&(g||c?d.transform=pF(b,a.transform,c):d.transform&&(d.transform="none")),h){let{originX:a="50%",originY:b="50%",originZ:c=0}=f;d.transformOrigin=`${a} ${b} ${c}`}}let pH={offset:"stroke-dashoffset",array:"stroke-dasharray"},pI={offset:"strokeDashoffset",array:"strokeDasharray"};function pJ(a,b,c=1,d=0,e=!0){a.pathLength=1;let f=e?pH:pI;a[f.offset]=`${-d}`,a[f.array]=`${b} ${c}`}let pK=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function pL(a,{attrX:b,attrY:c,attrScale:d,pathLength:e,pathSpacing:f=1,pathOffset:g=0,...h},i,j,k){if(pG(a,h,j),i){a.style.viewBox&&(a.attrs.viewBox=a.style.viewBox);return}a.attrs=a.style,a.style={};let{attrs:l,style:m}=a;for(let a of(l.transform&&(m.transform=l.transform,delete l.transform),(m.transform||l.transformOrigin)&&(m.transformOrigin=l.transformOrigin??"50% 50%",delete l.transformOrigin),m.transform&&(m.transformBox=k?.transformBox??"fill-box",delete l.transformBox),pK))void 0!==l[a]&&(m[a]=l[a],delete l[a]);void 0!==b&&(l.x=b),void 0!==c&&(l.y=c),void 0!==d&&(l.scale=d),void 0!==e&&pJ(l,e,f,g,!1)}let pM=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),pN=a=>"string"==typeof a&&"svg"===a.toLowerCase();function pO(a,{style:b,vars:c},d,e){let f,g=a.style;for(f in b)g[f]=b[f];for(f in e?.applyProjectionStyles(g,d),c)g.setProperty(f,c[f])}function pP(a,b,c,d){for(let c in pO(a,b,void 0,d),b.attrs)a.setAttribute(pM.has(c)?c:pB(c),b.attrs[c])}function pQ(a,b){return b.max===b.min?0:a/(b.max-b.min)*100}let pR={correct:(a,b)=>{if(!b.target)return a;if("string"==typeof a)if(!mu.test(a))return a;else a=parseFloat(a);let c=pQ(a,b.target.x),d=pQ(a,b.target.y);return`${c}% ${d}%`}},pS={correct:(a,{treeScale:b,projectionDelta:c})=>{let d=a,e=mM.parse(a);if(e.length>5)return d;let f=mM.createTransformer(a),g=+("number"!=typeof e[0]),h=c.x.scale*b.x,i=c.y.scale*b.y;e[0+g]/=h,e[1+g]/=i;let j=mQ(h,i,.5);return"number"==typeof e[2+g]&&(e[2+g]/=j),"number"==typeof e[3+g]&&(e[3+g]/=j),f(e)}},pT={borderRadius:{...pR,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:pR,borderTopRightRadius:pR,borderBottomLeftRadius:pR,borderBottomRightRadius:pR,boxShadow:pS};function pU(a,{layout:b,layoutId:c}){return n9.has(a)||a.startsWith("origin")||(b||void 0!==c)&&(!!pT[a]||"opacity"===a)}function pV(a,b,c){let d=a.style,e=b?.style,f={};if(!d)return f;for(let b in d)(l$(d[b])||e&&l$(e[b])||pU(b,a)||c?.getValue(b)?.liveStyle!==void 0)&&(f[b]=d[b]);return f}function pW(a,b,c){let d=pV(a,b,c);for(let c in a)(l$(a[c])||l$(b[c]))&&(d[-1!==n8.indexOf(c)?"attr"+c.charAt(0).toUpperCase()+c.substring(1):c]=a[c]);return d}class pX extends pA{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=om}getBaseTargetFromProps(a,b){return a[b]}readValueFromInstance(a,b){if(n9.has(b)){let a=oi(b);return a&&a.default||0}return b=pM.has(b)?b:pB(b),a.getAttribute(b)}scrapeMotionValuesFromProps(a,b,c){return pW(a,b,c)}build(a,b,c){pL(a,b,this.isSVGTag,c.transformTemplate,c.style)}renderInstance(a,b,c,d){pP(a,b,c,d)}mount(a){this.isSVGTag=pN(a.tagName),super.mount(a)}}function pY({top:a,left:b,right:c,bottom:d}){return{x:{min:b,max:c},y:{min:a,max:d}}}function pZ({x:a,y:b}){return{top:b.min,right:a.max,bottom:b.max,left:a.min}}function p$(a,b){if(!b)return a;let c=b({x:a.left,y:a.top}),d=b({x:a.right,y:a.bottom});return{top:c.y,left:c.x,bottom:d.y,right:d.x}}function p_(a){return void 0===a||1===a}function p0({scale:a,scaleX:b,scaleY:c}){return!p_(a)||!p_(b)||!p_(c)}function p1(a){return p0(a)||p2(a)||a.z||a.rotate||a.rotateX||a.rotateY||a.skewX||a.skewY}function p2(a){return p3(a.x)||p3(a.y)}function p3(a){return a&&"0%"!==a}function p4(a,b,c){let d=b*(a-c);return c+d}function p5(a,b,c,d,e){return void 0!==e&&(a=p4(a,e,d)),p4(a,c,d)+b}function p6(a,b=0,c=1,d,e){a.min=p5(a.min,b,c,d,e),a.max=p5(a.max,b,c,d,e)}function p7(a,{x:b,y:c}){p6(a.x,b.translate,b.scale,b.originPoint),p6(a.y,c.translate,c.scale,c.originPoint)}let p8=.999999999999,p9=1.0000000000001;function qa(a,b,c,d=!1){let e,f,g=c.length;if(g){b.x=b.y=1;for(let h=0;h<g;h++){f=(e=c[h]).projectionDelta;let{visualElement:g}=e.options;(!g||!g.props.style||"contents"!==g.props.style.display)&&(d&&e.options.layoutScroll&&e.scroll&&e!==e.root&&qd(a,{x:-e.scroll.offset.x,y:-e.scroll.offset.y}),f&&(b.x*=f.x.scale,b.y*=f.y.scale,p7(a,f)),d&&p1(e.latestValues)&&qd(a,e.latestValues))}b.x<p9&&b.x>p8&&(b.x=1),b.y<p9&&b.y>p8&&(b.y=1)}}function qb(a,b){a.min=a.min+b,a.max=a.max+b}function qc(a,b,c,d,e=.5){let f=mQ(a.min,a.max,e);p6(a,b,c,f,d)}function qd(a,b){qc(a.x,b.x,b.scaleX,b.scale,b.originX),qc(a.y,b.y,b.scaleY,b.scale,b.originY)}function qe(a,b){return pY(p$(a.getBoundingClientRect(),b))}function qf(a,b,c){let d=qe(a,c),{scroll:e}=b;return e&&(qb(d.x,e.offset.x),qb(d.y,e.offset.y)),d}function qg(a){return window.getComputedStyle(a)}class qh extends pA{constructor(){super(...arguments),this.type="html",this.renderInstance=pO}readValueFromInstance(a,b){if(n9.has(b))return this.projection?.isProjecting?oF(b):oH(a,b);{let c=qg(a),d=(l8(b)?c.getPropertyValue(b):c[b])||0;return"string"==typeof d?d.trim():d}}measureInstanceViewportBox(a,{transformPagePoint:b}){return qe(a,b)}build(a,b,c){pG(a,b,c.transformTemplate)}scrapeMotionValuesFromProps(a,b,c){return pV(a,b,c)}}let qi=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function qj(a){if("string"!=typeof a||a.includes("-"));else if(qi.indexOf(a)>-1||/[A-Z]/u.test(a))return!0;return!1}let qk=(a,b)=>b.isSVG??qj(a)?new pX(b):new qh(b,{allowProjection:a!==y.Fragment}),ql=(0,y.createContext)({}),qm=(0,y.createContext)({strict:!1}),qn=(0,y.createContext)({});function qo(a,b){if(pm(a)){let{initial:b,animate:c}=a;return{initial:!1===b||pj(b)?b:void 0,animate:pj(c)?c:void 0}}return!1!==a.inherit?b:{}}function qp(a){let{initial:b,animate:c}=qo(a,(0,y.useContext)(qn));return(0,y.useMemo)(()=>({initial:b,animate:c}),[qq(b),qq(c)])}function qq(a){return Array.isArray(a)?a.join(" "):a}let qr=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function qs(a,b,c){for(let d in b)l$(b[d])||pU(d,c)||(a[d]=b[d])}function qt({transformTemplate:a},b){return(0,y.useMemo)(()=>{let c=qr();return pG(c,b,a),Object.assign({},c.vars,c.style)},[b])}function qu(a,b){let c=a.style||{},d={};return qs(d,c,a),Object.assign(d,qt(a,b)),d}function qv(a,b){let c={},d=qu(a,b);return a.drag&&!1!==a.dragListener&&(c.draggable=!1,d.userSelect=d.WebkitUserSelect=d.WebkitTouchCallout="none",d.touchAction=!0===a.drag?"none":`pan-${"x"===a.drag?"y":"x"}`),void 0===a.tabIndex&&(a.onTap||a.onTapStart||a.whileTap)&&(c.tabIndex=0),c.style=d,c}let qw=()=>({...qr(),attrs:{}});function qx(a,b,c,d){let e=(0,y.useMemo)(()=>{let c=qw();return pL(c,b,pN(d),a.transformTemplate,a.style),{...c.attrs,style:{...c.style}}},[b]);if(a.style){let b={};qs(b,a.style,a),e.style={...b,...e.style}}return e}let qy=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","propagate","ignoreStrict","viewport"]);function qz(a){return a.startsWith("while")||a.startsWith("drag")&&"draggable"!==a||a.startsWith("layout")||a.startsWith("onTap")||a.startsWith("onPan")||a.startsWith("onLayout")||qy.has(a)}let qA=a=>!qz(a);function qB(a){"function"==typeof a&&(qA=b=>b.startsWith("on")?!qz(b):a(b))}try{qB(require("@emotion/is-prop-valid").default)}catch{}function qC(a,b,c){let d={};for(let e in a)("values"!==e||"object"!=typeof a.values)&&(qA(e)||!0===c&&qz(e)||!b&&!qz(e)||a.draggable&&e.startsWith("onDrag"))&&(d[e]=a[e]);return d}function qD(a,b,c,{latestValues:d},e,f=!1,g){let h=(g??qj(a)?qx:qv)(b,d,e,a),i=qC(b,"string"==typeof a,f),j=a!==y.Fragment?{...i,...h,ref:c}:{},{children:k}=b,l=(0,y.useMemo)(()=>l$(k)?k.get():k,[k]);return(0,y.createElement)(a,{...j,children:l})}function qE(a){return l$(a)?a.get():a}let qF=(0,y.createContext)(null);function qG({scrapeMotionValuesFromProps:a,createRenderState:b},c,d,e){return{latestValues:qH(c,d,e,a),renderState:b()}}function qH(a,b,c,d){let e={},f=d(a,{});for(let a in f)e[a]=qE(f[a]);let{initial:g,animate:h}=a,i=pm(a),j=pn(a);b&&j&&!i&&!1!==a.inherit&&(void 0===g&&(g=b.initial),void 0===h&&(h=b.animate));let k=!!c&&!1===c.initial,l=(k=k||!1===g)?h:g;if(l&&"boolean"!=typeof l&&!pi(l)){let b=Array.isArray(l)?l:[l];for(let c=0;c<b.length;c++){let d=pu(a,b[c]);if(d){let{transitionEnd:a,transition:b,...c}=d;for(let a in c){let b=c[a];if(Array.isArray(b)){let a=k?b.length-1:0;b=b[a]}null!==b&&(e[a]=b)}for(let b in a)e[b]=a[b]}}}return e}let qI=a=>(b,c)=>{let d=(0,y.useContext)(qn),e=(0,y.useContext)(qF),f=()=>qG(a,b,d,e);return c?f():lY(f)},qJ=qI({scrapeMotionValuesFromProps:pV,createRenderState:qr}),qK=qI({scrapeMotionValuesFromProps:pW,createRenderState:qw}),qL={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},qM=!1;function qN(){if(qM)return;let a={};for(let b in qL)a[b]={isEnabled:a=>qL[b].some(b=>!!a[b])};px(a),qM=!0}function qO(){return qN(),py()}function qP(a){let b=qO();for(let c in a)b[c]={...b[c],...a[c]};px(b)}let qQ=Symbol.for("motionComponentSymbol");function qR(a,b,c){let d=(0,y.useRef)(c);(0,y.useInsertionEffect)(()=>{d.current=c});let e=(0,y.useRef)(null);return(0,y.useCallback)(c=>{c&&a.onMount?.(c),b&&(c?b.mount(c):b.unmount());let f=d.current;if("function"==typeof f)if(c){let a=f(c);"function"==typeof a&&(e.current=a)}else e.current?(e.current(),e.current=null):f(c);else f&&(f.current=c)},[b])}let qS="data-"+pB("framerAppearId"),qT=(0,y.createContext)({});function qU(a){return a&&"object"==typeof a&&Object.prototype.hasOwnProperty.call(a,"current")}function qV(a,b,c,d,e,f){let{visualElement:g}=(0,y.useContext)(qn),h=(0,y.useContext)(qm),i=(0,y.useContext)(qF),j=(0,y.useContext)(lX),k=j.reducedMotion,l=j.skipAnimations,m=(0,y.useRef)(null),n=(0,y.useRef)(!1);d=d||h.renderer,!m.current&&d&&(m.current=d(a,{visualState:b,parent:g,props:c,presenceContext:i,blockInitialAnimation:!!i&&!1===i.initial,reducedMotionConfig:k,skipAnimations:l,isSVG:f}),n.current&&m.current&&(m.current.manuallyAnimateOnMount=!0));let o=m.current,p=(0,y.useContext)(qT);o&&!o.projection&&e&&("html"===o.type||"svg"===o.type)&&qW(m.current,c,e,p);let q=(0,y.useRef)(!1);(0,y.useInsertionEffect)(()=>{o&&q.current&&o.update(c,i)});let r=c[qS],s=(0,y.useRef)(!!r&&!window.MotionHandoffIsComplete?.(r)&&window.MotionHasOptimisedAnimation?.(r));return n0(()=>{n.current=!0,o&&(q.current=!0,window.MotionIsMounted=!0,o.updateFeatures(),o.scheduleRenderMicrotask(),s.current&&o.animationState&&o.animationState.animateChanges())}),o}function qW(a,b,c,d){let{layoutId:e,layout:f,drag:g,dragConstraints:h,layoutScroll:i,layoutRoot:j,layoutCrossfade:k}=b;a.projection=new c(a.latestValues,b["data-framer-portal-id"]?void 0:qX(a.parent)),a.projection.setOptions({layoutId:e,layout:f,alwaysMeasureLayout:!!g||h&&qU(h),visualElement:a,animationType:"string"==typeof f?f:"both",initialPromotionConfig:d,crossfade:k,layoutScroll:i,layoutRoot:j})}function qX(a){if(a)return!1!==a.options.allowProjection?a.projection:qX(a.parent)}function qY(a,{forwardMotionProps:b=!1,type:c}={},d,e){d&&qP(d);let f=c?"svg"===c:qj(a),g=f?qK:qJ;function h(c,h){let i,j={...(0,y.useContext)(lX),...c,layoutId:qZ(c)},{isStatic:k}=j,l=qp(c),m=g(c,k);if(!k&&n_){q$(j,d);let b=q_(j);i=b.MeasureLayout,l.visualElement=qV(a,m,j,e,b.ProjectionNode,f)}return(0,x.jsxs)(qn.Provider,{value:l,children:[i&&l.visualElement?(0,x.jsx)(i,{visualElement:l.visualElement,...j}):null,qD(a,c,qR(m,l.visualElement,h),m,k,b,f)]})}h.displayName=`motion.${"string"==typeof a?a:`create(${a.displayName??a.name??""})`}`;let i=(0,y.forwardRef)(h);return i[qQ]=a,i}function qZ({layoutId:a}){let b=(0,y.useContext)(ql).id;return b&&void 0!==a?b+"-"+a:a}function q$(a,b){(0,y.useContext)(qm).strict}function q_(a){let{drag:b,layout:c}=qO();if(!b&&!c)return{};let d={...b,...c};return{MeasureLayout:b?.isEnabled(a)||c?.isEnabled(a)?d.MeasureLayout:void 0,ProjectionNode:d.ProjectionNode}}function q0(a,b){if("undefined"==typeof Proxy)return qY;let c=new Map,d=(c,d)=>qY(c,d,a,b);return new Proxy((a,b)=>d(a,b),{get:(e,f)=>"create"===f?d:(c.has(f)||c.set(f,qY(f,void 0,a,b)),c.get(f))})}class q1{constructor(a){this.isMounted=!1,this.node=a}update(){}}function q2(a,b,c){let d=a.getProps();return pu(d,b,void 0!==c?c:d.custom,a)}function q3(a,b){if(a?.inherit&&b){let{inherit:c,...d}=a;return{...b,...d}}return a}function q4(a,b){let c=a?.[b]??a?.default??a;return c!==a?q3(c,a):c}let q5=a=>Array.isArray(a);function q6(a,b,c){a.hasValue(b)?a.getValue(b).set(c):a.addValue(b,lW(c))}function q7(a){return q5(a)?a[a.length-1]||0:a}function q8(a,b){let{transitionEnd:c={},transition:d={},...e}=q2(a,b)||{};for(let b in e={...e,...c}){let c=q7(e[b]);q6(a,b,c)}}function q9(a){return!!(l$(a)&&a.add)}function ra(a,b){let c=a.getValue("willChange");if(q9(c))return c.add(b);if(!c&&lF.WillChange){let c=new lF.WillChange("auto");a.addValue("willChange",c),c.add(b)}}function rb(a){return a.props[qS]}let rc={anticipate:nA,backInOut:nz,circInOut:nD};function rd(a){return a in rc}function re(a){"string"==typeof a.ease&&rd(a.ease)&&(a.ease=rc[a.ease])}let rf=10;class rg extends pc{constructor(a){re(a),nT(a),super(a),void 0!==a.startTime&&(this.startTime=a.startTime),this.options=a}updateMotionValue(a){let{motionValue:b,onUpdate:c,onComplete:d,element:e,...f}=this.options;if(!b)return;if(void 0!==a)return void b.set(a);let g=new nW({...f,autoplay:!1}),h=Math.max(rf,lR.now()-this.startTime),i=l1(0,rf,h-rf);b.setWithVelocity(g.sample(Math.max(0,h-i)).value,g.sample(h).value,i),g.stop()}}let rh=(a,b)=>"zIndex"!==b&&!!("number"==typeof a||Array.isArray(a)||"string"==typeof a&&(mM.test(a)||"0"===a)&&!a.startsWith("url("));function ri(a){let b=a[0];if(1===a.length)return!0;for(let c=0;c<a.length;c++)if(a[c]!==b)return!0}function rj(a,b,c,d){let e=a[0];if(null===e)return!1;if("display"===b||"visibility"===b)return!0;let f=a[a.length-1],g=rh(e,b),h=rh(f,b);return l5(g===h,`You are trying to animate ${b} from "${e}" to "${f}". "${g?f:e}" is not an animatable value.`,"value-not-animatable"),!!g&&!!h&&(ri(a)||("spring"===c||pa(c))&&d)}function rk(a){a.duration=0,a.type="keyframes"}let rl=new Set(["opacity","clipPath","filter","transform"]),rm=o2(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function rn(a){let{motionValue:b,name:c,repeatDelay:d,repeatType:e,damping:f,type:g}=a;if(!(b?.owner?.current instanceof HTMLElement))return!1;let{onUpdate:h,transformTemplate:i}=b.owner.getProps();return rm()&&c&&rl.has(c)&&("transform"!==c||!i)&&!h&&!d&&"mirror"!==e&&0!==f&&"inertia"!==g}let ro=40;class rp extends nU{constructor({autoplay:a=!0,delay:b=0,type:c="keyframes",repeat:d=0,repeatDelay:e=0,repeatType:f="loop",keyframes:g,name:h,motionValue:i,element:j,...k}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=lR.now();let l={autoplay:a,delay:b,type:c,repeat:d,repeatDelay:e,repeatType:f,name:h,motionValue:i,element:j,...k},m=j?.KeyframeResolver||oV;this.keyframeResolver=new m(g,(a,b,c)=>this.onKeyframesResolved(a,b,l,!c),h,i,j),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(a,b,c,d){this.keyframeResolver=void 0;let{name:e,type:f,velocity:g,delay:h,isHandoff:i,onUpdate:j}=c;this.resolvedAt=lR.now(),rj(a,e,f,g)||((lF.instantAnimations||!h)&&j?.(nR(a,c,b)),a[0]=a[a.length-1],rk(c),c.repeat=0);let k={startTime:d?this.resolvedAt&&this.resolvedAt-this.createdAt>ro?this.resolvedAt:this.createdAt:void 0,finalKeyframe:b,...c,keyframes:a},l=!i&&rn(k),m=k.motionValue?.owner?.current,n=l?new rg({...k,element:m}):new nW(k);n.finished.then(()=>{this.notifyFinished()}).catch(lG),this.pendingTimeline&&(this.stopTimeline=n.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=n}get finished(){return this._animation?this.animation.finished:this._finished}then(a,b){return this.finished.finally(a).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),oU()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(a){this.animation.time=a}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(a){this.animation.speed=a}get startTime(){return this.animation.startTime}attachTimeline(a){return this._animation?this.stopTimeline=this.animation.attachTimeline(a):this.pendingTimeline=a,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}let rq={type:"spring",stiffness:500,damping:25,restSpeed:10},rr=a=>({type:"spring",stiffness:550,damping:0===a?2*Math.sqrt(550):30,restSpeed:10}),rs={type:"keyframes",duration:.8},rt={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},ru=(a,{keyframes:b})=>b.length>2?rs:n9.has(a)?a.startsWith("scale")?rr(b[1]):rq:rt,rv=a=>null!==a;function rw(a,{repeat:b,repeatType:c="loop"},d){let e=a.filter(rv),f=b&&"loop"!==c&&b%2==1?0:e.length-1;return f&&void 0!==d?d:e[f]}function rx({when:a,delay:b,delayChildren:c,staggerChildren:d,staggerDirection:e,repeat:f,repeatType:g,repeatDelay:h,from:i,elapsed:j,...k}){return!!Object.keys(k).length}let ry=(a,b,c,d={},e,f)=>g=>{let h=q4(d,a)||{},i=h.delay||d.delay||0,{elapsed:j=0}=d;j-=l2(i);let k={keyframes:Array.isArray(c)?c:[null,c],ease:"easeOut",velocity:b.getVelocity(),...h,delay:-j,onUpdate:a=>{b.set(a),h.onUpdate&&h.onUpdate(a)},onComplete:()=>{g(),h.onComplete&&h.onComplete()},name:a,motionValue:b,element:f?void 0:e};rx(h)||Object.assign(k,ru(a,k)),k.duration&&(k.duration=l2(k.duration)),k.repeatDelay&&(k.repeatDelay=l2(k.repeatDelay)),void 0!==k.from&&(k.keyframes[0]=k.from);let l=!1;if(!1!==k.type&&(0!==k.duration||k.repeatDelay)||(rk(k),0===k.delay&&(l=!0)),(lF.instantAnimations||lF.skipAnimations||e?.shouldSkipAnimations)&&(l=!0,rk(k),k.delay=0),k.allowFlatten=!h.type&&!h.ease,l&&!f&&void 0!==b.get()){let a=rw(k.keyframes,h);if(void 0!==a)return void lM.update(()=>{k.onUpdate(a),k.onComplete()})}return h.isSync?new nW(k):new rp(k)};function rz({protectedKeys:a,needsAnimating:b},c){let d=a.hasOwnProperty(c)&&!0!==b[c];return b[c]=!1,d}function rA(a,b,{delay:c=0,transitionOverride:d,type:e}={}){let{transition:f,transitionEnd:g,...h}=b,i=a.getDefaultTransition();f=f?q3(f,i):i;let j=f?.reduceMotion;d&&(f=d);let k=[],l=e&&a.animationState&&a.animationState.getState()[e];for(let b in h){let d=a.getValue(b,a.latestValues[b]??null),e=h[b];if(void 0===e||l&&rz(l,b))continue;let g={delay:c,...q4(f||{},b)},i=d.get();if(void 0!==i&&!d.isAnimating&&!Array.isArray(e)&&e===i&&!g.velocity)continue;let m=!1;if(window.MotionHandoffAnimation){let c=rb(a);if(c){let a=window.MotionHandoffAnimation(c,b,lM);null!==a&&(g.startTime=a,m=!0)}}ra(a,b);let n=j??a.shouldReduceMotion;d.start(ry(b,d,e,n&&on.has(b)?{type:!1}:g,a,m));let o=d.animation;o&&k.push(o)}if(g){let b=()=>lM.update(()=>{g&&q8(a,g)});k.length?Promise.all(k).then(b):b()}return k}function rB(a,b,c,d=0,e=1){let f=Array.from(a).sort((a,b)=>a.sortNodePosition(b)).indexOf(b),g=a.size,h=(g-1)*d;return"function"==typeof c?c(f,g):1===e?f*d:h-f*d}function rC(a,b,c={}){let d=q2(a,b,"exit"===c.type?a.presenceContext?.custom:void 0),{transition:e=a.getDefaultTransition()||{}}=d||{};c.transitionOverride&&(e=c.transitionOverride);let f=d?()=>Promise.all(rA(a,d,c)):()=>Promise.resolve(),g=a.variantChildren&&a.variantChildren.size?(d=0)=>{let{delayChildren:f=0,staggerChildren:g,staggerDirection:h}=e;return rD(a,b,d,f,g,h,c)}:()=>Promise.resolve(),{when:h}=e;if(!h)return Promise.all([f(),g(c.delay)]);{let[a,b]="beforeChildren"===h?[f,g]:[g,f];return a().then(()=>b())}}function rD(a,b,c=0,d=0,e=0,f=1,g){let h=[];for(let i of a.variantChildren)i.notify("AnimationStart",b),h.push(rC(i,b,{...g,delay:c+("function"==typeof d?0:d)+rB(a.variantChildren,i,d,e,f)}).then(()=>i.notify("AnimationComplete",b)));return Promise.all(h)}function rE(a,b,c={}){let d;if(a.notify("AnimationStart",b),Array.isArray(b))d=Promise.all(b.map(b=>rC(a,b,c)));else if("string"==typeof b)d=rC(a,b,c);else{let e="function"==typeof b?q2(a,b,c.custom):b;d=Promise.all(rA(a,e,c))}return d.then(()=>{a.notify("AnimationComplete",b)})}let rF=pl.length;function rG(a){if(!a)return;if(!a.isControllingVariants){let b=a.parent&&rG(a.parent)||{};return void 0!==a.props.initial&&(b.initial=a.props.initial),b}let b={};for(let c=0;c<rF;c++){let d=pl[c],e=a.props[d];(pj(e)||!1===e)&&(b[d]=e)}return b}function rH(a,b){if(!Array.isArray(b))return!1;let c=b.length;if(c!==a.length)return!1;for(let d=0;d<c;d++)if(b[d]!==a[d])return!1;return!0}let rI=[...pk].reverse(),rJ=pk.length;function rK(a){return b=>Promise.all(b.map(({animation:b,options:c})=>rE(a,b,c)))}function rL(a){let b=rK(a),c=rO(),d=!0,e=b=>(c,d)=>{let e=q2(a,d,"exit"===b?a.presenceContext?.custom:void 0);if(e){let{transition:a,transitionEnd:b,...d}=e;c={...c,...d,...b}}return c};function f(f){let{props:g}=a,h=rG(a.parent)||{},i=[],j=new Set,k={},l=1/0;for(let b=0;b<rJ;b++){let m=rI[b],n=c[m],o=void 0!==g[m]?g[m]:h[m],p=pj(o),q=m===f?n.isActive:null;!1===q&&(l=b);let r=o===h[m]&&o!==g[m]&&p;if(r&&d&&a.manuallyAnimateOnMount&&(r=!1),n.protectedKeys={...k},!n.isActive&&null===q||!o&&!n.prevProp||pi(o)||"boolean"==typeof o)continue;if("exit"===m&&n.isActive&&!0!==q){n.prevResolvedValues&&(k={...k,...n.prevResolvedValues});continue}let s=rM(n.prevProp,o),t=s||m===f&&n.isActive&&!r&&p||b>l&&p,u=!1,v=Array.isArray(o)?o:[o],w=v.reduce(e(m),{});!1===q&&(w={});let{prevResolvedValues:x={}}=n,y={...x,...w},z=b=>{t=!0,j.has(b)&&(u=!0,j.delete(b)),n.needsAnimating[b]=!0;let c=a.getValue(b);c&&(c.liveStyle=!1)};for(let a in y){let b=w[a],c=x[a];if(k.hasOwnProperty(a))continue;let d=!1;(d=q5(b)&&q5(c)?!rH(b,c):b!==c)?null!=b?z(a):j.add(a):void 0!==b&&j.has(a)?z(a):n.protectedKeys[a]=!0}n.prevProp=o,n.prevResolvedValues=w,n.isActive&&(k={...k,...w}),d&&a.blockInitialAnimation&&(t=!1);let A=r&&s,B=!A||u;t&&B&&i.push(...v.map(b=>{let c={type:m};if("string"==typeof b&&d&&!A&&a.manuallyAnimateOnMount&&a.parent){let{parent:d}=a,e=q2(d,b);if(d.enteringChildren&&e){let{delayChildren:b}=e.transition||{};c.delay=rB(d.enteringChildren,a,b)}}return{animation:b,options:c}}))}if(j.size){let b={};if("boolean"!=typeof g.initial){let c=q2(a,Array.isArray(g.initial)?g.initial[0]:g.initial);c&&c.transition&&(b.transition=c.transition)}j.forEach(c=>{let d=a.getBaseTarget(c),e=a.getValue(c);e&&(e.liveStyle=!0),b[c]=d??null}),i.push({animation:b})}let m=!!i.length;return d&&(!1===g.initial||g.initial===g.animate)&&!a.manuallyAnimateOnMount&&(m=!1),d=!1,m?b(i):Promise.resolve()}function g(b,d){if(c[b].isActive===d)return Promise.resolve();a.variantChildren?.forEach(a=>a.animationState?.setActive(b,d)),c[b].isActive=d;let e=f(b);for(let a in c)c[a].protectedKeys={};return e}return{animateChanges:f,setActive:g,setAnimateFunction:function(c){b=c(a)},getState:()=>c,reset:()=>{c=rO()}}}function rM(a,b){return"string"==typeof b?b!==a:!!Array.isArray(b)&&!rH(b,a)}function rN(a=!1){return{isActive:a,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function rO(){return{animate:rN(!0),whileInView:rN(),whileHover:rN(),whileTap:rN(),whileDrag:rN(),whileFocus:rN(),exit:rN()}}class rP extends q1{constructor(a){super(a),a.animationState||(a.animationState=rL(a))}updateAnimationControlsSubscription(){let{animate:a}=this.node.getProps();pi(a)&&(this.unmountControls=a.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){let{animate:a}=this.node.getProps(),{animate:b}=this.node.prevProps||{};a!==b&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let rQ=0;class rR extends q1{constructor(){super(...arguments),this.id=rQ++}update(){if(!this.node.presenceContext)return;let{isPresent:a,onExitComplete:b}=this.node.presenceContext,{isPresent:c}=this.node.prevPresenceContext||{};if(!this.node.animationState||a===c)return;let d=this.node.animationState.setActive("exit",!a);b&&!a&&d.then(()=>{b(this.id)})}mount(){let{register:a,onExitComplete:b}=this.node.presenceContext||{};b&&b(this.id),a&&(this.unmount=a(this.id))}unmount(){}}let rS={animation:{Feature:rP},exit:{Feature:rR}},rT={x:!1,y:!1};function rU(){return rT.x||rT.y}function rV(a){if("x"===a||"y"===a)if(rT[a])return null;else return rT[a]=!0,()=>{rT[a]=!1};return rT.x||rT.y?null:(rT.x=rT.y=!0,()=>{rT.x=rT.y=!1})}function rW(a){return[a("x"),a("y")]}let rX=.9999,rY=1.0001,rZ=-.01,r$=.01;function r_(a){return a.max-a.min}function r0(a,b,c){return Math.abs(a-b)<=c}function r1(a,b,c,d=.5){a.origin=d,a.originPoint=mQ(b.min,b.max,a.origin),a.scale=r_(c)/r_(b),a.translate=mQ(c.min,c.max,a.origin)-a.originPoint,(a.scale>=rX&&a.scale<=rY||isNaN(a.scale))&&(a.scale=1),(a.translate>=rZ&&a.translate<=r$||isNaN(a.translate))&&(a.translate=0)}function r2(a,b,c,d){r1(a.x,b.x,c.x,d?d.originX:void 0),r1(a.y,b.y,c.y,d?d.originY:void 0)}function r3(a,b,c){a.min=c.min+b.min,a.max=a.min+r_(b)}function r4(a,b,c){r3(a.x,b.x,c.x),r3(a.y,b.y,c.y)}function r5(a,b,c){a.min=b.min-c.min,a.max=a.min+r_(b)}function r6(a,b,c){r5(a.x,b.x,c.x),r5(a.y,b.y,c.y)}let r7=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function r8(a){return r7.has(a.tagName)||!0===a.isContentEditable}let r9=new Set(["INPUT","SELECT","TEXTAREA"]);function sa(a){return r9.has(a.tagName)||!0===a.isContentEditable}function sb(a,b,c,d={passive:!0}){return a.addEventListener(b,c,d),()=>a.removeEventListener(b,c)}function sc(a){return"object"==typeof a&&null!==a}function sd(a){return sc(a)&&"ownerSVGElement"in a}function se(a,b,c){if(null==a)return[];if(a instanceof EventTarget)return[a];if("string"==typeof a){let d=document;b&&(d=b.current);let e=c?.[a]??d.querySelectorAll(a);return e?Array.from(e):[]}return Array.from(a).filter(a=>null!=a)}let sf=new WeakMap,sg=(a,b,c)=>(d,e)=>e&&e[0]?e[0][a+"Size"]:sd(d)&&"getBBox"in d?d.getBBox()[b]:d[c],sh=sg("inline","width","offsetWidth"),si=sg("block","height","offsetHeight");function sj({target:a,borderBoxSize:b}){sf.get(a)?.forEach(c=>{c(a,{get width(){return sh(a,b)},get height(){return si(a,b)}})})}function sk(a){a.forEach(sj)}function sl(){"undefined"!=typeof ResizeObserver&&(h=new ResizeObserver(sk))}function sm(a,b){h||sl();let c=se(a);return c.forEach(a=>{let c=sf.get(a);c||(c=new Set,sf.set(a,c)),c.add(b),h?.observe(a)}),()=>{c.forEach(a=>{let c=sf.get(a);c?.delete(b),c?.size||h?.unobserve(a)})}}let sn=new Set;function so(){i=()=>{let a={get width(){return window.innerWidth},get height(){return window.innerHeight}};sn.forEach(b=>b(a))},window.addEventListener("resize",i)}function sp(a){return sn.add(a),i||so(),()=>{sn.delete(a),sn.size||"function"!=typeof i||(window.removeEventListener("resize",i),i=void 0)}}function sq(a,b){return"function"==typeof a?sp(a):sm(a,b)}let sr=a=>"mouse"===a.pointerType?"number"!=typeof a.button||a.button<=0:!1!==a.isPrimary;function ss(a){return{point:{x:a.pageX,y:a.pageY}}}let st=a=>b=>sr(b)&&a(b,ss(b));function su(a,b,c,d){return sb(a,b,st(c),d)}let sv=({current:a})=>a?a.ownerDocument.defaultView:null,sw=(a,b)=>Math.abs(a-b);function sx(a,b){return Math.sqrt(sw(a.x,b.x)**2+sw(a.y,b.y)**2)}let sy=new Set(["auto","scroll"]);class sz{constructor(a,b,{transformPagePoint:c,contextWindow:d=window,dragSnapToOrigin:e=!1,distanceThreshold:f=3,element:g}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=a=>{this.handleScroll(a.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let a=sC(this.lastMoveEventInfo,this.history),b=null!==this.startEvent,c=sx(a.offset,{x:0,y:0})>=this.distanceThreshold;if(!b&&!c)return;let{point:d}=a,{timestamp:e}=lO;this.history.push({...d,timestamp:e});let{onStart:f,onMove:g}=this.handlers;b||(f&&f(this.lastMoveEvent,a),this.startEvent=this.lastMoveEvent),g&&g(this.lastMoveEvent,a)},this.handlePointerMove=(a,b)=>{this.lastMoveEvent=a,this.lastMoveEventInfo=sA(b,this.transformPagePoint),lM.update(this.updatePoint,!0)},this.handlePointerUp=(a,b)=>{this.end();let{onEnd:c,onSessionEnd:d,resumeAnimation:e}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&e&&e(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let f=sC("pointercancel"===a.type?this.lastMoveEventInfo:sA(b,this.transformPagePoint),this.history);this.startEvent&&c&&c(a,f),d&&d(a,f)},!sr(a))return;this.dragSnapToOrigin=e,this.handlers=b,this.transformPagePoint=c,this.distanceThreshold=f,this.contextWindow=d||window;let h=sA(ss(a),this.transformPagePoint),{point:i}=h,{timestamp:j}=lO;this.history=[{...i,timestamp:j}];let{onSessionStart:k}=b;k&&k(a,sC(h,this.history)),this.removeListeners=l0(su(this.contextWindow,"pointermove",this.handlePointerMove),su(this.contextWindow,"pointerup",this.handlePointerUp),su(this.contextWindow,"pointercancel",this.handlePointerUp)),g&&this.startScrollTracking(g)}startScrollTracking(a){let b=a.parentElement;for(;b;){let a=getComputedStyle(b);(sy.has(a.overflowX)||sy.has(a.overflowY))&&this.scrollPositions.set(b,{x:b.scrollLeft,y:b.scrollTop}),b=b.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(a){let b=this.scrollPositions.get(a);if(!b)return;let c=a===window,d=c?{x:window.scrollX,y:window.scrollY}:{x:a.scrollLeft,y:a.scrollTop},e={x:d.x-b.x,y:d.y-b.y};(0!==e.x||0!==e.y)&&(c?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=e.x,this.lastMoveEventInfo.point.y+=e.y):this.history.length>0&&(this.history[0].x-=e.x,this.history[0].y-=e.y),this.scrollPositions.set(a,d),lM.update(this.updatePoint,!0))}updateHandlers(a){this.handlers=a}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),lN(this.updatePoint)}}function sA(a,b){return b?{point:b(a.point)}:a}function sB(a,b){return{x:a.x-b.x,y:a.y-b.y}}function sC({point:a},b){return{point:a,delta:sB(a,sE(b)),offset:sB(a,sD(b)),velocity:sF(b,.1)}}function sD(a){return a[0]}function sE(a){return a[a.length-1]}function sF(a,b){if(a.length<2)return{x:0,y:0};let c=a.length-1,d=null,e=sE(a);for(;c>=0&&(d=a[c],!(e.timestamp-d.timestamp>l2(b)));)c--;if(!d)return{x:0,y:0};d===a[0]&&a.length>2&&e.timestamp-d.timestamp>2*l2(b)&&(d=a[1]);let f=l3(e.timestamp-d.timestamp);if(0===f)return{x:0,y:0};let g={x:(e.x-d.x)/f,y:(e.y-d.y)/f};return g.x===1/0&&(g.x=0),g.y===1/0&&(g.y=0),g}function sG(a,{min:b,max:c},d){return void 0!==b&&a<b?a=d?mQ(b,a,d.min):Math.max(a,b):void 0!==c&&a>c&&(a=d?mQ(c,a,d.max):Math.min(a,c)),a}function sH(a,b,c){return{min:void 0!==b?a.min+b:void 0,max:void 0!==c?a.max+c-(a.max-a.min):void 0}}function sI(a,{top:b,left:c,bottom:d,right:e}){return{x:sH(a.x,c,e),y:sH(a.y,b,d)}}function sJ(a,b){let c=b.min-a.min,d=b.max-a.max;return b.max-b.min<a.max-a.min&&([c,d]=[d,c]),{min:c,max:d}}function sK(a,b){return{x:sJ(a.x,b.x),y:sJ(a.y,b.y)}}function sL(a,b){let c=.5,d=r_(a),e=r_(b);return e>d?c=nI(b.min,b.max-d,a.min):d>e&&(c=nI(a.min,a.max-e,b.min)),l1(0,1,c)}function sM(a,b){let c={};return void 0!==b.min&&(c.min=b.min-a.min),void 0!==b.max&&(c.max=b.max-a.min),c}let sN=.35;function sO(a=sN){return!1===a?a=0:!0===a&&(a=sN),{x:sP(a,"left","right"),y:sP(a,"top","bottom")}}function sP(a,b,c){return{min:sQ(a,b),max:sQ(a,c)}}function sQ(a,b){return"number"==typeof a?a:a[b]||0}let sR=new WeakMap;class sS{constructor(a){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=om(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=a}start(a,{snapToCursor:b=!1,distanceThreshold:c}={}){let{presenceContext:d}=this.visualElement;if(d&&!1===d.isPresent)return;let e=a=>{b&&this.snapToCursor(ss(a).point),this.stopAnimation()},f=(a,b)=>{let{drag:c,dragPropagation:d,onDragStart:e}=this.getProps();if(c&&!d&&(this.openDragLock&&this.openDragLock(),this.openDragLock=rV(c),!this.openDragLock))return;this.latestPointerEvent=a,this.latestPanInfo=b,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),rW(a=>{let b=this.getAxisMotionValue(a).get()||0;if(mt.test(b)){let{projection:c}=this.visualElement;if(c&&c.layout){let d=c.layout.layoutBox[a];d&&(b=r_(d)*(parseFloat(b)/100))}}this.originPoint[a]=b}),e&&lM.update(()=>e(a,b),!1,!0),ra(this.visualElement,"transform");let{animationState:f}=this.visualElement;f&&f.setActive("whileDrag",!0)},g=(a,b)=>{this.latestPointerEvent=a,this.latestPanInfo=b;let{dragPropagation:c,dragDirectionLock:d,onDirectionLock:e,onDrag:f}=this.getProps();if(!c&&!this.openDragLock)return;let{offset:g}=b;if(d&&null===this.currentDirection){this.currentDirection=sW(g),null!==this.currentDirection&&e&&e(this.currentDirection);return}this.updateAxis("x",b.point,g),this.updateAxis("y",b.point,g),this.visualElement.render(),f&&lM.update(()=>f(a,b),!1,!0)},h=(a,b)=>{this.latestPointerEvent=a,this.latestPanInfo=b,this.stop(a,b),this.latestPointerEvent=null,this.latestPanInfo=null},i=()=>{let{dragSnapToOrigin:a}=this.getProps();(a||this.constraints)&&this.startAnimation({x:0,y:0})},{dragSnapToOrigin:j}=this.getProps();this.panSession=new sz(a,{onSessionStart:e,onStart:f,onMove:g,onSessionEnd:h,resumeAnimation:i},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:j,distanceThreshold:c,contextWindow:sv(this.visualElement),element:this.visualElement.current})}stop(a,b){let c=a||this.latestPointerEvent,d=b||this.latestPanInfo,e=this.isDragging;if(this.cancel(),!e||!d||!c)return;let{velocity:f}=d;this.startAnimation(f);let{onDragEnd:g}=this.getProps();g&&lM.postRender(()=>g(c,d))}cancel(){this.isDragging=!1;let{projection:a,animationState:b}=this.visualElement;a&&(a.isAnimationBlocked=!1),this.endPanSession();let{dragPropagation:c}=this.getProps();!c&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),b&&b.setActive("whileDrag",!1)}endPanSession(){this.panSession&&this.panSession.end(),this.panSession=void 0}updateAxis(a,b,c){let{drag:d}=this.getProps();if(!c||!sV(a,d,this.currentDirection))return;let e=this.getAxisMotionValue(a),f=this.originPoint[a]+c[a];this.constraints&&this.constraints[a]&&(f=sG(f,this.constraints[a],this.elastic[a])),e.set(f)}resolveConstraints(){let{dragConstraints:a,dragElastic:b}=this.getProps(),c=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,d=this.constraints;a&&qU(a)?this.constraints||(this.constraints=this.resolveRefConstraints()):a&&c?this.constraints=sI(c.layoutBox,a):this.constraints=!1,this.elastic=sO(b),d!==this.constraints&&!qU(a)&&c&&this.constraints&&!this.hasMutatedConstraints&&rW(a=>{!1!==this.constraints&&this.getAxisMotionValue(a)&&(this.constraints[a]=sM(c.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){let{dragConstraints:a,onMeasureDragConstraints:b}=this.getProps();if(!a||!qU(a))return!1;let c=a.current;l6(null!==c,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.","drag-constraints-ref");let{projection:d}=this.visualElement;if(!d||!d.layout)return!1;let e=qf(c,d.root,this.visualElement.getTransformPagePoint()),f=sK(d.layout.layoutBox,e);if(b){let a=b(pZ(f));this.hasMutatedConstraints=!!a,a&&(f=pY(a))}return f}startAnimation(a){let{drag:b,dragMomentum:c,dragElastic:d,dragTransition:e,dragSnapToOrigin:f,onDragTransitionEnd:g}=this.getProps(),h=this.constraints||{};return Promise.all(rW(g=>{if(!sV(g,b,this.currentDirection))return;let i=h&&h[g]||{};f&&(i={min:0,max:0});let j=d?200:1e6,k=d?40:1e7,l={type:"inertia",velocity:c?a[g]:0,bounceStiffness:j,bounceDamping:k,timeConstant:750,restDelta:1,restSpeed:10,...e,...i};return this.startAxisValueAnimation(g,l)})).then(g)}startAxisValueAnimation(a,b){let c=this.getAxisMotionValue(a);return ra(this.visualElement,a),c.start(ry(a,c,0,b,this.visualElement,!1))}stopAnimation(){rW(a=>this.getAxisMotionValue(a).stop())}getAxisMotionValue(a){let b=`_drag${a.toUpperCase()}`,c=this.visualElement.getProps();return c[b]||this.visualElement.getValue(a,(c.initial?c.initial[a]:void 0)||0)}snapToCursor(a){rW(b=>{let{drag:c}=this.getProps();if(!sV(b,c,this.currentDirection))return;let{projection:d}=this.visualElement,e=this.getAxisMotionValue(b);if(d&&d.layout){let{min:c,max:f}=d.layout.layoutBox[b],g=e.get()||0;e.set(a[b]-mQ(c,f,.5)+g)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;let{drag:a,dragConstraints:b}=this.getProps(),{projection:c}=this.visualElement;if(!qU(b)||!c||!this.constraints)return;this.stopAnimation();let d={x:0,y:0};rW(a=>{let b=this.getAxisMotionValue(a);if(b&&!1!==this.constraints){let c=b.get();d[a]=sL({min:c,max:c},this.constraints[a])}});let{transformTemplate:e}=this.visualElement.getProps();this.visualElement.current.style.transform=e?e({},""):"none",c.root&&c.root.updateScroll(),c.updateLayout(),this.constraints=!1,this.resolveConstraints(),rW(b=>{if(!sV(b,a,null))return;let c=this.getAxisMotionValue(b),{min:e,max:f}=this.constraints[b];c.set(mQ(e,f,d[b]))}),this.visualElement.render()}addListeners(){let a;if(!this.visualElement.current)return;sR.set(this.visualElement,this);let b=this.visualElement.current,c=su(b,"pointerdown",a=>{let{drag:c,dragListener:d=!0}=this.getProps(),e=a.target,f=e!==b&&sa(e);c&&d&&!f&&this.start(a)}),d=()=>{let{dragConstraints:c}=this.getProps();qU(c)&&c.current&&(this.constraints=this.resolveRefConstraints(),a||(a=sU(b,c.current,()=>this.scalePositionWithinConstraints())))},{projection:e}=this.visualElement,f=e.addEventListener("measure",d);e&&!e.layout&&(e.root&&e.root.updateScroll(),e.updateLayout()),lM.read(d);let g=sb(window,"resize",()=>this.scalePositionWithinConstraints()),h=e.addEventListener("didUpdate",({delta:a,hasLayoutChanged:b})=>{this.isDragging&&b&&(rW(b=>{let c=this.getAxisMotionValue(b);c&&(this.originPoint[b]+=a[b].translate,c.set(c.get()+a[b].translate))}),this.visualElement.render())});return()=>{g(),c(),f(),h&&h(),a&&a()}}getProps(){let a=this.visualElement.getProps(),{drag:b=!1,dragDirectionLock:c=!1,dragPropagation:d=!1,dragConstraints:e=!1,dragElastic:f=sN,dragMomentum:g=!0}=a;return{...a,drag:b,dragDirectionLock:c,dragPropagation:d,dragConstraints:e,dragElastic:f,dragMomentum:g}}}function sT(a){let b=!0;return()=>{if(b){b=!1;return}a()}}function sU(a,b,c){let d=sq(a,sT(c)),e=sq(b,sT(c));return()=>{d(),e()}}function sV(a,b,c){return(!0===b||b===a)&&(null===c||c===a)}function sW(a,b=10){let c=null;return Math.abs(a.y)>b?c="y":Math.abs(a.x)>b&&(c="x"),c}class sX extends q1{constructor(a){super(a),this.removeGroupControls=lG,this.removeListeners=lG,this.controls=new sS(a)}mount(){let{dragControls:a}=this.node.getProps();a&&(this.removeGroupControls=a.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||lG}update(){let{dragControls:a}=this.node.getProps(),{dragControls:b}=this.node.prevProps||{};a!==b&&(this.removeGroupControls(),a&&(this.removeGroupControls=a.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners(),this.controls.isDragging||this.controls.endPanSession()}}let sY=a=>(b,c)=>{a&&lM.update(()=>a(b,c),!1,!0)};class sZ extends q1{constructor(){super(...arguments),this.removePointerDownListener=lG}onPointerDown(a){this.session=new sz(a,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:sv(this.node)})}createPanHandlers(){let{onPanSessionStart:a,onPanStart:b,onPan:c,onPanEnd:d}=this.node.getProps();return{onSessionStart:sY(a),onStart:sY(b),onMove:sY(c),onEnd:(a,b)=>{delete this.session,d&&lM.postRender(()=>d(a,b))}}}mount(){this.removePointerDownListener=su(this.node.current,"pointerdown",a=>this.onPointerDown(a))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let s$={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function s_(a=!0){let b=(0,y.useContext)(qF);if(null===b)return[!0,null];let{isPresent:c,onExitComplete:d,register:e}=b,f=(0,y.useId)(),g=(0,y.useCallback)(()=>a&&d&&d(f),[f,d,a]);return!c&&d?[!1,g]:[!0]}let s0=!1;class s1 extends y.Component{componentDidMount(){let{visualElement:a,layoutGroup:b,switchLayoutGroup:c,layoutId:d}=this.props,{projection:e}=a;e&&(b.group&&b.group.add(e),c&&c.register&&d&&c.register(e),s0&&e.root.didUpdate(),e.addEventListener("animationComplete",()=>{this.safeToRemove()}),e.setOptions({...e.options,layoutDependency:this.props.layoutDependency,onExitComplete:()=>this.safeToRemove()})),s$.hasEverUpdated=!0}getSnapshotBeforeUpdate(a){let{layoutDependency:b,visualElement:c,drag:d,isPresent:e}=this.props,{projection:f}=c;return f&&(f.isPresent=e,a.layoutDependency!==b&&f.setOptions({...f.options,layoutDependency:b}),s0=!0,d||a.layoutDependency!==b||void 0===b||a.isPresent!==e?f.willUpdate():this.safeToRemove(),a.isPresent!==e&&(e?f.promote():f.relegate()||lM.postRender(()=>{let a=f.getStack();a&&a.members.length||this.safeToRemove()}))),null}componentDidUpdate(){let{projection:a}=this.props.visualElement;a&&(a.root.didUpdate(),pe.postRender(()=>{!a.currentAnimation&&a.isLead()&&this.safeToRemove()}))}componentWillUnmount(){let{visualElement:a,layoutGroup:b,switchLayoutGroup:c}=this.props,{projection:d}=a;s0=!0,d&&(d.scheduleCheckAfterUnmount(),b&&b.group&&b.group.remove(d),c&&c.deregister&&c.deregister(d))}safeToRemove(){let{safeToRemove:a}=this.props;a&&a()}render(){return null}}function s2(a){let[b,c]=s_(),d=(0,y.useContext)(ql);return(0,x.jsx)(s1,{...a,layoutGroup:d,switchLayoutGroup:(0,y.useContext)(qT),isPresent:b,safeToRemove:c})}function s3(a,b,c){let d=l$(a)?a:lW(a);return d.start(ry("",d,b,c)),d.animation}function s4(a,b){let c=lR.now(),d=({timestamp:e})=>{let f=e-c;f>=b&&(lN(d),a(f-b))};return lM.setup(d,!0),()=>lN(d)}function s5(a){return sd(a)&&"svg"===a.tagName}let s6=["TopLeft","TopRight","BottomLeft","BottomRight"],s7=s6.length,s8=a=>"string"==typeof a?parseFloat(a):a,s9=a=>"number"==typeof a||mu.test(a);function ta(a,b,c,d,e,f){e?(a.opacity=mQ(0,c.opacity??1,tc(d)),a.opacityExit=mQ(b.opacity??1,0,td(d))):f&&(a.opacity=mQ(b.opacity??1,c.opacity??1,d));for(let e=0;e<s7;e++){let f=`border${s6[e]}Radius`,g=tb(b,f),h=tb(c,f);(void 0!==g||void 0!==h)&&(g||(g=0),h||(h=0),0===g||0===h||s9(g)===s9(h)?(a[f]=Math.max(mQ(s8(g),s8(h),d),0),(mt.test(h)||mt.test(g))&&(a[f]+="%")):a[f]=h)}(b.rotate||c.rotate)&&(a.rotate=mQ(b.rotate||0,c.rotate||0,d))}function tb(a,b){return void 0!==a[b]?a[b]:a.borderRadius}let tc=te(0,.5,nC),td=te(.5,.95,lG);function te(a,b,c){return d=>d<a?0:d>b?1:c(nI(a,b,d))}function tf(a,b){a.min=b.min,a.max=b.max}function tg(a,b){tf(a.x,b.x),tf(a.y,b.y)}function th(a,b){a.translate=b.translate,a.scale=b.scale,a.originPoint=b.originPoint,a.origin=b.origin}function ti(a,b,c,d,e){return a-=b,a=p4(a,1/c,d),void 0!==e&&(a=p4(a,1/e,d)),a}function tj(a,b=0,c=1,d=.5,e,f=a,g=a){if(mt.test(b)&&(b=parseFloat(b),b=mQ(g.min,g.max,b/100)-g.min),"number"!=typeof b)return;let h=mQ(f.min,f.max,d);a===f&&(h-=b),a.min=ti(a.min,b,c,h,e),a.max=ti(a.max,b,c,h,e)}function tk(a,b,[c,d,e],f,g){tj(a,b[c],b[d],b[e],b.scale,f,g)}let tl=["x","scaleX","originX"],tm=["y","scaleY","originY"];function tn(a,b,c,d){tk(a.x,b,tl,c?c.x:void 0,d?d.x:void 0),tk(a.y,b,tm,c?c.y:void 0,d?d.y:void 0)}function to(a){return 0===a.translate&&1===a.scale}function tp(a){return to(a.x)&&to(a.y)}function tq(a,b){return a.min===b.min&&a.max===b.max}function tr(a,b){return tq(a.x,b.x)&&tq(a.y,b.y)}function ts(a,b){return Math.round(a.min)===Math.round(b.min)&&Math.round(a.max)===Math.round(b.max)}function tt(a,b){return ts(a.x,b.x)&&ts(a.y,b.y)}function tu(a){return r_(a.x)/r_(a.y)}function tv(a,b){return a.translate===b.translate&&a.scale===b.scale&&a.originPoint===b.originPoint}class tw{constructor(){this.members=[]}add(a){lB(this.members,a);for(let b=this.members.length-1;b>=0;b--){let c=this.members[b];if(c===a||c===this.lead||c===this.prevLead)continue;let d=c.instance;d&&!1===d.isConnected&&!1!==c.isPresent&&!c.snapshot&&lC(this.members,c)}a.scheduleRender()}remove(a){if(lC(this.members,a),a===this.prevLead&&(this.prevLead=void 0),a===this.lead){let a=this.members[this.members.length-1];a&&this.promote(a)}}relegate(a){let b,c=this.members.findIndex(b=>a===b);if(0===c)return!1;for(let a=c;a>=0;a--){let c=this.members[a],d=c.instance;if(!1!==c.isPresent&&(!d||!1!==d.isConnected)){b=c;break}}return!!b&&(this.promote(b),!0)}promote(a,b){let c=this.lead;if(a!==c&&(this.prevLead=c,this.lead=a,a.show(),c)){c.instance&&c.scheduleRender(),a.scheduleRender();let d=c.options.layoutDependency,e=a.options.layoutDependency;if(void 0===d||void 0===e||d!==e){let d=c.instance;!(d&&!1===d.isConnected&&!c.snapshot)&&(a.resumeFrom=c,b&&(a.resumeFrom.preserveOpacity=!0),c.snapshot&&(a.snapshot=c.snapshot,a.snapshot.latestValues=c.animationValues||c.latestValues),a.root&&a.root.isUpdating&&(a.isLayoutDirty=!0))}let{crossfade:f}=a.options;!1===f&&c.hide()}}exitAnimationComplete(){this.members.forEach(a=>{let{options:b,resumingFrom:c}=a;b.onExitComplete&&b.onExitComplete(),c&&c.options.onExitComplete&&c.options.onExitComplete()})}scheduleRender(){this.members.forEach(a=>{a.instance&&a.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function tx(a,b,c){let d="",e=a.x.translate/b.x,f=a.y.translate/b.y,g=c?.z||0;if((e||f||g)&&(d=`translate3d(${e}px, ${f}px, ${g}px) `),(1!==b.x||1!==b.y)&&(d+=`scale(${1/b.x}, ${1/b.y}) `),c){let{transformPerspective:a,rotate:b,rotateX:e,rotateY:f,skewX:g,skewY:h}=c;a&&(d=`perspective(${a}px) ${d}`),b&&(d+=`rotate(${b}deg) `),e&&(d+=`rotateX(${e}deg) `),f&&(d+=`rotateY(${f}deg) `),g&&(d+=`skewX(${g}deg) `),h&&(d+=`skewY(${h}deg) `)}let h=a.x.scale*b.x,i=a.y.scale*b.y;return(1!==h||1!==i)&&(d+=`scale(${h}, ${i})`),d||"none"}let ty=(a,b)=>a.depth-b.depth;class tz{constructor(){this.children=[],this.isDirty=!1}add(a){lB(this.children,a),this.isDirty=!0}remove(a){lC(this.children,a),this.isDirty=!0}forEach(a){this.isDirty&&this.children.sort(ty),this.isDirty=!1,this.children.forEach(a)}}let tA={nodes:0,calculatedTargetDeltas:0,calculatedProjections:0},tB=["","X","Y","Z"],tC=1e3,tD=0;function tE(a,b,c,d){let{latestValues:e}=b;e[a]&&(c[a]=e[a],b.setStaticValue(a,0),d&&(d[a]=0))}function tF(a){if(a.hasCheckedOptimisedAppear=!0,a.root===a)return;let{visualElement:b}=a.options;if(!b)return;let c=rb(b);if(window.MotionHasOptimisedAnimation(c,"transform")){let{layout:b,layoutId:d}=a.options;window.MotionCancelOptimisedAnimation(c,"transform",lM,!(b||d))}let{parent:d}=a;d&&!d.hasCheckedOptimisedAppear&&tF(d)}function tG({attachResizeListener:a,defaultParent:b,measureScroll:c,checkIsScrollRoot:d,resetTransform:e}){return class{constructor(a={},c=b?.()){this.id=tD++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,lI.value&&(tA.nodes=tA.calculatedTargetDeltas=tA.calculatedProjections=0),this.nodes.forEach(tJ),this.nodes.forEach(tQ),this.nodes.forEach(tR),this.nodes.forEach(tK),lI.addProjectionMetrics&&lI.addProjectionMetrics(tA)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let a=0;a<this.path.length;a++)this.path[a].shouldResetTransform=!0;this.root===this&&(this.nodes=new tz)}addEventListener(a,b){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new lD),this.eventHandlers.get(a).add(b)}notifyListeners(a,...b){let c=this.eventHandlers.get(a);c&&c.notify(...b)}hasListeners(a){return this.eventHandlers.has(a)}mount(b){if(this.instance)return;this.isSVG=sd(b)&&!s5(b),this.instance=b;let{layoutId:c,layout:d,visualElement:e}=this.options;if(e&&!e.current&&e.mount(b),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(d||c)&&(this.isLayoutDirty=!0),a){let c,d=0,e=()=>this.root.updateBlockedByResize=!1;lM.read(()=>{d=window.innerWidth}),a(b,()=>{let a=window.innerWidth;a!==d&&(d=a,this.root.updateBlockedByResize=!0,c&&c(),c=s4(e,250),s$.hasAnimatedSinceResize&&(s$.hasAnimatedSinceResize=!1,this.nodes.forEach(tP)))})}c&&this.root.registerSharedNode(c,this),!1!==this.options.animate&&e&&(c||d)&&this.addEventListener("didUpdate",({delta:a,hasLayoutChanged:b,hasRelativeLayoutChanged:c,layout:d})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}let f=this.options.transition||e.getDefaultTransition()||tY,{onLayoutAnimationStart:g,onLayoutAnimationComplete:h}=e.getProps(),i=!this.targetLayout||!tt(this.targetLayout,d),j=!b&&c;if(this.options.layoutRoot||this.resumeFrom||j||b&&(i||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);let b={...q4(f,"layout"),onPlay:g,onComplete:h};(e.shouldReduceMotion||this.options.layoutRoot)&&(b.delay=0,b.type=!1),this.startAnimation(b),this.setAnimationOrigin(a,j)}else b||tP(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=d})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);let a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),lN(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){!this.isUpdateBlocked()&&(this.isUpdating=!0,this.nodes&&this.nodes.forEach(tS),this.animationId++)}getTransformTemplate(){let{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&tF(this),this.root.isUpdating||this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let a=0;a<this.path.length;a++){let b=this.path[a];b.shouldResetTransform=!0,b.updateScroll("snapshot"),b.options.layoutRoot&&b.willUpdate(!1)}let{layoutId:b,layout:c}=this.options;if(void 0===b&&!c)return;let d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(tM);return}if(this.animationId<=this.animationCommitId)return void this.nodes.forEach(tN);this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(tO),this.nodes.forEach(tH),this.nodes.forEach(tI)):this.nodes.forEach(tN),this.clearAllSnapshots();let a=lR.now();lO.delta=l1(0,1e3/60,a-lO.timestamp),lO.timestamp=a,lO.isProcessing=!0,lP.update.process(lO),lP.preRender.process(lO),lP.render.process(lO),lO.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,pe.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(tL),this.sharedNodes.forEach(tT)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,lM.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){lM.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure(),!this.snapshot||r_(this.snapshot.measuredBox.x)||r_(this.snapshot.measuredBox.y)||(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let a=0;a<this.path.length;a++)this.path[a].updateScroll();let a=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=om(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);let{visualElement:b}=this.options;b&&b.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let b=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(b=!1),b&&this.instance){let b=d(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:b,offset:c(this.instance),wasRoot:this.scroll?this.scroll.isRoot:b}}}resetTransform(){if(!e)return;let a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,b=this.projectionDelta&&!tp(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,f=d!==this.prevTransformTemplateValue;a&&this.instance&&(b||p1(this.latestValues)||f)&&(e(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){let b=this.measurePageBox(),c=this.removeElementScroll(b);return a&&(c=this.removeTransform(c)),t0(c),{animationId:this.root.animationId,measuredBox:b,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){let{visualElement:a}=this.options;if(!a)return om();let b=a.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(t2))){let{scroll:a}=this.root;a&&(qb(b.x,a.offset.x),qb(b.y,a.offset.y))}return b}removeElementScroll(a){let b=om();if(tg(b,a),this.scroll?.wasRoot)return b;for(let c=0;c<this.path.length;c++){let d=this.path[c],{scroll:e,options:f}=d;d!==this.root&&e&&f.layoutScroll&&(e.wasRoot&&tg(b,a),qb(b.x,e.offset.x),qb(b.y,e.offset.y))}return b}applyTransform(a,b=!1){let c=om();tg(c,a);for(let a=0;a<this.path.length;a++){let d=this.path[a];!b&&d.options.layoutScroll&&d.scroll&&d!==d.root&&qd(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),p1(d.latestValues)&&qd(c,d.latestValues)}return p1(this.latestValues)&&qd(c,this.latestValues),c}removeTransform(a){let b=om();tg(b,a);for(let a=0;a<this.path.length;a++){let c=this.path[a];if(!c.instance||!p1(c.latestValues))continue;p0(c.latestValues)&&c.updateSnapshot();let d=om();tg(d,c.measurePageBox()),tn(b,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,d)}return p1(this.latestValues)&&tn(b,this.latestValues),b}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:void 0===a.crossfade||a.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==lO.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){let b=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=b.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=b.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=b.isSharedProjectionDirty);let c=!!this.resumingFrom||this!==b;if(!(a||c&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;let{layout:d,layoutId:e}=this.options;if(!this.layout||!(d||e))return;this.resolvedRelativeTargetAt=lO.timestamp;let f=this.getClosestProjectingParent();f&&this.linkedParentVersion!==f.layoutVersion&&!f.options.layoutRoot&&this.removeRelativeTarget(),this.targetDelta||this.relativeTarget||(f&&f.layout?this.createRelativeTarget(f,this.layout.layoutBox,f.layout.layoutBox):this.removeRelativeTarget()),(this.relativeTarget||this.targetDelta)&&(this.target||(this.target=om(),this.targetWithTransforms=om()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),r4(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):tg(this.target,this.layout.layoutBox),p7(this.target,this.targetDelta)):tg(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&1!==this.animationProgress?this.createRelativeTarget(f,this.target,f.target):this.relativeParent=this.relativeTarget=void 0),lI.value&&tA.calculatedTargetDeltas++)}getClosestProjectingParent(){if(!(!this.parent||p0(this.parent.latestValues)||p2(this.parent.latestValues)))if(this.parent.isProjecting())return this.parent;else return this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(a,b,c){this.relativeParent=a,this.linkedParentVersion=a.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=om(),this.relativeTargetOrigin=om(),r6(this.relativeTargetOrigin,b,c),tg(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){let a=this.getLead(),b=!!this.resumingFrom||this!==a,c=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(c=!1),b&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===lO.timestamp&&(c=!1),c)return;let{layout:d,layoutId:e}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||e))return;tg(this.layoutCorrected,this.layout.layoutBox);let f=this.treeScale.x,g=this.treeScale.y;qa(this.layoutCorrected,this.treeScale,this.path,b),a.layout&&!a.target&&(1!==this.treeScale.x||1!==this.treeScale.y)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=om());let{target:h}=a;if(!h){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}this.projectionDelta&&this.prevProjectionDelta?(th(this.prevProjectionDelta.x,this.projectionDelta.x),th(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),r2(this.projectionDelta,this.layoutCorrected,h,this.latestValues),this.treeScale.x===f&&this.treeScale.y===g&&tv(this.projectionDelta.x,this.prevProjectionDelta.x)&&tv(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",h)),lI.value&&tA.calculatedProjections++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){if(this.options.visualElement?.scheduleRender(),a){let a=this.getStack();a&&a.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=ok(),this.projectionDelta=ok(),this.projectionDeltaWithTransform=ok()}setAnimationOrigin(a,b=!1){let c,d=this.snapshot,e=d?d.latestValues:{},f={...this.latestValues},g=ok();this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!b;let h=om(),i=(d?d.source:void 0)!==(this.layout?this.layout.source:void 0),j=this.getStack(),k=!j||j.members.length<=1,l=!!(i&&!k&&!0===this.options.crossfade&&!this.path.some(tX));this.animationProgress=0,this.mixTargetDelta=b=>{let d=b/1e3;tU(g.x,a.x,d),tU(g.y,a.y,d),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(r6(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),tW(this.relativeTarget,this.relativeTargetOrigin,h,d),c&&tr(this.relativeTarget,c)&&(this.isProjectionDirty=!1),c||(c=om()),tg(c,this.relativeTarget)),i&&(this.animationValues=f,ta(f,e,this.latestValues,d,l,k)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=d},this.mixTargetDelta(1e3*!!this.options.layoutRoot)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(lN(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=lM.update(()=>{s$.hasAnimatedSinceResize=!0,l4.layout++,this.motionValue||(this.motionValue=lW(0)),this.currentAnimation=s3(this.motionValue,[0,1e3],{...a,velocity:0,isSync:!0,onUpdate:b=>{this.mixTargetDelta(b),a.onUpdate&&a.onUpdate(b)},onStop:()=>{l4.layout--},onComplete:()=>{l4.layout--,a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);let a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(tC),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){let a=this.getLead(),{targetWithTransforms:b,target:c,layout:d,latestValues:e}=a;if(b&&c&&d){if(this!==a&&this.layout&&d&&t1(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||om();let b=r_(this.layout.layoutBox.x);c.x.min=a.target.x.min,c.x.max=c.x.min+b;let d=r_(this.layout.layoutBox.y);c.y.min=a.target.y.min,c.y.max=c.y.min+d}tg(b,c),qd(b,e),r2(this.projectionDeltaWithTransform,this.layoutCorrected,b,e)}}registerSharedNode(a,b){this.sharedNodes.has(a)||this.sharedNodes.set(a,new tw),this.sharedNodes.get(a).add(b);let c=b.options.initialPromotionConfig;b.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(b):void 0})}isLead(){let a=this.getStack();return!a||a.lead===this}getLead(){let{layoutId:a}=this.options;return a&&this.getStack()?.lead||this}getPrevLead(){let{layoutId:a}=this.options;return a?this.getStack()?.prevLead:void 0}getStack(){let{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:b,preserveFollowOpacity:c}={}){let d=this.getStack();d&&d.promote(this,c),a&&(this.projectionDelta=void 0,this.needsReset=!0),b&&this.setOptions({transition:b})}relegate(){let a=this.getStack();return!!a&&a.relegate(this)}resetSkewAndRotation(){let{visualElement:a}=this.options;if(!a)return;let b=!1,{latestValues:c}=a;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(b=!0),!b)return;let d={};c.z&&tE("z",a,d,this.animationValues);for(let b=0;b<tB.length;b++)tE(`rotate${tB[b]}`,a,d,this.animationValues),tE(`skew${tB[b]}`,a,d,this.animationValues);for(let b in a.render(),d)a.setStaticValue(b,d[b]),this.animationValues&&(this.animationValues[b]=d[b]);a.scheduleRender()}applyProjectionStyles(a,b){if(!this.instance||this.isSVG)return;if(!this.isVisible){a.visibility="hidden";return}let c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,a.visibility="",a.opacity="",a.pointerEvents=qE(b?.pointerEvents)||"",a.transform=c?c(this.latestValues,""):"none";return}let d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(a.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,a.pointerEvents=qE(b?.pointerEvents)||""),this.hasProjected&&!p1(this.latestValues)&&(a.transform=c?c({},""):"none",this.hasProjected=!1);return}a.visibility="";let e=d.animationValues||d.latestValues;this.applyTransformsToTarget();let f=tx(this.projectionDeltaWithTransform,this.treeScale,e);c&&(f=c(e,f)),a.transform=f;let{x:g,y:h}=this.projectionDelta;for(let b in a.transformOrigin=`${100*g.origin}% ${100*h.origin}% 0`,d.animationValues?a.opacity=d===this?e.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:e.opacityExit:a.opacity=d===this?void 0!==e.opacity?e.opacity:"":void 0!==e.opacityExit?e.opacityExit:0,pT){if(void 0===e[b])continue;let{correct:c,applyTo:g,isCSSVariable:h}=pT[b],i="none"===f?e[b]:c(e[b],d);if(g){let b=g.length;for(let c=0;c<b;c++)a[g[c]]=i}else h?this.options.visualElement.renderState.vars[b]=i:a[b]=i}this.options.layoutId&&(a.pointerEvents=d===this?qE(b?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>a.currentAnimation?.stop()),this.root.nodes.forEach(tM),this.root.sharedNodes.clear()}}}function tH(a){a.updateLayout()}function tI(a){let b=a.resumeFrom?.snapshot||a.snapshot;if(a.isLead()&&a.layout&&b&&a.hasListeners("didUpdate")){let{layoutBox:c,measuredBox:d}=a.layout,{animationType:e}=a.options,f=b.source!==a.layout.source;"size"===e?rW(a=>{let d=f?b.measuredBox[a]:b.layoutBox[a],e=r_(d);d.min=c[a].min,d.max=d.min+e}):t1(e,b.layoutBox,c)&&rW(d=>{let e=f?b.measuredBox[d]:b.layoutBox[d],g=r_(c[d]);e.max=e.min+g,a.relativeTarget&&!a.currentAnimation&&(a.isProjectionDirty=!0,a.relativeTarget[d].max=a.relativeTarget[d].min+g)});let g=ok();r2(g,c,b.layoutBox);let h=ok();f?r2(h,a.applyTransform(d,!0),b.measuredBox):r2(h,c,b.layoutBox);let i=!tp(g),j=!1;if(!a.resumeFrom){let d=a.getClosestProjectingParent();if(d&&!d.resumeFrom){let{snapshot:e,layout:f}=d;if(e&&f){let g=om();r6(g,b.layoutBox,e.layoutBox);let h=om();r6(h,c,f.layoutBox),tt(g,h)||(j=!0),d.options.layoutRoot&&(a.relativeTarget=h,a.relativeTargetOrigin=g,a.relativeParent=d)}}}a.notifyListeners("didUpdate",{layout:c,snapshot:b,delta:h,layoutDelta:g,hasLayoutChanged:i,hasRelativeLayoutChanged:j})}else if(a.isLead()){let{onExitComplete:b}=a.options;b&&b()}a.options.transition=void 0}function tJ(a){lI.value&&tA.nodes++,a.parent&&(a.isProjecting()||(a.isProjectionDirty=a.parent.isProjectionDirty),a.isSharedProjectionDirty||(a.isSharedProjectionDirty=!!(a.isProjectionDirty||a.parent.isProjectionDirty||a.parent.isSharedProjectionDirty)),a.isTransformDirty||(a.isTransformDirty=a.parent.isTransformDirty))}function tK(a){a.isProjectionDirty=a.isSharedProjectionDirty=a.isTransformDirty=!1}function tL(a){a.clearSnapshot()}function tM(a){a.clearMeasurements()}function tN(a){a.isLayoutDirty=!1}function tO(a){let{visualElement:b}=a.options;b&&b.getProps().onBeforeLayoutMeasure&&b.notify("BeforeLayoutMeasure"),a.resetTransform()}function tP(a){a.finishAnimation(),a.targetDelta=a.relativeTarget=a.target=void 0,a.isProjectionDirty=!0}function tQ(a){a.resolveTargetDelta()}function tR(a){a.calcProjection()}function tS(a){a.resetSkewAndRotation()}function tT(a){a.removeLeadSnapshot()}function tU(a,b,c){a.translate=mQ(b.translate,0,c),a.scale=mQ(b.scale,1,c),a.origin=b.origin,a.originPoint=b.originPoint}function tV(a,b,c,d){a.min=mQ(b.min,c.min,d),a.max=mQ(b.max,c.max,d)}function tW(a,b,c,d){tV(a.x,b.x,c.x,d),tV(a.y,b.y,c.y,d)}function tX(a){return a.animationValues&&void 0!==a.animationValues.opacityExit}let tY={duration:.45,ease:[.4,0,.1,1]},tZ=a=>"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(a),t$=tZ("applewebkit/")&&!tZ("chrome/")?Math.round:lG;function t_(a){a.min=t$(a.min),a.max=t$(a.max)}function t0(a){t_(a.x),t_(a.y)}function t1(a,b,c){return"position"===a||"preserve-aspect"===a&&!r0(tu(b),tu(c),.2)}function t2(a){return a!==a.root&&a.scroll?.wasRoot}let t3=tG({attachResizeListener:(a,b)=>sb(a,"resize",b),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body?.scrollLeft||0,y:document.documentElement.scrollTop||document.body?.scrollTop||0}),checkIsScrollRoot:()=>!0}),t4={current:void 0},t5=tG({measureScroll:a=>({x:a.scrollLeft,y:a.scrollTop}),defaultParent:()=>{if(!t4.current){let a=new t3({});a.mount(window),a.setOptions({layoutScroll:!0}),t4.current=a}return t4.current},resetTransform:(a,b)=>{a.style.transform=void 0!==b?b:"none"},checkIsScrollRoot:a=>"fixed"===window.getComputedStyle(a).position}),t6={pan:{Feature:sZ},drag:{Feature:sX,ProjectionNode:t5,MeasureLayout:s2}};function t7(a,b){let c=se(a),d=new AbortController;return[c,{passive:!0,...b,signal:d.signal},()=>d.abort()]}function t8(a){return!("touch"===a.pointerType||rU())}function t9(a,b,c={}){let[d,e,f]=t7(a,c);return d.forEach(a=>{let c,d=!1,f=!1,g=()=>{a.removeEventListener("pointerleave",k)},h=a=>{c&&(c(a),c=void 0),g()},i=a=>{d=!1,window.removeEventListener("pointerup",i),window.removeEventListener("pointercancel",i),f&&(f=!1,h(a))},j=()=>{d=!0,window.addEventListener("pointerup",i,e),window.addEventListener("pointercancel",i,e)},k=a=>{if("touch"!==a.pointerType){if(d){f=!0;return}h(a)}},l=d=>{if(!t8(d))return;f=!1;let g=b(a,d);"function"==typeof g&&(c=g,a.addEventListener("pointerleave",k,e))};a.addEventListener("pointerenter",l,e),a.addEventListener("pointerdown",j,e)}),f}function ua(a,b,c){let{props:d}=a;a.animationState&&d.whileHover&&a.animationState.setActive("whileHover","Start"===c);let e=d["onHover"+c];e&&lM.postRender(()=>e(b,ss(b)))}class ub extends q1{mount(){let{current:a}=this.node;a&&(this.unmount=t9(a,(a,b)=>(ua(this.node,b,"Start"),a=>ua(this.node,a,"End"))))}unmount(){}}class uc extends q1{constructor(){super(...arguments),this.isActive=!1}onFocus(){let a=!1;try{a=this.node.current.matches(":focus-visible")}catch(b){a=!0}a&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=l0(sb(this.node.current,"focus",()=>this.onFocus()),sb(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function ud(a){return sc(a)&&"offsetHeight"in a}let ue=(a,b)=>!!b&&(a===b||ue(a,b.parentElement)),uf=new WeakSet;function ug(a){return b=>{"Enter"===b.key&&a(b)}}function uh(a,b){a.dispatchEvent(new PointerEvent("pointer"+b,{isPrimary:!0,bubbles:!0}))}let ui=(a,b)=>{let c=a.currentTarget;if(!c)return;let d=ug(()=>{if(uf.has(c))return;uh(c,"down");let a=ug(()=>{uh(c,"up")}),d=()=>uh(c,"cancel");c.addEventListener("keyup",a,b),c.addEventListener("blur",d,b)});c.addEventListener("keydown",d,b),c.addEventListener("blur",()=>c.removeEventListener("keydown",d),b)};function uj(a){return sr(a)&&!rU()}let uk=new WeakSet;function ul(a,b,c={}){let[d,e,f]=t7(a,c),g=a=>{let d=a.currentTarget;if(!uj(a)||uk.has(a))return;uf.add(d),c.stopPropagation&&uk.add(a);let f=b(d,a),g=(a,b)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",i),uf.has(d)&&uf.delete(d),uj(a)&&"function"==typeof f&&f(a,{success:b})},h=a=>{g(a,d===window||d===document||c.useGlobalTarget||ue(d,a.target))},i=a=>{g(a,!1)};window.addEventListener("pointerup",h,e),window.addEventListener("pointercancel",i,e)};return d.forEach(a=>{(c.useGlobalTarget?window:a).addEventListener("pointerdown",g,e),ud(a)&&(a.addEventListener("focus",a=>ui(a,e)),r8(a)||a.hasAttribute("tabindex")||(a.tabIndex=0))}),f}function um(a,b,c){let{props:d}=a;if(a.current instanceof HTMLButtonElement&&a.current.disabled)return;a.animationState&&d.whileTap&&a.animationState.setActive("whileTap","Start"===c);let e=d["onTap"+("End"===c?"":c)];e&&lM.postRender(()=>e(b,ss(b)))}class un extends q1{mount(){let{current:a}=this.node;if(!a)return;let{globalTapTarget:b,propagate:c}=this.node.props;this.unmount=ul(a,(a,b)=>(um(this.node,b,"Start"),(a,{success:b})=>um(this.node,a,b?"End":"Cancel")),{useGlobalTarget:b,stopPropagation:c?.tap===!1})}unmount(){}}let uo=new WeakMap,up=new WeakMap,uq=a=>{let b=uo.get(a.target);b&&b(a)},ur=a=>{a.forEach(uq)};function us({root:a,...b}){let c=a||document;up.has(c)||up.set(c,{});let d=up.get(c),e=JSON.stringify(b);return d[e]||(d[e]=new IntersectionObserver(ur,{root:a,...b})),d[e]}function ut(a,b,c){let d=us(b);return uo.set(a,c),d.observe(a),()=>{uo.delete(a),d.unobserve(a)}}let uu={some:0,all:1};class uv extends q1{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();let{viewport:a={}}=this.node.getProps(),{root:b,margin:c,amount:d="some",once:e}=a,f={root:b?b.current:void 0,rootMargin:c,threshold:"number"==typeof d?d:uu[d]},g=a=>{let{isIntersecting:b}=a;if(this.isInView===b||(this.isInView=b,e&&!b&&this.hasEnteredView))return;b&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",b);let{onViewportEnter:c,onViewportLeave:d}=this.node.getProps(),f=b?c:d;f&&f(a)};return ut(this.node.current,f,g)}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;let{props:a,prevProps:b}=this.node;["amount","margin","root"].some(uw(a,b))&&this.startObserver()}unmount(){}}function uw({viewport:a={}},{viewport:b={}}={}){return c=>a[c]!==b[c]}let ux={inView:{Feature:uv},tap:{Feature:un},focus:{Feature:uc},hover:{Feature:ub}},uy={layout:{ProjectionNode:t5,MeasureLayout:s2}},uz=q0({...rS,...ux,...t6,...uy},qk);var uA=c(44943);let uB=({id:a,className:b,children:c,fullWidth:d=!1})=>(0,x.jsx)("section",{id:a,className:(0,uA.cn)("section-wrapper py-32 md:py-40 justify-center",b),children:(0,x.jsx)(uz.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0,amount:.1},transition:{duration:.8,ease:"easeOut"},className:(0,uA.cn)("w-full mx-auto flex flex-col justify-center",!d&&"max-w-7xl px-6 md:px-12"),children:c})}),uC=[{label:"Academic Node",desc:"B.Tech CSE, CUK (20242028). Researching scalable systems."},{label:"Industrial Layer",desc:"Python Developer Intern @ Oasis Infobyte. Automation & Logic."},{label:"Physical Layer",desc:"National Level Taekwondo. High-performance mindset."}],uD=()=>{let[a,b]=(0,y.useState)({x:0,y:0}),[c,d]=(0,y.useState)(!1),e=lZ(0),f=lZ(0),g=n7(e,{stiffness:150,damping:20}),h=n3(n7(f,{stiffness:150,damping:20}),[-.5,.5],["10deg","-10deg"]),i=n3(g,[-.5,.5],["-10deg","10deg"]),j=a=>{let b=a.currentTarget.getBoundingClientRect(),c=(a.clientX-b.left)/b.width-.5,d=(a.clientY-b.top)/b.height-.5;e.set(c),f.set(d)},k=()=>d(!0),l=()=>{e.set(0),f.set(0),d(!1)};return(0,y.useEffect)(()=>{let a=a=>{b({x:(a.clientX/window.innerWidth-.5)*40,y:(a.clientY/window.innerHeight-.5)*40})};return window.addEventListener("mousemove",a),()=>window.removeEventListener("mousemove",a)},[]),(0,x.jsx)(uB,{id:"hero",className:"relative bg-transparent overflow-visible min-h-screen flex items-center pt-24 md:pt-0",children:(0,x.jsxs)("div",{className:"z-10 relative grid lg:grid-cols-2 gap-12 items-center w-full",children:[(0,x.jsx)("div",{className:"perspective-1000 order-1",children:(0,x.jsxs)(uz.div,{animate:{x:.1*a.x,y:.1*a.y},transition:{type:"spring",stiffness:100},children:[(0,x.jsxs)(uz.h1,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:1.2,ease:"circOut"},className:"text-5xl md:text-8xl xl:text-9xl font-headline font-bold leading-[0.85] tracking-tighter mb-4",children:["AATIF MUNEEB ",(0,x.jsx)("br",{}),(0,x.jsx)("span",{className:"text-transparent stroke-text opacity-40",children:"KHAN"})]}),(0,x.jsxs)(uz.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:1.2,delay:.3,ease:"easeOut"},className:"flex items-center gap-4 mb-8",children:[(0,x.jsx)("div",{className:"w-8 h-[1px] bg-primary/60"}),(0,x.jsx)("span",{className:"text-primary font-headline text-[11px] md:text-sm uppercase tracking-[0.8em] whitespace-nowrap",children:"AI / ML Engineer"})]}),(0,x.jsxs)(uz.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:1.5,delay:.8},className:"max-w-xl text-lg text-muted-foreground font-body leading-relaxed border-l border-primary/20 pl-8",children:[(0,x.jsxs)("p",{className:"mb-8 font-light tracking-tight",children:["Building intelligent systems with ",(0,x.jsx)("span",{className:"text-white font-medium",children:"discipline and depth"}),"."]}),(0,x.jsxs)("div",{className:"flex gap-12 text-[9px] uppercase tracking-[0.4em] font-headline opacity-60",children:[(0,x.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,x.jsx)("span",{className:"text-primary",children:"Focus"}),(0,x.jsx)("span",{className:"text-white",children:"Neural Reliability"})]}),(0,x.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,x.jsx)("span",{className:"text-primary",children:"Status"}),(0,x.jsx)("span",{className:"text-white",children:"Research Active"})]})]})]})]})}),(0,x.jsx)("div",{className:"flex justify-center lg:justify-end order-2",children:(0,x.jsxs)(uz.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:c?0:[0,-10,0]},onMouseEnter:k,onMouseMove:j,onMouseLeave:l,style:{rotateY:i,rotateX:h,transformStyle:"preserve-3d",backfaceVisibility:"hidden"},transition:{duration:c?.3:4,repeat:c?0:1/0,ease:"easeInOut",opacity:{duration:1.2,delay:.5}},className:"relative perspective-1000 w-full max-w-[340px] will-change-transform",children:[(0,x.jsxs)("div",{className:"bg-[#0a0a0a] p-8 rounded-2xl border border-white/10 shadow-2xl backdrop-blur-xl group overflow-hidden antialiased",children:[(0,x.jsx)("h2",{className:"text-primary font-headline text-[10px] uppercase tracking-[0.5em] mb-8 opacity-80",style:{transform:"translateZ(30px)"},children:"Deployment Profile"}),(0,x.jsx)("div",{className:"space-y-8",style:{transform:"translateZ(40px)"},children:uC.map((a,b)=>(0,x.jsxs)("div",{className:"relative pl-6 border-l border-white/5 group/node",children:[(0,x.jsx)("div",{className:"absolute left-0 top-0 w-[1px] h-0 bg-primary group-hover/node:h-full transition-all duration-500"}),(0,x.jsx)("h4",{className:"font-headline font-bold text-sm text-white mb-1",children:a.label}),(0,x.jsx)("p",{className:"text-[11px] text-muted-foreground leading-relaxed font-light",children:a.desc})]},b))}),(0,x.jsxs)("div",{className:"mt-8 pt-6 border-t border-white/5",style:{transform:"translateZ(30px)"},children:[(0,x.jsx)("h5",{className:"font-headline text-[8px] uppercase tracking-widest text-primary mb-3 opacity-40",children:"System Inventory"}),(0,x.jsx)("div",{className:"flex flex-wrap gap-2",children:["Teamwork","Adaptability","Boxing","Film Making"].map(a=>(0,x.jsx)("span",{className:"text-[7px] uppercase tracking-widest opacity-30 px-2 py-1 bg-white/5 rounded border border-white/5",children:a},a))})]}),(0,x.jsx)(uz.div,{className:"absolute inset-0 bg-gradient-to-br from-white/[0.03] to-transparent pointer-events-none opacity-0 group-hover:opacity-100 transition-opacity",style:{transform:"translateZ(100px)"}})]}),(0,x.jsx)("div",{className:"absolute -right-4 top-1/4 hidden md:flex flex-col gap-4 opacity-20",style:{transform:"translateZ(-20px)"},children:[1,2,3].map(a=>(0,x.jsx)("div",{className:"w-1 h-1 rounded-full bg-primary"},a))})]})})]})})},uE=[{title:"Model Evaluation & Error Analysis",desc:"Developing robust frameworks for measuring AI performance beyond simple accuracy, focusing on edge-case discovery."},{title:"Efficient & Scalable ML Systems",desc:"Optimizing model throughput and latency for deployment in resource-constrained real-world environments."},{title:"Applied AI with Real-World Constraints",desc:"Bridging the gap between research-grade models and production-ready systems that solve actual business logic."}],uF=({focus:a,index:b})=>{let c=lZ(0),d=lZ(0),e=n7(c),f=n3(n7(d),[-.5,.5],["10deg","-10deg"]),g=n3(e,[-.5,.5],["-10deg","10deg"]),h=a=>{let b=a.currentTarget.getBoundingClientRect(),e=(a.clientX-b.left)/b.width-.5,f=(a.clientY-b.top)/b.height-.5;c.set(e),d.set(f)};return(0,x.jsx)(uz.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.6,delay:.2*b},onMouseMove:h,onMouseLeave:()=>{c.set(0),d.set(0)},style:{rotateX:f,rotateY:g,transformStyle:"preserve-3d"},className:"group border-l border-primary/20 pl-8 py-6 hover:border-primary transition-all bg-white/[0.02] rounded-r-xl backdrop-blur-sm",children:(0,x.jsxs)("div",{style:{transform:"translateZ(30px)"},children:[(0,x.jsx)("h4",{className:"font-headline font-bold text-xl mb-2 group-hover:text-primary transition-colors",children:a.title}),(0,x.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:a.desc})]})})},uG=()=>(0,x.jsx)(uB,{id:"about",className:"bg-transparent",children:(0,x.jsxs)("div",{className:"space-y-32",children:[(0,x.jsxs)("div",{className:"grid lg:grid-cols-2 gap-20 items-start",children:[(0,x.jsxs)(uz.div,{initial:{opacity:0,x:-30},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{duration:.8},children:[(0,x.jsx)("h2",{className:"text-primary font-headline text-sm uppercase tracking-[0.5em] mb-6",children:"Research Direction"}),(0,x.jsxs)("h3",{className:"text-4xl md:text-6xl font-headline font-bold mb-10 leading-tight",children:["Im interested in building AI systems that are ",(0,x.jsx)("span",{className:"text-primary text-glow italic",children:"measurable, reliable, and scalable."})]}),(0,x.jsx)("p",{className:"text-lg text-muted-foreground font-body leading-relaxed max-w-xl",children:"Currently a B.Tech CSE student at CUK (20242028). My work avoids tutorial-level shallow implementation, focusing instead on the long-term depth of neural architectures."})]}),(0,x.jsx)("div",{className:"space-y-8 perspective-1000",children:uE.map((a,b)=>(0,x.jsx)(uF,{focus:a,index:b},b))})]}),(0,x.jsxs)(uz.div,{initial:{opacity:0,scale:.95},whileInView:{opacity:1,scale:1},viewport:{once:!0},className:"border-y border-white/5 py-12 flex flex-col md:flex-row items-center justify-between gap-8",children:[(0,x.jsxs)("div",{className:"flex items-center gap-6",children:[(0,x.jsxs)("div",{className:"relative",children:[(0,x.jsx)("div",{className:"w-3 h-3 bg-primary rounded-full animate-ping"}),(0,x.jsx)("div",{className:"absolute inset-0 w-3 h-3 bg-primary rounded-full"})]}),(0,x.jsx)("span",{className:"font-headline text-xs uppercase tracking-[0.3em] text-primary",children:"Currently Building"})]}),(0,x.jsxs)("div",{className:"flex flex-wrap gap-8 justify-center text-[10px] md:text-xs uppercase tracking-widest font-body opacity-60",children:[(0,x.jsx)("span",{children:"Learning PyTorch Deeply"}),(0,x.jsx)("span",{children:"Studying Model Evaluation Techniques"}),(0,x.jsx)("span",{children:"Targeting GSoC 2026"})]})]})]})}),uH=[{label:"Data",desc:"Curation & Versioning"},{label:"Model",desc:"Architecture Selection"},{label:"Evaluation",desc:"Robust Stress Testing"},{label:"Deployment",desc:"Scalable Infrastructure"},{label:"Monitoring",desc:"Drift & Performance"}],uI=({step:a,index:b})=>{let c=lZ(0),d=lZ(0),e=n7(c),f=n3(n7(d),[-.5,.5],["15deg","-15deg"]),g=n3(e,[-.5,.5],["-15deg","15deg"]);return(0,x.jsxs)(uz.div,{onMouseMove:a=>{let b=a.currentTarget.getBoundingClientRect();c.set((a.clientX-b.left)/b.width-.5),d.set((a.clientY-b.top)/b.height-.5)},onMouseLeave:()=>{c.set(0),d.set(0)},style:{rotateX:f,rotateY:g,transformStyle:"preserve-3d"},className:"relative group",children:[(0,x.jsx)("div",{className:"bg-card/30 border border-white/5 p-6 rounded-lg backdrop-blur-md group-hover:border-primary/40 transition-all",children:(0,x.jsxs)("div",{style:{transform:"translateZ(20px)"},children:[(0,x.jsxs)("span",{className:"block text-[10px] text-primary mb-2 opacity-50 font-code",children:["0",b+1]}),(0,x.jsx)("h4",{className:"font-headline font-bold text-lg mb-1",children:a.label}),(0,x.jsx)("p",{className:"text-[10px] text-muted-foreground uppercase tracking-widest",children:a.desc})]})}),b<4&&(0,x.jsx)("div",{className:"hidden md:block absolute top-1/2 -right-2 w-4 h-[1px] bg-primary/20 -translate-y-1/2"})]})},uJ=()=>(0,x.jsx)(uB,{id:"system-thinking",className:"bg-transparent",children:(0,x.jsxs)("div",{className:"max-w-5xl mx-auto w-full",children:[(0,x.jsx)("h2",{className:"text-primary font-headline text-sm uppercase tracking-[0.5em] mb-6",children:"System Architecture"}),(0,x.jsxs)("h3",{className:"text-4xl md:text-6xl font-headline font-bold mb-16",children:["How I Think About ",(0,x.jsx)("br",{}),(0,x.jsx)("span",{className:"text-primary/60",children:"AI Systems."})]}),(0,x.jsx)("div",{className:"grid md:grid-cols-5 gap-4 mb-20 perspective-1000",children:uH.map((a,b)=>(0,x.jsx)(uI,{step:a,index:b},b))}),(0,x.jsxs)("div",{className:"grid md:grid-cols-2 gap-12 items-center",children:[(0,x.jsxs)(uz.div,{initial:{opacity:0,x:-20},whileInView:{opacity:1,x:0},viewport:{once:!0},className:"space-y-8",children:[(0,x.jsx)("h4",{className:"text-2xl font-headline font-bold",children:"The Engineering Philosophy"}),(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("div",{className:"flex gap-6 group",children:[(0,x.jsx)("span",{className:"text-primary font-code text-xl group-hover:scale-110 transition-transform",children:"01"}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h5",{className:"font-headline font-bold uppercase text-xs tracking-widest mb-1 group-hover:text-primary transition-colors",children:"Tradeoffs > Accuracy"}),(0,x.jsx)("p",{className:"text-sm text-muted-foreground",children:"Highest accuracy isn't always the goal. I optimize for cost, latency, and maintainability."})]})]}),(0,x.jsxs)("div",{className:"flex gap-6 group",children:[(0,x.jsx)("span",{className:"text-primary font-code text-xl group-hover:scale-110 transition-transform",children:"02"}),(0,x.jsxs)("div",{children:[(0,x.jsx)("h5",{className:"font-headline font-bold uppercase text-xs tracking-widest mb-1 group-hover:text-primary transition-colors",children:"Reproducibility Matters"}),(0,x.jsx)("p",{className:"text-sm text-muted-foreground",children:"Research is useless if it can't be replicated. Versioned data and seeds are non-negotiable."})]})]})]})]}),(0,x.jsxs)(uz.div,{initial:{opacity:0,scale:.9},whileInView:{opacity:1,scale:1},viewport:{once:!0},className:"bg-primary/5 p-8 border border-primary/10 rounded-xl flex items-center justify-center relative overflow-hidden group",children:[(0,x.jsx)("div",{className:"absolute inset-0 bg-primary/5 opacity-0 group-hover:opacity-100 transition-opacity"}),(0,x.jsxs)("div",{className:"text-center relative z-10",children:[(0,x.jsx)("p",{className:"text-primary font-headline text-lg italic mb-2",children:'"Complexity is the enemy of reliability."'}),(0,x.jsx)("p",{className:"text-[10px] uppercase tracking-widest opacity-40",children:" Engineering Principle"})]})]})]})]})}),uK=()=>void 0,uL={NODE_CLIENT:!1,SDK_VERSION:"${JSCORE_VERSION}"},uM=function(a){return Error("Firebase Database ("+uL.SDK_VERSION+") INTERNAL ASSERT FAILED: "+a)},uN=function(a){let b=[],c=0;for(let d=0;d<a.length;d++){let e=a.charCodeAt(d);e<128?b[c++]=e:(e<2048?b[c++]=e>>6|192:((64512&e)==55296&&d+1<a.length&&(64512&a.charCodeAt(d+1))==56320?(e=65536+((1023&e)<<10)+(1023&a.charCodeAt(++d)),b[c++]=e>>18|240,b[c++]=e>>12&63|128):b[c++]=e>>12|224,b[c++]=e>>6&63|128),b[c++]=63&e|128)}return b},uO=function(a){let b=[],c=0,d=0;for(;c<a.length;){let e=a[c++];if(e<128)b[d++]=String.fromCharCode(e);else if(e>191&&e<224){let f=a[c++];b[d++]=String.fromCharCode((31&e)<<6|63&f)}else if(e>239&&e<365){let f=a[c++],g=((7&e)<<18|(63&f)<<12|(63&a[c++])<<6|63&a[c++])-65536;b[d++]=String.fromCharCode(55296+(g>>10)),b[d++]=String.fromCharCode(56320+(1023&g))}else{let f=a[c++],g=a[c++];b[d++]=String.fromCharCode((15&e)<<12|(63&f)<<6|63&g)}}return b.join("")},uP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(a,b){if(!Array.isArray(a))throw Error("encodeByteArray takes an array as a parameter");this.init_();let c=b?this.byteToCharMapWebSafe_:this.byteToCharMap_,d=[];for(let b=0;b<a.length;b+=3){let e=a[b],f=b+1<a.length,g=f?a[b+1]:0,h=b+2<a.length,i=h?a[b+2]:0,j=e>>2,k=(3&e)<<4|g>>4,l=(15&g)<<2|i>>6,m=63&i;!h&&(m=64,f||(l=64)),d.push(c[j],c[k],c[l],c[m])}return d.join("")},encodeString(a,b){return this.HAS_NATIVE_SUPPORT&&!b?btoa(a):this.encodeByteArray(uN(a),b)},decodeString(a,b){return this.HAS_NATIVE_SUPPORT&&!b?atob(a):uO(this.decodeStringToByteArray(a,b))},decodeStringToByteArray(a,b){this.init_();let c=b?this.charToByteMapWebSafe_:this.charToByteMap_,d=[];for(let b=0;b<a.length;){let e=c[a.charAt(b++)],f=b<a.length?c[a.charAt(b)]:0,g=++b<a.length?c[a.charAt(b)]:64,h=++b<a.length?c[a.charAt(b)]:64;if(++b,null==e||null==f||null==g||null==h)throw new uQ;let i=e<<2|f>>4;if(d.push(i),64!==g){let a=f<<4&240|g>>2;if(d.push(a),64!==h){let a=g<<6&192|h;d.push(a)}}}return d},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let a=0;a<this.ENCODED_VALS.length;a++)this.byteToCharMap_[a]=this.ENCODED_VALS.charAt(a),this.charToByteMap_[this.byteToCharMap_[a]]=a,this.byteToCharMapWebSafe_[a]=this.ENCODED_VALS_WEBSAFE.charAt(a),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[a]]=a,a>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(a)]=a,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(a)]=a)}}};class uQ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let uR=function(a){let b=uN(a);return uP.encodeByteArray(b,!0)},uS=function(a){return uR(a).replace(/\./g,"")},uT=function(a){try{return uP.decodeString(a,!0)}catch(a){console.error("base64Decode failed: ",a)}return null};function uU(a){return"__proto__"!==a}function uV(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("Unable to locate global object.")}let uW=()=>uV().__FIREBASE_DEFAULTS__,uX=()=>{if("undefined"==typeof process||void 0===process.env)return;let a=process.env.__FIREBASE_DEFAULTS__;if(a)return JSON.parse(a)},uY=()=>{let a;if("undefined"==typeof document)return;try{a=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(a){return}let b=a&&uT(a[1]);return b&&JSON.parse(b)},uZ=()=>{try{return uK()||uW()||uX()||uY()}catch(a){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${a}`);return}},u$=a=>{var b,c;return null==(c=null==(b=uZ())?void 0:b.emulatorHosts)?void 0:c[a]},u_=a=>{let b=u$(a);if(!b)return;let c=b.lastIndexOf(":");if(c<=0||c+1===b.length)throw Error(`Invalid host ${b} with no separate hostname and port!`);let d=parseInt(b.substring(c+1),10);return"["===b[0]?[b.substring(1,c-1),d]:[b.substring(0,c),d]},u0=()=>{var a;return null==(a=uZ())?void 0:a.config};class u1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((a,b)=>{this.resolve=a,this.reject=b})}wrapCallback(a){return(b,c)=>{b?this.reject(b):this.resolve(c),"function"==typeof a&&(this.promise.catch(()=>{}),1===a.length?a(b):a(b,c))}}}function u2(a){return a.endsWith(".cloudworkstations.dev")}async function u3(a){return(await fetch(a,{credentials:"include"})).ok}function u4(a,b){if(a.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let c={alg:"none",type:"JWT"},d=b||"demo-project",e=a.iat||0,f=a.sub||a.user_id;if(!f)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let g=Object.assign({iss:`https://securetoken.google.com/${d}`,aud:d,iat:e,exp:e+3600,auth_time:e,sub:f,user_id:f,firebase:{sign_in_provider:"custom",identities:{}}},a),h="";return[uS(JSON.stringify(c)),uS(JSON.stringify(g)),h].join(".")}let u5={};function u6(){let a={prod:[],emulator:[]};for(let b of Object.keys(u5))u5[b]?a.emulator.push(b):a.prod.push(b);return a}function u7(a){let b=document.getElementById(a),c=!1;return b||((b=document.createElement("div")).setAttribute("id",a),c=!0),{created:c,element:b}}let u8=!1;function u9(a,b){if("undefined"==typeof window||"undefined"==typeof document||!u2(window.location.host)||u5[a]===b||u5[a]||u8)return;function c(a){return`__firebase__banner__${a}`}u5[a]=b;let d="__firebase__banner",e=u6().prod.length>0;function f(){let a=document.getElementById(d);a&&a.remove()}function g(a){a.style.display="flex",a.style.background="#7faaf0",a.style.position="fixed",a.style.bottom="5px",a.style.left="5px",a.style.padding=".5em",a.style.borderRadius="5px",a.style.alignItems="center"}function h(a,b){a.setAttribute("width","24"),a.setAttribute("id",b),a.setAttribute("height","24"),a.setAttribute("viewBox","0 0 24 24"),a.setAttribute("fill","none"),a.style.marginLeft="-6px"}function i(){let a=document.createElement("span");return a.style.cursor="pointer",a.style.marginLeft="16px",a.style.fontSize="24px",a.innerHTML=" &times;",a.onclick=()=>{u8=!0,f()},a}function j(a,b){a.setAttribute("id",b),a.innerText="Learn more",a.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",a.setAttribute("target","__blank"),a.style.paddingLeft="5px",a.style.textDecoration="underline"}function k(){let a=u7(d),b=c("text"),f=document.getElementById(b)||document.createElement("span"),k=c("learnmore"),l=document.getElementById(k)||document.createElement("a"),m=c("preprendIcon"),n=document.getElementById(m)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(a.created){let b=a.element;g(b),j(l,k);let c=i();h(n,m),b.append(n,f,l,c),document.body.appendChild(b)}e?(f.innerText="Preview backend disconnected.",n.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(n.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,f.innerText="Preview backend running in this workspace."),f.setAttribute("id",b)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",k):k()}function va(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function vb(){var a;let b=null==(a=uZ())?void 0:a.forceEnvironment;if("node"===b)return!0;if("browser"===b)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(a){return!1}}function vc(){return!vb()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function vd(){return!vb()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function ve(){try{return"object"==typeof indexedDB}catch(a){return!1}}function vf(){return new Promise((a,b)=>{try{let c=!0,d="validate-browser-context-for-indexeddb-analytics-module",e=self.indexedDB.open(d);e.onsuccess=()=>{e.result.close(),c||self.indexedDB.deleteDatabase(d),a(!0)},e.onupgradeneeded=()=>{c=!1},e.onerror=()=>{var a;b((null==(a=e.error)?void 0:a.message)||"")}}catch(a){b(a)}})}let vg="FirebaseError";class vh extends Error{constructor(a,b,c){super(b),this.code=a,this.customData=c,this.name=vg,Object.setPrototypeOf(this,vh.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vi.prototype.create)}}class vi{constructor(a,b,c){this.service=a,this.serviceName=b,this.errors=c}create(a,...b){let c=b[0]||{},d=`${this.service}/${a}`,e=this.errors[a],f=e?vj(e,c):"Error",g=`${this.serviceName}: ${f} (${d}).`;return new vh(d,g,c)}}function vj(a,b){return a.replace(vk,(a,c)=>{let d=b[c];return null!=d?String(d):`<${c}?>`})}let vk=/\{\$([^}]+)}/g;function vl(a){return JSON.parse(a)}function vm(a,b){if(a===b)return!0;let c=Object.keys(a),d=Object.keys(b);for(let e of c){if(!d.includes(e))return!1;let c=a[e],f=b[e];if(vn(c)&&vn(f)){if(!vm(c,f))return!1}else if(c!==f)return!1}for(let a of d)if(!c.includes(a))return!1;return!0}function vn(a){return null!==a&&"object"==typeof a}function vo(a,b){if("object"!=typeof a||null===a)return!1;for(let c of b)if(c in a&&"function"==typeof a[c])return!0;return!1}function vp(){}function vq(a){return a&&a._delegate?a._delegate:a}uL.NODE_CLIENT=!0;class vr{constructor(a,b,c){this.name=a,this.instanceFactory=b,this.type=c,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(a){return this.instantiationMode=a,this}setMultipleInstances(a){return this.multipleInstances=a,this}setServiceProps(a){return this.serviceProps=a,this}setInstanceCreatedCallback(a){return this.onInstanceCreated=a,this}}let vs="[DEFAULT]";class vt{constructor(a,b){this.name=a,this.container=b,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(a){let b=this.normalizeInstanceIdentifier(a);if(!this.instancesDeferred.has(b)){let a=new u1;if(this.instancesDeferred.set(b,a),this.isInitialized(b)||this.shouldAutoInitialize())try{let c=this.getOrInitializeService({instanceIdentifier:b});c&&a.resolve(c)}catch(a){}}return this.instancesDeferred.get(b).promise}getImmediate(a){var b;let c=this.normalizeInstanceIdentifier(null==a?void 0:a.identifier),d=null!=(b=null==a?void 0:a.optional)&&b;if(this.isInitialized(c)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:c})}catch(a){if(d)return null;throw a}if(d)return null;throw Error(`Service ${this.name} is not available`)}getComponent(){return this.component}setComponent(a){if(a.name!==this.name)throw Error(`Mismatching Component ${a.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=a,this.shouldAutoInitialize()){if(vv(a))try{this.getOrInitializeService({instanceIdentifier:vs})}catch(a){}for(let[a,b]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(a);try{let a=this.getOrInitializeService({instanceIdentifier:c});b.resolve(a)}catch(a){}}}}clearInstance(a=vs){this.instancesDeferred.delete(a),this.instancesOptions.delete(a),this.instances.delete(a)}async delete(){let a=Array.from(this.instances.values());await Promise.all([...a.filter(a=>"INTERNAL"in a).map(a=>a.INTERNAL.delete()),...a.filter(a=>"_delete"in a).map(a=>a._delete())])}isComponentSet(){return null!=this.component}isInitialized(a=vs){return this.instances.has(a)}getOptions(a=vs){return this.instancesOptions.get(a)||{}}initialize(a={}){let{options:b={}}=a,c=this.normalizeInstanceIdentifier(a.instanceIdentifier);if(this.isInitialized(c))throw Error(`${this.name}(${c}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let d=this.getOrInitializeService({instanceIdentifier:c,options:b});for(let[a,b]of this.instancesDeferred.entries())c===this.normalizeInstanceIdentifier(a)&&b.resolve(d);return d}onInit(a,b){var c;let d=this.normalizeInstanceIdentifier(b),e=null!=(c=this.onInitCallbacks.get(d))?c:new Set;e.add(a),this.onInitCallbacks.set(d,e);let f=this.instances.get(d);return f&&a(f,d),()=>{e.delete(a)}}invokeOnInitCallbacks(a,b){let c=this.onInitCallbacks.get(b);if(c)for(let d of c)try{d(a,b)}catch(a){}}getOrInitializeService({instanceIdentifier:a,options:b={}}){let c=this.instances.get(a);if(!c&&this.component&&(c=this.component.instanceFactory(this.container,{instanceIdentifier:vu(a),options:b}),this.instances.set(a,c),this.instancesOptions.set(a,b),this.invokeOnInitCallbacks(c,a),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,a,c)}catch(a){}return c||null}normalizeInstanceIdentifier(a=vs){return this.component?this.component.multipleInstances?a:vs:a}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function vu(a){return a===vs?void 0:a}function vv(a){return"EAGER"===a.instantiationMode}class vw{constructor(a){this.name=a,this.providers=new Map}addComponent(a){let b=this.getProvider(a.name);if(b.isComponentSet())throw Error(`Component ${a.name} has already been registered with ${this.name}`);b.setComponent(a)}addOrOverwriteComponent(a){this.getProvider(a.name).isComponentSet()&&this.providers.delete(a.name),this.addComponent(a)}getProvider(a){if(this.providers.has(a))return this.providers.get(a);let b=new vt(a,this);return this.providers.set(a,b),b}getProviders(){return Array.from(this.providers.values())}}let vx=[];!function(a){a[a.DEBUG=0]="DEBUG",a[a.VERBOSE=1]="VERBOSE",a[a.INFO=2]="INFO",a[a.WARN=3]="WARN",a[a.ERROR=4]="ERROR",a[a.SILENT=5]="SILENT"}(m||(m={}));let vy={debug:m.DEBUG,verbose:m.VERBOSE,info:m.INFO,warn:m.WARN,error:m.ERROR,silent:m.SILENT},vz=m.INFO,vA={[m.DEBUG]:"log",[m.VERBOSE]:"log",[m.INFO]:"info",[m.WARN]:"warn",[m.ERROR]:"error"},vB=(a,b,...c)=>{if(b<a.logLevel)return;let d=new Date().toISOString(),e=vA[b];if(e)console[e](`[${d}]  ${a.name}:`,...c);else throw Error(`Attempted to log a message with an invalid logType (value: ${b})`)};class vC{constructor(a){this.name=a,this._logLevel=vz,this._logHandler=vB,this._userLogHandler=null,vx.push(this)}get logLevel(){return this._logLevel}set logLevel(a){if(!(a in m))throw TypeError(`Invalid value "${a}" assigned to \`logLevel\``);this._logLevel=a}setLogLevel(a){this._logLevel="string"==typeof a?vy[a]:a}get logHandler(){return this._logHandler}set logHandler(a){if("function"!=typeof a)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=a}get userLogHandler(){return this._userLogHandler}set userLogHandler(a){this._userLogHandler=a}debug(...a){this._userLogHandler&&this._userLogHandler(this,m.DEBUG,...a),this._logHandler(this,m.DEBUG,...a)}log(...a){this._userLogHandler&&this._userLogHandler(this,m.VERBOSE,...a),this._logHandler(this,m.VERBOSE,...a)}info(...a){this._userLogHandler&&this._userLogHandler(this,m.INFO,...a),this._logHandler(this,m.INFO,...a)}warn(...a){this._userLogHandler&&this._userLogHandler(this,m.WARN,...a),this._logHandler(this,m.WARN,...a)}error(...a){this._userLogHandler&&this._userLogHandler(this,m.ERROR,...a),this._logHandler(this,m.ERROR,...a)}}let vD=(a,b)=>b.some(b=>a instanceof b);function vE(){return j||(j=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function vF(){return k||(k=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}let vG=new WeakMap,vH=new WeakMap,vI=new WeakMap,vJ=new WeakMap,vK=new WeakMap;function vL(a){let b=new Promise((b,c)=>{let d=()=>{a.removeEventListener("success",e),a.removeEventListener("error",f)},e=()=>{b(vR(a.result)),d()},f=()=>{c(a.error),d()};a.addEventListener("success",e),a.addEventListener("error",f)});return b.then(b=>{b instanceof IDBCursor&&vG.set(b,a)}).catch(()=>{}),vK.set(b,a),b}function vM(a){if(vH.has(a))return;let b=new Promise((b,c)=>{let d=()=>{a.removeEventListener("complete",e),a.removeEventListener("error",f),a.removeEventListener("abort",f)},e=()=>{b(),d()},f=()=>{c(a.error||new DOMException("AbortError","AbortError")),d()};a.addEventListener("complete",e),a.addEventListener("error",f),a.addEventListener("abort",f)});vH.set(a,b)}let vN={get(a,b,c){if(a instanceof IDBTransaction){if("done"===b)return vH.get(a);if("objectStoreNames"===b)return a.objectStoreNames||vI.get(a);if("store"===b)return c.objectStoreNames[1]?void 0:c.objectStore(c.objectStoreNames[0])}return vR(a[b])},set:(a,b,c)=>(a[b]=c,!0),has:(a,b)=>a instanceof IDBTransaction&&("done"===b||"store"===b)||b in a};function vO(a){vN=a(vN)}function vP(a){return a!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?vF().includes(a)?function(...b){return a.apply(vS(this),b),vR(vG.get(this))}:function(...b){return vR(a.apply(vS(this),b))}:function(b,...c){let d=a.call(vS(this),b,...c);return vI.set(d,b.sort?b.sort():[b]),vR(d)}}function vQ(a){return"function"==typeof a?vP(a):(a instanceof IDBTransaction&&vM(a),vD(a,vE()))?new Proxy(a,vN):a}function vR(a){if(a instanceof IDBRequest)return vL(a);if(vJ.has(a))return vJ.get(a);let b=vQ(a);return b!==a&&(vJ.set(a,b),vK.set(b,a)),b}let vS=a=>vK.get(a);function vT(a,b,{blocked:c,upgrade:d,blocking:e,terminated:f}={}){let g=indexedDB.open(a,b),h=vR(g);return d&&g.addEventListener("upgradeneeded",a=>{d(vR(g.result),a.oldVersion,a.newVersion,vR(g.transaction),a)}),c&&g.addEventListener("blocked",a=>c(a.oldVersion,a.newVersion,a)),h.then(a=>{f&&a.addEventListener("close",()=>f()),e&&a.addEventListener("versionchange",a=>e(a.oldVersion,a.newVersion,a))}).catch(()=>{}),h}let vU=["get","getKey","getAll","getAllKeys","count"],vV=["put","add","delete","clear"],vW=new Map;function vX(a,b){if(!(a instanceof IDBDatabase&&!(b in a)&&"string"==typeof b))return;if(vW.get(b))return vW.get(b);let c=b.replace(/FromIndex$/,""),d=b!==c,e=vV.includes(c);if(!(c in(d?IDBIndex:IDBObjectStore).prototype)||!(e||vU.includes(c)))return;let f=async function(a,...b){let f=this.transaction(a,e?"readwrite":"readonly"),g=f.store;return d&&(g=g.index(b.shift())),(await Promise.all([g[c](...b),e&&f.done]))[0]};return vW.set(b,f),f}vO(a=>({...a,get:(b,c,d)=>vX(b,c)||a.get(b,c,d),has:(b,c)=>!!vX(b,c)||a.has(b,c)}));class vY{constructor(a){this.container=a}getPlatformInfoString(){return this.container.getProviders().map(a=>{if(!vZ(a))return null;{let b=a.getImmediate();return`${b.library}/${b.version}`}}).filter(a=>a).join(" ")}}function vZ(a){let b=a.getComponent();return(null==b?void 0:b.type)==="VERSION"}let v$="@firebase/app",v_="0.13.1",v0=new vC("@firebase/app"),v1="11.9.0",v2="[DEFAULT]",v3={[v$]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/ai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},v4=new Map,v5=new Map,v6=new Map;function v7(a,b){try{a.container.addComponent(b)}catch(c){v0.debug(`Component ${b.name} failed to register with FirebaseApp ${a.name}`,c)}}function v8(a){let b=a.name;if(v6.has(b))return v0.debug(`There were multiple attempts to register component ${b}.`),!1;for(let c of(v6.set(b,a),v4.values()))v7(c,a);for(let b of v5.values())v7(b,a);return!0}function v9(a,b){let c=a.container.getProvider("heartbeat").getImmediate({optional:!0});return c&&c.triggerHeartbeat(),a.container.getProvider(b)}function wa(a){return null!=a&&void 0!==a.settings}let wb=new vi("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class wc{constructor(a,b,c){this._isDeleted=!1,this._options=Object.assign({},a),this._config=Object.assign({},b),this._name=b.name,this._automaticDataCollectionEnabled=b.automaticDataCollectionEnabled,this._container=c,this.container.addComponent(new vr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(a){this.checkDestroyed(),this._automaticDataCollectionEnabled=a}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(a){this._isDeleted=a}checkDestroyed(){if(this.isDeleted)throw wb.create("app-deleted",{appName:this._name})}}function wd(a,b){let c=uT(a.split(".")[1]);return null===c?void console.error(`FirebaseServerApp ${b} is invalid: second part could not be parsed.`):void 0===JSON.parse(c).exp?void console.error(`FirebaseServerApp ${b} is invalid: expiration claim could not be parsed`):void(1e3*JSON.parse(c).exp-new Date().getTime()<=0&&console.error(`FirebaseServerApp ${b} is invalid: the token has expired.`))}let we=v1;function wf(a,b={}){let c=a;"object"!=typeof b&&(b={name:b});let d=Object.assign({name:v2,automaticDataCollectionEnabled:!0},b),e=d.name;if("string"!=typeof e||!e)throw wb.create("bad-app-name",{appName:String(e)});if(c||(c=u0()),!c)throw wb.create("no-options");let f=v4.get(e);if(f)if(vm(c,f.options)&&vm(d,f.config))return f;else throw wb.create("duplicate-app",{appName:e});let g=new vw(e);for(let a of v6.values())g.addComponent(a);let h=new wc(c,d,g);return v4.set(e,h),h}function wg(a=v2){let b=v4.get(a);if(!b&&a===v2&&u0())return wf();if(!b)throw wb.create("no-app",{appName:a});return b}function wh(){return Array.from(v4.values())}async function wi(a){let b=!1,c=a.name;v4.has(c)?(b=!0,v4.delete(c)):v5.has(c)&&0>=a.decRefCount()&&(v5.delete(c),b=!0),b&&(await Promise.all(a.container.getProviders().map(a=>a.delete())),a.isDeleted=!0)}function wj(a,b,c){var d;let e=null!=(d=v3[a])?d:a;c&&(e+=`-${c}`);let f=e.match(/\s|\//),g=b.match(/\s|\//);if(f||g){let a=[`Unable to register library "${e}" with version "${b}":`];f&&a.push(`library name "${e}" contains illegal characters (whitespace or "/")`),f&&g&&a.push("and"),g&&a.push(`version name "${b}" contains illegal characters (whitespace or "/")`),v0.warn(a.join(" "));return}v8(new vr(`${e}-version`,()=>({library:e,version:b}),"VERSION"))}let wk="firebase-heartbeat-database",wl=1,wm="firebase-heartbeat-store",wn=null;function wo(){return wn||(wn=vT(wk,wl,{upgrade:(a,b)=>{if(0===b)try{a.createObjectStore(wm)}catch(a){console.warn(a)}}}).catch(a=>{throw wb.create("idb-open",{originalErrorMessage:a.message})})),wn}async function wp(a){try{let b=(await wo()).transaction(wm),c=await b.objectStore(wm).get(wr(a));return await b.done,c}catch(a){if(a instanceof vh)v0.warn(a.message);else{let b=wb.create("idb-get",{originalErrorMessage:null==a?void 0:a.message});v0.warn(b.message)}}}async function wq(a,b){try{let c=(await wo()).transaction(wm,"readwrite"),d=c.objectStore(wm);await d.put(b,wr(a)),await c.done}catch(a){if(a instanceof vh)v0.warn(a.message);else{let b=wb.create("idb-set",{originalErrorMessage:null==a?void 0:a.message});v0.warn(b.message)}}}function wr(a){return`${a.name}!${a.options.appId}`}let ws=1024,wt=30;class wu{constructor(a){this.container=a,this._heartbeatsCache=null;let b=this.container.getProvider("app").getImmediate();this._storage=new wx(b),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){var a,b;try{let c=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),d=wv();if((null==(a=this._heartbeatsCache)?void 0:a.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,(null==(b=this._heartbeatsCache)?void 0:b.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===d||this._heartbeatsCache.heartbeats.some(a=>a.date===d))return;if(this._heartbeatsCache.heartbeats.push({date:d,agent:c}),this._heartbeatsCache.heartbeats.length>wt){let a=wz(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(a){v0.warn(a)}}async getHeartbeatsHeader(){var a;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,(null==(a=this._heartbeatsCache)?void 0:a.heartbeats)==null||0===this._heartbeatsCache.heartbeats.length)return"";let b=wv(),{heartbeatsToSend:c,unsentEntries:d}=ww(this._heartbeatsCache.heartbeats),e=uS(JSON.stringify({version:2,heartbeats:c}));return this._heartbeatsCache.lastSentHeartbeatDate=b,d.length>0?(this._heartbeatsCache.heartbeats=d,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),e}catch(a){return v0.warn(a),""}}}function wv(){return new Date().toISOString().substring(0,10)}function ww(a,b=ws){let c=[],d=a.slice();for(let e of a){let a=c.find(a=>a.agent===e.agent);if(a){if(a.dates.push(e.date),wy(c)>b){a.dates.pop();break}}else if(c.push({agent:e.agent,dates:[e.date]}),wy(c)>b){c.pop();break}d=d.slice(1)}return{heartbeatsToSend:c,unsentEntries:d}}class wx{constructor(a){this.app=a,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!ve()&&vf().then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};{let a=await wp(this.app);return(null==a?void 0:a.heartbeats)?a:{heartbeats:[]}}}async overwrite(a){var b;if(await this._canUseIndexedDBPromise){let c=await this.read();return wq(this.app,{lastSentHeartbeatDate:null!=(b=a.lastSentHeartbeatDate)?b:c.lastSentHeartbeatDate,heartbeats:a.heartbeats})}}async add(a){var b;if(await this._canUseIndexedDBPromise){let c=await this.read();return wq(this.app,{lastSentHeartbeatDate:null!=(b=a.lastSentHeartbeatDate)?b:c.lastSentHeartbeatDate,heartbeats:[...c.heartbeats,...a.heartbeats]})}}}function wy(a){return uS(JSON.stringify({version:2,heartbeats:a})).length}function wz(a){if(0===a.length)return -1;let b=0,c=a[0].date;for(let d=1;d<a.length;d++)a[d].date<c&&(c=a[d].date,b=d);return b}(function(a){v8(new vr("platform-logger",a=>new vY(a),"PRIVATE")),v8(new vr("heartbeat",a=>new wu(a),"PRIVATE")),wj(v$,v_,""),wj(v$,v_,"esm2017"),wj("fire-js","")})(""),wj("firebase","11.9.1","app");var wA=c(28354);let wB=require("crypto");var wC="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},wD={};(function(){function a(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function b(a,b,c){c||(c=0);var d=Array(16);if("string"==typeof b)for(var e=0;16>e;++e)d[e]=b.charCodeAt(c++)|b.charCodeAt(c++)<<8|b.charCodeAt(c++)<<16|b.charCodeAt(c++)<<24;else for(e=0;16>e;++e)d[e]=b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24;b=a.g[0],c=a.g[1],e=a.g[2];var f=a.g[3],g=b+(f^c&(e^f))+d[0]+0xd76aa478|0;g=f+(e^(b=c+(g<<7|g>>>25))&(c^e))+d[1]+0xe8c7b756|0,g=e+(c^(f=b+(g<<12|g>>>20))&(b^c))+d[2]+0x242070db|0,g=c+(b^(e=f+(g<<17|g>>>15))&(f^b))+d[3]+0xc1bdceee|0,g=b+(f^(c=e+(g<<22|g>>>10))&(e^f))+d[4]+0xf57c0faf|0,g=f+(e^(b=c+(g<<7|g>>>25))&(c^e))+d[5]+0x4787c62a|0,g=e+(c^(f=b+(g<<12|g>>>20))&(b^c))+d[6]+0xa8304613|0,g=c+(b^(e=f+(g<<17|g>>>15))&(f^b))+d[7]+0xfd469501|0,g=b+(f^(c=e+(g<<22|g>>>10))&(e^f))+d[8]+0x698098d8|0,g=f+(e^(b=c+(g<<7|g>>>25))&(c^e))+d[9]+0x8b44f7af|0,g=e+(c^(f=b+(g<<12|g>>>20))&(b^c))+d[10]+0xffff5bb1|0,g=c+(b^(e=f+(g<<17|g>>>15))&(f^b))+d[11]+0x895cd7be|0,g=b+(f^(c=e+(g<<22|g>>>10))&(e^f))+d[12]+0x6b901122|0,g=f+(e^(b=c+(g<<7|g>>>25))&(c^e))+d[13]+0xfd987193|0,g=e+(c^(f=b+(g<<12|g>>>20))&(b^c))+d[14]+0xa679438e|0,g=c+(b^(e=f+(g<<17|g>>>15))&(f^b))+d[15]+0x49b40821|0,c=e+(g<<22|g>>>10),g=b+(e^f&(c^e))+d[1]+0xf61e2562|0,b=c+(g<<5|g>>>27),g=f+(c^e&(b^c))+d[6]+0xc040b340|0,f=b+(g<<9|g>>>23),g=e+(b^c&(f^b))+d[11]+0x265e5a51|0,e=f+(g<<14|g>>>18),g=c+(f^b&(e^f))+d[0]+0xe9b6c7aa|0,c=e+(g<<20|g>>>12),g=b+(e^f&(c^e))+d[5]+0xd62f105d|0,b=c+(g<<5|g>>>27),g=f+(c^e&(b^c))+d[10]+0x2441453|0,f=b+(g<<9|g>>>23),g=e+(b^c&(f^b))+d[15]+0xd8a1e681|0,e=f+(g<<14|g>>>18),g=c+(f^b&(e^f))+d[4]+0xe7d3fbc8|0,c=e+(g<<20|g>>>12),g=b+(e^f&(c^e))+d[9]+0x21e1cde6|0,b=c+(g<<5|g>>>27),g=f+(c^e&(b^c))+d[14]+0xc33707d6|0,f=b+(g<<9|g>>>23),g=e+(b^c&(f^b))+d[3]+0xf4d50d87|0,e=f+(g<<14|g>>>18),g=c+(f^b&(e^f))+d[8]+0x455a14ed|0,c=e+(g<<20|g>>>12),g=b+(e^f&(c^e))+d[13]+0xa9e3e905|0,b=c+(g<<5|g>>>27),g=f+(c^e&(b^c))+d[2]+0xfcefa3f8|0,f=b+(g<<9|g>>>23),g=e+(b^c&(f^b))+d[7]+0x676f02d9|0,e=f+(g<<14|g>>>18),g=c+(f^b&(e^f))+d[12]+0x8d2a4c8a|0,g=b+((c=e+(g<<20|g>>>12))^e^f)+d[5]+0xfffa3942|0,g=f+((b=c+(g<<4|g>>>28))^c^e)+d[8]+0x8771f681|0,g=e+((f=b+(g<<11|g>>>21))^b^c)+d[11]+0x6d9d6122|0,g=c+((e=f+(g<<16|g>>>16))^f^b)+d[14]+0xfde5380c|0,g=b+((c=e+(g<<23|g>>>9))^e^f)+d[1]+0xa4beea44|0,g=f+((b=c+(g<<4|g>>>28))^c^e)+d[4]+0x4bdecfa9|0,g=e+((f=b+(g<<11|g>>>21))^b^c)+d[7]+0xf6bb4b60|0,g=c+((e=f+(g<<16|g>>>16))^f^b)+d[10]+0xbebfbc70|0,g=b+((c=e+(g<<23|g>>>9))^e^f)+d[13]+0x289b7ec6|0,g=f+((b=c+(g<<4|g>>>28))^c^e)+d[0]+0xeaa127fa|0,g=e+((f=b+(g<<11|g>>>21))^b^c)+d[3]+0xd4ef3085|0,g=c+((e=f+(g<<16|g>>>16))^f^b)+d[6]+0x4881d05|0,g=b+((c=e+(g<<23|g>>>9))^e^f)+d[9]+0xd9d4d039|0,g=f+((b=c+(g<<4|g>>>28))^c^e)+d[12]+0xe6db99e5|0,g=e+((f=b+(g<<11|g>>>21))^b^c)+d[15]+0x1fa27cf8|0,g=c+((e=f+(g<<16|g>>>16))^f^b)+d[2]+0xc4ac5665|0,c=e+(g<<23|g>>>9),g=b+(e^(c|~f))+d[0]+0xf4292244|0,b=c+(g<<6|g>>>26),g=f+(c^(b|~e))+d[7]+0x432aff97|0,f=b+(g<<10|g>>>22),g=e+(b^(f|~c))+d[14]+0xab9423a7|0,e=f+(g<<15|g>>>17),g=c+(f^(e|~b))+d[5]+0xfc93a039|0,c=e+(g<<21|g>>>11),g=b+(e^(c|~f))+d[12]+0x655b59c3|0,b=c+(g<<6|g>>>26),g=f+(c^(b|~e))+d[3]+0x8f0ccc92|0,f=b+(g<<10|g>>>22),g=e+(b^(f|~c))+d[10]+0xffeff47d|0,e=f+(g<<15|g>>>17),g=c+(f^(e|~b))+d[1]+0x85845dd1|0,c=e+(g<<21|g>>>11),g=b+(e^(c|~f))+d[8]+0x6fa87e4f|0,b=c+(g<<6|g>>>26),g=f+(c^(b|~e))+d[15]+0xfe2ce6e0|0,f=b+(g<<10|g>>>22),g=e+(b^(f|~c))+d[6]+0xa3014314|0,e=f+(g<<15|g>>>17),g=c+(f^(e|~b))+d[13]+0x4e0811a1|0,c=e+(g<<21|g>>>11),g=b+(e^(c|~f))+d[4]+0xf7537e82|0,b=c+(g<<6|g>>>26),g=f+(c^(b|~e))+d[11]+0xbd3af235|0,f=b+(g<<10|g>>>22),g=e+(b^(f|~c))+d[2]+0x2ad7d2bb|0,e=f+(g<<15|g>>>17),g=c+(f^(e|~b))+d[9]+0xeb86d391|0,a.g[0]=a.g[0]+b|0,a.g[1]=a.g[1]+(e+(g<<21|g>>>11))|0,a.g[2]=a.g[2]+e|0,a.g[3]=a.g[3]+f|0}function c(a,b){var c=f;return Object.prototype.hasOwnProperty.call(c,a)?c[a]:c[a]=b(a)}function d(a,b){this.h=b;for(var c=[],d=!0,e=a.length-1;0<=e;e--){var f=0|a[e];d&&f==b||(c[e]=f,d=!1)}this.g=c}(function(a,b){function c(){}c.prototype=b.prototype,a.D=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.C=function(a,c,d){for(var e=Array(arguments.length-2),f=2;f<arguments.length;f++)e[f-2]=arguments[f];return b.prototype[c].apply(a,e)}})(a,function(){this.blockSize=-1}),a.prototype.s=function(){this.g[0]=0x67452301,this.g[1]=0xefcdab89,this.g[2]=0x98badcfe,this.g[3]=0x10325476,this.o=this.h=0},a.prototype.u=function(a,c){void 0===c&&(c=a.length);for(var d=c-this.blockSize,e=this.B,f=this.h,g=0;g<c;){if(0==f)for(;g<=d;)b(this,a,g),g+=this.blockSize;if("string"==typeof a){for(;g<c;)if(e[f++]=a.charCodeAt(g++),f==this.blockSize){b(this,e),f=0;break}}else for(;g<c;)if(e[f++]=a[g++],f==this.blockSize){b(this,e),f=0;break}}this.h=f,this.o+=c},a.prototype.v=function(){var a=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);a[0]=128;for(var b=1;b<a.length-8;++b)a[b]=0;var c=8*this.o;for(b=a.length-8;b<a.length;++b)a[b]=255&c,c/=256;for(this.u(a),a=Array(16),b=c=0;4>b;++b)for(var d=0;32>d;d+=8)a[c++]=this.g[b]>>>d&255;return a};var e,f={};function g(a){return -128<=a&&128>a?c(a,function(a){return new d([0|a],0>a?-1:0)}):new d([0|a],0>a?-1:0)}function h(a){if(isNaN(a)||!isFinite(a))return j;if(0>a)return q(h(-a));for(var b=[],c=1,e=0;a>=c;e++)b[e]=a/c|0,c*=0x100000000;return new d(b,0)}function i(a,b){if(0==a.length)throw Error("number format error: empty string");if(2>(b=b||10)||36<b)throw Error("radix out of range: "+b);if("-"==a.charAt(0))return q(i(a.substring(1),b));if(0<=a.indexOf("-"))throw Error('number format error: interior "-" character');for(var c=h(Math.pow(b,8)),d=j,e=0;e<a.length;e+=8){var f=Math.min(8,a.length-e),g=parseInt(a.substring(e,e+f),b);8>f?(f=h(Math.pow(b,f)),d=d.j(f).add(h(g))):d=(d=d.j(c)).add(h(g))}return d}var j=g(0),k=g(1),l=g(0x1000000);function m(a){if(0!=a.h)return!1;for(var b=0;b<a.g.length;b++)if(0!=a.g[b])return!1;return!0}function p(a){return -1==a.h}function q(a){for(var b=a.g.length,c=[],e=0;e<b;e++)c[e]=~a.g[e];return new d(c,~a.h).add(k)}function r(a,b){return a.add(q(b))}function s(a,b){for(;(65535&a[b])!=a[b];)a[b+1]+=a[b]>>>16,a[b]&=65535,b++}function t(a,b){this.g=a,this.h=b}function u(a,b){if(m(b))throw Error("division by zero");if(m(a))return new t(j,j);if(p(a))return b=u(q(a),b),new t(q(b.g),q(b.h));if(p(b))return b=u(a,q(b)),new t(q(b.g),b.h);if(30<a.g.length){if(p(a)||p(b))throw Error("slowDivide_ only works with positive integers.");for(var c=k,d=b;0>=d.l(a);)c=v(c),d=v(d);var e=w(c,1),f=w(d,1);for(d=w(d,2),c=w(c,2);!m(d);){var g=f.add(d);0>=g.l(a)&&(e=e.add(c),f=g),d=w(d,1),c=w(c,1)}return b=r(a,e.j(b)),new t(e,b)}for(e=j;0<=a.l(b);){for(d=48>=(d=Math.ceil(Math.log(c=Math.max(1,Math.floor(a.m()/b.m())))/Math.LN2))?1:Math.pow(2,d-48),g=(f=h(c)).j(b);p(g)||0<g.l(a);)c-=d,g=(f=h(c)).j(b);m(f)&&(f=k),e=e.add(f),a=r(a,g)}return new t(e,a)}function v(a){for(var b=a.g.length+1,c=[],e=0;e<b;e++)c[e]=a.i(e)<<1|a.i(e-1)>>>31;return new d(c,a.h)}function w(a,b){var c=b>>5;b%=32;for(var e=a.g.length-c,f=[],g=0;g<e;g++)f[g]=0<b?a.i(g+c)>>>b|a.i(g+c+1)<<32-b:a.i(g+c);return new d(f,a.h)}(e=d.prototype).m=function(){if(p(this))return-q(this).m();for(var a=0,b=1,c=0;c<this.g.length;c++){var d=this.i(c);a+=(0<=d?d:0x100000000+d)*b,b*=0x100000000}return a},e.toString=function(a){if(2>(a=a||10)||36<a)throw Error("radix out of range: "+a);if(m(this))return"0";if(p(this))return"-"+q(this).toString(a);for(var b=h(Math.pow(a,6)),c=this,d="";;){var e=u(c,b).g,f=((0<(c=r(c,e.j(b))).g.length?c.g[0]:c.h)>>>0).toString(a);if(m(c=e))return f+d;for(;6>f.length;)f="0"+f;d=f+d}},e.i=function(a){return 0>a?0:a<this.g.length?this.g[a]:this.h},e.l=function(a){return p(a=r(this,a))?-1:+!m(a)},e.abs=function(){return p(this)?q(this):this},e.add=function(a){for(var b=Math.max(this.g.length,a.g.length),c=[],e=0,f=0;f<=b;f++){var g=e+(65535&this.i(f))+(65535&a.i(f)),h=(g>>>16)+(this.i(f)>>>16)+(a.i(f)>>>16);e=h>>>16,g&=65535,h&=65535,c[f]=h<<16|g}return new d(c,-0x80000000&c[c.length-1]?-1:0)},e.j=function(a){if(m(this)||m(a))return j;if(p(this))return p(a)?q(this).j(q(a)):q(q(this).j(a));if(p(a))return q(this.j(q(a)));if(0>this.l(l)&&0>a.l(l))return h(this.m()*a.m());for(var b=this.g.length+a.g.length,c=[],e=0;e<2*b;e++)c[e]=0;for(e=0;e<this.g.length;e++)for(var f=0;f<a.g.length;f++){var g=this.i(e)>>>16,i=65535&this.i(e),k=a.i(f)>>>16,n=65535&a.i(f);c[2*e+2*f]+=i*n,s(c,2*e+2*f),c[2*e+2*f+1]+=g*n,s(c,2*e+2*f+1),c[2*e+2*f+1]+=i*k,s(c,2*e+2*f+1),c[2*e+2*f+2]+=g*k,s(c,2*e+2*f+2)}for(e=0;e<b;e++)c[e]=c[2*e+1]<<16|c[2*e];for(e=b;e<2*b;e++)c[e]=0;return new d(c,0)},e.A=function(a){return u(this,a).h},e.and=function(a){for(var b=Math.max(this.g.length,a.g.length),c=[],e=0;e<b;e++)c[e]=this.i(e)&a.i(e);return new d(c,this.h&a.h)},e.or=function(a){for(var b=Math.max(this.g.length,a.g.length),c=[],e=0;e<b;e++)c[e]=this.i(e)|a.i(e);return new d(c,this.h|a.h)},e.xor=function(a){for(var b=Math.max(this.g.length,a.g.length),c=[],e=0;e<b;e++)c[e]=this.i(e)^a.i(e);return new d(c,this.h^a.h)},a.prototype.digest=a.prototype.v,a.prototype.reset=a.prototype.s,a.prototype.update=a.prototype.u,o=wD.Md5=a,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=h,d.fromString=i,n=wD.Integer=d}).apply(void 0!==wC?wC:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var wE=c(19609),wF=c(47372);let wG="@firebase/firestore",wH="4.7.17";class wI{constructor(a){this.uid=a}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(a){return a.uid===this.uid}}wI.UNAUTHENTICATED=new wI(null),wI.GOOGLE_CREDENTIALS=new wI("google-credentials-uid"),wI.FIRST_PARTY=new wI("first-party-uid"),wI.MOCK_USER=new wI("mock-user");let wJ="11.9.0";function wK(a){wJ=a}function wL(a){return(0,wA.inspect)(a,{depth:100})}let wM=new vC("@firebase/firestore");function wN(){return wM.logLevel}function wO(a,...b){if(wM.logLevel<=m.DEBUG){let c=b.map(wR);wM.debug(`Firestore (${wJ}): ${a}`,...c)}}function wP(a,...b){if(wM.logLevel<=m.ERROR){let c=b.map(wR);wM.error(`Firestore (${wJ}): ${a}`,...c)}}function wQ(a,...b){if(wM.logLevel<=m.WARN){let c=b.map(wR);wM.warn(`Firestore (${wJ}): ${a}`,...c)}}function wR(a){if("string"==typeof a)return a;try{return wL(a)}catch(b){return a}}function wS(a,b,c){let d="Unexpected state";"string"==typeof b?d=b:c=b,wT(a,d,c)}function wT(a,b,c){let d=`FIRESTORE (${wJ}) INTERNAL ASSERTION FAILED: ${b} (ID: ${a.toString(16)})`;if(void 0!==c)try{let a=JSON.stringify(c);d+=" CONTEXT: "+a}catch(a){d+=" CONTEXT: "+c}throw wP(d),Error(d)}function wU(a,b,c,d){let e="Unexpected state";"string"==typeof c?e=c:d=c,a||wT(b,e,d)}function wV(a,b){return a}let wW={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class wX extends vh{constructor(a,b){super(a,b),this.code=a,this.message=b,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class wY{constructor(){this.promise=new Promise((a,b)=>{this.resolve=a,this.reject=b})}}class wZ{constructor(a,b){this.user=b,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${a}`)}}class w${getToken(){return Promise.resolve(null)}invalidateToken(){}start(a,b){a.enqueueRetryable(()=>b(wI.UNAUTHENTICATED))}shutdown(){}}class w_{constructor(a){this.token=a,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(a,b){this.changeListener=b,a.enqueueRetryable(()=>b(this.token.user))}shutdown(){this.changeListener=null}}class w0{constructor(a){this.authProvider=a,this.currentUser=wI.UNAUTHENTICATED,this.tokenCounter=0,this.forceRefresh=!1,this.auth=null}start(a,b){wU(void 0===this.tokenListener,42304);let c=this.tokenCounter,d=a=>this.tokenCounter!==c?(c=this.tokenCounter,b(a)):Promise.resolve(),e=new wY;this.tokenListener=()=>{this.tokenCounter++,this.currentUser=this.getUser(),e.resolve(),e=new wY,a.enqueueRetryable(()=>d(this.currentUser))};let f=()=>{let b=e;a.enqueueRetryable(async()=>{await b.promise,await d(this.currentUser)})},g=a=>{wO("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=a,this.tokenListener&&(this.auth.addAuthTokenListener(this.tokenListener),f())};this.authProvider.onInit(a=>g(a)),setTimeout(()=>{if(!this.auth){let a=this.authProvider.getImmediate({optional:!0});a?g(a):(wO("FirebaseAuthCredentialsProvider","Auth not yet detected"),e.resolve(),e=new wY)}},0),f()}getToken(){let a=this.tokenCounter,b=this.forceRefresh;return(this.forceRefresh=!1,this.auth)?this.auth.getToken(b).then(b=>this.tokenCounter!==a?(wO("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):b?(wU("string"==typeof b.accessToken,31837,{tokenData:b}),new wZ(b.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.tokenListener&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=void 0}getUser(){let a=this.auth&&this.auth.getUid();return wU(null===a||"string"==typeof a,2055,{currentUid:a}),new wI(a)}}class w1{constructor(a,b,c){this.sessionIndex=a,this.iamToken=b,this.authTokenFactory=c,this.type="FirstParty",this.user=wI.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let a=this.getAuthToken();return a&&this._headers.set("Authorization",a),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}}class w2{constructor(a,b,c){this.sessionIndex=a,this.iamToken=b,this.authTokenFactory=c}getToken(){return Promise.resolve(new w1(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(a,b){a.enqueueRetryable(()=>b(wI.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class w3{constructor(a){this.value=a,this.type="AppCheck",this.headers=new Map,a&&a.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class w4{constructor(a,b){this.appCheckProvider=b,this.forceRefresh=!1,this.appCheck=null,this.latestAppCheckToken=null,this.serverAppAppCheckToken=null,wa(a)&&a.settings.appCheckToken&&(this.serverAppAppCheckToken=a.settings.appCheckToken)}start(a,b){wU(void 0===this.tokenListener,3512);let c=a=>{null!=a.error&&wO("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);let c=a.token!==this.latestAppCheckToken;return this.latestAppCheckToken=a.token,wO("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?b(a.token):Promise.resolve()};this.tokenListener=b=>{a.enqueueRetryable(()=>c(b))};let d=a=>{wO("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.tokenListener&&this.appCheck.addTokenListener(this.tokenListener)};this.appCheckProvider.onInit(a=>d(a)),setTimeout(()=>{if(!this.appCheck){let a=this.appCheckProvider.getImmediate({optional:!0});a?d(a):wO("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.serverAppAppCheckToken)return Promise.resolve(new w3(this.serverAppAppCheckToken));let a=this.forceRefresh;return(this.forceRefresh=!1,this.appCheck)?this.appCheck.getToken(a).then(a=>a?(wU("string"==typeof a.token,44558,{tokenResult:a}),this.latestAppCheckToken=a.token,new w3(a.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.tokenListener&&this.appCheck.removeTokenListener(this.tokenListener),this.tokenListener=void 0}}function w5(a){if(!a)return new w$;switch(a.type){case"firstParty":return new w2(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new wX(wW.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}function w6(a){return(0,wB.randomBytes)(a)}function w7(){return new wA.TextEncoder}function w8(){return new TextDecoder("utf-8")}class w9{static newId(){let a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",b=Math.floor(256/a.length)*a.length,c="",d=20;for(;c.length<d;){let e=w6(40);for(let f=0;f<e.length;++f)c.length<d&&e[f]<b&&(c+=a.charAt(e[f]%a.length))}return c}}function xa(a,b){return a<b?-1:+(a>b)}function xb(a,b){let c=0;for(;c<a.length&&c<b.length;){let d=a.codePointAt(c),e=b.codePointAt(c);if(d!==e)if(d<128&&e<128)return xa(d,e);else{let f=w7(),g=xd(f.encode(xc(a,c)),f.encode(xc(b,c)));if(0!==g)return g;return xa(d,e)}c+=d>65535?2:1}return xa(a.length,b.length)}function xc(a,b){return a.codePointAt(b)>65535?a.substring(b,b+2):a.substring(b,b+1)}function xd(a,b){for(let c=0;c<a.length&&c<b.length;++c)if(a[c]!==b[c])return xa(a[c],b[c]);return xa(a.length,b.length)}function xe(a,b,c){return a.length===b.length&&a.every((a,d)=>c(a,b[d]))}function xf(a){return a+"\0"}let xg=-0xe7791f700,xh=1e6;class xi{static now(){return xi.fromMillis(Date.now())}static fromDate(a){return xi.fromMillis(a.getTime())}static fromMillis(a){let b=Math.floor(a/1e3),c=Math.floor((a-1e3*b)*xh);return new xi(b,c)}constructor(a,b){if(this.seconds=a,this.nanoseconds=b,b<0||b>=1e9)throw new wX(wW.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+b);if(a<xg||a>=0x3afff44180)throw new wX(wW.INVALID_ARGUMENT,"Timestamp seconds out of range: "+a)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/xh}_compareTo(a){return this.seconds===a.seconds?xa(this.nanoseconds,a.nanoseconds):xa(this.seconds,a.seconds)}isEqual(a){return a.seconds===this.seconds&&a.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds-xg).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class xj{static fromTimestamp(a){return new xj(a)}static min(){return new xj(new xi(0,0))}static max(){return new xj(new xi(0x3afff4417f,1e9-1))}constructor(a){this.timestamp=a}compareTo(a){return this.timestamp._compareTo(a.timestamp)}isEqual(a){return this.timestamp.isEqual(a.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}let xk="__name__";class xl{constructor(a,b,c){void 0===b?b=0:b>a.length&&wS(637,{offset:b,range:a.length}),void 0===c?c=a.length-b:c>a.length-b&&wS(1746,{length:c,range:a.length-b}),this.segments=a,this.offset=b,this.len=c}get length(){return this.len}isEqual(a){return 0===xl.comparator(this,a)}child(a){let b=this.segments.slice(this.offset,this.limit());return a instanceof xl?a.forEach(a=>{b.push(a)}):b.push(a),this.construct(b)}limit(){return this.offset+this.length}popFirst(a){return a=void 0===a?1:a,this.construct(this.segments,this.offset+a,this.length-a)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(a){return this.segments[this.offset+a]}isEmpty(){return 0===this.length}isPrefixOf(a){if(a.length<this.length)return!1;for(let b=0;b<this.length;b++)if(this.get(b)!==a.get(b))return!1;return!0}isImmediateParentOf(a){if(this.length+1!==a.length)return!1;for(let b=0;b<this.length;b++)if(this.get(b)!==a.get(b))return!1;return!0}forEach(a){for(let b=this.offset,c=this.limit();b<c;b++)a(this.segments[b])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(a,b){let c=Math.min(a.length,b.length);for(let d=0;d<c;d++){let c=xl.compareSegments(a.get(d),b.get(d));if(0!==c)return c}return xa(a.length,b.length)}static compareSegments(a,b){let c=xl.isNumericId(a),d=xl.isNumericId(b);return c&&!d?-1:!c&&d?1:c&&d?xl.extractNumericId(a).compare(xl.extractNumericId(b)):xb(a,b)}static isNumericId(a){return a.startsWith("__id")&&a.endsWith("__")}static extractNumericId(a){return n.fromString(a.substring(4,a.length-2))}}class xm extends xl{construct(a,b,c){return new xm(a,b,c)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...a){let b=[];for(let c of a){if(c.indexOf("//")>=0)throw new wX(wW.INVALID_ARGUMENT,`Invalid segment (${c}). Paths must not contain // in them.`);b.push(...c.split("/").filter(a=>a.length>0))}return new xm(b)}static emptyPath(){return new xm([])}}let xn=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xo extends xl{construct(a,b,c){return new xo(a,b,c)}static isValidIdentifier(a){return xn.test(a)}canonicalString(){return this.toArray().map(a=>(a=a.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xo.isValidIdentifier(a)||(a="`"+a+"`"),a)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===xk}static keyField(){return new xo([xk])}static fromServerFormat(a){let b=[],c="",d=0,e=()=>{if(0===c.length)throw new wX(wW.INVALID_ARGUMENT,`Invalid field path (${a}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);b.push(c),c=""},f=!1;for(;d<a.length;){let b=a[d];if("\\"===b){if(d+1===a.length)throw new wX(wW.INVALID_ARGUMENT,"Path has trailing escape character: "+a);let b=a[d+1];if("\\"!==b&&"."!==b&&"`"!==b)throw new wX(wW.INVALID_ARGUMENT,"Path has invalid escape sequence: "+a);c+=b,d+=2}else"`"===b?f=!f:"."!==b||f?c+=b:e(),d++}if(e(),f)throw new wX(wW.INVALID_ARGUMENT,"Unterminated ` in path: "+a);return new xo(b)}static emptyPath(){return new xo([])}}class xp{constructor(a){this.path=a}static fromPath(a){return new xp(xm.fromString(a))}static fromName(a){return new xp(xm.fromString(a).popFirst(5))}static empty(){return new xp(xm.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(a){return this.path.length>=2&&this.path.get(this.path.length-2)===a}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(a){return null!==a&&0===xm.comparator(this.path,a.path)}toString(){return this.path.toString()}static comparator(a,b){return xm.comparator(a.path,b.path)}static isDocumentKey(a){return a.length%2==0}static fromSegments(a){return new xp(new xm(a.slice()))}}let xq=-1,xr=0;class xs{constructor(a,b,c,d){this.indexId=a,this.collectionGroup=b,this.fields=c,this.indexState=d}}function xt(a){return a.fields.find(a=>2===a.kind)}function xu(a){return a.fields.filter(a=>2!==a.kind)}function xv(a){let b=xu(a);return 0===b.length?0:b[b.length-1].kind}function xw(a,b){let c=xa(a.collectionGroup,b.collectionGroup);if(0!==c)return c;for(let d=0;d<Math.min(a.fields.length,b.fields.length);++d)if(0!==(c=xz(a.fields[d],b.fields[d])))return c;return xa(a.fields.length,b.fields.length)}function xx(a){return`id=${a.indexId}|cg=${a.collectionGroup}|f=${a.fields.map(a=>`${a.fieldPath}:${a.kind}`).join(",")}`}xs.UNKNOWN_ID=-1;class xy{constructor(a,b){this.fieldPath=a,this.kind=b}}function xz(a,b){let c=xo.comparator(a.fieldPath,b.fieldPath);return 0!==c?c:xa(a.kind,b.kind)}class xA{constructor(a,b){this.sequenceNumber=a,this.offset=b}static empty(){return new xA(xr,xD.min())}}function xB(a,b){let c=a.toTimestamp().seconds,d=a.toTimestamp().nanoseconds+1;return new xD(xj.fromTimestamp(1e9===d?new xi(c+1,0):new xi(c,d)),xp.empty(),b)}function xC(a){return new xD(a.readTime,a.key,xq)}class xD{constructor(a,b,c){this.readTime=a,this.documentKey=b,this.largestBatchId=c}static min(){return new xD(xj.min(),xp.empty(),xq)}static max(){return new xD(xj.max(),xp.empty(),xq)}}function xE(a,b){let c=a.readTime.compareTo(b.readTime);return 0!==c||0!==(c=xp.comparator(a.documentKey,b.documentKey))?c:xa(a.largestBatchId,b.largestBatchId)}let xF="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class xG{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(a){this.onCommittedListeners.push(a)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(a=>a())}}async function xH(a){if(a.code===wW.FAILED_PRECONDITION&&a.message===xF)wO("LocalStore","Unexpectedly lost primary lease");else throw a}class xI{constructor(a){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,a(a=>{this.isDone=!0,this.result=a,this.nextCallback&&this.nextCallback(a)},a=>{this.isDone=!0,this.error=a,this.catchCallback&&this.catchCallback(a)})}catch(a){return this.next(void 0,a)}next(a,b){return(this.callbackAttached&&wS(59440),this.callbackAttached=!0,this.isDone)?this.error?this.wrapFailure(b,this.error):this.wrapSuccess(a,this.result):new xI((c,d)=>{this.nextCallback=b=>{this.wrapSuccess(a,b).next(c,d)},this.catchCallback=a=>{this.wrapFailure(b,a).next(c,d)}})}toPromise(){return new Promise((a,b)=>{this.next(a,b)})}wrapUserFunction(a){try{let b=a();if(b instanceof xI)return b;return xI.resolve(b)}catch(a){return xI.reject(a)}}wrapSuccess(a,b){return a?this.wrapUserFunction(()=>a(b)):xI.resolve(b)}wrapFailure(a,b){return a?this.wrapUserFunction(()=>a(b)):xI.reject(b)}static resolve(a){return new xI((b,c)=>{b(a)})}static reject(a){return new xI((b,c)=>{c(a)})}static waitFor(a){return new xI((b,c)=>{let d=0,e=0,f=!1;a.forEach(a=>{++d,a.next(()=>{++e,f&&e===d&&b()},a=>c(a))}),f=!0,e===d&&b()})}static or(a){let b=xI.resolve(!1);for(let c of a)b=b.next(a=>a?xI.resolve(a):c());return b}static forEach(a,b){let c=[];return a.forEach((a,d)=>{c.push(b.call(this,a,d))}),this.waitFor(c)}static mapArray(a,b){return new xI((c,d)=>{let e=a.length,f=Array(e),g=0;for(let h=0;h<e;h++){let i=h;b(a[i]).next(a=>{f[i]=a,++g===e&&c(f)},a=>d(a))}})}static doWhile(a,b){return new xI((c,d)=>{let e=()=>{!0===a()?b().next(()=>{e()},d):c()};e()})}}let xJ="SimpleDb",xK=3;class xL{static open(a,b,c,d){try{return new xL(b,a.transaction(d,c))}catch(a){throw new xP(b,a)}}constructor(a,b){this.action=a,this.transaction=b,this.aborted=!1,this.completionDeferred=new wY,this.transaction.oncomplete=()=>{this.completionDeferred.resolve()},this.transaction.onabort=()=>{b.error?this.completionDeferred.reject(new xP(a,b.error)):this.completionDeferred.resolve()},this.transaction.onerror=b=>{let c=xU(b.target.error);this.completionDeferred.reject(new xP(a,c))}}get completionPromise(){return this.completionDeferred.promise}abort(a){a&&this.completionDeferred.reject(a),this.aborted||(wO(xJ,"Aborting transaction:",a?a.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}maybeCommit(){let a=this.transaction;this.aborted||"function"!=typeof a.commit||a.commit()}store(a){return new xR(this.transaction.objectStore(a))}}class xM{static delete(a){return wO(xJ,"Removing database:",a),xS(uV().indexedDB.deleteDatabase(a)).toPromise()}static isAvailable(){if(!ve())return!1;if(xM.isMockPersistence())return!0;let a=va(),b=xM.getIOSVersion(a),c=0<b&&b<10,d=xN(a),e=0<d&&d<4.5;return!(a.indexOf("MSIE ")>0||a.indexOf("Trident/")>0||a.indexOf("Edge/")>0)&&!c&&!e}static isMockPersistence(){var a;return"undefined"!=typeof process&&(null==(a=process.env)?void 0:a.USE_MOCK_PERSISTENCE)==="YES"}static getStore(a,b){return a.store(b)}static getIOSVersion(a){let b=a.match(/i(?:phone|pad|pod) os ([\d_]+)/i);return Number(b?b[1].split("_").slice(0,2).join("."):"-1")}constructor(a,b,c){this.name=a,this.version=b,this.schemaConverter=c,this.lastClosedDbVersion=null,12.2===xM.getIOSVersion(va())&&wP("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async ensureDb(a){return this.db||(wO(xJ,"Opening database:",this.name),this.db=await new Promise((b,c)=>{let d=indexedDB.open(this.name,this.version);d.onsuccess=a=>{b(a.target.result)},d.onblocked=()=>{c(new xP(a,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},d.onerror=b=>{let d=b.target.error;"VersionError"===d.name?c(new wX(wW.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===d.name?c(new wX(wW.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+d)):c(new xP(a,d))},d.onupgradeneeded=a=>{wO(xJ,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);let b=a.target.result;if(null!==this.lastClosedDbVersion&&this.lastClosedDbVersion!==a.oldVersion)throw Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.lastClosedDbVersion}, event.oldVersion=${a.oldVersion}, event.newVersion=${a.newVersion}, db.version=${b.version}`);this.schemaConverter.createOrUpgrade(b,d.transaction,a.oldVersion,this.version).next(()=>{wO(xJ,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",a=>{let b=a.target;this.lastClosedDbVersion=b.version},{passive:!0})),this.versionchangelistener&&(this.db.onversionchange=a=>this.versionchangelistener(a)),this.db}setVersionChangeListener(a){this.versionchangelistener=a,this.db&&(this.db.onversionchange=b=>a(b))}async runTransaction(a,b,c,d){let e="readonly"===b,f=0;for(;;){++f;try{this.db=await this.ensureDb(a);let b=xL.open(this.db,a,e?"readonly":"readwrite",c),f=d(b).next(a=>(b.maybeCommit(),a)).catch(a=>(b.abort(a),xI.reject(a))).toPromise();return f.catch(()=>{}),await b.completionPromise,f}catch(c){let a=c,b="FirebaseError"!==a.name&&f<xK;if(wO(xJ,"Transaction failed with error:",a.message,"Retrying:",b),this.close(),!b)return Promise.reject(a)}}}close(){this.db&&this.db.close(),this.db=void 0}}function xN(a){let b=a.match(/Android ([\d.]+)/i);return Number(b?b[1].split(".").slice(0,2).join("."):"-1")}class xO{constructor(a){this.dbCursor=a,this.shouldStop=!1,this.nextKey=null}get isDone(){return this.shouldStop}get skipToKey(){return this.nextKey}set cursor(a){this.dbCursor=a}done(){this.shouldStop=!0}skip(a){this.nextKey=a}delete(){return xS(this.dbCursor.delete())}}class xP extends wX{constructor(a,b){super(wW.UNAVAILABLE,`IndexedDB transaction '${a}' failed: ${b}`),this.name="IndexedDbTransactionError"}}function xQ(a){return"IndexedDbTransactionError"===a.name}class xR{constructor(a){this.store=a}put(a,b){let c;return void 0!==b?(wO(xJ,"PUT",this.store.name,a,b),c=this.store.put(b,a)):(wO(xJ,"PUT",this.store.name,"<auto-key>",a),c=this.store.put(a)),xS(c)}add(a){return wO(xJ,"ADD",this.store.name,a,a),xS(this.store.add(a))}get(a){return xS(this.store.get(a)).next(b=>(void 0===b&&(b=null),wO(xJ,"GET",this.store.name,a,b),b))}delete(a){return wO(xJ,"DELETE",this.store.name,a),xS(this.store.delete(a))}count(){return wO(xJ,"COUNT",this.store.name),xS(this.store.count())}loadAll(a,b){let c=this.options(a,b),d=c.index?this.store.index(c.index):this.store;if("function"==typeof d.getAll){let a=d.getAll(c.range);return new xI((b,c)=>{a.onerror=a=>{c(a.target.error)},a.onsuccess=a=>{b(a.target.result)}})}{let a=this.cursor(c),b=[];return this.iterateCursor(a,(a,c)=>{b.push(c)}).next(()=>b)}}loadFirst(a,b){let c=this.store.getAll(a,null===b?void 0:b);return new xI((a,b)=>{c.onerror=a=>{b(a.target.error)},c.onsuccess=b=>{a(b.target.result)}})}deleteAll(a,b){wO(xJ,"DELETE ALL",this.store.name);let c=this.options(a,b);c.keysOnly=!1;let d=this.cursor(c);return this.iterateCursor(d,(a,b,c)=>c.delete())}iterate(a,b){let c;b?c=a:(c={},b=a);let d=this.cursor(c);return this.iterateCursor(d,b)}iterateSerial(a){let b=this.cursor({});return new xI((c,d)=>{b.onerror=a=>{d(xU(a.target.error))},b.onsuccess=b=>{let d=b.target.result;if(!d)return void c();a(d.primaryKey,d.value).next(a=>{a?d.continue():c()})}})}iterateCursor(a,b){let c=[];return new xI((d,e)=>{a.onerror=a=>{e(a.target.error)},a.onsuccess=a=>{let e=a.target.result;if(!e)return void d();let f=new xO(e),g=b(e.primaryKey,e.value,f);if(g instanceof xI){let a=g.catch(a=>(f.done(),xI.reject(a)));c.push(a)}f.isDone?d():null===f.skipToKey?e.continue():e.continue(f.skipToKey)}}).next(()=>xI.waitFor(c))}options(a,b){let c;return void 0!==a&&("string"==typeof a?c=a:b=a),{index:c,range:b}}cursor(a){let b="next";if(a.reverse&&(b="prev"),!a.index)return this.store.openCursor(a.range,b);{let c=this.store.index(a.index);return a.keysOnly?c.openKeyCursor(a.range,b):c.openCursor(a.range,b)}}}function xS(a){return new xI((b,c)=>{a.onsuccess=a=>{b(a.target.result)},a.onerror=a=>{c(xU(a.target.error))}})}let xT=!1;function xU(a){let b=xM.getIOSVersion(va());if(b>=12.2&&b<13){let b="An internal error was encountered in the Indexed Database server";if(a.message.indexOf(b)>=0){let a=new wX("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${b}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return xT||(xT=!0,setTimeout(()=>{throw a},0)),a}}return a}let xV="IndexBackfiller",xW=15e3,xX=6e4,xY=50;class xZ{constructor(a,b){this.asyncQueue=a,this.backfiller=b,this.task=null}start(){this.schedule(xW)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}schedule(a){wO(xV,`Scheduled in ${a}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",a,async()=>{this.task=null;try{let a=await this.backfiller.backfill();wO(xV,`Documents written: ${a}`)}catch(a){xQ(a)?wO(xV,"Ignoring IndexedDB error during index backfill: ",a):await xH(a)}await this.schedule(xX)})}}class x${constructor(a,b){this.localStore=a,this.persistence=b}async backfill(a=xY){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",b=>this.writeIndexEntries(b,a))}writeIndexEntries(a,b){let c=new Set,d=b,e=!0;return xI.doWhile(()=>!0===e&&d>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(a).next(b=>{if(!(null===b||c.has(b)))return wO(xV,`Processing collection: ${b}`),this.writeEntriesForCollectionGroup(a,b,d).next(a=>{d-=a,c.add(b)});e=!1})).next(()=>b-d)}writeEntriesForCollectionGroup(a,b,c){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(a,b).next(d=>this.localStore.localDocuments.getNextDocuments(a,b,d,c).next(c=>{let e=c.changes;return this.localStore.indexManager.updateIndexEntries(a,e).next(()=>this.getNewOffset(d,c)).next(c=>(wO(xV,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(a,b,c))).next(()=>e.size)}))}getNewOffset(a,b){let c=a;return b.changes.forEach((a,b)=>{let d=xC(b);xE(d,c)>0&&(c=d)}),new xD(c.readTime,c.documentKey,Math.max(b.batchId,a.largestBatchId))}}class x_{constructor(a,b){this.previousValue=a,b&&(b.sequenceNumberHandler=a=>this.setPreviousValue(a),this.writeNewSequenceNumber=a=>b.writeSequenceNumber(a))}setPreviousValue(a){return this.previousValue=Math.max(a,this.previousValue),this.previousValue}next(){let a=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(a),a}}x_.INVALID=-1;let x0="\x01",x1="\x01",x2="\x10",x3="\x11";function x4(a){let b="";for(let c=0;c<a.length;c++)b.length>0&&(b=x6(b)),b=x5(a.get(c),b);return x6(b)}function x5(a,b){let c=b,d=a.length;for(let b=0;b<d;b++){let d=a.charAt(b);switch(d){case"\0":c+=x0+x2;break;case x0:c+=x0+x3;break;default:c+=d}}return c}function x6(a){return a+x0+x1}function x7(a){let b=a.length;if(wU(b>=2,64408,{path:a}),2===b)return wU(a.charAt(0)===x0&&a.charAt(1)===x1,56145,{path:a}),xm.emptyPath();let c=b-2,d=[],e="";for(let f=0;f<b;){let b=a.indexOf(x0,f);switch((b<0||b>c)&&wS(50515,{path:a}),a.charAt(b+1)){case x1:let g,h=a.substring(f,b);0===e.length?g=h:(e+=h,g=e,e=""),d.push(g);break;case x2:e+=a.substring(f,b),e+="\0";break;case x3:e+=a.substring(f,b+1);break;default:wS(61167,{path:a})}f=b+2}return new xm(d)}let x8="remoteDocuments",x9="owner",ya="owner",yb="mutationQueues",yc="userId",yd="mutations",ye="batchId",yf="userMutationsIndex",yg=["userId","batchId"];function yh(a){return[a]}function yi(a,b){return[a,x4(b)]}function yj(a,b,c){return[a,x4(b),c]}let yk={},yl="documentMutations",ym="remoteDocumentsV14",yn=["prefixPath","collectionGroup","readTime","documentId"],yo="documentKeyIndex",yp=["prefixPath","collectionGroup","documentId"],yq="collectionGroupIndex",yr=["collectionGroup","readTime","prefixPath","documentId"],ys="remoteDocumentGlobal",yt="remoteDocumentGlobalKey",yu="targets",yv="targetId",yw="queryTargetsIndex",yx=["canonicalId","targetId"],yy="targetDocuments",yz=["targetId","path"],yA="documentTargetsIndex",yB=["path","targetId"],yC="targetGlobalKey",yD="targetGlobal",yE="collectionParents",yF=["collectionId","parent"],yG="clientMetadata",yH="clientId",yI="bundles",yJ="bundleId",yK="namedQueries",yL="name",yM="indexConfiguration",yN="indexId",yO="collectionGroupIndex",yP="collectionGroup",yQ="indexState",yR=["indexId","uid"],yS="sequenceNumberIndex",yT=["uid","sequenceNumber"],yU="indexEntries",yV=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],yW="documentKeyIndex",yX=["indexId","uid","orderedDocumentKey"],yY="documentOverlays",yZ=["userId","collectionPath","documentId"],y$="collectionPathOverlayIndex",y_=["userId","collectionPath","largestBatchId"],y0="collectionGroupOverlayIndex",y1=["userId","collectionGroup","largestBatchId"],y2="globals",y3="name",y4=[yb,yd,yl,x8,yu,x9,yD,yy,yG,ys,yE,yI,yK],y5=[...y4,yY],y6=[yb,yd,yl,ym,yu,x9,yD,yy,yG,ys,yE,yI,yK,yY],y7=y6,y8=[...y7,yM,yQ,yU],y9=y8,za=[...y8,y2],zb=za;function zc(a){return 18===a?zb:17===a?za:16===a?y9:15===a?y8:14===a?y7:13===a?y6:12===a?y5:11===a?y4:void wS(60245)}class zd extends xG{constructor(a,b){super(),this.simpleDbTransaction=a,this.currentSequenceNumber=b}}function ze(a,b){let c=wV(a);return xM.getStore(c.simpleDbTransaction,b)}function zf(a){let b=0;for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&b++;return b}function zg(a,b){for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&b(c,a[c])}function zh(a,b){let c=[];for(let d in a)Object.prototype.hasOwnProperty.call(a,d)&&c.push(b(a[d],d,a));return c}function zi(a){for(let b in a)if(Object.prototype.hasOwnProperty.call(a,b))return!1;return!0}class zj{constructor(a,b){this.comparator=a,this.root=b||zl.EMPTY}insert(a,b){return new zj(this.comparator,this.root.insert(a,b,this.comparator).copy(null,null,zl.BLACK,null,null))}remove(a){return new zj(this.comparator,this.root.remove(a,this.comparator).copy(null,null,zl.BLACK,null,null))}get(a){let b=this.root;for(;!b.isEmpty();){let c=this.comparator(a,b.key);if(0===c)return b.value;c<0?b=b.left:c>0&&(b=b.right)}return null}indexOf(a){let b=0,c=this.root;for(;!c.isEmpty();){let d=this.comparator(a,c.key);if(0===d)return b+c.left.size;d<0?c=c.left:(b+=c.left.size+1,c=c.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(a){return this.root.inorderTraversal(a)}forEach(a){this.inorderTraversal((b,c)=>(a(b,c),!1))}toString(){let a=[];return this.inorderTraversal((b,c)=>(a.push(`${b}:${c}`),!1)),`{${a.join(", ")}}`}reverseTraversal(a){return this.root.reverseTraversal(a)}getIterator(){return new zk(this.root,null,this.comparator,!1)}getIteratorFrom(a){return new zk(this.root,a,this.comparator,!1)}getReverseIterator(){return new zk(this.root,null,this.comparator,!0)}getReverseIteratorFrom(a){return new zk(this.root,a,this.comparator,!0)}}class zk{constructor(a,b,c,d){this.isReverse=d,this.nodeStack=[];let e=1;for(;!a.isEmpty();)if(e=b?c(a.key,b):1,b&&d&&(e*=-1),e<0)a=this.isReverse?a.left:a.right;else if(0===e){this.nodeStack.push(a);break}else this.nodeStack.push(a),a=this.isReverse?a.right:a.left}getNext(){let a=this.nodeStack.pop(),b={key:a.key,value:a.value};if(this.isReverse)for(a=a.left;!a.isEmpty();)this.nodeStack.push(a),a=a.right;else for(a=a.right;!a.isEmpty();)this.nodeStack.push(a),a=a.left;return b}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let a=this.nodeStack[this.nodeStack.length-1];return{key:a.key,value:a.value}}}class zl{constructor(a,b,c,d,e){this.key=a,this.value=b,this.color=null!=c?c:zl.RED,this.left=null!=d?d:zl.EMPTY,this.right=null!=e?e:zl.EMPTY,this.size=this.left.size+1+this.right.size}copy(a,b,c,d,e){return new zl(null!=a?a:this.key,null!=b?b:this.value,null!=c?c:this.color,null!=d?d:this.left,null!=e?e:this.right)}isEmpty(){return!1}inorderTraversal(a){return this.left.inorderTraversal(a)||a(this.key,this.value)||this.right.inorderTraversal(a)}reverseTraversal(a){return this.right.reverseTraversal(a)||a(this.key,this.value)||this.left.reverseTraversal(a)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(a,b,c){let d=this,e=c(a,d.key);return(d=e<0?d.copy(null,null,null,d.left.insert(a,b,c),null):0===e?d.copy(null,b,null,null,null):d.copy(null,null,null,null,d.right.insert(a,b,c))).fixUp()}removeMin(){if(this.left.isEmpty())return zl.EMPTY;let a=this;return a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),(a=a.copy(null,null,null,a.left.removeMin(),null)).fixUp()}remove(a,b){let c,d=this;if(0>b(a,d.key))d.left.isEmpty()||d.left.isRed()||d.left.left.isRed()||(d=d.moveRedLeft()),d=d.copy(null,null,null,d.left.remove(a,b),null);else{if(d.left.isRed()&&(d=d.rotateRight()),d.right.isEmpty()||d.right.isRed()||d.right.left.isRed()||(d=d.moveRedRight()),0===b(a,d.key))if(d.right.isEmpty())return zl.EMPTY;else c=d.right.min(),d=d.copy(c.key,c.value,null,null,d.right.removeMin());d=d.copy(null,null,null,null,d.right.remove(a,b))}return d.fixUp()}isRed(){return this.color}fixUp(){let a=this;return a.right.isRed()&&!a.left.isRed()&&(a=a.rotateLeft()),a.left.isRed()&&a.left.left.isRed()&&(a=a.rotateRight()),a.left.isRed()&&a.right.isRed()&&(a=a.colorFlip()),a}moveRedLeft(){let a=this.colorFlip();return a.right.left.isRed()&&(a=(a=(a=a.copy(null,null,null,null,a.right.rotateRight())).rotateLeft()).colorFlip()),a}moveRedRight(){let a=this.colorFlip();return a.left.left.isRed()&&(a=(a=a.rotateRight()).colorFlip()),a}rotateLeft(){let a=this.copy(null,null,zl.RED,null,this.right.left);return this.right.copy(null,null,this.color,a,null)}rotateRight(){let a=this.copy(null,null,zl.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,a)}colorFlip(){let a=this.left.copy(null,null,!this.left.color,null,null),b=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,a,b)}checkMaxDepth(){return Math.pow(2,this.check())<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw wS(43730,{key:this.key,value:this.value});if(this.right.isRed())throw wS(14113,{key:this.key,value:this.value});let a=this.left.check();if(a===this.right.check())return a+ +!this.isRed();throw wS(27949)}}zl.EMPTY=null,zl.RED=!0,zl.BLACK=!1;class zm{constructor(){this.size=0}get key(){throw wS(57766)}get value(){throw wS(16141)}get color(){throw wS(16727)}get left(){throw wS(29726)}get right(){throw wS(36894)}copy(a,b,c,d,e){return this}insert(a,b,c){return new zl(a,b)}remove(a,b){return this}isEmpty(){return!0}inorderTraversal(a){return!1}reverseTraversal(a){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}}zl.EMPTY=new zm;class zn{constructor(a){this.comparator=a,this.data=new zj(this.comparator)}has(a){return null!==this.data.get(a)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(a){return this.data.indexOf(a)}forEach(a){this.data.inorderTraversal((b,c)=>(a(b),!1))}forEachInRange(a,b){let c=this.data.getIteratorFrom(a[0]);for(;c.hasNext();){let d=c.getNext();if(this.comparator(d.key,a[1])>=0)return;b(d.key)}}forEachWhile(a,b){let c;for(c=void 0!==b?this.data.getIteratorFrom(b):this.data.getIterator();c.hasNext();)if(!a(c.getNext().key))return}firstAfterOrEqual(a){let b=this.data.getIteratorFrom(a);return b.hasNext()?b.getNext().key:null}getIterator(){return new zo(this.data.getIterator())}getIteratorFrom(a){return new zo(this.data.getIteratorFrom(a))}add(a){return this.copy(this.data.remove(a).insert(a,!0))}delete(a){return this.has(a)?this.copy(this.data.remove(a)):this}isEmpty(){return this.data.isEmpty()}unionWith(a){let b=this;return b.size<a.size&&(b=a,a=this),a.forEach(a=>{b=b.add(a)}),b}isEqual(a){if(!(a instanceof zn)||this.size!==a.size)return!1;let b=this.data.getIterator(),c=a.data.getIterator();for(;b.hasNext();){let a=b.getNext().key,d=c.getNext().key;if(0!==this.comparator(a,d))return!1}return!0}toArray(){let a=[];return this.forEach(b=>{a.push(b)}),a}toString(){let a=[];return this.forEach(b=>a.push(b)),"SortedSet("+a.toString()+")"}copy(a){let b=new zn(this.comparator);return b.data=a,b}}class zo{constructor(a){this.iter=a}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function zp(a,b,c,d,e){let f=a.getIterator(),g=b.getIterator(),h=zq(f),i=zq(g);for(;h||i;){let a=!1,b=!1;if(h&&i){let d=c(h,i);d<0?b=!0:d>0&&(a=!0)}else null!=h?b=!0:a=!0;a?(d(i),i=zq(g)):b?(e(h),h=zq(f)):(h=zq(f),i=zq(g))}}function zq(a){return a.hasNext()?a.getNext():void 0}class zr{constructor(a){this.fields=a,a.sort(xo.comparator)}static empty(){return new zr([])}unionWith(a){let b=new zn(xo.comparator);for(let a of this.fields)b=b.add(a);for(let c of a)b=b.add(c);return new zr(b.toArray())}covers(a){for(let b of this.fields)if(b.isPrefixOf(a))return!0;return!1}isEqual(a){return xe(this.fields,a.fields,(a,b)=>a.isEqual(b))}}function zs(a){return Buffer.from(a,"base64").toString("binary")}function zt(a){return Buffer.from(a,"binary").toString("base64")}class zu{constructor(a){this.binaryString=a}static fromBase64String(a){return new zu(zs(a))}static fromUint8Array(a){return new zu(zv(a))}[Symbol.iterator](){let a=0;return{next:()=>a<this.binaryString.length?{value:this.binaryString.charCodeAt(a++),done:!1}:{value:void 0,done:!0}}}toBase64(){return zt(this.binaryString)}toUint8Array(){return zw(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(a){return xa(this.binaryString,a.binaryString)}isEqual(a){return this.binaryString===a.binaryString}}function zv(a){let b="";for(let c=0;c<a.length;++c)b+=String.fromCharCode(a[c]);return b}function zw(a){let b=new Uint8Array(a.length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b}zu.EMPTY_BYTE_STRING=new zu("");let zx=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zy(a){if(wU(!!a,39018),"string"==typeof a){let b=0,c=zx.exec(a);if(wU(!!c,46558,{timestamp:a}),c[1]){let a=c[1];b=Number(a=(a+"000000000").substr(0,9))}return{seconds:Math.floor(new Date(a).getTime()/1e3),nanos:b}}return{seconds:zz(a.seconds),nanos:zz(a.nanos)}}function zz(a){return"number"==typeof a?a:"string"==typeof a?Number(a):0}function zA(a){return"string"==typeof a?zu.fromBase64String(a):zu.fromUint8Array(a)}let zB="server_timestamp",zC="__type__",zD="__previous_value__",zE="__local_write_time__";function zF(a){var b,c;return(null==(c=((null==(b=null==a?void 0:a.mapValue)?void 0:b.fields)||{})[zC])?void 0:c.stringValue)===zB}function zG(a,b){let c={fields:{[zC]:{stringValue:zB},[zE]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return b&&zF(b)&&(b=zH(b)),b&&(c.fields[zD]=b),{mapValue:c}}function zH(a){let b=a.mapValue.fields[zD];return zF(b)?zH(b):b}function zI(a){let b=zy(a.mapValue.fields[zE].timestampValue);return new xi(b.seconds,b.nanos)}class zJ{constructor(a,b,c,d,e,f,g,h,i,j){this.databaseId=a,this.appId=b,this.persistenceKey=c,this.host=d,this.ssl=e,this.forceLongPolling=f,this.autoDetectLongPolling=g,this.longPollingOptions=h,this.useFetchStreams=i,this.isUsingEmulator=j}}let zK="(default)";class zL{constructor(a,b){this.projectId=a,this.database=b||zK}static empty(){return new zL("","")}get isDefaultDatabase(){return this.database===zK}isEqual(a){return a instanceof zL&&a.projectId===this.projectId&&a.database===this.database}}function zM(a,b){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new wX(wW.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zL(a.options.projectId,b)}let zN=-1;function zO(a){return null==a}function zP(a){return 0===a&&1/a==-1/0}function zQ(a){return"number"==typeof a&&Number.isInteger(a)&&!zP(a)&&a<=Number.MAX_SAFE_INTEGER&&a>=Number.MIN_SAFE_INTEGER}let zR="__type__",zS="__max__",zT={mapValue:{fields:{__type__:{stringValue:zS}}}},zU="__vector__",zV="value",zW={nullValue:"NULL_VALUE"};function zX(a){return"nullValue"in a?0:"booleanValue"in a?1:"integerValue"in a||"doubleValue"in a?2:"timestampValue"in a?3:"stringValue"in a?5:"bytesValue"in a?6:"referenceValue"in a?7:"geoPointValue"in a?8:"arrayValue"in a?9:"mapValue"in a?zF(a)?4:Ax(a)?0x1fffffffffffff:Av(a)?10:11:wS(28295,{value:a})}function zY(a,b){if(a===b)return!0;let c=zX(a);if(c!==zX(b))return!1;switch(c){case 0:case 0x1fffffffffffff:return!0;case 1:return a.booleanValue===b.booleanValue;case 4:return zI(a).isEqual(zI(b));case 3:return zZ(a,b);case 5:return a.stringValue===b.stringValue;case 6:return z_(a,b);case 7:return a.referenceValue===b.referenceValue;case 8:return z$(a,b);case 2:return z0(a,b);case 9:return xe(a.arrayValue.values||[],b.arrayValue.values||[],zY);case 10:case 11:return z1(a,b);default:return wS(52216,{left:a})}}function zZ(a,b){if("string"==typeof a.timestampValue&&"string"==typeof b.timestampValue&&a.timestampValue.length===b.timestampValue.length)return a.timestampValue===b.timestampValue;let c=zy(a.timestampValue),d=zy(b.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos}function z$(a,b){return zz(a.geoPointValue.latitude)===zz(b.geoPointValue.latitude)&&zz(a.geoPointValue.longitude)===zz(b.geoPointValue.longitude)}function z_(a,b){return zA(a.bytesValue).isEqual(zA(b.bytesValue))}function z0(a,b){if("integerValue"in a&&"integerValue"in b)return zz(a.integerValue)===zz(b.integerValue);if("doubleValue"in a&&"doubleValue"in b){let c=zz(a.doubleValue),d=zz(b.doubleValue);return c===d?zP(c)===zP(d):isNaN(c)&&isNaN(d)}return!1}function z1(a,b){let c=a.mapValue.fields||{},d=b.mapValue.fields||{};if(zf(c)!==zf(d))return!1;for(let a in c)if(c.hasOwnProperty(a)&&(void 0===d[a]||!zY(c[a],d[a])))return!1;return!0}function z2(a,b){return void 0!==(a.values||[]).find(a=>zY(a,b))}function z3(a,b){if(a===b)return 0;let c=zX(a),d=zX(b);if(c!==d)return xa(c,d);switch(c){case 0:case 0x1fffffffffffff:return 0;case 1:return xa(a.booleanValue,b.booleanValue);case 2:return z4(a,b);case 3:return z5(a.timestampValue,b.timestampValue);case 4:return z5(zI(a),zI(b));case 5:return xb(a.stringValue,b.stringValue);case 6:return z8(a.bytesValue,b.bytesValue);case 7:return z6(a.referenceValue,b.referenceValue);case 8:return z7(a.geoPointValue,b.geoPointValue);case 9:return z9(a.arrayValue,b.arrayValue);case 10:return Aa(a.mapValue,b.mapValue);case 11:return Ab(a.mapValue,b.mapValue);default:throw wS(23264,{leftType:c})}}function z4(a,b){let c=zz(a.integerValue||a.doubleValue),d=zz(b.integerValue||b.doubleValue);return c<d?-1:c>d?1:c===d?0:isNaN(c)?isNaN(d)?0:-1:1}function z5(a,b){if("string"==typeof a&&"string"==typeof b&&a.length===b.length)return xa(a,b);let c=zy(a),d=zy(b),e=xa(c.seconds,d.seconds);return 0!==e?e:xa(c.nanos,d.nanos)}function z6(a,b){let c=a.split("/"),d=b.split("/");for(let a=0;a<c.length&&a<d.length;a++){let b=xa(c[a],d[a]);if(0!==b)return b}return xa(c.length,d.length)}function z7(a,b){let c=xa(zz(a.latitude),zz(b.latitude));return 0!==c?c:xa(zz(a.longitude),zz(b.longitude))}function z8(a,b){let c=zA(a),d=zA(b);return c.compareTo(d)}function z9(a,b){let c=a.values||[],d=b.values||[];for(let a=0;a<c.length&&a<d.length;++a){let b=z3(c[a],d[a]);if(b)return b}return xa(c.length,d.length)}function Aa(a,b){var c,d,e,f;let g=a.fields||{},h=b.fields||{},i=null==(c=g[zV])?void 0:c.arrayValue,j=null==(d=h[zV])?void 0:d.arrayValue,k=xa((null==(e=null==i?void 0:i.values)?void 0:e.length)||0,(null==(f=null==j?void 0:j.values)?void 0:f.length)||0);return 0!==k?k:z9(i,j)}function Ab(a,b){if(a===zT.mapValue&&b===zT.mapValue)return 0;if(a===zT.mapValue)return 1;if(b===zT.mapValue)return -1;let c=a.fields||{},d=Object.keys(c),e=b.fields||{},f=Object.keys(e);d.sort(),f.sort();for(let a=0;a<d.length&&a<f.length;++a){let b=xb(d[a],f[a]);if(0!==b)return b;let g=z3(c[d[a]],e[f[a]]);if(0!==g)return g}return xa(d.length,f.length)}function Ac(a){return Ad(a)}function Ad(a){if("nullValue"in a)return"null";if("booleanValue"in a)return""+a.booleanValue;if("integerValue"in a)return""+a.integerValue;if("doubleValue"in a)return""+a.doubleValue;if("timestampValue"in a)return Af(a.timestampValue);else if("stringValue"in a)return a.stringValue;else if("bytesValue"in a)return Ae(a.bytesValue);else if("referenceValue"in a)return Ah(a.referenceValue);else if("geoPointValue"in a)return Ag(a.geoPointValue);else if("arrayValue"in a)return Aj(a.arrayValue);else if("mapValue"in a)return Ai(a.mapValue);else return wS(61005,{value:a})}function Ae(a){return zA(a).toBase64()}function Af(a){let b=zy(a);return`time(${b.seconds},${b.nanos})`}function Ag(a){return`geo(${a.latitude},${a.longitude})`}function Ah(a){return xp.fromName(a).toString()}function Ai(a){let b=Object.keys(a.fields||{}).sort(),c="{",d=!0;for(let e of b)d?d=!1:c+=",",c+=`${e}:${Ad(a.fields[e])}`;return c+"}"}function Aj(a){let b="[",c=!0;for(let d of a.values||[])c?c=!1:b+=",",b+=Ad(d);return b+"]"}function Ak(a){switch(zX(a)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let b=zH(a);return b?16+Ak(b):16;case 5:return 2*a.stringValue.length;case 6:return zA(a.bytesValue).approximateByteSize();case 7:return a.referenceValue.length;case 9:return Am(a.arrayValue);case 10:case 11:return Al(a.mapValue);default:throw wS(13486,{value:a})}}function Al(a){let b=0;return zg(a.fields,(a,c)=>{b+=a.length+Ak(c)}),b}function Am(a){return(a.values||[]).reduce((a,b)=>a+Ak(b),0)}function An(a,b){return{referenceValue:`projects/${a.projectId}/databases/${a.database}/documents/${b.path.canonicalString()}`}}function Ao(a){return!!a&&"integerValue"in a}function Ap(a){return!!a&&"doubleValue"in a}function Aq(a){return Ao(a)||Ap(a)}function Ar(a){return!!a&&"arrayValue"in a}function As(a){return!!a&&"nullValue"in a}function At(a){return!!a&&"doubleValue"in a&&isNaN(Number(a.doubleValue))}function Au(a){return!!a&&"mapValue"in a}function Av(a){var b,c;return(null==(c=((null==(b=null==a?void 0:a.mapValue)?void 0:b.fields)||{})[zR])?void 0:c.stringValue)===zU}function Aw(a){if(a.geoPointValue)return{geoPointValue:Object.assign({},a.geoPointValue)};if(a.timestampValue&&"object"==typeof a.timestampValue)return{timestampValue:Object.assign({},a.timestampValue)};if(a.mapValue){let b={mapValue:{fields:{}}};return zg(a.mapValue.fields,(a,c)=>b.mapValue.fields[a]=Aw(c)),b}{if(!a.arrayValue)return Object.assign({},a);let b={arrayValue:{values:[]}};for(let c=0;c<(a.arrayValue.values||[]).length;++c)b.arrayValue.values[c]=Aw(a.arrayValue.values[c]);return b}}function Ax(a){return(((a.mapValue||{}).fields||{}).__type__||{}).stringValue===zS}let Ay={mapValue:{fields:{[zR]:{stringValue:zU},[zV]:{arrayValue:{}}}}};function Az(a){if("nullValue"in a)return zW;if("booleanValue"in a)return{booleanValue:!1};if("integerValue"in a||"doubleValue"in a)return{doubleValue:NaN};if("timestampValue"in a)return{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}};if("stringValue"in a)return{stringValue:""};else if("bytesValue"in a)return{bytesValue:""};else if("referenceValue"in a)return An(zL.empty(),xp.empty());else if("geoPointValue"in a)return{geoPointValue:{latitude:-90,longitude:-180}};else if("arrayValue"in a)return{arrayValue:{}};else if(!("mapValue"in a))return wS(35942,{value:a});else return Av(a)?Ay:{mapValue:{}}}function AA(a){if("nullValue"in a)return{booleanValue:!1};if("booleanValue"in a)return{doubleValue:NaN};if("integerValue"in a||"doubleValue"in a)return{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}};if("timestampValue"in a)return{stringValue:""};if("stringValue"in a)return{bytesValue:""};else if("bytesValue"in a)return An(zL.empty(),xp.empty());else if("referenceValue"in a)return{geoPointValue:{latitude:-90,longitude:-180}};else if("geoPointValue"in a)return{arrayValue:{}};else if("arrayValue"in a)return Ay;else if(!("mapValue"in a))return wS(61959,{value:a});else return Av(a)?{mapValue:{}}:zT}function AB(a,b){let c=z3(a.value,b.value);return 0!==c?c:a.inclusive&&!b.inclusive?-1:!a.inclusive&&b.inclusive?1:0}function AC(a,b){let c=z3(a.value,b.value);return 0!==c?c:a.inclusive&&!b.inclusive?1:!a.inclusive&&b.inclusive?-1:0}class AD{constructor(a){this.value=a}static empty(){return new AD({mapValue:{}})}field(a){if(a.isEmpty())return this.value;{let b=this.value;for(let c=0;c<a.length-1;++c)if(!Au(b=(b.mapValue.fields||{})[a.get(c)]))return null;return(b=(b.mapValue.fields||{})[a.lastSegment()])||null}}set(a,b){this.getFieldsMap(a.popLast())[a.lastSegment()]=Aw(b)}setAll(a){let b=xo.emptyPath(),c={},d=[];a.forEach((a,e)=>{if(!b.isImmediateParentOf(e)){let a=this.getFieldsMap(b);this.applyChanges(a,c,d),c={},d=[],b=e.popLast()}a?c[e.lastSegment()]=Aw(a):d.push(e.lastSegment())});let e=this.getFieldsMap(b);this.applyChanges(e,c,d)}delete(a){let b=this.field(a.popLast());Au(b)&&b.mapValue.fields&&delete b.mapValue.fields[a.lastSegment()]}isEqual(a){return zY(this.value,a.value)}getFieldsMap(a){let b=this.value;b.mapValue.fields||(b.mapValue={fields:{}});for(let c=0;c<a.length;++c){let d=b.mapValue.fields[a.get(c)];Au(d)&&d.mapValue.fields||(d={mapValue:{fields:{}}},b.mapValue.fields[a.get(c)]=d),b=d}return b.mapValue.fields}applyChanges(a,b,c){for(let d of(zg(b,(b,c)=>a[b]=c),c))delete a[d]}clone(){return new AD(Aw(this.value))}}function AE(a){let b=[];return zg(a.fields,(a,c)=>{let d=new xo([a]);if(Au(c)){let a=AE(c.mapValue).fields;if(0===a.length)b.push(d);else for(let c of a)b.push(d.child(c))}else b.push(d)}),new zr(b)}class AF{constructor(a,b,c,d,e,f,g){this.key=a,this.documentType=b,this.version=c,this.readTime=d,this.createTime=e,this.data=f,this.documentState=g}static newInvalidDocument(a){return new AF(a,0,xj.min(),xj.min(),xj.min(),AD.empty(),0)}static newFoundDocument(a,b,c,d){return new AF(a,1,b,xj.min(),c,d,0)}static newNoDocument(a,b){return new AF(a,2,b,xj.min(),xj.min(),AD.empty(),0)}static newUnknownDocument(a,b){return new AF(a,3,b,xj.min(),xj.min(),AD.empty(),2)}convertToFoundDocument(a,b){return this.createTime.isEqual(xj.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=a),this.version=a,this.documentType=1,this.data=b,this.documentState=0,this}convertToNoDocument(a){return this.version=a,this.documentType=2,this.data=AD.empty(),this.documentState=0,this}convertToUnknownDocument(a){return this.version=a,this.documentType=3,this.data=AD.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=xj.min(),this}setReadTime(a){return this.readTime=a,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(a){return a instanceof AF&&this.key.isEqual(a.key)&&this.version.isEqual(a.version)&&this.documentType===a.documentType&&this.documentState===a.documentState&&this.data.isEqual(a.data)}mutableCopy(){return new AF(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}function AG(a,b,c){let d=b.data.field(a),e=c.data.field(a);return null!==d&&null!==e?z3(d,e):wS(42886)}class AH{constructor(a,b){this.position=a,this.inclusive=b}}function AI(a,b,c){let d=0;for(let e=0;e<a.position.length;e++){let f=b[e],g=a.position[e];if(d=f.field.isKeyField()?xp.comparator(xp.fromName(g.referenceValue),c.key):z3(g,c.data.field(f.field)),"desc"===f.dir&&(d*=-1),0!==d)break}return d}function AJ(a,b,c){let d=AI(a,b,c);return a.inclusive?d>=0:d>0}function AK(a,b,c){let d=AI(a,b,c);return a.inclusive?d<=0:d<0}function AL(a,b){if(null===a)return null===b;if(null===b||a.inclusive!==b.inclusive||a.position.length!==b.position.length)return!1;for(let c=0;c<a.position.length;c++)if(!zY(a.position[c],b.position[c]))return!1;return!0}class AM{constructor(a,b="asc"){this.field=a,this.dir=b}}function AN(a){return a.field.canonicalString()+a.dir}function AO(a){return`${a.field.canonicalString()} (${a.dir})`}function AP(a,b){return a.dir===b.dir&&a.field.isEqual(b.field)}class AQ{}class AR extends AQ{constructor(a,b,c){super(),this.field=a,this.op=b,this.value=c}static create(a,b,c){if(a.isKeyField())if("in"===b||"not-in"===b)return this.createKeyFieldInFilter(a,b,c);else return new A3(a,b,c);if("array-contains"===b)return new A7(a,c);if("in"===b)return new A8(a,c);if("not-in"===b)return new A9(a,c);if("array-contains-any"===b)return new Ba(a,c);else return new AR(a,b,c)}static createKeyFieldInFilter(a,b,c){return"in"===b?new A4(a,c):new A5(a,c)}matches(a){let b=a.data.field(this.field);return"!="===this.op?null!==b&&void 0===b.nullValue&&this.matchesComparison(z3(b,this.value)):null!==b&&zX(this.value)===zX(b)&&this.matchesComparison(z3(b,this.value))}matchesComparison(a){switch(this.op){case"<":return a<0;case"<=":return a<=0;case"==":return 0===a;case"!=":return 0!==a;case">":return a>0;case">=":return a>=0;default:return wS(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class AS extends AQ{constructor(a,b){super(),this.filters=a,this.op=b,this.memoizedFlattenedFilters=null}static create(a,b){return new AS(a,b)}matches(a){return AT(this)?void 0===this.filters.find(b=>!b.matches(a)):void 0!==this.filters.find(b=>b.matches(a))}getFlattenedFilters(){return null!==this.memoizedFlattenedFilters||(this.memoizedFlattenedFilters=this.filters.reduce((a,b)=>a.concat(b.getFlattenedFilters()),[])),this.memoizedFlattenedFilters}getFilters(){return Object.assign([],this.filters)}}function AT(a){return"and"===a.op}function AU(a){return"or"===a.op}function AV(a){return AW(a)&&AT(a)}function AW(a){for(let b of a.filters)if(b instanceof AS)return!1;return!0}function AX(a){if(a instanceof AR)return a.field.canonicalString()+a.op.toString()+Ac(a.value);{if(AV(a))return a.filters.map(a=>AX(a)).join(",");let b=a.filters.map(a=>AX(a)).join(",");return`${a.op}(${b})`}}function AY(a,b){return a instanceof AR?AZ(a,b):a instanceof AS?A$(a,b):void wS(19439)}function AZ(a,b){return b instanceof AR&&a.op===b.op&&a.field.isEqual(b.field)&&zY(a.value,b.value)}function A$(a,b){return b instanceof AS&&a.op===b.op&&a.filters.length===b.filters.length&&a.filters.reduce((a,c,d)=>a&&AY(c,b.filters[d]),!0)}function A_(a,b){let c=a.filters.concat(b);return AS.create(c,a.op)}function A0(a){return a instanceof AR?A2(a):a instanceof AS?A1(a):"Filter"}function A1(a){return a.op.toString()+" {"+a.getFilters().map(A0).join(" ,")+"}"}function A2(a){return`${a.field.canonicalString()} ${a.op} ${Ac(a.value)}`}class A3 extends AR{constructor(a,b,c){super(a,b,c),this.key=xp.fromName(c.referenceValue)}matches(a){let b=xp.comparator(a.key,this.key);return this.matchesComparison(b)}}class A4 extends AR{constructor(a,b){super(a,"in",b),this.keys=A6("in",b)}matches(a){return this.keys.some(b=>b.isEqual(a.key))}}class A5 extends AR{constructor(a,b){super(a,"not-in",b),this.keys=A6("not-in",b)}matches(a){return!this.keys.some(b=>b.isEqual(a.key))}}function A6(a,b){var c;return((null==(c=b.arrayValue)?void 0:c.values)||[]).map(a=>xp.fromName(a.referenceValue))}class A7 extends AR{constructor(a,b){super(a,"array-contains",b)}matches(a){let b=a.data.field(this.field);return Ar(b)&&z2(b.arrayValue,this.value)}}class A8 extends AR{constructor(a,b){super(a,"in",b)}matches(a){let b=a.data.field(this.field);return null!==b&&z2(this.value.arrayValue,b)}}class A9 extends AR{constructor(a,b){super(a,"not-in",b)}matches(a){if(z2(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let b=a.data.field(this.field);return null!==b&&void 0===b.nullValue&&!z2(this.value.arrayValue,b)}}class Ba extends AR{constructor(a,b){super(a,"array-contains-any",b)}matches(a){let b=a.data.field(this.field);return!!Ar(b)&&!!b.arrayValue.values&&b.arrayValue.values.some(a=>z2(this.value.arrayValue,a))}}class Bb{constructor(a,b=null,c=[],d=[],e=null,f=null,g=null){this.path=a,this.collectionGroup=b,this.orderBy=c,this.filters=d,this.limit=e,this.startAt=f,this.endAt=g,this.memoizedCanonicalId=null}}function Bc(a,b=null,c=[],d=[],e=null,f=null,g=null){return new Bb(a,b,c,d,e,f,g)}function Bd(a){let b=wV(a);if(null===b.memoizedCanonicalId){let a=b.path.canonicalString();null!==b.collectionGroup&&(a+="|cg:"+b.collectionGroup),a+="|f:",a+=b.filters.map(a=>AX(a)).join(","),a+="|ob:",a+=b.orderBy.map(a=>AN(a)).join(","),zO(b.limit)||(a+="|l:",a+=b.limit),b.startAt&&(a+="|lb:",a+=b.startAt.inclusive?"b:":"a:",a+=b.startAt.position.map(a=>Ac(a)).join(",")),b.endAt&&(a+="|ub:",a+=b.endAt.inclusive?"a:":"b:",a+=b.endAt.position.map(a=>Ac(a)).join(",")),b.memoizedCanonicalId=a}return b.memoizedCanonicalId}function Be(a){let b=a.path.canonicalString();return null!==a.collectionGroup&&(b+=" collectionGroup="+a.collectionGroup),a.filters.length>0&&(b+=`, filters: [${a.filters.map(a=>A0(a)).join(", ")}]`),zO(a.limit)||(b+=", limit: "+a.limit),a.orderBy.length>0&&(b+=`, orderBy: [${a.orderBy.map(a=>AO(a)).join(", ")}]`),a.startAt&&(b+=", startAt: ",b+=a.startAt.inclusive?"b:":"a:",b+=a.startAt.position.map(a=>Ac(a)).join(",")),a.endAt&&(b+=", endAt: ",b+=a.endAt.inclusive?"a:":"b:",b+=a.endAt.position.map(a=>Ac(a)).join(",")),`Target(${b})`}function Bf(a,b){if(a.limit!==b.limit||a.orderBy.length!==b.orderBy.length)return!1;for(let c=0;c<a.orderBy.length;c++)if(!AP(a.orderBy[c],b.orderBy[c]))return!1;if(a.filters.length!==b.filters.length)return!1;for(let c=0;c<a.filters.length;c++)if(!AY(a.filters[c],b.filters[c]))return!1;return a.collectionGroup===b.collectionGroup&&!!a.path.isEqual(b.path)&&!!AL(a.startAt,b.startAt)&&AL(a.endAt,b.endAt)}function Bg(a){return xp.isDocumentKey(a.path)&&null===a.collectionGroup&&0===a.filters.length}function Bh(a,b){return a.filters.filter(a=>a instanceof AR&&a.field.isEqual(b))}function Bi(a,b){let c=xt(b);if(void 0===c)return null;for(let b of Bh(a,c.fieldPath))switch(b.op){case"array-contains-any":return b.value.arrayValue.values||[];case"array-contains":return[b.value]}return null}function Bj(a,b){let c=new Map;for(let d of xu(b))for(let b of Bh(a,d.fieldPath))switch(b.op){case"==":case"in":c.set(d.fieldPath.canonicalString(),b.value);break;case"not-in":case"!=":return c.set(d.fieldPath.canonicalString(),b.value),Array.from(c.values())}return null}function Bk(a,b){let c=[],d=!0;for(let e of xu(b)){let b=0===e.kind?Bm(a,e.fieldPath,a.startAt):Bn(a,e.fieldPath,a.startAt);c.push(b.value),d&&(d=b.inclusive)}return new AH(c,d)}function Bl(a,b){let c=[],d=!0;for(let e of xu(b)){let b=0===e.kind?Bn(a,e.fieldPath,a.endAt):Bm(a,e.fieldPath,a.endAt);c.push(b.value),d&&(d=b.inclusive)}return new AH(c,d)}function Bm(a,b,c){let d=zW,e=!0;for(let c of Bh(a,b)){let a=zW,b=!0;switch(c.op){case"<":case"<=":a=Az(c.value);break;case"==":case"in":case">=":a=c.value;break;case">":a=c.value,b=!1;break;case"!=":case"not-in":a=zW}0>AB({value:d,inclusive:e},{value:a,inclusive:b})&&(d=a,e=b)}if(null!==c){for(let f=0;f<a.orderBy.length;++f)if(a.orderBy[f].field.isEqual(b)){let a=c.position[f];0>AB({value:d,inclusive:e},{value:a,inclusive:c.inclusive})&&(d=a,e=c.inclusive);break}}return{value:d,inclusive:e}}function Bn(a,b,c){let d=zT,e=!0;for(let c of Bh(a,b)){let a=zT,b=!0;switch(c.op){case">=":case">":a=AA(c.value),b=!1;break;case"==":case"in":case"<=":a=c.value;break;case"<":a=c.value,b=!1;break;case"!=":case"not-in":a=zT}AC({value:d,inclusive:e},{value:a,inclusive:b})>0&&(d=a,e=b)}if(null!==c){for(let f=0;f<a.orderBy.length;++f)if(a.orderBy[f].field.isEqual(b)){let a=c.position[f];AC({value:d,inclusive:e},{value:a,inclusive:c.inclusive})>0&&(d=a,e=c.inclusive);break}}return{value:d,inclusive:e}}function Bo(a){let b=new zn(xo.comparator),c=!1;for(let d of a.filters)for(let a of d.getFlattenedFilters())a.field.isKeyField()||("array-contains"===a.op||"array-contains-any"===a.op?c=!0:b=b.add(a.field));for(let c of a.orderBy)c.field.isKeyField()||(b=b.add(c.field));return b.size+ +!!c}function Bp(a){return null!==a.limit}class Bq{constructor(a,b=null,c=[],d=[],e=null,f="F",g=null,h=null){this.path=a,this.collectionGroup=b,this.explicitOrderBy=c,this.filters=d,this.limit=e,this.limitType=f,this.startAt=g,this.endAt=h,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}}function Br(a,b,c,d,e,f,g,h){return new Bq(a,b,c,d,e,f,g,h)}function Bs(a){return new Bq(a)}function Bt(a,b){return new Bq(b,null,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)}function Bu(a){return 0===a.filters.length&&null===a.limit&&null==a.startAt&&null==a.endAt&&(0===a.explicitOrderBy.length||1===a.explicitOrderBy.length&&a.explicitOrderBy[0].field.isKeyField())}function Bv(a){let b=new zn(xo.comparator);return a.filters.forEach(a=>{a.getFlattenedFilters().forEach(a=>{a.isInequality()&&(b=b.add(a.field))})}),b}function Bw(a){return xp.isDocumentKey(a.path)&&null===a.collectionGroup&&0===a.filters.length}function Bx(a){return null!==a.collectionGroup}function By(a){let b=wV(a);if(null===b.memoizedNormalizedOrderBy){b.memoizedNormalizedOrderBy=[];let a=new Set;for(let c of b.explicitOrderBy)b.memoizedNormalizedOrderBy.push(c),a.add(c.field.canonicalString());let c=b.explicitOrderBy.length>0?b.explicitOrderBy[b.explicitOrderBy.length-1].dir:"asc";Bv(b).forEach(d=>{a.has(d.canonicalString())||d.isKeyField()||b.memoizedNormalizedOrderBy.push(new AM(d,c))}),a.has(xo.keyField().canonicalString())||b.memoizedNormalizedOrderBy.push(new AM(xo.keyField(),c))}return b.memoizedNormalizedOrderBy}function Bz(a){let b=wV(a);return b.memoizedTarget||(b.memoizedTarget=BB(b,By(a))),b.memoizedTarget}function BA(a){let b=wV(a);return b.memoizedAggregateTarget||(b.memoizedAggregateTarget=BB(b,a.explicitOrderBy)),b.memoizedAggregateTarget}function BB(a,b){if("F"===a.limitType)return Bc(a.path,a.collectionGroup,b,a.filters,a.limit,a.startAt,a.endAt);{b=b.map(a=>{let b="desc"===a.dir?"asc":"desc";return new AM(a.field,b)});let c=a.endAt?new AH(a.endAt.position,a.endAt.inclusive):null,d=a.startAt?new AH(a.startAt.position,a.startAt.inclusive):null;return Bc(a.path,a.collectionGroup,b,a.filters,a.limit,c,d)}}function BC(a,b){let c=a.filters.concat([b]);return new Bq(a.path,a.collectionGroup,a.explicitOrderBy.slice(),c,a.limit,a.limitType,a.startAt,a.endAt)}function BD(a,b){let c=a.explicitOrderBy.concat([b]);return new Bq(a.path,a.collectionGroup,c,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)}function BE(a,b,c){return new Bq(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),b,c,a.startAt,a.endAt)}function BF(a,b){return new Bq(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,b,a.endAt)}function BG(a,b){return new Bq(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,b)}function BH(a,b){return Bf(Bz(a),Bz(b))&&a.limitType===b.limitType}function BI(a){return`${Bd(Bz(a))}|lt:${a.limitType}`}function BJ(a){return`Query(target=${Be(Bz(a))}; limitType=${a.limitType})`}function BK(a,b){return b.isFoundDocument()&&BL(a,b)&&BM(a,b)&&BN(a,b)&&BO(a,b)}function BL(a,b){let c=b.key.path;return null!==a.collectionGroup?b.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(c):xp.isDocumentKey(a.path)?a.path.isEqual(c):a.path.isImmediateParentOf(c)}function BM(a,b){for(let c of By(a))if(!c.field.isKeyField()&&null===b.data.field(c.field))return!1;return!0}function BN(a,b){for(let c of a.filters)if(!c.matches(b))return!1;return!0}function BO(a,b){return(!a.startAt||!!AK(a.startAt,By(a),b))&&(!a.endAt||!!AJ(a.endAt,By(a),b))}function BP(a){return a.collectionGroup||(a.path.length%2==1?a.path.lastSegment():a.path.get(a.path.length-2))}function BQ(a){return(b,c)=>{let d=!1;for(let e of By(a)){let a=BR(e,b,c);if(0!==a)return a;d=d||e.field.isKeyField()}return 0}}function BR(a,b,c){let d=a.field.isKeyField()?xp.comparator(b.key,c.key):AG(a.field,b,c);switch(a.dir){case"asc":return d;case"desc":return -1*d;default:return wS(19790,{direction:a.dir})}}class BS{constructor(a,b){this.mapKeyFn=a,this.equalsFn=b,this.inner={},this.innerSize=0}get(a){let b=this.mapKeyFn(a),c=this.inner[b];if(void 0!==c){for(let[b,d]of c)if(this.equalsFn(b,a))return d}}has(a){return void 0!==this.get(a)}set(a,b){let c=this.mapKeyFn(a),d=this.inner[c];if(void 0===d){this.inner[c]=[[a,b]],this.innerSize++;return}for(let c=0;c<d.length;c++)if(this.equalsFn(d[c][0],a)){d[c]=[a,b];return}d.push([a,b]),this.innerSize++}delete(a){let b=this.mapKeyFn(a),c=this.inner[b];if(void 0===c)return!1;for(let d=0;d<c.length;d++)if(this.equalsFn(c[d][0],a))return 1===c.length?delete this.inner[b]:c.splice(d,1),this.innerSize--,!0;return!1}forEach(a){zg(this.inner,(b,c)=>{for(let[b,d]of c)a(b,d)})}isEmpty(){return zi(this.inner)}size(){return this.innerSize}}let BT=new zj(xp.comparator);function BU(){return BT}let BV=new zj(xp.comparator);function BW(...a){let b=BV;for(let c of a)b=b.insert(c.key,c);return b}function BX(){return B_()}function BY(a){let b=BV;return a.forEach((a,c)=>b=b.insert(a,c.overlayedDocument)),b}function BZ(){return B_()}function B$(){return B_()}function B_(){return new BS(a=>a.toString(),(a,b)=>a.isEqual(b))}let B0=new zj(xp.comparator);function B1(){return B0}let B2=new zn(xp.comparator);function B3(...a){let b=B2;for(let c of a)b=b.add(c);return b}let B4=new zn(xa);function B5(){return B4}function B6(a,b){if(a.useProto3Json){if(isNaN(b))return{doubleValue:"NaN"};else if(b===1/0)return{doubleValue:"Infinity"};else if(b===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zP(b)?"-0":b}}function B7(a){return{integerValue:""+a}}function B8(a,b){return zQ(b)?B7(b):B6(a,b)}class B9{constructor(){this._=void 0}}function Ca(a,b,c){return a instanceof Ce?zG(c,b):a instanceof Cf?Cg(a,b):a instanceof Ch?Ci(a,b):Ck(a,b)}function Cb(a,b,c){return a instanceof Cf?Cg(a,b):a instanceof Ch?Ci(a,b):c}function Cc(a,b){return a instanceof Cj?Aq(b)?b:{integerValue:0}:null}function Cd(a,b){return a instanceof Cf&&b instanceof Cf||a instanceof Ch&&b instanceof Ch?xe(a.elements,b.elements,zY):a instanceof Cj&&b instanceof Cj?zY(a.operand,b.operand):a instanceof Ce&&b instanceof Ce}class Ce extends B9{}class Cf extends B9{constructor(a){super(),this.elements=a}}function Cg(a,b){let c=Cm(b);for(let b of a.elements)c.some(a=>zY(a,b))||c.push(b);return{arrayValue:{values:c}}}class Ch extends B9{constructor(a){super(),this.elements=a}}function Ci(a,b){let c=Cm(b);for(let b of a.elements)c=c.filter(a=>!zY(a,b));return{arrayValue:{values:c}}}class Cj extends B9{constructor(a,b){super(),this.serializer=a,this.operand=b}}function Ck(a,b){let c=Cc(a,b),d=Cl(c)+Cl(a.operand);return Ao(c)&&Ao(a.operand)?B7(d):B6(a.serializer,d)}function Cl(a){return zz(a.integerValue||a.doubleValue)}function Cm(a){return Ar(a)&&a.arrayValue.values?a.arrayValue.values.slice():[]}class Cn{constructor(a,b){this.field=a,this.transform=b}}function Co(a,b){return a.field.isEqual(b.field)&&Cd(a.transform,b.transform)}function Cp(a,b){return void 0===a&&void 0===b||!!a&&!!b&&xe(a,b,(a,b)=>Co(a,b))}class Cq{constructor(a,b){this.version=a,this.transformResults=b}}class Cr{constructor(a,b){this.updateTime=a,this.exists=b}static none(){return new Cr}static exists(a){return new Cr(void 0,a)}static updateTime(a){return new Cr(a)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(a){return this.exists===a.exists&&(this.updateTime?!!a.updateTime&&this.updateTime.isEqual(a.updateTime):!a.updateTime)}}function Cs(a,b){return void 0!==a.updateTime?b.isFoundDocument()&&b.version.isEqual(a.updateTime):void 0===a.exists||a.exists===b.isFoundDocument()}class Ct{}function Cu(a,b){if(!a.hasLocalMutations||b&&0===b.fields.length)return null;if(null===b)if(a.isNoDocument())return new CI(a.key,Cr.none());else return new Cz(a.key,a.data,Cr.none());{let c=a.data,d=AD.empty(),e=new zn(xo.comparator);for(let a of b.fields)if(!e.has(a)){let b=c.field(a);null===b&&a.length>1&&(a=a.popLast(),b=c.field(a)),null===b?d.delete(a):d.set(a,b),e=e.add(a)}return new CC(a.key,d,new zr(e.toArray()),Cr.none())}}function Cv(a,b,c){a instanceof Cz?CA(a,b,c):a instanceof CC?CD(a,b,c):CJ(a,b,c)}function Cw(a,b,c,d){return a instanceof Cz?CB(a,b,c,d):a instanceof CC?CE(a,b,c,d):CK(a,b,c)}function Cx(a,b){let c=null;for(let d of a.fieldTransforms){let a=b.data.field(d.field),e=Cc(d.transform,a||null);null!=e&&(null===c&&(c=AD.empty()),c.set(d.field,e))}return c||null}function Cy(a,b){return a.type===b.type&&!!a.key.isEqual(b.key)&&!!a.precondition.isEqual(b.precondition)&&!!Cp(a.fieldTransforms,b.fieldTransforms)&&(0===a.type?a.value.isEqual(b.value):1!==a.type||a.data.isEqual(b.data)&&a.fieldMask.isEqual(b.fieldMask))}class Cz extends Ct{constructor(a,b,c,d=[]){super(),this.key=a,this.value=b,this.precondition=c,this.fieldTransforms=d,this.type=0}getFieldMask(){return null}}function CA(a,b,c){let d=a.value.clone(),e=CG(a.fieldTransforms,b,c.transformResults);d.setAll(e),b.convertToFoundDocument(c.version,d).setHasCommittedMutations()}function CB(a,b,c,d){if(!Cs(a.precondition,b))return c;let e=a.value.clone(),f=CH(a.fieldTransforms,d,b);return e.setAll(f),b.convertToFoundDocument(b.version,e).setHasLocalMutations(),null}class CC extends Ct{constructor(a,b,c,d,e=[]){super(),this.key=a,this.data=b,this.fieldMask=c,this.precondition=d,this.fieldTransforms=e,this.type=1}getFieldMask(){return this.fieldMask}}function CD(a,b,c){if(!Cs(a.precondition,b))return void b.convertToUnknownDocument(c.version);let d=CG(a.fieldTransforms,b,c.transformResults),e=b.data;e.setAll(CF(a)),e.setAll(d),b.convertToFoundDocument(c.version,e).setHasCommittedMutations()}function CE(a,b,c,d){if(!Cs(a.precondition,b))return c;let e=CH(a.fieldTransforms,d,b),f=b.data;return(f.setAll(CF(a)),f.setAll(e),b.convertToFoundDocument(b.version,f).setHasLocalMutations(),null===c)?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(a=>a.field))}function CF(a){let b=new Map;return a.fieldMask.fields.forEach(c=>{if(!c.isEmpty()){let d=a.data.field(c);b.set(c,d)}}),b}function CG(a,b,c){let d=new Map;wU(a.length===c.length,32656,{serverTransformResultCount:c.length,fieldTransformCount:a.length});for(let e=0;e<c.length;e++){let f=a[e],g=f.transform,h=b.data.field(f.field);d.set(f.field,Cb(g,h,c[e]))}return d}function CH(a,b,c){let d=new Map;for(let e of a){let a=e.transform,f=c.data.field(e.field);d.set(e.field,Ca(a,f,b))}return d}class CI extends Ct{constructor(a,b){super(),this.key=a,this.precondition=b,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}function CJ(a,b,c){b.convertToNoDocument(c.version).setHasCommittedMutations()}function CK(a,b,c){return Cs(a.precondition,b)?(b.convertToNoDocument(b.version).setHasLocalMutations(),null):c}class CL extends Ct{constructor(a,b){super(),this.key=a,this.precondition=b,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class CM{constructor(a,b,c,d){this.batchId=a,this.localWriteTime=b,this.baseMutations=c,this.mutations=d}applyToRemoteDocument(a,b){let c=b.mutationResults;for(let b=0;b<this.mutations.length;b++){let d=this.mutations[b];d.key.isEqual(a.key)&&Cv(d,a,c[b])}}applyToLocalView(a,b){for(let c of this.baseMutations)c.key.isEqual(a.key)&&(b=Cw(c,a,b,this.localWriteTime));for(let c of this.mutations)c.key.isEqual(a.key)&&(b=Cw(c,a,b,this.localWriteTime));return b}applyToLocalDocumentSet(a,b){let c=B$();return this.mutations.forEach(d=>{let e=a.get(d.key),f=e.overlayedDocument,g=this.applyToLocalView(f,e.mutatedFields),h=Cu(f,g=b.has(d.key)?null:g);null!==h&&c.set(d.key,h),f.isValidDocument()||f.convertToNoDocument(xj.min())}),c}keys(){return this.mutations.reduce((a,b)=>a.add(b.key),B3())}isEqual(a){return this.batchId===a.batchId&&xe(this.mutations,a.mutations,(a,b)=>Cy(a,b))&&xe(this.baseMutations,a.baseMutations,(a,b)=>Cy(a,b))}}class CN{constructor(a,b,c,d){this.batch=a,this.commitVersion=b,this.mutationResults=c,this.docVersions=d}static from(a,b,c){wU(a.mutations.length===c.length,58842,{mutationsSent:a.mutations.length,resultsReceived:c.length});let d=B1(),e=a.mutations;for(let a=0;a<e.length;a++)d=d.insert(e[a].key,c[a].version);return new CN(a,b,c,d)}}class CO{constructor(a,b){this.largestBatchId=a,this.mutation=b}getKey(){return this.mutation.key}isEqual(a){return null!==a&&this.mutation===a.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class CP{constructor(a,b){this.count=a,this.unchangedNames=b}}function CQ(a){switch(a){case wW.OK:return wS(64938);case wW.CANCELLED:case wW.UNKNOWN:case wW.DEADLINE_EXCEEDED:case wW.RESOURCE_EXHAUSTED:case wW.INTERNAL:case wW.UNAVAILABLE:case wW.UNAUTHENTICATED:return!1;case wW.INVALID_ARGUMENT:case wW.NOT_FOUND:case wW.ALREADY_EXISTS:case wW.PERMISSION_DENIED:case wW.FAILED_PRECONDITION:case wW.ABORTED:case wW.OUT_OF_RANGE:case wW.UNIMPLEMENTED:case wW.DATA_LOSS:return!0;default:return wS(15467,{code:a})}}function CR(a){return CQ(a)&&a!==wW.ABORTED}function CS(a){if(void 0===a)return wP("GRPC error has no .code"),wW.UNKNOWN;switch(a){case p.OK:return wW.OK;case p.CANCELLED:return wW.CANCELLED;case p.UNKNOWN:return wW.UNKNOWN;case p.DEADLINE_EXCEEDED:return wW.DEADLINE_EXCEEDED;case p.RESOURCE_EXHAUSTED:return wW.RESOURCE_EXHAUSTED;case p.INTERNAL:return wW.INTERNAL;case p.UNAVAILABLE:return wW.UNAVAILABLE;case p.UNAUTHENTICATED:return wW.UNAUTHENTICATED;case p.INVALID_ARGUMENT:return wW.INVALID_ARGUMENT;case p.NOT_FOUND:return wW.NOT_FOUND;case p.ALREADY_EXISTS:return wW.ALREADY_EXISTS;case p.PERMISSION_DENIED:return wW.PERMISSION_DENIED;case p.FAILED_PRECONDITION:return wW.FAILED_PRECONDITION;case p.ABORTED:return wW.ABORTED;case p.OUT_OF_RANGE:return wW.OUT_OF_RANGE;case p.UNIMPLEMENTED:return wW.UNIMPLEMENTED;case p.DATA_LOSS:return wW.DATA_LOSS;default:return wS(39323,{code:a})}}!function(a){a[a.OK=0]="OK",a[a.CANCELLED=1]="CANCELLED",a[a.UNKNOWN=2]="UNKNOWN",a[a.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",a[a.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",a[a.NOT_FOUND=5]="NOT_FOUND",a[a.ALREADY_EXISTS=6]="ALREADY_EXISTS",a[a.PERMISSION_DENIED=7]="PERMISSION_DENIED",a[a.UNAUTHENTICATED=16]="UNAUTHENTICATED",a[a.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",a[a.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",a[a.ABORTED=10]="ABORTED",a[a.OUT_OF_RANGE=11]="OUT_OF_RANGE",a[a.UNIMPLEMENTED=12]="UNIMPLEMENTED",a[a.INTERNAL=13]="INTERNAL",a[a.UNAVAILABLE=14]="UNAVAILABLE",a[a.DATA_LOSS=15]="DATA_LOSS"}(p||(p={}));class CT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}let CU=null;function CV(a){if(CU)throw Error("a TestingHooksSpi instance is already set");CU=a}let CW=new n([0xffffffff,0xffffffff],0);function CX(a){let b=w7().encode(a),c=new o;return c.update(b),new Uint8Array(c.digest())}function CY(a){let b=new DataView(a.buffer),c=b.getUint32(0,!0),d=b.getUint32(4,!0),e=b.getUint32(8,!0),f=b.getUint32(12,!0);return[new n([c,d],0),new n([e,f],0)]}class CZ{constructor(a,b,c){if(this.bitmap=a,this.padding=b,this.hashCount=c,b<0||b>=8)throw new C$(`Invalid padding: ${b}`);if(c<0||a.length>0&&0===this.hashCount)throw new C$(`Invalid hash count: ${c}`);if(0===a.length&&0!==b)throw new C$(`Invalid padding when bitmap length is 0: ${b}`);this.bitCount=8*a.length-b,this.bitCountInInteger=n.fromNumber(this.bitCount)}getBitIndex(a,b,c){let d=a.add(b.multiply(n.fromNumber(c)));return 1===d.compare(CW)&&(d=new n([d.getBits(0),d.getBits(1)],0)),d.modulo(this.bitCountInInteger).toNumber()}isBitSet(a){return(this.bitmap[Math.floor(a/8)]&1<<a%8)!=0}mightContain(a){if(0===this.bitCount)return!1;let[b,c]=CY(CX(a));for(let a=0;a<this.hashCount;a++){let d=this.getBitIndex(b,c,a);if(!this.isBitSet(d))return!1}return!0}static create(a,b,c){let d=a%8==0?0:8-a%8,e=new CZ(new Uint8Array(Math.ceil(a/8)),d,b);return c.forEach(a=>e.insert(a)),e}insert(a){if(0===this.bitCount)return;let[b,c]=CY(CX(a));for(let a=0;a<this.hashCount;a++){let d=this.getBitIndex(b,c,a);this.setBit(d)}}setBit(a){let b=Math.floor(a/8),c=a%8;this.bitmap[b]|=1<<c}}class C$ extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class C_{constructor(a,b,c,d,e){this.snapshotVersion=a,this.targetChanges=b,this.targetMismatches=c,this.documentUpdates=d,this.resolvedLimboDocuments=e}static createSynthesizedRemoteEventForCurrentChange(a,b,c){let d=new Map;return d.set(a,C0.createSynthesizedTargetChangeForCurrentChange(a,b,c)),new C_(xj.min(),d,new zj(xa),BU(),B3())}}class C0{constructor(a,b,c,d,e){this.resumeToken=a,this.current=b,this.addedDocuments=c,this.modifiedDocuments=d,this.removedDocuments=e}static createSynthesizedTargetChangeForCurrentChange(a,b,c){return new C0(c,b,B3(),B3(),B3())}}class C1{constructor(a,b,c,d){this.updatedTargetIds=a,this.removedTargetIds=b,this.key=c,this.newDoc=d}}class C2{constructor(a,b){this.targetId=a,this.existenceFilter=b}}class C3{constructor(a,b,c=zu.EMPTY_BYTE_STRING,d=null){this.state=a,this.targetIds=b,this.resumeToken=c,this.cause=d}}class C4{constructor(){this.pendingResponses=0,this.documentChanges=C8(),this._resumeToken=zu.EMPTY_BYTE_STRING,this._current=!1,this._hasPendingChanges=!0}get current(){return this._current}get resumeToken(){return this._resumeToken}get isPending(){return 0!==this.pendingResponses}get hasPendingChanges(){return this._hasPendingChanges}updateResumeToken(a){a.approximateByteSize()>0&&(this._hasPendingChanges=!0,this._resumeToken=a)}toTargetChange(){let a=B3(),b=B3(),c=B3();return this.documentChanges.forEach((d,e)=>{switch(e){case 0:a=a.add(d);break;case 2:b=b.add(d);break;case 1:c=c.add(d);break;default:wS(38017,{changeType:e})}}),new C0(this._resumeToken,this._current,a,b,c)}clearPendingChanges(){this._hasPendingChanges=!1,this.documentChanges=C8()}addDocumentChange(a,b){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(a,b)}removeDocumentChange(a){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(a)}recordPendingTargetRequest(){this.pendingResponses+=1}recordTargetResponse(){this.pendingResponses-=1,wU(this.pendingResponses>=0,3241,{pendingResponses:this.pendingResponses})}markCurrent(){this._hasPendingChanges=!0,this._current=!0}}let C5="WatchChangeAggregator";class C6{constructor(a){this.metadataProvider=a,this.targetStates=new Map,this.pendingDocumentUpdates=BU(),this.pendingDocumentUpdatesByTarget=C7(),this.pendingDocumentTargetMapping=C7(),this.pendingTargetResets=new zj(xa)}handleDocumentChange(a){for(let b of a.updatedTargetIds)a.newDoc&&a.newDoc.isFoundDocument()?this.addDocumentToTarget(b,a.newDoc):this.removeDocumentFromTarget(b,a.key,a.newDoc);for(let b of a.removedTargetIds)this.removeDocumentFromTarget(b,a.key,a.newDoc)}handleTargetChange(a){this.forEachTarget(a,b=>{let c=this.ensureTargetState(b);switch(a.state){case 0:this.isActiveTarget(b)&&c.updateResumeToken(a.resumeToken);break;case 1:c.recordTargetResponse(),c.isPending||c.clearPendingChanges(),c.updateResumeToken(a.resumeToken);break;case 2:c.recordTargetResponse(),c.isPending||this.removeTarget(b);break;case 3:this.isActiveTarget(b)&&(c.markCurrent(),c.updateResumeToken(a.resumeToken));break;case 4:this.isActiveTarget(b)&&(this.resetTarget(b),c.updateResumeToken(a.resumeToken));break;default:wS(56790,{state:a.state})}})}forEachTarget(a,b){a.targetIds.length>0?a.targetIds.forEach(b):this.targetStates.forEach((a,c)=>{this.isActiveTarget(c)&&b(c)})}handleExistenceFilter(a){let b=a.targetId,c=a.existenceFilter.count,d=this.targetDataForActiveTarget(b);if(d){let e=d.target;if(Bg(e))if(0===c){let a=new xp(e.path);this.removeDocumentFromTarget(b,a,AF.newNoDocument(a,xj.min()))}else wU(1===c,20013,{expectedCount:c});else{let d=this.getCurrentDocumentCountForTarget(b);if(d!==c){let c=this.parseBloomFilter(a),e=c?this.applyBloomFilter(c,a,d):1;if(0!==e){this.resetTarget(b);let a=2===e?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.pendingTargetResets=this.pendingTargetResets.insert(b,a)}null==CU||CU.notifyOnExistenceFilterMismatch(C9(d,a.existenceFilter,this.metadataProvider.getDatabaseId(),c,e))}}}}parseBloomFilter(a){let b,c,d=a.existenceFilter.unchangedNames;if(!d||!d.bits)return null;let{bits:{bitmap:e="",padding:f=0},hashCount:g=0}=d;try{b=zA(e).toUint8Array()}catch(a){if(a instanceof CT)return wQ("Decoding the base64 bloom filter in existence filter failed ("+a.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw a}try{c=new CZ(b,f,g)}catch(a){return a instanceof C$?wQ("BloomFilter error: ",a):wQ("Applying bloom filter failed: ",a),null}return 0===c.bitCount?null:c}applyBloomFilter(a,b,c){return 2*(b.existenceFilter.count!==c-this.filterRemovedDocuments(a,b.targetId))}filterRemovedDocuments(a,b){let c=this.metadataProvider.getRemoteKeysForTarget(b),d=0;return c.forEach(c=>{let e=this.metadataProvider.getDatabaseId(),f=`projects/${e.projectId}/databases/${e.database}/documents/${c.path.canonicalString()}`;!a.mightContain(f)&&(this.removeDocumentFromTarget(b,c,null),d++)}),d}createRemoteEvent(a){let b=new Map;this.targetStates.forEach((c,d)=>{let e=this.targetDataForActiveTarget(d);if(e){if(c.current&&Bg(e.target)){let b=new xp(e.target.path);this.ensureDocumentUpdateByTarget(b).has(d)||this.targetContainsDocument(d,b)||this.removeDocumentFromTarget(d,b,AF.newNoDocument(b,a))}c.hasPendingChanges&&(b.set(d,c.toTargetChange()),c.clearPendingChanges())}});let c=B3();this.pendingDocumentTargetMapping.forEach((a,b)=>{let d=!0;b.forEachWhile(a=>{let b=this.targetDataForActiveTarget(a);return!b||"TargetPurposeLimboResolution"===b.purpose||(d=!1,!1)}),d&&(c=c.add(a))}),this.pendingDocumentUpdates.forEach((b,c)=>c.setReadTime(a));let d=new C_(a,b,this.pendingTargetResets,this.pendingDocumentUpdates,c);return this.pendingDocumentUpdates=BU(),this.pendingDocumentUpdatesByTarget=C7(),this.pendingDocumentTargetMapping=C7(),this.pendingTargetResets=new zj(xa),d}addDocumentToTarget(a,b){if(!this.isActiveTarget(a))return;let c=2*!!this.targetContainsDocument(a,b.key);this.ensureTargetState(a).addDocumentChange(b.key,c),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(b.key,b),this.pendingDocumentUpdatesByTarget=this.pendingDocumentUpdatesByTarget.insert(b.key,this.ensureDocumentUpdateByTarget(b.key).add(a)),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(b.key,this.ensureDocumentTargetMapping(b.key).add(a))}removeDocumentFromTarget(a,b,c){if(!this.isActiveTarget(a))return;let d=this.ensureTargetState(a);this.targetContainsDocument(a,b)?d.addDocumentChange(b,1):d.removeDocumentChange(b),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(b,this.ensureDocumentTargetMapping(b).delete(a)),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(b,this.ensureDocumentTargetMapping(b).add(a)),c&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(b,c))}removeTarget(a){this.targetStates.delete(a)}getCurrentDocumentCountForTarget(a){let b=this.ensureTargetState(a).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(a).size+b.addedDocuments.size-b.removedDocuments.size}recordPendingTargetRequest(a){this.ensureTargetState(a).recordPendingTargetRequest()}ensureTargetState(a){let b=this.targetStates.get(a);return b||(b=new C4,this.targetStates.set(a,b)),b}ensureDocumentTargetMapping(a){let b=this.pendingDocumentTargetMapping.get(a);return b||(b=new zn(xa),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(a,b)),b}ensureDocumentUpdateByTarget(a){let b=this.pendingDocumentUpdatesByTarget.get(a);return b||(b=new zn(xa),this.pendingDocumentUpdatesByTarget=this.pendingDocumentUpdatesByTarget.insert(a,b)),b}isActiveTarget(a){let b=null!==this.targetDataForActiveTarget(a);return b||wO(C5,"Detected inactive target",a),b}targetDataForActiveTarget(a){let b=this.targetStates.get(a);return b&&b.isPending?null:this.metadataProvider.getTargetDataForTarget(a)}resetTarget(a){this.targetStates.set(a,new C4),this.metadataProvider.getRemoteKeysForTarget(a).forEach(b=>{this.removeDocumentFromTarget(a,b,null)})}targetContainsDocument(a,b){return this.metadataProvider.getRemoteKeysForTarget(a).has(b)}}function C7(){return new zj(xp.comparator)}function C8(){return new zj(xp.comparator)}function C9(a,b,c,d,e){var f,g,h,i,j,k;let l={localCacheCount:a,existenceFilterCount:b.count,databaseId:c.database,projectId:c.projectId},m=b.unchangedNames;return m&&(l.bloomFilter={applied:0===e,hashCount:null!=(f=null==m?void 0:m.hashCount)?f:0,bitmapLength:null!=(i=null==(h=null==(g=null==m?void 0:m.bits)?void 0:g.bitmap)?void 0:h.length)?i:0,padding:null!=(k=null==(j=null==m?void 0:m.bits)?void 0:j.padding)?k:0,mightContain:a=>{var b;return null!=(b=null==d?void 0:d.mightContain(a))&&b}}),l}let Da=(()=>{let a={};return a.asc="ASCENDING",a.desc="DESCENDING",a})(),Db=(()=>{let a={};return a["<"]="LESS_THAN",a["<="]="LESS_THAN_OR_EQUAL",a[">"]="GREATER_THAN",a[">="]="GREATER_THAN_OR_EQUAL",a["=="]="EQUAL",a["!="]="NOT_EQUAL",a["array-contains"]="ARRAY_CONTAINS",a.in="IN",a["not-in"]="NOT_IN",a["array-contains-any"]="ARRAY_CONTAINS_ANY",a})(),Dc=(()=>{let a={};return a.and="AND",a.or="OR",a})();class Dd{constructor(a,b){this.databaseId=a,this.useProto3Json=b}}function De(a){return new wX(void 0===a.code?wW.UNKNOWN:CS(a.code),a.message||"")}function Df(a,b){return a.useProto3Json||zO(b)?b:{value:b}}function Dg(a){let b;return zO(b="object"==typeof a?a.value:a)?null:b}function Dh(a,b){if(!a.useProto3Json)return{seconds:""+b.seconds,nanos:b.nanoseconds};{let a=new Date(1e3*b.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),c=("000000000"+b.nanoseconds).slice(-9);return`${a}.${c}Z`}}function Di(a){let b=zy(a);return new xi(b.seconds,b.nanos)}function Dj(a,b){return a.useProto3Json?b.toBase64():b.toUint8Array()}function Dk(a,b){return a.useProto3Json?(wU(void 0===b||"string"==typeof b,58123),zu.fromBase64String(b||"")):(wU(void 0===b||b instanceof Buffer||b instanceof Uint8Array,16193),zu.fromUint8Array(b||new Uint8Array))}function Dl(a,b){return Dh(a,b.toTimestamp())}function Dm(a){return wU(!!a,49232),xj.fromTimestamp(Di(a))}function Dn(a,b){return Do(a,b).canonicalString()}function Do(a,b){let c=Dv(a).child("documents");return void 0===b?c:c.child(b)}function Dp(a){let b=xm.fromString(a);return wU(Em(b),10190,{key:b.toString()}),b}function Dq(a,b){return Dn(a.databaseId,b.path)}function Dr(a,b){let c=Dp(b);if(c.get(1)!==a.databaseId.projectId)throw new wX(wW.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+c.get(1)+" vs "+a.databaseId.projectId);if(c.get(3)!==a.databaseId.database)throw new wX(wW.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+c.get(3)+" vs "+a.databaseId.database);return new xp(Dw(c))}function Ds(a,b){return Dn(a.databaseId,b)}function Dt(a){let b=Dp(a);return 4===b.length?xm.emptyPath():Dw(b)}function Du(a){return new xm(["projects",a.databaseId.projectId,"databases",a.databaseId.database]).canonicalString()}function Dv(a){return new xm(["projects",a.projectId,"databases",a.database])}function Dw(a){return wU(a.length>4&&"documents"===a.get(4),29091,{key:a.toString()}),a.popFirst(5)}function Dx(a,b,c){return{name:Dq(a,b),fields:c.value.mapValue.fields}}function Dy(a,b){return{name:Dq(a,b.key),fields:b.data.value.mapValue.fields,updateTime:Dh(a,b.version.toTimestamp()),createTime:Dh(a,b.createTime.toTimestamp())}}function Dz(a,b,c){let d=Dr(a,b.name),e=Dm(b.updateTime),f=b.createTime?Dm(b.createTime):xj.min(),g=new AD({mapValue:{fields:b.fields}}),h=AF.newFoundDocument(d,e,f,g);return c&&h.setHasCommittedMutations(),c?h.setHasCommittedMutations():h}function DA(a,b){wU(!!b.found,43571),b.found.name,b.found.updateTime;let c=Dr(a,b.found.name),d=Dm(b.found.updateTime),e=b.found.createTime?Dm(b.found.createTime):xj.min(),f=new AD({mapValue:{fields:b.found.fields}});return AF.newFoundDocument(c,d,e,f)}function DB(a,b){wU(!!b.missing,3894),wU(!!b.readTime,22933);let c=Dr(a,b.missing),d=Dm(b.readTime);return AF.newNoDocument(c,d)}function DC(a,b){return"found"in b?DA(a,b):"missing"in b?DB(a,b):wS(7234,{result:b})}function DD(a,b){let c;if("targetChange"in b){b.targetChange;let d=DE(b.targetChange.targetChangeType||"NO_CHANGE"),e=b.targetChange.targetIds||[],f=Dk(a,b.targetChange.resumeToken),g=b.targetChange.cause;c=new C3(d,e,f,g&&De(g)||null)}else if("documentChange"in b){b.documentChange;let d=b.documentChange;d.document,d.document.name,d.document.updateTime;let e=Dr(a,d.document.name),f=Dm(d.document.updateTime),g=d.document.createTime?Dm(d.document.createTime):xj.min(),h=new AD({mapValue:{fields:d.document.fields}}),i=AF.newFoundDocument(e,f,g,h);c=new C1(d.targetIds||[],d.removedTargetIds||[],i.key,i)}else if("documentDelete"in b){b.documentDelete;let d=b.documentDelete;d.document;let e=Dr(a,d.document),f=d.readTime?Dm(d.readTime):xj.min(),g=AF.newNoDocument(e,f);c=new C1([],d.removedTargetIds||[],g.key,g)}else if("documentRemove"in b){b.documentRemove;let d=b.documentRemove;d.document;let e=Dr(a,d.document);c=new C1([],d.removedTargetIds||[],e,null)}else{if(!("filter"in b))return wS(11601,{change:b});b.filter;let a=b.filter;a.targetId;let{count:d=0,unchangedNames:e}=a,f=new CP(d,e);c=new C2(a.targetId,f)}return c}function DE(a){if("NO_CHANGE"===a)return 0;if("ADD"===a)return 1;if("REMOVE"===a)return 2;if("CURRENT"===a)return 3;if("RESET"===a)return 4;else return wS(39313,{state:a})}function DF(a){if(!("targetChange"in a))return xj.min();let b=a.targetChange;return b.targetIds&&b.targetIds.length||!b.readTime?xj.min():Dm(b.readTime)}function DG(a,b){let c;if(b instanceof Cz)c={update:Dx(a,b.key,b.value)};else if(b instanceof CI)c={delete:Dq(a,b.key)};else if(b instanceof CC)c={update:Dx(a,b.key,b.data),updateMask:Ek(b.fieldMask)};else{if(!(b instanceof CL))return wS(16599,{mutationType:b.type});c={verify:Dq(a,b.key)}}return b.fieldTransforms.length>0&&(c.updateTransforms=b.fieldTransforms.map(b=>DM(a,b))),b.precondition.isNone||(c.currentDocument=DI(a,b.precondition)),c}function DH(a,b){let c=b.currentDocument?DJ(b.currentDocument):Cr.none(),d=b.updateTransforms?b.updateTransforms.map(b=>DN(a,b)):[];if(b.update){b.update.name;let e=Dr(a,b.update.name),f=new AD({mapValue:{fields:b.update.fields}});return b.updateMask?new CC(e,f,El(b.updateMask),c,d):new Cz(e,f,c,d)}return b.delete?new CI(Dr(a,b.delete),c):b.verify?new CL(Dr(a,b.verify),c):wS(1463,{proto:b})}function DI(a,b){return void 0!==b.updateTime?{updateTime:Dl(a,b.updateTime)}:void 0!==b.exists?{exists:b.exists}:wS(27497)}function DJ(a){return void 0!==a.updateTime?Cr.updateTime(Dm(a.updateTime)):void 0!==a.exists?Cr.exists(a.exists):Cr.none()}function DK(a,b){let c=a.updateTime?Dm(a.updateTime):Dm(b);return c.isEqual(xj.min())&&(c=Dm(b)),new Cq(c,a.transformResults||[])}function DL(a,b){return a&&a.length>0?(wU(void 0!==b,14353),a.map(a=>DK(a,b))):[]}function DM(a,b){let c=b.transform;if(c instanceof Ce)return{fieldPath:b.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Cf)return{fieldPath:b.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Ch)return{fieldPath:b.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Cj)return{fieldPath:b.field.canonicalString(),increment:c.operand};throw wS(20930,{transform:b.transform})}function DN(a,b){let c=null;return"setToServerValue"in b?(wU("REQUEST_TIME"===b.setToServerValue,16630,{proto:b}),c=new Ce):"appendMissingElements"in b?c=new Cf(b.appendMissingElements.values||[]):"removeAllFromArray"in b?c=new Ch(b.removeAllFromArray.values||[]):"increment"in b?c=new Cj(a,b.increment):wS(16584,{proto:b}),new Cn(xo.fromServerFormat(b.fieldPath),c)}function DO(a,b){return{documents:[Ds(a,b.path)]}}function DP(a){let b=a.documents.length;return wU(1===b,1966,{count:b}),Bz(Bs(Dt(a.documents[0])))}function DQ(a,b){let c,d={structuredQuery:{}},e=b.path;null!==b.collectionGroup?(c=e,d.structuredQuery.from=[{collectionId:b.collectionGroup,allDescendants:!0}]):(c=e.popLast(),d.structuredQuery.from=[{collectionId:e.lastSegment()}]),d.parent=Ds(a,c);let f=DX(b.filters);f&&(d.structuredQuery.where=f);let g=D$(b.orderBy);g&&(d.structuredQuery.orderBy=g);let h=Df(a,b.limit);return null!==h&&(d.structuredQuery.limit=h),b.startAt&&(d.structuredQuery.startAt=D0(b.startAt)),b.endAt&&(d.structuredQuery.endAt=D1(b.endAt)),{queryTarget:d,parent:c}}function DR(a,b,c,d){let{queryTarget:e,parent:f}=DQ(a,b),g={},h=[],i=0;return c.forEach(a=>{let b=d?a.alias:`aggregate_${i++}`;g[b]=a.alias,"count"===a.aggregateType?h.push({alias:b,count:{}}):"avg"===a.aggregateType?h.push({alias:b,avg:{field:Ea(a.fieldPath)}}):"sum"===a.aggregateType&&h.push({alias:b,sum:{field:Ea(a.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:h,structuredQuery:e.structuredQuery},parent:e.parent},aliasMap:g,parent:f}}function DS(a){let b=Dt(a.parent),c=a.structuredQuery,d=c.from?c.from.length:0,e=null;if(d>0){wU(1===d,65062);let a=c.from[0];a.allDescendants?e=a.collectionId:b=b.child(a.collectionId)}let f=[];c.where&&(f=DY(c.where));let g=[];c.orderBy&&(g=D_(c.orderBy));let h=null;c.limit&&(h=Dg(c.limit));let i=null;c.startAt&&(i=D2(c.startAt));let j=null;return c.endAt&&(j=D3(c.endAt)),Br(b,e,g,f,h,"F",i,j)}function DT(a){return Bz(DS(a))}function DU(a,b){let c=DV(b.purpose);return null==c?null:{"goog-listen-tags":c}}function DV(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return wS(28987,{purpose:a})}}function DW(a,b){let c,d=b.target;if((c=Bg(d)?{documents:DO(a,d)}:{query:DQ(a,d).queryTarget}).targetId=b.targetId,b.resumeToken.approximateByteSize()>0){c.resumeToken=Dj(a,b.resumeToken);let d=Df(a,b.expectedCount);null!==d&&(c.expectedCount=d)}else if(b.snapshotVersion.compareTo(xj.min())>0){c.readTime=Dh(a,b.snapshotVersion.toTimestamp());let d=Df(a,b.expectedCount);null!==d&&(c.expectedCount=d)}return c}function DX(a){if(0!==a.length)return Ee(AS.create(a,"and"))}function DY(a){let b=DZ(a);return b instanceof AS&&AV(b)?b.getFilters():[b]}function DZ(a){return void 0!==a.unaryFilter?Eh(a):void 0!==a.fieldFilter?Ei(a):void 0!==a.compositeFilter?Ej(a):wS(30097,{filter:a})}function D$(a){if(0!==a.length)return a.map(a=>Ec(a))}function D_(a){return a.map(a=>Ed(a))}function D0(a){return{before:a.inclusive,values:a.position}}function D1(a){return{before:!a.inclusive,values:a.position}}function D2(a){let b=!!a.before;return new AH(a.values||[],b)}function D3(a){let b=!a.before;return new AH(a.values||[],b)}function D4(a){return Da[a]}function D5(a){switch(a){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}function D6(a){return Db[a]}function D7(a){return Dc[a]}function D8(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return wS(58110);default:return wS(50506)}}function D9(a){switch(a){case"AND":return"and";case"OR":return"or";default:return wS(1026)}}function Ea(a){return{fieldPath:a.canonicalString()}}function Eb(a){return xo.fromServerFormat(a.fieldPath)}function Ec(a){return{field:Ea(a.field),direction:D4(a.dir)}}function Ed(a){return new AM(Eb(a.field),D5(a.direction))}function Ee(a){return a instanceof AR?Eg(a):a instanceof AS?Ef(a):wS(54877,{filter:a})}function Ef(a){let b=a.getFilters().map(a=>Ee(a));return 1===b.length?b[0]:{compositeFilter:{op:D7(a.op),filters:b}}}function Eg(a){if("=="===a.op){if(At(a.value))return{unaryFilter:{field:Ea(a.field),op:"IS_NAN"}};else if(As(a.value))return{unaryFilter:{field:Ea(a.field),op:"IS_NULL"}}}else if("!="===a.op){if(At(a.value))return{unaryFilter:{field:Ea(a.field),op:"IS_NOT_NAN"}};else if(As(a.value))return{unaryFilter:{field:Ea(a.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ea(a.field),op:D6(a.op),value:a.value}}}function Eh(a){switch(a.unaryFilter.op){case"IS_NAN":let b=Eb(a.unaryFilter.field);return AR.create(b,"==",{doubleValue:NaN});case"IS_NULL":let c=Eb(a.unaryFilter.field);return AR.create(c,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let d=Eb(a.unaryFilter.field);return AR.create(d,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let e=Eb(a.unaryFilter.field);return AR.create(e,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return wS(61313);default:return wS(60726)}}function Ei(a){return AR.create(Eb(a.fieldFilter.field),D8(a.fieldFilter.op),a.fieldFilter.value)}function Ej(a){return AS.create(a.compositeFilter.filters.map(a=>DZ(a)),D9(a.compositeFilter.op))}function Ek(a){let b=[];return a.fields.forEach(a=>b.push(a.canonicalString())),{fieldPaths:b}}function El(a){return new zr((a.fieldPaths||[]).map(a=>xo.fromServerFormat(a)))}function Em(a){return a.length>=4&&"projects"===a.get(0)&&"databases"===a.get(2)}class En{constructor(a,b,c,d,e=xj.min(),f=xj.min(),g=zu.EMPTY_BYTE_STRING,h=null){this.target=a,this.targetId=b,this.purpose=c,this.sequenceNumber=d,this.snapshotVersion=e,this.lastLimboFreeSnapshotVersion=f,this.resumeToken=g,this.expectedCount=h}withSequenceNumber(a){return new En(this.target,this.targetId,this.purpose,a,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(a,b){return new En(this.target,this.targetId,this.purpose,this.sequenceNumber,b,this.lastLimboFreeSnapshotVersion,a,null)}withExpectedCount(a){return new En(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,a)}withLastLimboFreeSnapshotVersion(a){return new En(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,a,this.resumeToken,this.expectedCount)}}class Eo{constructor(a){this.remoteSerializer=a}}function Ep(a,b){let c;if(b.document)c=Dz(a.remoteSerializer,b.document,!!b.hasCommittedMutations);else if(b.noDocument){let a=xp.fromSegments(b.noDocument.path),d=Eu(b.noDocument.readTime);c=AF.newNoDocument(a,d),b.hasCommittedMutations&&c.setHasCommittedMutations()}else{if(!b.unknownDocument)return wS(56709);let a=xp.fromSegments(b.unknownDocument.path),d=Eu(b.unknownDocument.version);c=AF.newUnknownDocument(a,d)}return b.readTime&&c.setReadTime(Es(b.readTime)),c}function Eq(a,b){let c=b.key,d={prefixPath:c.getCollectionPath().popLast().toArray(),collectionGroup:c.collectionGroup,documentId:c.path.lastSegment(),readTime:Er(b.readTime),hasCommittedMutations:b.hasCommittedMutations};if(b.isFoundDocument())d.document=Dy(a.remoteSerializer,b);else if(b.isNoDocument())d.noDocument={path:c.path.toArray(),readTime:Et(b.version)};else{if(!b.isUnknownDocument())return wS(57904,{document:b});d.unknownDocument={path:c.path.toArray(),version:Et(b.version)}}return d}function Er(a){let b=a.toTimestamp();return[b.seconds,b.nanoseconds]}function Es(a){let b=new xi(a[0],a[1]);return xj.fromTimestamp(b)}function Et(a){let b=a.toTimestamp();return{seconds:b.seconds,nanoseconds:b.nanoseconds}}function Eu(a){let b=new xi(a.seconds,a.nanoseconds);return xj.fromTimestamp(b)}function Ev(a,b,c){let d=c.baseMutations.map(b=>DG(a.remoteSerializer,b)),e=c.mutations.map(b=>DG(a.remoteSerializer,b));return{userId:b,batchId:c.batchId,localWriteTimeMs:c.localWriteTime.toMillis(),baseMutations:d,mutations:e}}function Ew(a,b){let c=(b.baseMutations||[]).map(b=>DH(a.remoteSerializer,b));for(let a=0;a<b.mutations.length-1;++a){let c=b.mutations[a];a+1<b.mutations.length&&void 0!==b.mutations[a+1].transform&&(c.updateTransforms=b.mutations[a+1].transform.fieldTransforms,b.mutations.splice(a+1,1),++a)}let d=b.mutations.map(b=>DH(a.remoteSerializer,b)),e=xi.fromMillis(b.localWriteTimeMs);return new CM(b.batchId,e,c,d)}function Ex(a){let b,c=Eu(a.readTime),d=void 0!==a.lastLimboFreeSnapshotVersion?Eu(a.lastLimboFreeSnapshotVersion):xj.min();return new En(b=Ez(a.query)?DP(a.query):DT(a.query),a.targetId,"TargetPurposeListen",a.lastListenSequenceNumber,c,d,zu.fromBase64String(a.resumeToken))}function Ey(a,b){let c,d=Et(b.snapshotVersion),e=Et(b.lastLimboFreeSnapshotVersion);c=Bg(b.target)?DO(a.remoteSerializer,b.target):DQ(a.remoteSerializer,b.target).queryTarget;let f=b.resumeToken.toBase64();return{targetId:b.targetId,canonicalId:Bd(b.target),readTime:d,resumeToken:f,lastListenSequenceNumber:b.sequenceNumber,lastLimboFreeSnapshotVersion:e,query:c}}function Ez(a){return void 0!==a.documents}function EA(a){return{id:a.bundleId,createTime:Eu(a.createTime),version:a.version}}function EB(a){return{bundleId:a.id,createTime:Et(Dm(a.createTime)),version:a.version}}function EC(a){return{name:a.name,query:EE(a.bundledQuery),readTime:Eu(a.readTime)}}function ED(a){return{name:a.name,readTime:Et(Dm(a.readTime)),bundledQuery:a.bundledQuery}}function EE(a){let b=DS({parent:a.parent,structuredQuery:a.structuredQuery});return"LAST"===a.limitType?BE(b,b.limit,"L"):b}function EF(a){return{name:a.name,query:EE(a.bundledQuery),readTime:Dm(a.readTime)}}function EG(a){return{id:a.id,version:a.version,createTime:Dm(a.createTime)}}function EH(a,b){return new CO(b.largestBatchId,DH(a.remoteSerializer,b.overlayMutation))}function EI(a,b,c){let[d,e,f]=EJ(b,c.mutation.key);return{userId:b,collectionPath:e,documentId:f,collectionGroup:c.mutation.key.getCollectionGroup(),largestBatchId:c.largestBatchId,overlayMutation:DG(a.remoteSerializer,c.mutation)}}function EJ(a,b){let c=b.path.lastSegment();return[a,x4(b.path.popLast()),c]}function EK(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])}}function EL(a,b){let c=b?new xA(b.sequenceNumber,new xD(Eu(b.readTime),new xp(x7(b.documentKey)),b.largestBatchId)):xA.empty(),d=a.fields.map(([a,b])=>new xy(xo.fromServerFormat(a),b));return new xs(a.indexId,a.collectionGroup,d,c)}function EM(a,b,c,d){return{indexId:a,uid:b,sequenceNumber:c,readTime:Et(d.readTime),documentKey:x4(d.documentKey.path),largestBatchId:d.largestBatchId}}class EN{getBundleMetadata(a,b){return EO(a).get(b).next(a=>{if(a)return EA(a)})}saveBundleMetadata(a,b){return EO(a).put(EB(b))}getNamedQuery(a,b){return EP(a).get(b).next(a=>{if(a)return EC(a)})}saveNamedQuery(a,b){return EP(a).put(ED(b))}}function EO(a){return ze(a,yI)}function EP(a){return ze(a,yK)}class EQ{constructor(a,b){this.serializer=a,this.userId=b}static forUser(a,b){return new EQ(a,b.uid||"")}getOverlay(a,b){return ER(a).get(EJ(this.userId,b)).next(a=>a?EH(this.serializer,a):null)}getOverlays(a,b){let c=BZ();return xI.forEach(b,b=>this.getOverlay(a,b).next(a=>{null!==a&&c.set(b,a)})).next(()=>c)}saveOverlays(a,b,c){let d=[];return c.forEach((c,e)=>{let f=new CO(b,e);d.push(this.saveOverlay(a,f))}),xI.waitFor(d)}removeOverlaysForBatchId(a,b,c){let d=new Set;b.forEach(a=>d.add(x4(a.getCollectionPath())));let e=[];return d.forEach(b=>{let d=IDBKeyRange.bound([this.userId,b,c],[this.userId,b,c+1],!1,!0);e.push(ER(a).deleteAll(y$,d))}),xI.waitFor(e)}getOverlaysForCollection(a,b,c){let d=BZ(),e=x4(b),f=IDBKeyRange.bound([this.userId,e,c],[this.userId,e,1/0],!0);return ER(a).loadAll(y$,f).next(a=>{for(let b of a){let a=EH(this.serializer,b);d.set(a.getKey(),a)}return d})}getOverlaysForCollectionGroup(a,b,c,d){let e,f=BZ(),g=IDBKeyRange.bound([this.userId,b,c],[this.userId,b,1/0],!0);return ER(a).iterate({index:y0,range:g},(a,b,c)=>{let g=EH(this.serializer,b);f.size()<d||g.largestBatchId===e?(f.set(g.getKey(),g),e=g.largestBatchId):c.done()}).next(()=>f)}saveOverlay(a,b){return ER(a).put(EI(this.serializer,this.userId,b))}}function ER(a){return ze(a,yY)}class ES{globalsStore(a){return ze(a,y2)}getSessionToken(a){return this.globalsStore(a).get("sessionToken").next(a=>{let b=null==a?void 0:a.value;return b?zu.fromUint8Array(b):zu.EMPTY_BYTE_STRING})}setSessionToken(a,b){return this.globalsStore(a).put({name:"sessionToken",value:b.toUint8Array()})}}let ET=5,EU=10,EV=13,EW=15,EX=20,EY=25,EZ=30,E$=37,E_=45,E0=50,E1=53,E2=55,E3=60,E4=2;class E5{constructor(){}writeIndexValue(a,b){this.writeIndexValueAux(a,b),b.writeInfinity()}writeIndexValueAux(a,b){if("nullValue"in a)this.writeValueTypeLabel(b,ET);else if("booleanValue"in a)this.writeValueTypeLabel(b,EU),b.writeNumber(+!!a.booleanValue);else if("integerValue"in a)this.writeValueTypeLabel(b,EW),b.writeNumber(zz(a.integerValue));else if("doubleValue"in a){let c=zz(a.doubleValue);isNaN(c)?this.writeValueTypeLabel(b,EV):(this.writeValueTypeLabel(b,EW),zP(c)?b.writeNumber(0):b.writeNumber(c))}else if("timestampValue"in a){let c=a.timestampValue;this.writeValueTypeLabel(b,EX),"string"==typeof c&&(c=zy(c)),b.writeString(`${c.seconds||""}`),b.writeNumber(c.nanos||0)}else if("stringValue"in a)this.writeIndexString(a.stringValue,b),this.writeTruncationMarker(b);else if("bytesValue"in a)this.writeValueTypeLabel(b,EZ),b.writeBytes(zA(a.bytesValue)),this.writeTruncationMarker(b);else if("referenceValue"in a)this.writeIndexEntityRef(a.referenceValue,b);else if("geoPointValue"in a){let c=a.geoPointValue;this.writeValueTypeLabel(b,E_),b.writeNumber(c.latitude||0),b.writeNumber(c.longitude||0)}else"mapValue"in a?Ax(a)?this.writeValueTypeLabel(b,Number.MAX_SAFE_INTEGER):Av(a)?this.writeIndexVector(a.mapValue,b):(this.writeIndexMap(a.mapValue,b),this.writeTruncationMarker(b)):"arrayValue"in a?(this.writeIndexArray(a.arrayValue,b),this.writeTruncationMarker(b)):wS(19022,{indexValue:a})}writeIndexString(a,b){this.writeValueTypeLabel(b,EY),this.writeUnlabeledIndexString(a,b)}writeUnlabeledIndexString(a,b){b.writeString(a)}writeIndexMap(a,b){let c=a.fields||{};for(let a of(this.writeValueTypeLabel(b,E2),Object.keys(c)))this.writeIndexString(a,b),this.writeIndexValueAux(c[a],b)}writeIndexVector(a,b){var c,d;let e=a.fields||{};this.writeValueTypeLabel(b,E1);let f=zV,g=(null==(d=null==(c=e[f].arrayValue)?void 0:c.values)?void 0:d.length)||0;this.writeValueTypeLabel(b,EW),b.writeNumber(zz(g)),this.writeIndexString(f,b),this.writeIndexValueAux(e[f],b)}writeIndexArray(a,b){let c=a.values||[];for(let a of(this.writeValueTypeLabel(b,E0),c))this.writeIndexValueAux(a,b)}writeIndexEntityRef(a,b){this.writeValueTypeLabel(b,E$),xp.fromName(a).path.forEach(a=>{this.writeValueTypeLabel(b,E3),this.writeUnlabeledIndexString(a,b)})}writeValueTypeLabel(a,b){a.writeNumber(b)}writeTruncationMarker(a){a.writeNumber(E4)}}E5.INSTANCE=new E5;let E6="\uD800",E7="\uDBFF",E8=0,E9=255,Fa=1,Fb=255,Fc=255,Fd=0,Fe=64,Ff=8,Fg=1024;function Fh(a){let b=new DataView(new ArrayBuffer(8));return b.setFloat64(0,a,!1),new Uint8Array(b.buffer)}function Fi(a){if(0===a)return 8;let b=0;return a>>4==0&&(b+=4,a<<=4),a>>6==0&&(b+=2,a<<=2),a>>7==0&&(b+=1),b}function Fj(a){let b=0;for(let c=0;c<8;++c){let d=Fi(255&a[c]);if(b+=d,8!==d)break}return b}function Fk(a){return Math.ceil((Fe-Fj(a))/Ff)}class Fl{constructor(){this.buffer=new Uint8Array(Fg),this.position=0}writeBytesAscending(a){let b=a[Symbol.iterator](),c=b.next();for(;!c.done;)this.writeByteAscending(c.value),c=b.next();this.writeSeparatorAscending()}writeBytesDescending(a){let b=a[Symbol.iterator](),c=b.next();for(;!c.done;)this.writeByteDescending(c.value),c=b.next();this.writeSeparatorDescending()}writeUtf8Ascending(a){for(let b of a){let a=b.charCodeAt(0);if(a<128)this.writeByteAscending(a);else if(a<2048)this.writeByteAscending(960|a>>>6),this.writeByteAscending(128|63&a);else if(b<E6||E7<b)this.writeByteAscending(480|a>>>12),this.writeByteAscending(128|63&a>>>6),this.writeByteAscending(128|63&a);else{let a=b.codePointAt(0);this.writeByteAscending(240|a>>>18),this.writeByteAscending(128|63&a>>>12),this.writeByteAscending(128|63&a>>>6),this.writeByteAscending(128|63&a)}}this.writeSeparatorAscending()}writeUtf8Descending(a){for(let b of a){let a=b.charCodeAt(0);if(a<128)this.writeByteDescending(a);else if(a<2048)this.writeByteDescending(960|a>>>6),this.writeByteDescending(128|63&a);else if(b<E6||E7<b)this.writeByteDescending(480|a>>>12),this.writeByteDescending(128|63&a>>>6),this.writeByteDescending(128|63&a);else{let a=b.codePointAt(0);this.writeByteDescending(240|a>>>18),this.writeByteDescending(128|63&a>>>12),this.writeByteDescending(128|63&a>>>6),this.writeByteDescending(128|63&a)}}this.writeSeparatorDescending()}writeNumberAscending(a){let b=this.toOrderedBits(a),c=Fk(b);this.ensureAvailable(1+c),this.buffer[this.position++]=255&c;for(let a=b.length-c;a<b.length;++a)this.buffer[this.position++]=255&b[a]}writeNumberDescending(a){let b=this.toOrderedBits(a),c=Fk(b);this.ensureAvailable(1+c),this.buffer[this.position++]=~(255&c);for(let a=b.length-c;a<b.length;++a)this.buffer[this.position++]=~(255&b[a])}writeInfinityAscending(){this.writeEscapedByteAscending(Fb),this.writeEscapedByteAscending(Fc)}writeInfinityDescending(){this.writeEscapedByteDescending(Fb),this.writeEscapedByteDescending(Fc)}reset(){this.position=0}seed(a){this.ensureAvailable(a.length),this.buffer.set(a,this.position),this.position+=a.length}encodedBytes(){return this.buffer.slice(0,this.position)}toOrderedBits(a){let b=Fh(a),c=(128&b[0])!=0;b[0]^=c?255:128;for(let a=1;a<b.length;++a)b[a]^=255*!!c;return b}writeByteAscending(a){let b=255&a;b===E8?(this.writeEscapedByteAscending(E8),this.writeEscapedByteAscending(E9)):b===Fb?(this.writeEscapedByteAscending(Fb),this.writeEscapedByteAscending(Fd)):this.writeEscapedByteAscending(b)}writeByteDescending(a){let b=255&a;b===E8?(this.writeEscapedByteDescending(E8),this.writeEscapedByteDescending(E9)):b===Fb?(this.writeEscapedByteDescending(Fb),this.writeEscapedByteDescending(Fd)):this.writeEscapedByteDescending(a)}writeSeparatorAscending(){this.writeEscapedByteAscending(E8),this.writeEscapedByteAscending(Fa)}writeSeparatorDescending(){this.writeEscapedByteDescending(E8),this.writeEscapedByteDescending(Fa)}writeEscapedByteAscending(a){this.ensureAvailable(1),this.buffer[this.position++]=a}writeEscapedByteDescending(a){this.ensureAvailable(1),this.buffer[this.position++]=~a}ensureAvailable(a){let b=a+this.position;if(b<=this.buffer.length)return;let c=2*this.buffer.length;c<b&&(c=b);let d=new Uint8Array(c);d.set(this.buffer),this.buffer=d}}class Fm{constructor(a){this.orderedCode=a}writeBytes(a){this.orderedCode.writeBytesAscending(a)}writeString(a){this.orderedCode.writeUtf8Ascending(a)}writeNumber(a){this.orderedCode.writeNumberAscending(a)}writeInfinity(){this.orderedCode.writeInfinityAscending()}}class Fn{constructor(a){this.orderedCode=a}writeBytes(a){this.orderedCode.writeBytesDescending(a)}writeString(a){this.orderedCode.writeUtf8Descending(a)}writeNumber(a){this.orderedCode.writeNumberDescending(a)}writeInfinity(){this.orderedCode.writeInfinityDescending()}}class Fo{constructor(){this.orderedCode=new Fl,this.ascending=new Fm(this.orderedCode),this.descending=new Fn(this.orderedCode)}seed(a){this.orderedCode.seed(a)}forKind(a){return 0===a?this.ascending:this.descending}encodedBytes(){return this.orderedCode.encodedBytes()}reset(){this.orderedCode.reset()}}class Fp{constructor(a,b,c,d){this._indexId=a,this._documentKey=b,this._arrayValue=c,this._directionalValue=d}successor(){let a=this._directionalValue.length,b=0===a||255===this._directionalValue[a-1]?a+1:a,c=new Uint8Array(b);return c.set(this._directionalValue,0),b!==a?c.set([0],this._directionalValue.length):++c[c.length-1],new Fp(this._indexId,this._documentKey,this._arrayValue,c)}dbIndexEntry(a,b,c){return{indexId:this._indexId,uid:a,arrayValue:Fs(this._arrayValue),directionalValue:Fs(this._directionalValue),orderedDocumentKey:Fs(b),documentKey:c.path.toArray()}}dbIndexEntryKey(a,b,c){let d=this.dbIndexEntry(a,b,c);return[d.indexId,d.uid,d.arrayValue,d.directionalValue,d.orderedDocumentKey,d.documentKey]}}function Fq(a,b){let c=a._indexId-b._indexId;return 0!==c||0!==(c=Fr(a._arrayValue,b._arrayValue))||0!==(c=Fr(a._directionalValue,b._directionalValue))?c:xp.comparator(a._documentKey,b._documentKey)}function Fr(a,b){for(let c=0;c<a.length&&c<b.length;++c){let d=a[c]-b[c];if(0!==d)return d}return a.length-b.length}function Fs(a){return vd()?Fu(a):a}function Ft(a){return"string"!=typeof a?a:Fv(a)}function Fu(a){let b="";for(let c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b}function Fv(a){let b=new Uint8Array(a.length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b}class Fw{constructor(a){for(let b of(this.inequalityFilters=new zn((a,b)=>xo.comparator(a.field,b.field)),this.collectionId=null!=a.collectionGroup?a.collectionGroup:a.path.lastSegment(),this.orderBys=a.orderBy,this.equalityFilters=[],a.filters)){let a=b;a.isInequality()?this.inequalityFilters=this.inequalityFilters.add(a):this.equalityFilters.push(a)}}get hasMultipleInequality(){return this.inequalityFilters.size>1}servedByIndex(a){if(wU(a.collectionGroup===this.collectionId,49279),this.hasMultipleInequality)return!1;let b=xt(a);if(void 0!==b&&!this.hasMatchingEqualityFilter(b))return!1;let c=xu(a),d=new Set,e=0,f=0;for(;e<c.length;++e)if(this.hasMatchingEqualityFilter(c[e]))d=d.add(c[e].fieldPath.canonicalString());else break;if(e===c.length)return!0;if(this.inequalityFilters.size>0){let a=this.inequalityFilters.getIterator().getNext();if(!d.has(a.field.canonicalString())){let b=c[e];if(!this.matchesFilter(a,b)||!this.matchesOrderBy(this.orderBys[f++],b))return!1}++e}for(;e<c.length;++e){let a=c[e];if(f>=this.orderBys.length||!this.matchesOrderBy(this.orderBys[f++],a))return!1}return!0}buildTargetIndex(){if(this.hasMultipleInequality)return null;let a=new zn(xo.comparator),b=[];for(let c of this.equalityFilters)if(!c.field.isKeyField())if("array-contains"===c.op||"array-contains-any"===c.op)b.push(new xy(c.field,2));else{if(a.has(c.field))continue;a=a.add(c.field),b.push(new xy(c.field,0))}for(let c of this.orderBys)!c.field.isKeyField()&&(a.has(c.field)||(a=a.add(c.field),b.push(new xy(c.field,+("asc"!==c.dir)))));return new xs(xs.UNKNOWN_ID,this.collectionId,b,xA.empty())}hasMatchingEqualityFilter(a){for(let b of this.equalityFilters)if(this.matchesFilter(b,a))return!0;return!1}matchesFilter(a,b){if(void 0===a||!a.field.isEqual(b.fieldPath))return!1;let c="array-contains"===a.op||"array-contains-any"===a.op;return 2===b.kind===c}matchesOrderBy(a,b){return!!a.field.isEqual(b.fieldPath)&&(0===b.kind&&"asc"===a.dir||1===b.kind&&"desc"===a.dir)}}function Fx(a){var b,c;if(wU(a instanceof AR||a instanceof AS,20012),a instanceof AR)if(!(a instanceof A8))return a;else{let d=(null==(c=null==(b=a.value.arrayValue)?void 0:b.values)?void 0:c.map(b=>AR.create(a.field,"==",b)))||[];return AS.create(d,"or")}let d=a.filters.map(a=>Fx(a));return AS.create(d,a.op)}function Fy(a){if(0===a.getFilters().length)return[];let b=FD(Fx(a));return(wU(FB(b),7391),Fz(b)||FA(b))?[b]:b.getFilters()}function Fz(a){return a instanceof AR}function FA(a){return a instanceof AS&&AV(a)}function FB(a){return Fz(a)||FA(a)||FC(a)}function FC(a){if(a instanceof AS&&AU(a)){for(let b of a.getFilters())if(!Fz(b)&&!FA(b))return!1;return!0}return!1}function FD(a){if(wU(a instanceof AR||a instanceof AS,34018),a instanceof AR)return a;if(1===a.filters.length)return FD(a.filters[0]);let b=a.filters.map(a=>FD(a)),c=AS.create(b,a.op);return FB(c=FI(c))?c:(wU(c instanceof AS,64498),wU(AT(c),40251),wU(c.filters.length>1,57927),c.filters.reduce((a,b)=>FE(a,b)))}function FE(a,b){let c;return wU(a instanceof AR||a instanceof AS,38388),wU(b instanceof AR||b instanceof AS,25473),FI(c=a instanceof AR?b instanceof AR?FF(a,b):FH(a,b):b instanceof AR?FH(b,a):FG(a,b))}function FF(a,b){return AS.create([a,b],"and")}function FG(a,b){if(wU(a.filters.length>0&&b.filters.length>0,48005),AT(a)&&AT(b))return A_(a,b.getFilters());let c=AU(a)?a:b,d=AU(a)?b:a,e=c.filters.map(a=>FE(a,d));return AS.create(e,"or")}function FH(a,b){if(AT(b))return A_(b,a.getFilters());{let c=b.filters.map(b=>FE(a,b));return AS.create(c,"or")}}function FI(a){if(wU(a instanceof AR||a instanceof AS,11850),a instanceof AR)return a;let b=a.getFilters();if(1===b.length)return FI(b[0]);if(AW(a))return a;let c=b.map(a=>FI(a)),d=[];return(c.forEach(b=>{b instanceof AR?d.push(b):b instanceof AS&&(b.op===a.op?d.push(...b.filters):d.push(b))}),1===d.length)?d[0]:AS.create(d,a.op)}class FJ{constructor(){this.collectionParentIndex=new FK}addToCollectionParentIndex(a,b){return this.collectionParentIndex.add(b),xI.resolve()}getCollectionParents(a,b){return xI.resolve(this.collectionParentIndex.getEntries(b))}addFieldIndex(a,b){return xI.resolve()}deleteFieldIndex(a,b){return xI.resolve()}deleteAllFieldIndexes(a){return xI.resolve()}createTargetIndexes(a,b){return xI.resolve()}getDocumentsMatchingTarget(a,b){return xI.resolve(null)}getIndexType(a,b){return xI.resolve(0)}getFieldIndexes(a,b){return xI.resolve([])}getNextCollectionGroupToUpdate(a){return xI.resolve(null)}getMinOffset(a,b){return xI.resolve(xD.min())}getMinOffsetFromCollectionGroup(a,b){return xI.resolve(xD.min())}updateCollectionGroup(a,b,c){return xI.resolve()}updateIndexEntries(a,b){return xI.resolve()}}class FK{constructor(){this.index={}}add(a){let b=a.lastSegment(),c=a.popLast(),d=this.index[b]||new zn(xm.comparator),e=!d.has(c);return this.index[b]=d.add(c),e}has(a){let b=a.lastSegment(),c=a.popLast(),d=this.index[b];return d&&d.has(c)}getEntries(a){return(this.index[a]||new zn(xm.comparator)).toArray()}}let FL="IndexedDbIndexManager",FM=new Uint8Array(0);class FN{constructor(a,b){this.databaseId=b,this.collectionParentsCache=new FK,this.targetToDnfSubTargets=new BS(a=>Bd(a),(a,b)=>Bf(a,b)),this.uid=a.uid||""}addToCollectionParentIndex(a,b){if(!this.collectionParentsCache.has(b)){let c=b.lastSegment(),d=b.popLast();a.addOnCommittedListener(()=>{this.collectionParentsCache.add(b)});let e={collectionId:c,parent:x4(d)};return FO(a).put(e)}return xI.resolve()}getCollectionParents(a,b){let c=[],d=IDBKeyRange.bound([b,""],[xf(b),""],!1,!0);return FO(a).loadAll(d).next(a=>{for(let d of a){if(d.collectionId!==b)break;c.push(x7(d.parent))}return c})}addFieldIndex(a,b){let c=FQ(a),d=EK(b);delete d.indexId;let e=c.add(d);if(!b.indexState)return e.next();{let c=FR(a);return e.next(a=>{c.put(EM(a,this.uid,b.indexState.sequenceNumber,b.indexState.offset))})}}deleteFieldIndex(a,b){let c=FQ(a),d=FR(a),e=FP(a);return c.delete(b.indexId).next(()=>d.delete(IDBKeyRange.bound([b.indexId],[b.indexId+1],!1,!0))).next(()=>e.delete(IDBKeyRange.bound([b.indexId],[b.indexId+1],!1,!0)))}deleteAllFieldIndexes(a){let b=FQ(a),c=FP(a),d=FR(a);return b.deleteAll().next(()=>c.deleteAll()).next(()=>d.deleteAll())}createTargetIndexes(a,b){return xI.forEach(this.getSubTargets(b),b=>this.getIndexType(a,b).next(c=>{if(0===c||1===c){let c=new Fw(b).buildTargetIndex();if(null!=c)return this.addFieldIndex(a,c)}}))}getDocumentsMatchingTarget(a,b){let c=FP(a),d=!0,e=new Map;return xI.forEach(this.getSubTargets(b),b=>this.getFieldIndex(a,b).next(a=>{d&&(d=!!a),e.set(b,a)})).next(()=>{if(!d)return xI.resolve(null);{let a=B3(),d=[];return xI.forEach(e,(e,f)=>{wO(FL,`Using index ${xx(e)} to execute ${Bd(b)}`);let g=Bi(f,e),h=Bj(f,e),i=Bk(f,e),j=Bl(f,e),k=this.encodeBound(e,f,i),l=this.encodeBound(e,f,j),m=this.encodeValues(e,f,h),n=this.generateIndexRanges(e.indexId,g,k,i.inclusive,l,j.inclusive,m);return xI.forEach(n,e=>c.loadFirst(e,b.limit).next(b=>{b.forEach(b=>{let c=xp.fromSegments(b.documentKey);a.has(c)||(a=a.add(c),d.push(c))})}))}).next(()=>d)}})}getSubTargets(a){let b=this.targetToDnfSubTargets.get(a);return b||(b=0===a.filters.length?[a]:Fy(AS.create(a.filters,"and")).map(b=>Bc(a.path,a.collectionGroup,a.orderBy,b.getFilters(),a.limit,a.startAt,a.endAt)),this.targetToDnfSubTargets.set(a,b)),b}generateIndexRanges(a,b,c,d,e,f,g){let h=(null!=b?b.length:1)*Math.max(c.length,e.length),i=h/(null!=b?b.length:1),j=[];for(let k=0;k<h;++k){let h=b?this.encodeSingleElement(b[k/i]):FM,l=this.generateLowerBound(a,h,c[k%i],d),m=this.generateUpperBound(a,h,e[k%i],f),n=g.map(b=>this.generateLowerBound(a,h,b,!0));j.push(...this.createRange(l,m,n))}return j}generateLowerBound(a,b,c,d){let e=new Fp(a,xp.empty(),b,c);return d?e:e.successor()}generateUpperBound(a,b,c,d){let e=new Fp(a,xp.empty(),b,c);return d?e.successor():e}getFieldIndex(a,b){let c=new Fw(b),d=null!=b.collectionGroup?b.collectionGroup:b.path.lastSegment();return this.getFieldIndexes(a,d).next(a=>{let b=null;for(let d of a)c.servedByIndex(d)&&(!b||d.fields.length>b.fields.length)&&(b=d);return b})}getIndexType(a,b){let c=2,d=this.getSubTargets(b);return xI.forEach(d,b=>this.getFieldIndex(a,b).next(a=>{a?0!==c&&a.fields.length<Bo(b)&&(c=1):c=0})).next(()=>Bp(b)&&d.length>1&&2===c?1:c)}encodeDirectionalElements(a,b){let c=new Fo;for(let d of xu(a)){let a=b.data.field(d.fieldPath);if(null==a)return null;let e=c.forKind(d.kind);E5.INSTANCE.writeIndexValue(a,e)}return c.encodedBytes()}encodeSingleElement(a){let b=new Fo;return E5.INSTANCE.writeIndexValue(a,b.forKind(0)),b.encodedBytes()}encodeDirectionalKey(a,b){let c=new Fo;return E5.INSTANCE.writeIndexValue(An(this.databaseId,b),c.forKind(xv(a))),c.encodedBytes()}encodeValues(a,b,c){if(null===c)return[];let d=[];d.push(new Fo);let e=0;for(let f of xu(a)){let a=c[e++];for(let c of d)if(this.isInFilter(b,f.fieldPath)&&Ar(a))d=this.expandIndexValues(d,f,a);else{let b=c.forKind(f.kind);E5.INSTANCE.writeIndexValue(a,b)}}return this.getEncodedBytes(d)}encodeBound(a,b,c){return this.encodeValues(a,b,c.position)}getEncodedBytes(a){let b=[];for(let c=0;c<a.length;++c)b[c]=a[c].encodedBytes();return b}expandIndexValues(a,b,c){let d=[...a],e=[];for(let a of c.arrayValue.values||[])for(let c of d){let d=new Fo;d.seed(c.encodedBytes()),E5.INSTANCE.writeIndexValue(a,d.forKind(b.kind)),e.push(d)}return e}isInFilter(a,b){return!!a.filters.find(a=>a instanceof AR&&a.field.isEqual(b)&&("in"===a.op||"not-in"===a.op))}getFieldIndexes(a,b){let c=FQ(a),d=FR(a);return(b?c.loadAll(yO,IDBKeyRange.bound(b,b)):c.loadAll()).next(a=>{let b=[];return xI.forEach(a,a=>d.get([a.indexId,this.uid]).next(c=>{b.push(EL(a,c))})).next(()=>b)})}getNextCollectionGroupToUpdate(a){return this.getFieldIndexes(a).next(a=>0===a.length?null:(a.sort((a,b)=>{let c=a.indexState.sequenceNumber-b.indexState.sequenceNumber;return 0!==c?c:xa(a.collectionGroup,b.collectionGroup)}),a[0].collectionGroup))}updateCollectionGroup(a,b,c){let d=FQ(a),e=FR(a);return this.getNextSequenceNumber(a).next(a=>d.loadAll(yO,IDBKeyRange.bound(b,b)).next(b=>xI.forEach(b,b=>e.put(EM(b.indexId,this.uid,a,c)))))}updateIndexEntries(a,b){let c=new Map;return xI.forEach(b,(b,d)=>{let e=c.get(b.collectionGroup);return(e?xI.resolve(e):this.getFieldIndexes(a,b.collectionGroup)).next(e=>(c.set(b.collectionGroup,e),xI.forEach(e,c=>this.getExistingIndexEntries(a,b,c).next(b=>{let e=this.computeIndexEntries(d,c);return b.isEqual(e)?xI.resolve():this.updateEntries(a,d,c,b,e)}))))})}addIndexEntry(a,b,c,d){return FP(a).put(d.dbIndexEntry(this.uid,this.encodeDirectionalKey(c,b.key),b.key))}deleteIndexEntry(a,b,c,d){return FP(a).delete(d.dbIndexEntryKey(this.uid,this.encodeDirectionalKey(c,b.key),b.key))}getExistingIndexEntries(a,b,c){let d=FP(a),e=new zn(Fq);return d.iterate({index:yW,range:IDBKeyRange.only([c.indexId,this.uid,Fs(this.encodeDirectionalKey(c,b))])},(a,d)=>{e=e.add(new Fp(c.indexId,b,Ft(d.arrayValue),Ft(d.directionalValue)))}).next(()=>e)}computeIndexEntries(a,b){let c=new zn(Fq),d=this.encodeDirectionalElements(b,a);if(null==d)return c;let e=xt(b);if(null!=e){let f=a.data.field(e.fieldPath);if(Ar(f))for(let e of f.arrayValue.values||[])c=c.add(new Fp(b.indexId,a.key,this.encodeSingleElement(e),d))}else c=c.add(new Fp(b.indexId,a.key,FM,d));return c}updateEntries(a,b,c,d,e){wO(FL,"Updating index entries for document '%s'",b.key);let f=[];return zp(d,e,Fq,d=>{f.push(this.addIndexEntry(a,b,c,d))},d=>{f.push(this.deleteIndexEntry(a,b,c,d))}),xI.waitFor(f)}getNextSequenceNumber(a){let b=1;return FR(a).iterate({index:yS,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(a,c,d)=>{d.done(),b=c.sequenceNumber+1}).next(()=>b)}createRange(a,b,c){c=c.sort((a,b)=>Fq(a,b)).filter((a,b,c)=>!b||0!==Fq(a,c[b-1]));let d=[];for(let e of(d.push(a),c)){let c=Fq(e,a),f=Fq(e,b);if(0===c)d[0]=a.successor();else if(c>0&&f<0)d.push(e),d.push(e.successor());else if(f>0)break}d.push(b);let e=[];for(let a=0;a<d.length;a+=2){if(this.isRangeMatchable(d[a],d[a+1]))return[];let b=d[a].dbIndexEntryKey(this.uid,FM,xp.empty()),c=d[a+1].dbIndexEntryKey(this.uid,FM,xp.empty());e.push(IDBKeyRange.bound(b,c))}return e}isRangeMatchable(a,b){return Fq(a,b)>0}getMinOffsetFromCollectionGroup(a,b){return this.getFieldIndexes(a,b).next(FS)}getMinOffset(a,b){return xI.mapArray(this.getSubTargets(b),b=>this.getFieldIndex(a,b).next(a=>a||wS(44426))).next(FS)}}function FO(a){return ze(a,yE)}function FP(a){return ze(a,yU)}function FQ(a){return ze(a,yM)}function FR(a){return ze(a,yQ)}function FS(a){wU(0!==a.length,28825);let b=a[0].indexState.offset,c=b.largestBatchId;for(let d=1;d<a.length;d++){let e=a[d].indexState.offset;0>xE(e,b)&&(b=e),c<e.largestBatchId&&(c=e.largestBatchId)}return new xD(b.readTime,b.documentKey,c)}function FT(a,b,c){let d=a.store(yd),e=a.store(yl),f=[],g=IDBKeyRange.only(c.batchId),h=0,i=d.iterate({range:g},(a,b,c)=>(h++,c.delete()));f.push(i.next(()=>{wU(1===h,47070,{batchId:c.batchId})}));let j=[];for(let a of c.mutations){let d=yj(b,a.key.path,c.batchId);f.push(e.delete(d)),j.push(a.key)}return xI.waitFor(f).next(()=>j)}function FU(a){let b;if(!a)return 0;if(a.document)b=a.document;else if(a.unknownDocument)b=a.unknownDocument;else if(a.noDocument)b=a.noDocument;else throw wS(14731);return JSON.stringify(b).length}class FV{constructor(a,b,c,d){this.userId=a,this.serializer=b,this.indexManager=c,this.referenceDelegate=d,this.documentKeysByBatchId={}}static forUser(a,b,c,d){return wU(""!==a.uid,64387),new FV(a.isAuthenticated()?a.uid:"",b,c,d)}checkEmpty(a){let b=!0,c=IDBKeyRange.bound([this.userId,-1/0],[this.userId,1/0]);return FY(a).iterate({index:yf,range:c},(a,c,d)=>{b=!1,d.done()}).next(()=>b)}addMutationBatch(a,b,c,d){let e=FZ(a),f=FY(a);return f.add({}).next(g=>{wU("number"==typeof g,49019);let h=new CM(g,b,c,d),i=Ev(this.serializer,this.userId,h),j=[],k=new zn((a,b)=>xa(a.canonicalString(),b.canonicalString()));for(let a of d){let b=yj(this.userId,a.key.path,g);k=k.add(a.key.path.popLast()),j.push(f.put(i)),j.push(e.put(b,yk))}return k.forEach(b=>{j.push(this.indexManager.addToCollectionParentIndex(a,b))}),a.addOnCommittedListener(()=>{this.documentKeysByBatchId[g]=h.keys()}),xI.waitFor(j).next(()=>h)})}lookupMutationBatch(a,b){return FY(a).get(b).next(a=>a?(wU(a.userId===this.userId,48,"Unexpected user for mutation batch",{userId:a.userId,batchId:b}),Ew(this.serializer,a)):null)}lookupMutationKeys(a,b){return this.documentKeysByBatchId[b]?xI.resolve(this.documentKeysByBatchId[b]):this.lookupMutationBatch(a,b).next(a=>{if(!a)return null;{let c=a.keys();return this.documentKeysByBatchId[b]=c,c}})}getNextMutationBatchAfterBatchId(a,b){let c=b+1,d=IDBKeyRange.lowerBound([this.userId,c]),e=null;return FY(a).iterate({index:yf,range:d},(a,b,d)=>{b.userId===this.userId&&(wU(b.batchId>=c,47524,{nextBatchId:c}),e=Ew(this.serializer,b)),d.done()}).next(()=>e)}getHighestUnacknowledgedBatchId(a){let b=IDBKeyRange.upperBound([this.userId,1/0]),c=zN;return FY(a).iterate({index:yf,range:b,reverse:!0},(a,b,d)=>{c=b.batchId,d.done()}).next(()=>c)}getAllMutationBatches(a){let b=IDBKeyRange.bound([this.userId,zN],[this.userId,1/0]);return FY(a).loadAll(yf,b).next(a=>a.map(a=>Ew(this.serializer,a)))}getAllMutationBatchesAffectingDocumentKey(a,b){let c=yi(this.userId,b.path),d=IDBKeyRange.lowerBound(c),e=[];return FZ(a).iterate({range:d},(c,d,f)=>{let[g,h,i]=c,j=x7(h);return g===this.userId&&b.path.isEqual(j)?FY(a).get(i).next(a=>{if(!a)throw wS(61480,{indexKey:c,batchId:i});wU(a.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:a.userId,batchId:i}),e.push(Ew(this.serializer,a))}):void f.done()}).next(()=>e)}getAllMutationBatchesAffectingDocumentKeys(a,b){let c=new zn(xa),d=[];return b.forEach(b=>{let e=yi(this.userId,b.path),f=IDBKeyRange.lowerBound(e),g=FZ(a).iterate({range:f},(a,d,e)=>{let[f,g,h]=a,i=x7(g);if(f!==this.userId||!b.path.isEqual(i))return void e.done();c=c.add(h)});d.push(g)}),xI.waitFor(d).next(()=>this.lookupMutationBatches(a,c))}getAllMutationBatchesAffectingQuery(a,b){let c=b.path,d=c.length+1,e=yi(this.userId,c),f=IDBKeyRange.lowerBound(e),g=new zn(xa);return FZ(a).iterate({range:f},(a,b,e)=>{let[f,h,i]=a,j=x7(h);if(f!==this.userId||!c.isPrefixOf(j))return void e.done();j.length===d&&(g=g.add(i))}).next(()=>this.lookupMutationBatches(a,g))}lookupMutationBatches(a,b){let c=[],d=[];return b.forEach(b=>{d.push(FY(a).get(b).next(a=>{if(null===a)throw wS(35274,{batchId:b});wU(a.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:a.userId,batchId:b}),c.push(Ew(this.serializer,a))}))}),xI.waitFor(d).next(()=>c)}removeMutationBatch(a,b){return FT(a.simpleDbTransaction,this.userId,b).next(c=>(a.addOnCommittedListener(()=>{this.removeCachedMutationKeys(b.batchId)}),xI.forEach(c,b=>this.referenceDelegate.markPotentiallyOrphaned(a,b))))}removeCachedMutationKeys(a){delete this.documentKeysByBatchId[a]}performConsistencyCheck(a){return this.checkEmpty(a).next(b=>{if(!b)return xI.resolve();let c=IDBKeyRange.lowerBound(yh(this.userId)),d=[];return FZ(a).iterate({range:c},(a,b,c)=>{if(a[0]!==this.userId)return void c.done();{let b=x7(a[1]);d.push(b)}}).next(()=>{wU(0===d.length,56720,{danglingKeys:d.map(a=>a.canonicalString())})})})}containsKey(a,b){return FW(a,this.userId,b)}getMutationQueueMetadata(a){return F$(a).get(this.userId).next(a=>a||{userId:this.userId,lastAcknowledgedBatchId:zN,lastStreamToken:""})}}function FW(a,b,c){let d=yi(b,c.path),e=d[1],f=IDBKeyRange.lowerBound(d),g=!1;return FZ(a).iterate({range:f,keysOnly:!0},(a,c,d)=>{let[f,h,i]=a;f===b&&h===e&&(g=!0),d.done()}).next(()=>g)}function FX(a,b){let c=!1;return F$(a).iterateSerial(d=>FW(a,d,b).next(a=>(a&&(c=!0),xI.resolve(!a)))).next(()=>c)}function FY(a){return ze(a,yd)}function FZ(a){return ze(a,yl)}function F$(a){return ze(a,yb)}let F_=2;class F0{constructor(a){this.lastId=a}next(){return this.lastId+=F_,this.lastId}static forTargetCache(){return new F0(2-F_)}static forSyncEngine(){return new F0(1-F_)}}class F1{constructor(a,b){this.referenceDelegate=a,this.serializer=b}allocateTargetId(a){return this.retrieveMetadata(a).next(b=>{let c=new F0(b.highestTargetId);return b.highestTargetId=c.next(),this.saveMetadata(a,b).next(()=>b.highestTargetId)})}getLastRemoteSnapshotVersion(a){return this.retrieveMetadata(a).next(a=>xj.fromTimestamp(new xi(a.lastRemoteSnapshotVersion.seconds,a.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(a){return this.retrieveMetadata(a).next(a=>a.highestListenSequenceNumber)}setTargetsMetadata(a,b,c){return this.retrieveMetadata(a).next(d=>(d.highestListenSequenceNumber=b,c&&(d.lastRemoteSnapshotVersion=c.toTimestamp()),b>d.highestListenSequenceNumber&&(d.highestListenSequenceNumber=b),this.saveMetadata(a,d)))}addTargetData(a,b){return this.saveTargetData(a,b).next(()=>this.retrieveMetadata(a).next(c=>(c.targetCount+=1,this.updateMetadataFromTargetData(b,c),this.saveMetadata(a,c))))}updateTargetData(a,b){return this.saveTargetData(a,b)}removeTargetData(a,b){return this.removeMatchingKeysForTargetId(a,b.targetId).next(()=>F2(a).delete(b.targetId)).next(()=>this.retrieveMetadata(a)).next(b=>(wU(b.targetCount>0,8065),b.targetCount-=1,this.saveMetadata(a,b)))}removeTargets(a,b,c){let d=0,e=[];return F2(a).iterate((f,g)=>{let h=Ex(g);h.sequenceNumber<=b&&null===c.get(h.targetId)&&(d++,e.push(this.removeTargetData(a,h)))}).next(()=>xI.waitFor(e)).next(()=>d)}forEachTarget(a,b){return F2(a).iterate((a,c)=>{b(Ex(c))})}retrieveMetadata(a){return F3(a).get(yC).next(a=>(wU(null!==a,2888),a))}saveMetadata(a,b){return F3(a).put(yC,b)}saveTargetData(a,b){return F2(a).put(Ey(this.serializer,b))}updateMetadataFromTargetData(a,b){let c=!1;return a.targetId>b.highestTargetId&&(b.highestTargetId=a.targetId,c=!0),a.sequenceNumber>b.highestListenSequenceNumber&&(b.highestListenSequenceNumber=a.sequenceNumber,c=!0),c}getTargetCount(a){return this.retrieveMetadata(a).next(a=>a.targetCount)}getTargetData(a,b){let c=Bd(b),d=IDBKeyRange.bound([c,-1/0],[c,1/0]),e=null;return F2(a).iterate({range:d,index:yw},(a,c,d)=>{let f=Ex(c);Bf(b,f.target)&&(e=f,d.done())}).next(()=>e)}addMatchingKeys(a,b,c){let d=[],e=F4(a);return b.forEach(b=>{let f=x4(b.path);d.push(e.put({targetId:c,path:f})),d.push(this.referenceDelegate.addReference(a,c,b))}),xI.waitFor(d)}removeMatchingKeys(a,b,c){let d=F4(a);return xI.forEach(b,b=>{let e=x4(b.path);return xI.waitFor([d.delete([c,e]),this.referenceDelegate.removeReference(a,c,b)])})}removeMatchingKeysForTargetId(a,b){let c=F4(a),d=IDBKeyRange.bound([b],[b+1],!1,!0);return c.delete(d)}getMatchingKeysForTargetId(a,b){let c=IDBKeyRange.bound([b],[b+1],!1,!0),d=F4(a),e=B3();return d.iterate({range:c,keysOnly:!0},(a,b,c)=>{let d=new xp(x7(a[1]));e=e.add(d)}).next(()=>e)}containsKey(a,b){let c=x4(b.path),d=IDBKeyRange.bound([c],[xf(c)],!1,!0),e=0;return F4(a).iterate({index:yA,keysOnly:!0,range:d},([a,b],c,d)=>{0!==a&&(e++,d.done())}).next(()=>e>0)}getTargetDataForTarget(a,b){return F2(a).get(b).next(a=>a?Ex(a):null)}}function F2(a){return ze(a,yu)}function F3(a){return ze(a,yD)}function F4(a){return ze(a,yy)}let F5={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},F6=-1,F7=0x2800000;class F8{static withCacheSize(a){return new F8(a,F8.DEFAULT_COLLECTION_PERCENTILE,F8.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(a,b,c){this.cacheSizeCollectionThreshold=a,this.percentileToCollect=b,this.maximumSequenceNumbersToCollect=c}}F8.DEFAULT_COLLECTION_PERCENTILE=10,F8.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,F8.DEFAULT=new F8(F7,F8.DEFAULT_COLLECTION_PERCENTILE,F8.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),F8.DISABLED=new F8(F6,0,0);let F9="LruGarbageCollector",Ga=1048576,Gb=6e4,Gc=3e5;function Gd([a,b],[c,d]){let e=xa(a,c);return 0===e?xa(b,d):e}class Ge{constructor(a){this.maxElements=a,this.buffer=new zn(Gd),this.previousIndex=0}nextIndex(){return++this.previousIndex}addElement(a){let b=[a,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(b);else{let a=this.buffer.last();0>Gd(b,a)&&(this.buffer=this.buffer.delete(a).add(b))}}get maxValue(){return this.buffer.last()[0]}}class Gf{constructor(a,b,c){this.garbageCollector=a,this.asyncQueue=b,this.localStore=c,this.gcTask=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==F6&&this.scheduleGC(Gb)}stop(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)}get started(){return null!==this.gcTask}scheduleGC(a){wO(F9,`Garbage collection scheduled in ${a}ms`),this.gcTask=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",a,async()=>{this.gcTask=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(a){xQ(a)?wO(F9,"Ignoring IndexedDB error during garbage collection: ",a):await xH(a)}await this.scheduleGC(Gc)})}}class Gg{constructor(a,b){this.delegate=a,this.params=b}calculateTargetCount(a,b){return this.delegate.getSequenceNumberCount(a).next(a=>Math.floor(b/100*a))}nthSequenceNumber(a,b){if(0===b)return xI.resolve(x_.INVALID);let c=new Ge(b);return this.delegate.forEachTarget(a,a=>c.addElement(a.sequenceNumber)).next(()=>this.delegate.forEachOrphanedDocumentSequenceNumber(a,a=>c.addElement(a))).next(()=>c.maxValue)}removeTargets(a,b,c){return this.delegate.removeTargets(a,b,c)}removeOrphanedDocuments(a,b){return this.delegate.removeOrphanedDocuments(a,b)}collect(a,b){return this.params.cacheSizeCollectionThreshold===F6?(wO("LruGarbageCollector","Garbage collection skipped; disabled"),xI.resolve(F5)):this.getCacheSize(a).next(c=>c<this.params.cacheSizeCollectionThreshold?(wO("LruGarbageCollector",`Garbage collection skipped; Cache size ${c} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),F5):this.runGarbageCollection(a,b))}getCacheSize(a){return this.delegate.getCacheSize(a)}runGarbageCollection(a,b){let c,d,e,f,g,h,i,j=Date.now();return this.calculateTargetCount(a,this.params.percentileToCollect).next(b=>(b>this.params.maximumSequenceNumbersToCollect?(wO("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),d=this.params.maximumSequenceNumbersToCollect):d=b,f=Date.now(),this.nthSequenceNumber(a,d))).next(d=>(c=d,g=Date.now(),this.removeTargets(a,c,b))).next(b=>(e=b,h=Date.now(),this.removeOrphanedDocuments(a,c))).next(a=>(i=Date.now(),wN()<=m.DEBUG&&wO("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${f-j}ms
	Determined least recently used ${d} in ${g-f}ms
	Removed ${e} targets in ${h-g}ms
	Removed ${a} documents in ${i-h}ms
Total Duration: ${i-j}ms`),xI.resolve({didRun:!0,sequenceNumbersCollected:d,targetsRemoved:e,documentsRemoved:a})))}}function Gh(a,b){return new Gg(a,b)}class Gi{constructor(a,b){this.db=a,this.garbageCollector=Gh(this,b)}getSequenceNumberCount(a){let b=this.orphanedDocumentCount(a);return this.db.getTargetCache().getTargetCount(a).next(a=>b.next(b=>a+b))}orphanedDocumentCount(a){let b=0;return this.forEachOrphanedDocumentSequenceNumber(a,a=>{b++}).next(()=>b)}forEachTarget(a,b){return this.db.getTargetCache().forEachTarget(a,b)}forEachOrphanedDocumentSequenceNumber(a,b){return this.forEachOrphanedDocument(a,(a,c)=>b(c))}addReference(a,b,c){return Gl(a,c)}removeReference(a,b,c){return Gl(a,c)}removeTargets(a,b,c){return this.db.getTargetCache().removeTargets(a,b,c)}markPotentiallyOrphaned(a,b){return Gl(a,b)}isPinned(a,b){return FX(a,b)}removeOrphanedDocuments(a,b){let c=this.db.getRemoteDocumentCache().newChangeBuffer(),d=[],e=0;return this.forEachOrphanedDocument(a,(f,g)=>{if(g<=b){let b=this.isPinned(a,f).next(b=>{if(!b)return e++,c.getEntry(a,f).next(()=>(c.removeEntry(f,xj.min()),F4(a).delete(Gj(f))))});d.push(b)}}).next(()=>xI.waitFor(d)).next(()=>c.apply(a)).next(()=>e)}removeTarget(a,b){let c=b.withSequenceNumber(a.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(a,c)}updateLimboDocument(a,b){return Gl(a,b)}forEachOrphanedDocument(a,b){let c,d=F4(a),e=x_.INVALID;return d.iterate({index:yA},([a,d],{path:f,sequenceNumber:g})=>{0===a?(e!==x_.INVALID&&b(new xp(x7(c)),e),e=g,c=f):e=x_.INVALID}).next(()=>{e!==x_.INVALID&&b(new xp(x7(c)),e)})}getCacheSize(a){return this.db.getRemoteDocumentCache().getSize(a)}}function Gj(a){return[0,x4(a.path)]}function Gk(a,b){return{targetId:0,path:x4(a.path),sequenceNumber:b}}function Gl(a,b){return F4(a).put(Gk(b,a.currentSequenceNumber))}class Gm{constructor(){this.changes=new BS(a=>a.toString(),(a,b)=>a.isEqual(b)),this.changesApplied=!1}addEntry(a){this.assertNotApplied(),this.changes.set(a.key,a)}removeEntry(a,b){this.assertNotApplied(),this.changes.set(a,AF.newInvalidDocument(a).setReadTime(b))}getEntry(a,b){this.assertNotApplied();let c=this.changes.get(b);return void 0!==c?xI.resolve(c):this.getFromCache(a,b)}getEntries(a,b){return this.getAllFromCache(a,b)}apply(a){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(a)}assertNotApplied(){}}class Gn{constructor(a){this.serializer=a}setIndexManager(a){this.indexManager=a}addEntry(a,b,c){return Gr(a).put(c)}removeEntry(a,b,c){return Gr(a).delete(Gt(b,c))}updateMetadata(a,b){return this.getMetadata(a).next(c=>(c.byteSize+=b,this.setMetadata(a,c)))}getEntry(a,b){let c=AF.newInvalidDocument(b);return Gr(a).iterate({index:yo,range:IDBKeyRange.only(Gs(b))},(a,d)=>{c=this.maybeDecodeDocument(b,d)}).next(()=>c)}getSizedEntry(a,b){let c={size:0,document:AF.newInvalidDocument(b)};return Gr(a).iterate({index:yo,range:IDBKeyRange.only(Gs(b))},(a,d)=>{c={document:this.maybeDecodeDocument(b,d),size:FU(d)}}).next(()=>c)}getEntries(a,b){let c=BU();return this.forEachDbEntry(a,b,(a,b)=>{let d=this.maybeDecodeDocument(a,b);c=c.insert(a,d)}).next(()=>c)}getSizedEntries(a,b){let c=BU(),d=new zj(xp.comparator);return this.forEachDbEntry(a,b,(a,b)=>{let e=this.maybeDecodeDocument(a,b);c=c.insert(a,e),d=d.insert(a,FU(b))}).next(()=>({documents:c,sizeMap:d}))}forEachDbEntry(a,b,c){if(b.isEmpty())return xI.resolve();let d=new zn(Gv);b.forEach(a=>d=d.add(a));let e=IDBKeyRange.bound(Gs(d.first()),Gs(d.last())),f=d.getIterator(),g=f.getNext();return Gr(a).iterate({index:yo,range:e},(a,b,d)=>{let e=xp.fromSegments([...b.prefixPath,b.collectionGroup,b.documentId]);for(;g&&0>Gv(g,e);)c(g,null),g=f.getNext();g&&g.isEqual(e)&&(c(g,b),g=f.hasNext()?f.getNext():null),g?d.skip(Gs(g)):d.done()}).next(()=>{for(;g;)c(g,null),g=f.hasNext()?f.getNext():null})}getDocumentsMatchingQuery(a,b,c,d,e){let f=b.path,g=[f.popLast().toArray(),f.lastSegment(),Er(c.readTime),c.documentKey.path.isEmpty()?"":c.documentKey.path.lastSegment()],h=[f.popLast().toArray(),f.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Gr(a).loadAll(IDBKeyRange.bound(g,h,!0)).next(a=>{null==e||e.incrementDocumentReadCount(a.length);let c=BU();for(let e of a){let a=this.maybeDecodeDocument(xp.fromSegments(e.prefixPath.concat(e.collectionGroup,e.documentId)),e);a.isFoundDocument()&&(BK(b,a)||d.has(a.key))&&(c=c.insert(a.key,a))}return c})}getAllFromCollectionGroup(a,b,c,d){let e=BU(),f=Gu(b,c),g=Gu(b,xD.max());return Gr(a).iterate({index:yq,range:IDBKeyRange.bound(f,g,!0)},(a,b,c)=>{let f=this.maybeDecodeDocument(xp.fromSegments(b.prefixPath.concat(b.collectionGroup,b.documentId)),b);(e=e.insert(f.key,f)).size===d&&c.done()}).next(()=>e)}newChangeBuffer(a){return new Gp(this,!!a&&a.trackRemovals)}getSize(a){return this.getMetadata(a).next(a=>a.byteSize)}getMetadata(a){return Gq(a).get(yt).next(a=>(wU(!!a,20021),a))}setMetadata(a,b){return Gq(a).put(yt,b)}maybeDecodeDocument(a,b){if(b){let a=Ep(this.serializer,b);if(!(a.isNoDocument()&&a.version.isEqual(xj.min())))return a}return AF.newInvalidDocument(a)}}function Go(a){return new Gn(a)}class Gp extends Gm{constructor(a,b){super(),this.documentCache=a,this.trackRemovals=b,this.documentStates=new BS(a=>a.toString(),(a,b)=>a.isEqual(b))}applyChanges(a){let b=[],c=0,d=new zn((a,b)=>xa(a.canonicalString(),b.canonicalString()));return this.changes.forEach((e,f)=>{let g=this.documentStates.get(e);if(b.push(this.documentCache.removeEntry(a,e,g.readTime)),f.isValidDocument()){let h=Eq(this.documentCache.serializer,f);d=d.add(e.path.popLast());let i=FU(h);c+=i-g.size,b.push(this.documentCache.addEntry(a,e,h))}else if(c-=g.size,this.trackRemovals){let c=Eq(this.documentCache.serializer,f.convertToNoDocument(xj.min()));b.push(this.documentCache.addEntry(a,e,c))}}),d.forEach(c=>{b.push(this.documentCache.indexManager.addToCollectionParentIndex(a,c))}),b.push(this.documentCache.updateMetadata(a,c)),xI.waitFor(b)}getFromCache(a,b){return this.documentCache.getSizedEntry(a,b).next(a=>(this.documentStates.set(b,{size:a.size,readTime:a.document.readTime}),a.document))}getAllFromCache(a,b){return this.documentCache.getSizedEntries(a,b).next(({documents:a,sizeMap:b})=>(b.forEach((b,c)=>{this.documentStates.set(b,{size:c,readTime:a.get(b).readTime})}),a))}}function Gq(a){return ze(a,ys)}function Gr(a){return ze(a,ym)}function Gs(a){let b=a.path.toArray();return[b.slice(0,b.length-2),b[b.length-2],b[b.length-1]]}function Gt(a,b){let c=a.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],Er(b),c[c.length-1]]}function Gu(a,b){let c=b.documentKey.path.toArray();return[a,Er(b.readTime),c.slice(0,c.length-2),c.length>0?c[c.length-1]:""]}function Gv(a,b){let c=a.path.toArray(),d=b.path.toArray(),e=0;for(let a=0;a<c.length-2&&a<d.length-2;++a)if(e=xa(c[a],d[a]))return e;return(e=xa(c.length,d.length))||(e=xa(c[c.length-2],d[d.length-2]))?e:xa(c[c.length-1],d[d.length-1])}let Gw=18;class Gx{constructor(a,b){this.overlayedDocument=a,this.mutatedFields=b}}class Gy{constructor(a,b,c,d){this.remoteDocumentCache=a,this.mutationQueue=b,this.documentOverlayCache=c,this.indexManager=d}getDocument(a,b){let c=null;return this.documentOverlayCache.getOverlay(a,b).next(d=>(c=d,this.remoteDocumentCache.getEntry(a,b))).next(a=>(null!==c&&Cw(c.mutation,a,zr.empty(),xi.now()),a))}getDocuments(a,b){return this.remoteDocumentCache.getEntries(a,b).next(b=>this.getLocalViewOfDocuments(a,b,B3()).next(()=>b))}getLocalViewOfDocuments(a,b,c=B3()){let d=BZ();return this.populateOverlays(a,d,b).next(()=>this.computeViews(a,b,d,c).next(a=>{let b=BW();return a.forEach((a,c)=>{b=b.insert(a,c.overlayedDocument)}),b}))}getOverlayedDocuments(a,b){let c=BZ();return this.populateOverlays(a,c,b).next(()=>this.computeViews(a,b,c,B3()))}populateOverlays(a,b,c){let d=[];return c.forEach(a=>{b.has(a)||d.push(a)}),this.documentOverlayCache.getOverlays(a,d).next(a=>{a.forEach((a,c)=>{b.set(a,c)})})}computeViews(a,b,c,d){let e=BU(),f=B_(),g=BX();return b.forEach((a,b)=>{let g=c.get(b.key);d.has(b.key)&&(void 0===g||g.mutation instanceof CC)?e=e.insert(b.key,b):void 0!==g?(f.set(b.key,g.mutation.getFieldMask()),Cw(g.mutation,b,g.mutation.getFieldMask(),xi.now())):f.set(b.key,zr.empty())}),this.recalculateAndSaveOverlays(a,e).next(a=>(a.forEach((a,b)=>f.set(a,b)),b.forEach((a,b)=>{var c;return g.set(a,new Gx(b,null!=(c=f.get(a))?c:null))}),g))}recalculateAndSaveOverlays(a,b){let c=B_(),d=new zj((a,b)=>a-b),e=B3();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(a,b).next(a=>{for(let e of a)e.keys().forEach(a=>{let f=b.get(a);if(null===f)return;let g=c.get(a)||zr.empty();g=e.applyToLocalView(f,g),c.set(a,g);let h=(d.get(e.batchId)||B3()).add(a);d=d.insert(e.batchId,h)})}).next(()=>{let f=[],g=d.getReverseIterator();for(;g.hasNext();){let d=g.getNext(),h=d.key,i=d.value,j=B$();i.forEach(a=>{if(!e.has(a)){let d=Cu(b.get(a),c.get(a));null!==d&&j.set(a,d),e=e.add(a)}}),f.push(this.documentOverlayCache.saveOverlays(a,h,j))}return xI.waitFor(f)}).next(()=>c)}recalculateAndSaveOverlaysForDocumentKeys(a,b){return this.remoteDocumentCache.getEntries(a,b).next(b=>this.recalculateAndSaveOverlays(a,b))}getDocumentsMatchingQuery(a,b,c,d){return Bw(b)?this.getDocumentsMatchingDocumentQuery(a,b.path):Bx(b)?this.getDocumentsMatchingCollectionGroupQuery(a,b,c,d):this.getDocumentsMatchingCollectionQuery(a,b,c,d)}getNextDocuments(a,b,c,d){return this.remoteDocumentCache.getAllFromCollectionGroup(a,b,c,d).next(e=>{let f=d-e.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(a,b,c.largestBatchId,d-e.size):xI.resolve(BZ()),g=xq,h=e;return f.next(b=>xI.forEach(b,(b,c)=>(g<c.largestBatchId&&(g=c.largestBatchId),e.get(b))?xI.resolve():this.remoteDocumentCache.getEntry(a,b).next(a=>{h=h.insert(b,a)})).next(()=>this.populateOverlays(a,b,e)).next(()=>this.computeViews(a,h,b,B3())).next(a=>({batchId:g,changes:BY(a)})))})}getDocumentsMatchingDocumentQuery(a,b){return this.getDocument(a,new xp(b)).next(a=>{let b=BW();return a.isFoundDocument()&&(b=b.insert(a.key,a)),b})}getDocumentsMatchingCollectionGroupQuery(a,b,c,d){let e=b.collectionGroup,f=BW();return this.indexManager.getCollectionParents(a,e).next(g=>xI.forEach(g,g=>{let h=Bt(b,g.child(e));return this.getDocumentsMatchingCollectionQuery(a,h,c,d).next(a=>{a.forEach((a,b)=>{f=f.insert(a,b)})})}).next(()=>f))}getDocumentsMatchingCollectionQuery(a,b,c,d){let e;return this.documentOverlayCache.getOverlaysForCollection(a,b.path,c.largestBatchId).next(f=>(e=f,this.remoteDocumentCache.getDocumentsMatchingQuery(a,b,c,e,d))).next(a=>{e.forEach((b,c)=>{let d=c.getKey();null===a.get(d)&&(a=a.insert(d,AF.newInvalidDocument(d)))});let c=BW();return a.forEach((a,d)=>{let f=e.get(a);void 0!==f&&Cw(f.mutation,d,zr.empty(),xi.now()),BK(b,d)&&(c=c.insert(a,d))}),c})}}class Gz{constructor(a){this.serializer=a,this.bundles=new Map,this.namedQueries=new Map}getBundleMetadata(a,b){return xI.resolve(this.bundles.get(b))}saveBundleMetadata(a,b){return this.bundles.set(b.id,EG(b)),xI.resolve()}getNamedQuery(a,b){return xI.resolve(this.namedQueries.get(b))}saveNamedQuery(a,b){return this.namedQueries.set(b.name,EF(b)),xI.resolve()}}class GA{constructor(){this.overlays=new zj(xp.comparator),this.overlayByBatchId=new Map}getOverlay(a,b){return xI.resolve(this.overlays.get(b))}getOverlays(a,b){let c=BZ();return xI.forEach(b,b=>this.getOverlay(a,b).next(a=>{null!==a&&c.set(b,a)})).next(()=>c)}saveOverlays(a,b,c){return c.forEach((c,d)=>{this.saveOverlay(a,b,d)}),xI.resolve()}removeOverlaysForBatchId(a,b,c){let d=this.overlayByBatchId.get(c);return void 0!==d&&(d.forEach(a=>this.overlays=this.overlays.remove(a)),this.overlayByBatchId.delete(c)),xI.resolve()}getOverlaysForCollection(a,b,c){let d=BZ(),e=b.length+1,f=new xp(b.child("")),g=this.overlays.getIteratorFrom(f);for(;g.hasNext();){let a=g.getNext().value,f=a.getKey();if(!b.isPrefixOf(f.path))break;f.path.length===e&&a.largestBatchId>c&&d.set(a.getKey(),a)}return xI.resolve(d)}getOverlaysForCollectionGroup(a,b,c,d){let e=new zj((a,b)=>a-b),f=this.overlays.getIterator();for(;f.hasNext();){let a=f.getNext().value;if(a.getKey().getCollectionGroup()===b&&a.largestBatchId>c){let b=e.get(a.largestBatchId);null===b&&(b=BZ(),e=e.insert(a.largestBatchId,b)),b.set(a.getKey(),a)}}let g=BZ(),h=e.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((a,b)=>g.set(a,b)),!(g.size()>=d)););return xI.resolve(g)}saveOverlay(a,b,c){let d=this.overlays.get(c.key);if(null!==d){let a=this.overlayByBatchId.get(d.largestBatchId).delete(c.key);this.overlayByBatchId.set(d.largestBatchId,a)}this.overlays=this.overlays.insert(c.key,new CO(b,c));let e=this.overlayByBatchId.get(b);void 0===e&&(e=B3(),this.overlayByBatchId.set(b,e)),this.overlayByBatchId.set(b,e.add(c.key))}}class GB{constructor(){this.sessionToken=zu.EMPTY_BYTE_STRING}getSessionToken(a){return xI.resolve(this.sessionToken)}setSessionToken(a,b){return this.sessionToken=b,xI.resolve()}}class GC{constructor(){this.refsByKey=new zn(GD.compareByKey),this.refsByTarget=new zn(GD.compareByTargetId)}isEmpty(){return this.refsByKey.isEmpty()}addReference(a,b){let c=new GD(a,b);this.refsByKey=this.refsByKey.add(c),this.refsByTarget=this.refsByTarget.add(c)}addReferences(a,b){a.forEach(a=>this.addReference(a,b))}removeReference(a,b){this.removeRef(new GD(a,b))}removeReferences(a,b){a.forEach(a=>this.removeReference(a,b))}removeReferencesForId(a){let b=new xp(new xm([])),c=new GD(b,a),d=new GD(b,a+1),e=[];return this.refsByTarget.forEachInRange([c,d],a=>{this.removeRef(a),e.push(a.key)}),e}removeAllReferences(){this.refsByKey.forEach(a=>this.removeRef(a))}removeRef(a){this.refsByKey=this.refsByKey.delete(a),this.refsByTarget=this.refsByTarget.delete(a)}referencesForId(a){let b=new xp(new xm([])),c=new GD(b,a),d=new GD(b,a+1),e=B3();return this.refsByTarget.forEachInRange([c,d],a=>{e=e.add(a.key)}),e}containsKey(a){let b=new GD(a,0),c=this.refsByKey.firstAfterOrEqual(b);return null!==c&&a.isEqual(c.key)}}class GD{constructor(a,b){this.key=a,this.targetOrBatchId=b}static compareByKey(a,b){return xp.comparator(a.key,b.key)||xa(a.targetOrBatchId,b.targetOrBatchId)}static compareByTargetId(a,b){return xa(a.targetOrBatchId,b.targetOrBatchId)||xp.comparator(a.key,b.key)}}class GE{constructor(a,b){this.indexManager=a,this.referenceDelegate=b,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new zn(GD.compareByKey)}checkEmpty(a){return xI.resolve(0===this.mutationQueue.length)}addMutationBatch(a,b,c,d){let e=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let f=new CM(e,b,c,d);for(let b of(this.mutationQueue.push(f),d))this.batchesByDocumentKey=this.batchesByDocumentKey.add(new GD(b.key,e)),this.indexManager.addToCollectionParentIndex(a,b.key.path.popLast());return xI.resolve(f)}lookupMutationBatch(a,b){return xI.resolve(this.findMutationBatch(b))}getNextMutationBatchAfterBatchId(a,b){let c=b+1,d=this.indexOfBatchId(c),e=d<0?0:d;return xI.resolve(this.mutationQueue.length>e?this.mutationQueue[e]:null)}getHighestUnacknowledgedBatchId(){return xI.resolve(0===this.mutationQueue.length?zN:this.nextBatchId-1)}getAllMutationBatches(a){return xI.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(a,b){let c=new GD(b,0),d=new GD(b,1/0),e=[];return this.batchesByDocumentKey.forEachInRange([c,d],a=>{let b=this.findMutationBatch(a.targetOrBatchId);e.push(b)}),xI.resolve(e)}getAllMutationBatchesAffectingDocumentKeys(a,b){let c=new zn(xa);return b.forEach(a=>{let b=new GD(a,0),d=new GD(a,1/0);this.batchesByDocumentKey.forEachInRange([b,d],a=>{c=c.add(a.targetOrBatchId)})}),xI.resolve(this.findMutationBatches(c))}getAllMutationBatchesAffectingQuery(a,b){let c=b.path,d=c.length+1,e=c;xp.isDocumentKey(e)||(e=e.child(""));let f=new GD(new xp(e),0),g=new zn(xa);return this.batchesByDocumentKey.forEachWhile(a=>{let b=a.key.path;return!!c.isPrefixOf(b)&&(b.length===d&&(g=g.add(a.targetOrBatchId)),!0)},f),xI.resolve(this.findMutationBatches(g))}findMutationBatches(a){let b=[];return a.forEach(a=>{let c=this.findMutationBatch(a);null!==c&&b.push(c)}),b}removeMutationBatch(a,b){wU(0===this.indexOfExistingBatchId(b.batchId,"removed"),55003),this.mutationQueue.shift();let c=this.batchesByDocumentKey;return xI.forEach(b.mutations,d=>{let e=new GD(d.key,b.batchId);return c=c.delete(e),this.referenceDelegate.markPotentiallyOrphaned(a,d.key)}).next(()=>{this.batchesByDocumentKey=c})}removeCachedMutationKeys(a){}containsKey(a,b){let c=new GD(b,0),d=this.batchesByDocumentKey.firstAfterOrEqual(c);return xI.resolve(b.isEqual(d&&d.key))}performConsistencyCheck(a){return this.mutationQueue.length,xI.resolve()}indexOfExistingBatchId(a,b){return this.indexOfBatchId(a)}indexOfBatchId(a){return 0===this.mutationQueue.length?0:a-this.mutationQueue[0].batchId}findMutationBatch(a){let b=this.indexOfBatchId(a);return b<0||b>=this.mutationQueue.length?null:this.mutationQueue[b]}}let GF="-9223372036854775808";function GG(){return new zj(xp.comparator)}class GH{constructor(a){this.sizer=a,this.docs=GG(),this.size=0}setIndexManager(a){this.indexManager=a}addEntry(a,b){let c=b.key,d=this.docs.get(c),e=d?d.size:0,f=this.sizer(b);return this.docs=this.docs.insert(c,{document:b.mutableCopy(),size:f}),this.size+=f-e,this.indexManager.addToCollectionParentIndex(a,c.path.popLast())}removeEntry(a){let b=this.docs.get(a);b&&(this.docs=this.docs.remove(a),this.size-=b.size)}getEntry(a,b){let c=this.docs.get(b);return xI.resolve(c?c.document.mutableCopy():AF.newInvalidDocument(b))}getEntries(a,b){let c=BU();return b.forEach(a=>{let b=this.docs.get(a);c=c.insert(a,b?b.document.mutableCopy():AF.newInvalidDocument(a))}),xI.resolve(c)}getDocumentsMatchingQuery(a,b,c,d){let e=BU(),f=b.path,g=new xp(f.child("__id"+GF+"__")),h=this.docs.getIteratorFrom(g);for(;h.hasNext();){let{key:a,value:{document:g}}=h.getNext();if(!f.isPrefixOf(a.path))break;!(a.path.length>f.length+1||0>=xE(xC(g),c))&&(d.has(g.key)||BK(b,g))&&(e=e.insert(g.key,g.mutableCopy()))}return xI.resolve(e)}getAllFromCollectionGroup(a,b,c,d){wS(9500)}forEachDocumentKey(a,b){return xI.forEach(this.docs,a=>b(a))}newChangeBuffer(a){return new GJ(this)}getSize(a){return xI.resolve(this.size)}}function GI(a){return new GH(a)}class GJ extends Gm{constructor(a){super(),this.documentCache=a}applyChanges(a){let b=[];return this.changes.forEach((c,d)=>{d.isValidDocument()?b.push(this.documentCache.addEntry(a,d)):this.documentCache.removeEntry(c)}),xI.waitFor(b)}getFromCache(a,b){return this.documentCache.getEntry(a,b)}getAllFromCache(a,b){return this.documentCache.getEntries(a,b)}}class GK{constructor(a){this.persistence=a,this.targets=new BS(a=>Bd(a),Bf),this.lastRemoteSnapshotVersion=xj.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new GC,this.targetCount=0,this.targetIdGenerator=F0.forTargetCache()}forEachTarget(a,b){return this.targets.forEach((a,c)=>b(c)),xI.resolve()}getLastRemoteSnapshotVersion(a){return xI.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(a){return xI.resolve(this.highestSequenceNumber)}allocateTargetId(a){return this.highestTargetId=this.targetIdGenerator.next(),xI.resolve(this.highestTargetId)}setTargetsMetadata(a,b,c){return c&&(this.lastRemoteSnapshotVersion=c),b>this.highestSequenceNumber&&(this.highestSequenceNumber=b),xI.resolve()}saveTargetData(a){this.targets.set(a.target,a);let b=a.targetId;b>this.highestTargetId&&(this.targetIdGenerator=new F0(b),this.highestTargetId=b),a.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=a.sequenceNumber)}addTargetData(a,b){return this.saveTargetData(b),this.targetCount+=1,xI.resolve()}updateTargetData(a,b){return this.saveTargetData(b),xI.resolve()}removeTargetData(a,b){return this.targets.delete(b.target),this.references.removeReferencesForId(b.targetId),this.targetCount-=1,xI.resolve()}removeTargets(a,b,c){let d=0,e=[];return this.targets.forEach((f,g)=>{g.sequenceNumber<=b&&null===c.get(g.targetId)&&(this.targets.delete(f),e.push(this.removeMatchingKeysForTargetId(a,g.targetId)),d++)}),xI.waitFor(e).next(()=>d)}getTargetCount(a){return xI.resolve(this.targetCount)}getTargetData(a,b){let c=this.targets.get(b)||null;return xI.resolve(c)}addMatchingKeys(a,b,c){return this.references.addReferences(b,c),xI.resolve()}removeMatchingKeys(a,b,c){this.references.removeReferences(b,c);let d=this.persistence.referenceDelegate,e=[];return d&&b.forEach(b=>{e.push(d.markPotentiallyOrphaned(a,b))}),xI.waitFor(e)}removeMatchingKeysForTargetId(a,b){return this.references.removeReferencesForId(b),xI.resolve()}getMatchingKeysForTargetId(a,b){let c=this.references.referencesForId(b);return xI.resolve(c)}containsKey(a,b){return xI.resolve(this.references.containsKey(b))}}let GL="MemoryPersistence";class GM{constructor(a,b){this.mutationQueues={},this.overlays={},this.listenSequence=new x_(0),this._started=!1,this._started=!0,this.globalsCache=new GB,this.referenceDelegate=a(this),this.targetCache=new GK(this);let c=a=>this.referenceDelegate.documentSize(a);this.indexManager=new FJ,this.remoteDocumentCache=GI(c),this.serializer=new Eo(b),this.bundleCache=new Gz(this.serializer)}start(){return Promise.resolve()}shutdown(){return this._started=!1,Promise.resolve()}get started(){return this._started}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(a){return this.indexManager}getDocumentOverlayCache(a){let b=this.overlays[a.toKey()];return b||(b=new GA,this.overlays[a.toKey()]=b),b}getMutationQueue(a,b){let c=this.mutationQueues[a.toKey()];return c||(c=new GE(b,this.referenceDelegate),this.mutationQueues[a.toKey()]=c),c}getGlobalsCache(){return this.globalsCache}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.bundleCache}runTransaction(a,b,c){wO(GL,"Starting transaction:",a);let d=new GN(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),c(d).next(a=>this.referenceDelegate.onTransactionCommitted(d).next(()=>a)).toPromise().then(a=>(d.raiseOnCommittedEvent(),a))}mutationQueuesContainKey(a,b){return xI.or(Object.values(this.mutationQueues).map(c=>()=>c.containsKey(a,b)))}}class GN extends xG{constructor(a){super(),this.currentSequenceNumber=a}}class GO{constructor(a){this.persistence=a,this.localViewReferences=new GC,this._orphanedDocuments=null}static factory(a){return new GO(a)}get orphanedDocuments(){if(this._orphanedDocuments)return this._orphanedDocuments;throw wS(60996)}addReference(a,b,c){return this.localViewReferences.addReference(c,b),this.orphanedDocuments.delete(c.toString()),xI.resolve()}removeReference(a,b,c){return this.localViewReferences.removeReference(c,b),this.orphanedDocuments.add(c.toString()),xI.resolve()}markPotentiallyOrphaned(a,b){return this.orphanedDocuments.add(b.toString()),xI.resolve()}removeTarget(a,b){this.localViewReferences.removeReferencesForId(b.targetId).forEach(a=>this.orphanedDocuments.add(a.toString()));let c=this.persistence.getTargetCache();return c.getMatchingKeysForTargetId(a,b.targetId).next(a=>{a.forEach(a=>this.orphanedDocuments.add(a.toString()))}).next(()=>c.removeTargetData(a,b))}onTransactionStarted(){this._orphanedDocuments=new Set}onTransactionCommitted(a){let b=this.persistence.getRemoteDocumentCache().newChangeBuffer();return xI.forEach(this.orphanedDocuments,c=>{let d=xp.fromPath(c);return this.isReferenced(a,d).next(a=>{a||b.removeEntry(d,xj.min())})}).next(()=>(this._orphanedDocuments=null,b.apply(a)))}updateLimboDocument(a,b){return this.isReferenced(a,b).next(a=>{a?this.orphanedDocuments.delete(b.toString()):this.orphanedDocuments.add(b.toString())})}documentSize(a){return 0}isReferenced(a,b){return xI.or([()=>xI.resolve(this.localViewReferences.containsKey(b)),()=>this.persistence.getTargetCache().containsKey(a,b),()=>this.persistence.mutationQueuesContainKey(a,b)])}}class GP{constructor(a,b){this.persistence=a,this.orphanedSequenceNumbers=new BS(a=>x4(a.path),(a,b)=>a.isEqual(b)),this.garbageCollector=Gh(this,b)}static factory(a,b){return new GP(a,b)}onTransactionStarted(){}onTransactionCommitted(a){return xI.resolve()}forEachTarget(a,b){return this.persistence.getTargetCache().forEachTarget(a,b)}getSequenceNumberCount(a){let b=this.orphanedDocumentCount(a);return this.persistence.getTargetCache().getTargetCount(a).next(a=>b.next(b=>a+b))}orphanedDocumentCount(a){let b=0;return this.forEachOrphanedDocumentSequenceNumber(a,a=>{b++}).next(()=>b)}forEachOrphanedDocumentSequenceNumber(a,b){return xI.forEach(this.orphanedSequenceNumbers,(c,d)=>this.isPinned(a,c,d).next(a=>a?xI.resolve():b(d)))}removeTargets(a,b,c){return this.persistence.getTargetCache().removeTargets(a,b,c)}removeOrphanedDocuments(a,b){let c=0,d=this.persistence.getRemoteDocumentCache(),e=d.newChangeBuffer();return d.forEachDocumentKey(a,d=>this.isPinned(a,d,b).next(a=>{a||(c++,e.removeEntry(d,xj.min()))})).next(()=>e.apply(a)).next(()=>c)}markPotentiallyOrphaned(a,b){return this.orphanedSequenceNumbers.set(b,a.currentSequenceNumber),xI.resolve()}removeTarget(a,b){let c=b.withSequenceNumber(a.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(a,c)}addReference(a,b,c){return this.orphanedSequenceNumbers.set(c,a.currentSequenceNumber),xI.resolve()}removeReference(a,b,c){return this.orphanedSequenceNumbers.set(c,a.currentSequenceNumber),xI.resolve()}updateLimboDocument(a,b){return this.orphanedSequenceNumbers.set(b,a.currentSequenceNumber),xI.resolve()}documentSize(a){let b=a.key.toString().length;return a.isFoundDocument()&&(b+=Ak(a.data.value)),b}isPinned(a,b,c){return xI.or([()=>this.persistence.mutationQueuesContainKey(a,b),()=>this.persistence.getTargetCache().containsKey(a,b),()=>{let a=this.orphanedSequenceNumbers.get(b);return xI.resolve(void 0!==a&&a>c)}])}getCacheSize(a){return this.persistence.getRemoteDocumentCache().getSize(a)}}class GQ{constructor(a){this.serializer=a}createOrUpgrade(a,b,c,d){let e=new xL("createOrUpgrade",b);c<1&&d>=1&&(GS(a),GT(a),GY(a),GV(a));let f=xI.resolve();return c<3&&d>=3&&(0!==c&&(GZ(a),GY(a)),f=f.next(()=>G_(e))),c<4&&d>=4&&(0!==c&&(f=f.next(()=>GU(a,e))),f=f.next(()=>{G0(a)})),c<5&&d>=5&&(f=f.next(()=>this.removeAcknowledgedMutations(e))),c<6&&d>=6&&(f=f.next(()=>(GX(a),this.addDocumentGlobal(e)))),c<7&&d>=7&&(f=f.next(()=>this.ensureSequenceNumbers(e))),c<8&&d>=8&&(f=f.next(()=>this.createCollectionParentIndex(a,e))),c<9&&d>=9&&(f=f.next(()=>{G$(a)})),c<10&&d>=10&&(f=f.next(()=>this.rewriteCanonicalIds(e))),c<11&&d>=11&&(f=f.next(()=>{G1(a),G2(a)})),c<12&&d>=12&&(f=f.next(()=>{G4(a)})),c<13&&d>=13&&(f=f.next(()=>GW(a)).next(()=>this.rewriteRemoteDocumentCache(a,e)).next(()=>a.deleteObjectStore(x8))),c<14&&d>=14&&(f=f.next(()=>this.runOverlayMigration(a,e))),c<15&&d>=15&&(f=f.next(()=>G3(a))),c<16&&d>=16&&(f=f.next(()=>{b.objectStore(yQ).clear()}).next(()=>{b.objectStore(yU).clear()})),c<17&&d>=17&&(f=f.next(()=>{G5(a)})),c<18&&d>=18&&vd()&&(f=f.next(()=>{b.objectStore(yQ).clear()}).next(()=>{b.objectStore(yU).clear()})),f}addDocumentGlobal(a){let b=0;return a.store(x8).iterate((a,c)=>{b+=FU(c)}).next(()=>{let c={byteSize:b};return a.store(ys).put(yt,c)})}removeAcknowledgedMutations(a){let b=a.store(yb),c=a.store(yd);return b.loadAll().next(b=>xI.forEach(b,b=>{let d=IDBKeyRange.bound([b.userId,zN],[b.userId,b.lastAcknowledgedBatchId]);return c.loadAll(yf,d).next(c=>xI.forEach(c,c=>{wU(c.userId===b.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});let d=Ew(this.serializer,c);return FT(a,b.userId,d).next(()=>{})}))}))}ensureSequenceNumbers(a){let b=a.store(yy),c=a.store(x8);return a.store(yD).get(yC).next(a=>{let d=c=>b.put({targetId:0,path:x4(c),sequenceNumber:a.highestListenSequenceNumber}),e=[];return c.iterate((a,c)=>{let f=new xm(a),g=GR(f);e.push(b.get(g).next(a=>a?xI.resolve():d(f)))}).next(()=>xI.waitFor(e))})}createCollectionParentIndex(a,b){a.createObjectStore(yE,{keyPath:yF});let c=b.store(yE),d=new FK,e=a=>{if(d.add(a)){let b=a.lastSegment(),d=a.popLast();return c.put({collectionId:b,parent:x4(d)})}};return b.store(x8).iterate({keysOnly:!0},(a,b)=>e(new xm(a).popLast())).next(()=>b.store(yl).iterate({keysOnly:!0},([a,b,c],d)=>e(x7(b).popLast())))}rewriteCanonicalIds(a){let b=a.store(yu);return b.iterate((a,c)=>{let d=Ex(c),e=Ey(this.serializer,d);return b.put(e)})}rewriteRemoteDocumentCache(a,b){let c=b.store(x8),d=[];return c.iterate((a,c)=>{let e=b.store(ym),f=G6(c).path.toArray(),g={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:c.readTime||[0,0],unknownDocument:c.unknownDocument,noDocument:c.noDocument,document:c.document,hasCommittedMutations:!!c.hasCommittedMutations};d.push(e.put(g))}).next(()=>xI.waitFor(d))}runOverlayMigration(a,b){let c=b.store(yd),d=Go(this.serializer),e=new GM(GO.factory,this.serializer.remoteSerializer);return c.loadAll().next(a=>{let c=new Map;return a.forEach(a=>{var b;let d=null!=(b=c.get(a.userId))?b:B3();Ew(this.serializer,a).keys().forEach(a=>d=d.add(a)),c.set(a.userId,d)}),xI.forEach(c,(a,c)=>{let f=new wI(c),g=EQ.forUser(this.serializer,f),h=e.getIndexManager(f);return new Gy(d,FV.forUser(f,this.serializer,h,e.referenceDelegate),g,h).recalculateAndSaveOverlaysForDocumentKeys(new zd(b,x_.INVALID),a).next()})})}}function GR(a){return[0,x4(a)]}function GS(a){a.createObjectStore(x9)}function GT(a){a.createObjectStore(yb,{keyPath:yc}),a.createObjectStore(yd,{keyPath:ye,autoIncrement:!0}).createIndex(yf,yg,{unique:!0}),a.createObjectStore(yl)}function GU(a,b){return b.store(yd).loadAll().next(c=>{a.deleteObjectStore(yd),a.createObjectStore(yd,{keyPath:ye,autoIncrement:!0}).createIndex(yf,yg,{unique:!0});let d=b.store(yd),e=c.map(a=>d.put(a));return xI.waitFor(e)})}function GV(a){a.createObjectStore(x8)}function GW(a){let b=a.createObjectStore(ym,{keyPath:yn});b.createIndex(yo,yp),b.createIndex(yq,yr)}function GX(a){a.createObjectStore(ys)}function GY(a){a.createObjectStore(yy,{keyPath:yz}).createIndex(yA,yB,{unique:!0}),a.createObjectStore(yu,{keyPath:yv}).createIndex(yw,yx,{unique:!0}),a.createObjectStore(yD)}function GZ(a){a.deleteObjectStore(yy),a.deleteObjectStore(yu),a.deleteObjectStore(yD)}function G$(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")}function G_(a){let b=a.store(yD),c={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:xj.min().toTimestamp(),targetCount:0};return b.put(yC,c)}function G0(a){a.createObjectStore(yG,{keyPath:yH})}function G1(a){a.createObjectStore(yI,{keyPath:yJ})}function G2(a){a.createObjectStore(yK,{keyPath:yL})}function G3(a){a.createObjectStore(yM,{keyPath:yN,autoIncrement:!0}).createIndex(yO,yP,{unique:!1}),a.createObjectStore(yQ,{keyPath:yR}).createIndex(yS,yT,{unique:!1}),a.createObjectStore(yU,{keyPath:yV}).createIndex(yW,yX,{unique:!1})}function G4(a){let b=a.createObjectStore(yY,{keyPath:yZ});b.createIndex(y$,y_,{unique:!1}),b.createIndex(y0,y1,{unique:!1})}function G5(a){a.createObjectStore(y2,{keyPath:y3})}function G6(a){return a.document?new xp(xm.fromString(a.document.name).popFirst(5)):a.noDocument?xp.fromSegments(a.noDocument.path):a.unknownDocument?xp.fromSegments(a.unknownDocument.path):wS(36783)}let G7="IndexedDbPersistence",G8=18e5,G9=5e3,Ha=4e3,Hb="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Hc="This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.",Hd="firestore_zombie",He="main";class Hf{constructor(a,b,c,d,e,f,g,h,i,j,k=Gw){if(this.allowTabSynchronization=a,this.persistenceKey=b,this.clientId=c,this.queue=e,this.window=f,this.document=g,this.sequenceNumberSyncer=i,this.forceOwningTab=j,this.schemaVersion=k,this.listenSequence=null,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.windowUnloadHandler=null,this.inForeground=!1,this.documentVisibilityHandler=null,this.clientMetadataRefresher=null,this.lastGarbageCollectionTime=-1/0,this.primaryStateListener=a=>Promise.resolve(),!Hf.isAvailable())throw new wX(wW.UNIMPLEMENTED,Hc);this.referenceDelegate=new Gi(this,d),this.dbName=b+He,this.serializer=new Eo(h),this.simpleDb=new xM(this.dbName,this.schemaVersion,new GQ(this.serializer)),this.globalsCache=new ES,this.targetCache=new F1(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Go(this.serializer),this.bundleCache=new EN,this.window&&this.window.localStorage?this.webStorage=this.window.localStorage:(this.webStorage=null,!1===j&&wP(G7,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.updateClientMetadataAndTryBecomePrimary().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new wX(wW.FAILED_PRECONDITION,Hb);return this.attachVisibilityHandler(),this.attachWindowUnloadHook(),this.scheduleClientMetadataAndPrimaryLeaseRefreshes(),this.runTransaction("getHighestListenSequenceNumber","readonly",a=>this.targetCache.getHighestSequenceNumber(a))}).then(a=>{this.listenSequence=new x_(a,this.sequenceNumberSyncer)}).then(()=>{this._started=!0}).catch(a=>(this.simpleDb&&this.simpleDb.close(),Promise.reject(a)))}setPrimaryStateListener(a){return this.primaryStateListener=async b=>{if(this.started)return a(b)},a(this.isPrimary)}setDatabaseDeletedListener(a){this.simpleDb.setVersionChangeListener(async b=>{null===b.newVersion&&await a()})}setNetworkEnabled(a){this.networkEnabled!==a&&(this.networkEnabled=a,this.queue.enqueueAndForget(async()=>{this.started&&await this.updateClientMetadataAndTryBecomePrimary()}))}updateClientMetadataAndTryBecomePrimary(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",a=>Hh(a).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.verifyPrimaryLease(a).next(a=>{a||(this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)))})}).next(()=>this.canActAsPrimary(a)).next(b=>this.isPrimary&&!b?this.releasePrimaryLeaseIfHeld(a).next(()=>!1):!!b&&this.acquireOrExtendPrimaryLease(a).next(()=>!0))).catch(a=>{if(xQ(a))return wO(G7,"Failed to extend owner lease: ",a),this.isPrimary;if(!this.allowTabSynchronization)throw a;return wO(G7,"Releasing owner lease after error during lease refresh",a),!1}).then(a=>{this.isPrimary!==a&&this.queue.enqueueRetryable(()=>this.primaryStateListener(a)),this.isPrimary=a})}verifyPrimaryLease(a){return Hg(a).get(ya).next(a=>xI.resolve(this.isLocalClient(a)))}removeClientMetadata(a){return Hh(a).delete(this.clientId)}async maybeGarbageCollectMultiClientState(){if(this.isPrimary&&!this.isWithinAge(this.lastGarbageCollectionTime,G8)){this.lastGarbageCollectionTime=Date.now();let a=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",a=>{let b=ze(a,yG);return b.loadAll().next(a=>{let c=this.filterActiveClients(a,G8),d=a.filter(a=>-1===c.indexOf(a));return xI.forEach(d,a=>b.delete(a.clientId)).next(()=>d)})}).catch(()=>[]);if(this.webStorage)for(let b of a)this.webStorage.removeItem(this.zombiedClientLocalStorageKey(b.clientId))}}scheduleClientMetadataAndPrimaryLeaseRefreshes(){this.clientMetadataRefresher=this.queue.enqueueAfterDelay("client_metadata_refresh",Ha,()=>this.updateClientMetadataAndTryBecomePrimary().then(()=>this.maybeGarbageCollectMultiClientState()).then(()=>this.scheduleClientMetadataAndPrimaryLeaseRefreshes()))}isLocalClient(a){return!!a&&a.ownerId===this.clientId}canActAsPrimary(a){return this.forceOwningTab?xI.resolve(!0):Hg(a).get(ya).next(b=>{if(null!==b&&this.isWithinAge(b.leaseTimestampMs,G9)&&!this.isClientZombied(b.ownerId)){if(this.isLocalClient(b)&&this.networkEnabled)return!0;if(!this.isLocalClient(b)){if(!b.allowTabSynchronization)throw new wX(wW.FAILED_PRECONDITION,Hb);return!1}}return!!this.networkEnabled&&!!this.inForeground||Hh(a).loadAll().next(a=>void 0===this.filterActiveClients(a,G9).find(a=>{if(this.clientId!==a.clientId){let b=!this.networkEnabled&&a.networkEnabled,c=!this.inForeground&&a.inForeground,d=this.networkEnabled===a.networkEnabled;if(b||c&&d)return!0}return!1}))}).next(a=>(this.isPrimary!==a&&wO(G7,`Client ${a?"is":"is not"} eligible for a primary lease.`),a))}async shutdown(){this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&(this.clientMetadataRefresher.cancel(),this.clientMetadataRefresher=null),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),await this.simpleDb.runTransaction("shutdown","readwrite",[x9,yG],a=>{let b=new zd(a,x_.INVALID);return this.releasePrimaryLeaseIfHeld(b).next(()=>this.removeClientMetadata(b))}),this.simpleDb.close(),this.removeClientZombiedEntry()}filterActiveClients(a,b){return a.filter(a=>this.isWithinAge(a.updateTimeMs,b)&&!this.isClientZombied(a.clientId))}getActiveClients(){return this.runTransaction("getActiveClients","readonly",a=>Hh(a).loadAll().next(a=>this.filterActiveClients(a,G8).map(a=>a.clientId)))}get started(){return this._started}getGlobalsCache(){return this.globalsCache}getMutationQueue(a,b){return FV.forUser(a,this.serializer,b,this.referenceDelegate)}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(a){return new FN(a,this.serializer.remoteSerializer.databaseId)}getDocumentOverlayCache(a){return EQ.forUser(this.serializer,a)}getBundleCache(){return this.bundleCache}runTransaction(a,b,c){let d;wO(G7,"Starting transaction:",a);let e="readonly"===b?"readonly":"readwrite",f=zc(this.schemaVersion);return this.simpleDb.runTransaction(a,e,f,e=>(d=new zd(e,this.listenSequence?this.listenSequence.next():x_.INVALID),"readwrite-primary"===b)?this.verifyPrimaryLease(d).next(a=>!!a||this.canActAsPrimary(d)).next(b=>{if(!b)throw wP(`Failed to obtain primary lease for action '${a}'.`),this.isPrimary=!1,this.queue.enqueueRetryable(()=>this.primaryStateListener(!1)),new wX(wW.FAILED_PRECONDITION,xF);return c(d)}).next(a=>this.acquireOrExtendPrimaryLease(d).next(()=>a)):this.verifyAllowTabSynchronization(d).next(()=>c(d))).then(a=>(d.raiseOnCommittedEvent(),a))}verifyAllowTabSynchronization(a){return Hg(a).get(ya).next(a=>{if(null!==a&&this.isWithinAge(a.leaseTimestampMs,G9)&&!this.isClientZombied(a.ownerId)&&!this.isLocalClient(a)&&!this.forceOwningTab&&(!this.allowTabSynchronization||!a.allowTabSynchronization))throw new wX(wW.FAILED_PRECONDITION,Hb)})}acquireOrExtendPrimaryLease(a){let b={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Hg(a).put(ya,b)}static isAvailable(){return xM.isAvailable()}releasePrimaryLeaseIfHeld(a){let b=Hg(a);return b.get(ya).next(a=>this.isLocalClient(a)?(wO(G7,"Releasing primary lease."),b.delete(ya)):xI.resolve())}isWithinAge(a,b){let c=Date.now(),d=c-b,e=c;return!(a<d)&&(!(a>e)||(wP(`Detected an update time that is in the future: ${a} > ${e}`),!1))}attachVisibilityHandler(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=()=>{this.queue.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.updateClientMetadataAndTryBecomePrimary()))},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)}detachVisibilityHandler(){this.documentVisibilityHandler&&(this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)}attachWindowUnloadHook(){var a;"function"==typeof(null==(a=this.window)?void 0:a.addEventListener)&&(this.windowUnloadHandler=()=>{this.markClientZombied();let a=/(?:Version|Mobile)\/1[456]/;vc()&&(navigator.appVersion.match(a)||navigator.userAgent.match(a))&&this.queue.enterRestrictedMode(!0),this.queue.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.windowUnloadHandler))}detachWindowUnloadHook(){this.windowUnloadHandler&&(this.window.removeEventListener("pagehide",this.windowUnloadHandler),this.windowUnloadHandler=null)}isClientZombied(a){var b;try{let c=(null==(b=this.webStorage)?void 0:b.getItem(this.zombiedClientLocalStorageKey(a)))!==null;return wO(G7,`Client '${a}' ${c?"is":"is not"} zombied in LocalStorage`),c}catch(a){return wP(G7,"Failed to get zombied client id.",a),!1}}markClientZombied(){if(this.webStorage)try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(a){wP("Failed to set zombie client id.",a)}}removeClientZombiedEntry(){if(this.webStorage)try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(a){}}zombiedClientLocalStorageKey(a){return`${Hd}_${this.persistenceKey}_${a}`}}function Hg(a){return ze(a,x9)}function Hh(a){return ze(a,yG)}function Hi(a,b){let c=a.projectId;return a.isDefaultDatabase||(c+="."+a.database),"firestore/"+b+"/"+c+"/"}function Hj(a,b,c,d,e){b=[...b],(a=[...a]).sort(c),b.sort(c);let f=a.length,g=b.length,h=0,i=0;for(;h<g&&i<f;){let f=c(a[i],b[h]);f<0?e(a[i++]):f>0?d(b[h++]):(h++,i++)}for(;h<g;)d(b[h++]);for(;i<f;)e(a[i++])}function Hk(a,b){if(a.length!==b.length)return!1;for(let c=0;c<a.length;++c)if(a[c]!==b[c])return!1;return!0}let Hl="LocalStore",Hm=3e8;class Hn{constructor(a,b,c,d){this.persistence=a,this.queryEngine=b,this.serializer=d,this.targetDataByTarget=new zj(xa),this.targetIdByTarget=new BS(a=>Bd(a),Bf),this.collectionGroupReadTime=new Map,this.remoteDocuments=a.getRemoteDocumentCache(),this.targetCache=a.getTargetCache(),this.bundleCache=a.getBundleCache(),this.initializeUserComponents(c)}initializeUserComponents(a){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(a),this.indexManager=this.persistence.getIndexManager(a),this.mutationQueue=this.persistence.getMutationQueue(a,this.indexManager),this.localDocuments=new Gy(this.remoteDocuments,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.remoteDocuments.setIndexManager(this.indexManager),this.queryEngine.initialize(this.localDocuments,this.indexManager)}collectGarbage(a){return this.persistence.runTransaction("Collect garbage","readwrite-primary",b=>a.collect(b,this.targetDataByTarget))}}function Ho(a,b,c,d){return new Hn(a,b,c,d)}async function Hp(a,b){let c=wV(a);return await c.persistence.runTransaction("Handle user change","readonly",a=>{let d;return c.mutationQueue.getAllMutationBatches(a).next(e=>(d=e,c.initializeUserComponents(b),c.mutationQueue.getAllMutationBatches(a))).next(b=>{let e=[],f=[],g=B3();for(let a of d)for(let b of(e.push(a.batchId),a.mutations))g=g.add(b.key);for(let a of b)for(let b of(f.push(a.batchId),a.mutations))g=g.add(b.key);return c.localDocuments.getDocuments(a,g).next(a=>({affectedDocuments:a,removedBatchIds:e,addedBatchIds:f}))})})}function Hq(a,b){let c,d,e=wV(a),f=xi.now(),g=b.reduce((a,b)=>a.add(b.key),B3());return e.persistence.runTransaction("Locally write mutations","readwrite",a=>{let h=BU(),i=B3();return e.remoteDocuments.getEntries(a,g).next(a=>{(h=a).forEach((a,b)=>{b.isValidDocument()||(i=i.add(a))})}).next(()=>e.localDocuments.getOverlayedDocuments(a,h)).next(d=>{c=d;let g=[];for(let a of b){let b=Cx(a,c.get(a.key).overlayedDocument);null!=b&&g.push(new CC(a.key,b,AE(b.value.mapValue),Cr.exists(!0)))}return e.mutationQueue.addMutationBatch(a,f,g,b)}).next(b=>{d=b;let f=b.applyToLocalDocumentSet(c,i);return e.documentOverlayCache.saveOverlays(a,b.batchId,f)})}).then(()=>({batchId:d.batchId,changes:BY(c)}))}function Hr(a,b){let c=wV(a);return c.persistence.runTransaction("Acknowledge batch","readwrite-primary",a=>{let d=b.batch.keys(),e=c.remoteDocuments.newChangeBuffer({trackRemovals:!0});return HG(c,a,b,e).next(()=>e.apply(a)).next(()=>c.mutationQueue.performConsistencyCheck(a)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(a,d,b.batch.batchId)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,Hs(b))).next(()=>c.localDocuments.getDocuments(a,d))})}function Hs(a){let b=B3();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(b=b.add(a.batch.mutations[c].key));return b}function Ht(a,b){let c=wV(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",a=>{let d;return c.mutationQueue.lookupMutationBatch(a,b).next(b=>(wU(null!==b,37113),d=b.keys(),c.mutationQueue.removeMutationBatch(a,b))).next(()=>c.mutationQueue.performConsistencyCheck(a)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(a,d,b)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,d)).next(()=>c.localDocuments.getDocuments(a,d))})}function Hu(a){let b=wV(a);return b.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>b.mutationQueue.getHighestUnacknowledgedBatchId(a))}function Hv(a){let b=wV(a);return b.persistence.runTransaction("Get last remote snapshot version","readonly",a=>b.targetCache.getLastRemoteSnapshotVersion(a))}function Hw(a,b){let c=wV(a),d=b.snapshotVersion,e=c.targetDataByTarget;return c.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{let f=c.remoteDocuments.newChangeBuffer({trackRemovals:!0});e=c.targetDataByTarget;let g=[];b.targetChanges.forEach((f,h)=>{let i=e.get(h);if(!i)return;g.push(c.targetCache.removeMatchingKeys(a,f.removedDocuments,h).next(()=>c.targetCache.addMatchingKeys(a,f.addedDocuments,h)));let j=i.withSequenceNumber(a.currentSequenceNumber);null!==b.targetMismatches.get(h)?j=j.withResumeToken(zu.EMPTY_BYTE_STRING,xj.min()).withLastLimboFreeSnapshotVersion(xj.min()):f.resumeToken.approximateByteSize()>0&&(j=j.withResumeToken(f.resumeToken,d)),e=e.insert(h,j),Hy(i,j,f)&&g.push(c.targetCache.updateTargetData(a,j))});let h=BU(),i=B3();if(b.documentUpdates.forEach(d=>{b.resolvedLimboDocuments.has(d)&&g.push(c.persistence.referenceDelegate.updateLimboDocument(a,d))}),g.push(Hx(a,f,b.documentUpdates).next(a=>{h=a.changedDocuments,i=a.existenceChangedKeys})),!d.isEqual(xj.min())){let b=c.targetCache.getLastRemoteSnapshotVersion(a).next(b=>c.targetCache.setTargetsMetadata(a,a.currentSequenceNumber,d));g.push(b)}return xI.waitFor(g).next(()=>f.apply(a)).next(()=>c.localDocuments.getLocalViewOfDocuments(a,h,i)).next(()=>h)}).then(a=>(c.targetDataByTarget=e,a))}function Hx(a,b,c){let d=B3(),e=B3();return c.forEach(a=>d=d.add(a)),b.getEntries(a,d).next(a=>{let d=BU();return c.forEach((c,f)=>{let g=a.get(c);f.isFoundDocument()!==g.isFoundDocument()&&(e=e.add(c)),f.isNoDocument()&&f.version.isEqual(xj.min())?(b.removeEntry(c,f.readTime),d=d.insert(c,f)):!g.isValidDocument()||f.version.compareTo(g.version)>0||0===f.version.compareTo(g.version)&&g.hasPendingWrites?(b.addEntry(f),d=d.insert(c,f)):wO(Hl,"Ignoring outdated watch update for ",c,". Current version:",g.version," Watch version:",f.version)}),{changedDocuments:d,existenceChangedKeys:e}})}function Hy(a,b,c){return!!(0===a.resumeToken.approximateByteSize()||b.snapshotVersion.toMicroseconds()-a.snapshotVersion.toMicroseconds()>=Hm)||c.addedDocuments.size+c.modifiedDocuments.size+c.removedDocuments.size>0}async function Hz(a,b){let c=wV(a);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",a=>xI.forEach(b,b=>xI.forEach(b.addedKeys,d=>c.persistence.referenceDelegate.addReference(a,b.targetId,d)).next(()=>xI.forEach(b.removedKeys,d=>c.persistence.referenceDelegate.removeReference(a,b.targetId,d)))))}catch(a){if(xQ(a))wO(Hl,"Failed to update sequence numbers: "+a);else throw a}for(let a of b){let b=a.targetId;if(!a.fromCache){let a=c.targetDataByTarget.get(b),d=a.snapshotVersion,e=a.withLastLimboFreeSnapshotVersion(d);c.targetDataByTarget=c.targetDataByTarget.insert(b,e)}}}function HA(a,b){let c=wV(a);return c.persistence.runTransaction("Get next mutation batch","readonly",a=>(void 0===b&&(b=zN),c.mutationQueue.getNextMutationBatchAfterBatchId(a,b)))}function HB(a,b){let c=wV(a);return c.persistence.runTransaction("read document","readonly",a=>c.localDocuments.getDocument(a,b))}function HC(a,b){let c=wV(a);return c.persistence.runTransaction("Allocate target","readwrite",a=>{let d;return c.targetCache.getTargetData(a,b).next(e=>e?(d=e,xI.resolve(d)):c.targetCache.allocateTargetId(a).next(e=>(d=new En(b,e,"TargetPurposeListen",a.currentSequenceNumber),c.targetCache.addTargetData(a,d).next(()=>d))))}).then(a=>{let d=c.targetDataByTarget.get(a.targetId);return(null===d||a.snapshotVersion.compareTo(d.snapshotVersion)>0)&&(c.targetDataByTarget=c.targetDataByTarget.insert(a.targetId,a),c.targetIdByTarget.set(b,a.targetId)),a})}function HD(a,b,c){let d=wV(a),e=d.targetIdByTarget.get(c);return void 0!==e?xI.resolve(d.targetDataByTarget.get(e)):d.targetCache.getTargetData(b,c)}async function HE(a,b,c){let d=wV(a),e=d.targetDataByTarget.get(b),f=c?"readwrite":"readwrite-primary";try{c||await d.persistence.runTransaction("Release target",f,a=>d.persistence.referenceDelegate.removeTarget(a,e))}catch(a){if(xQ(a))wO(Hl,`Failed to update sequence numbers for target ${b}: ${a}`);else throw a}d.targetDataByTarget=d.targetDataByTarget.remove(b),d.targetIdByTarget.delete(e.target)}function HF(a,b,c){let d=wV(a),e=xj.min(),f=B3();return d.persistence.runTransaction("Execute query","readwrite",a=>HD(d,a,Bz(b)).next(b=>{if(b)return e=b.lastLimboFreeSnapshotVersion,d.targetCache.getMatchingKeysForTargetId(a,b.targetId).next(a=>{f=a})}).next(()=>d.queryEngine.getDocumentsMatchingQuery(a,b,c?e:xj.min(),c?f:B3())).next(a=>(HM(d,BP(b),a),{documents:a,remoteKeys:f})))}function HG(a,b,c,d){let e=c.batch,f=e.keys(),g=xI.resolve();return f.forEach(a=>{g=g.next(()=>d.getEntry(b,a)).next(b=>{let f=c.docVersions.get(a);wU(null!==f,48541),0>b.version.compareTo(f)&&(e.applyToRemoteDocument(b,c),b.isValidDocument()&&(b.setReadTime(c.commitVersion),d.addEntry(b)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(b,e))}function HH(a,b){let c=wV(a),d=wV(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",a=>d.lookupMutationKeys(a,b).next(b=>b?c.localDocuments.getDocuments(a,b):xI.resolve(null)))}function HI(a,b){wV(wV(a,Hn).mutationQueue).removeCachedMutationKeys(b)}function HJ(a){return wV(wV(a,Hn).persistence).getActiveClients()}function HK(a,b){let c=wV(a),d=wV(c.targetCache),e=c.targetDataByTarget.get(b);return e?Promise.resolve(e.target):c.persistence.runTransaction("Get target data","readonly",a=>d.getTargetDataForTarget(a,b).next(a=>a?a.target:null))}function HL(a,b){let c=wV(a),d=c.collectionGroupReadTime.get(b)||xj.min();return c.persistence.runTransaction("Get new document changes","readonly",a=>c.remoteDocuments.getAllFromCollectionGroup(a,b,xB(d,xq),Number.MAX_SAFE_INTEGER)).then(a=>(HM(c,b,a),a))}function HM(a,b,c){let d=a.collectionGroupReadTime.get(b)||xj.min();c.forEach((a,b)=>{b.readTime.compareTo(d)>0&&(d=b.readTime)}),a.collectionGroupReadTime.set(b,d)}function HN(a){return Bz(Bs(xm.fromString(`__bundle__/docs/${a}`)))}async function HO(a,b,c,d){let e=wV(a),f=B3(),g=BU();for(let a of c){let c=b.toDocumentKey(a.metadata.name);a.document&&(f=f.add(c));let d=b.toMutableDocument(a);d.setReadTime(b.toSnapshotVersion(a.metadata.readTime)),g=g.insert(c,d)}let h=e.remoteDocuments.newChangeBuffer({trackRemovals:!0}),i=await HC(e,HN(d));return e.persistence.runTransaction("Apply bundle documents","readwrite",a=>Hx(a,h,g).next(b=>(h.apply(a),b)).next(b=>e.targetCache.removeMatchingKeysForTargetId(a,i.targetId).next(()=>e.targetCache.addMatchingKeys(a,f,i.targetId)).next(()=>e.localDocuments.getLocalViewOfDocuments(a,b.changedDocuments,b.existenceChangedKeys)).next(()=>b.changedDocuments)))}function HP(a,b){let c=wV(a),d=Dm(b.createTime);return c.persistence.runTransaction("hasNewerBundle","readonly",a=>c.bundleCache.getBundleMetadata(a,b.id)).then(a=>!!a&&a.createTime.compareTo(d)>=0)}function HQ(a,b){let c=wV(a);return c.persistence.runTransaction("Save bundle","readwrite",a=>c.bundleCache.saveBundleMetadata(a,b))}function HR(a,b){let c=wV(a);return c.persistence.runTransaction("Get named query","readonly",a=>c.bundleCache.getNamedQuery(a,b))}async function HS(a,b,c=B3()){let d=await HC(a,Bz(EE(b.bundledQuery))),e=wV(a);return e.persistence.runTransaction("Save named query","readwrite",a=>{let f=Dm(b.readTime);if(d.snapshotVersion.compareTo(f)>=0)return e.bundleCache.saveNamedQuery(a,b);let g=d.withResumeToken(zu.EMPTY_BYTE_STRING,f);return e.targetDataByTarget=e.targetDataByTarget.insert(g.targetId,g),e.targetCache.updateTargetData(a,g).next(()=>e.targetCache.removeMatchingKeysForTargetId(a,d.targetId)).next(()=>e.targetCache.addMatchingKeys(a,c,d.targetId)).next(()=>e.bundleCache.saveNamedQuery(a,b))})}async function HT(a,b){let c=wV(a),d=c.indexManager,e=[];return c.persistence.runTransaction("Configure indexes","readwrite",a=>d.getFieldIndexes(a).next(c=>Hj(c,b,xw,b=>{e.push(d.addFieldIndex(a,b))},b=>{e.push(d.deleteFieldIndex(a,b))})).next(()=>xI.waitFor(e)))}function HU(a,b){wV(a).queryEngine.indexAutoCreationEnabled=b}function HV(a){let b=wV(a),c=b.indexManager;return b.persistence.runTransaction("Delete All Indexes","readwrite",a=>c.deleteAllFieldIndexes(a))}class HW{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(a){this._documentReadCount+=a}}let HX=100;function HY(){return vc()?8:xN(va())>0?6:4}class HZ{constructor(){this.initialized=!1,this.indexAutoCreationEnabled=!1,this.indexAutoCreationMinCollectionSize=HX,this.relativeIndexReadCostPerDocument=HY()}initialize(a,b){this.localDocumentsView=a,this.indexManager=b,this.initialized=!0}getDocumentsMatchingQuery(a,b,c,d){let e={result:null};return this.performQueryUsingIndex(a,b).next(a=>{e.result=a}).next(()=>{if(!e.result)return this.performQueryUsingRemoteKeys(a,b,d,c).next(a=>{e.result=a})}).next(()=>{if(e.result)return;let c=new HW;return this.executeFullCollectionScan(a,b,c).next(d=>{if(e.result=d,this.indexAutoCreationEnabled)return this.createCacheIndexes(a,b,c,d.size)})}).next(()=>e.result)}createCacheIndexes(a,b,c,d){return c.documentReadCount<this.indexAutoCreationMinCollectionSize?(wN()<=m.DEBUG&&wO("QueryEngine","SDK will not create cache indexes for query:",BJ(b),"since it only creates cache indexes for collection contains","more than or equal to",this.indexAutoCreationMinCollectionSize,"documents"),xI.resolve()):(wN()<=m.DEBUG&&wO("QueryEngine","Query:",BJ(b),"scans",c.documentReadCount,"local documents and returns",d,"documents as results."),c.documentReadCount>this.relativeIndexReadCostPerDocument*d)?(wN()<=m.DEBUG&&wO("QueryEngine","The SDK decides to create cache indexes for query:",BJ(b),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(a,Bz(b))):xI.resolve()}performQueryUsingIndex(a,b){if(Bu(b))return xI.resolve(null);let c=Bz(b);return this.indexManager.getIndexType(a,c).next(d=>0===d?null:(null!==b.limit&&1===d&&(c=Bz(b=BE(b,null,"F"))),this.indexManager.getDocumentsMatchingTarget(a,c).next(d=>{let e=B3(...d);return this.localDocumentsView.getDocuments(a,e).next(d=>this.indexManager.getMinOffset(a,c).next(c=>{let f=this.applyQuery(b,d);return this.needsRefill(b,f,e,c.readTime)?this.performQueryUsingIndex(a,BE(b,null,"F")):this.appendRemainingResults(a,f,b,c)}))})))}performQueryUsingRemoteKeys(a,b,c,d){return Bu(b)||d.isEqual(xj.min())?xI.resolve(null):this.localDocumentsView.getDocuments(a,c).next(e=>{let f=this.applyQuery(b,e);return this.needsRefill(b,f,c,d)?xI.resolve(null):(wN()<=m.DEBUG&&wO("QueryEngine","Re-using previous result from %s to execute query: %s",d.toString(),BJ(b)),this.appendRemainingResults(a,f,b,xB(d,xq)).next(a=>a))})}applyQuery(a,b){let c=new zn(BQ(a));return b.forEach((b,d)=>{BK(a,d)&&(c=c.add(d))}),c}needsRefill(a,b,c,d){if(null===a.limit)return!1;if(c.size!==b.size)return!0;let e="F"===a.limitType?b.last():b.first();return!!e&&(e.hasPendingWrites||e.version.compareTo(d)>0)}executeFullCollectionScan(a,b,c){return wN()<=m.DEBUG&&wO("QueryEngine","Using full collection scan to execute query:",BJ(b)),this.localDocumentsView.getDocumentsMatchingQuery(a,b,xD.min(),c)}appendRemainingResults(a,b,c,d){return this.localDocumentsView.getDocumentsMatchingQuery(a,c,d).next(a=>(b.forEach(b=>{a=a.insert(b.key,b)}),a))}}let H$="firestore_clients";function H_(a,b){return`${H$}_${a}_${b}`}let H0="firestore_mutations";function H1(a,b,c){let d=`${H0}_${a}_${c}`;return b.isAuthenticated()&&(d+=`_${b.uid}`),d}let H2="firestore_targets";function H3(a,b){return`${H2}_${a}_${b}`}let H4="firestore_online_state";function H5(a){return`${H4}_${a}`}let H6="firestore_bundle_loaded_v2";function H7(a){return`${H6}_${a}`}let H8="firestore_sequence_number";function H9(a){return`${H8}_${a}`}let Ia="SharedClientState";class Ib{constructor(a,b,c,d){this.user=a,this.batchId=b,this.state=c,this.error=d}static fromWebStorageEntry(a,b,c){let d,e=JSON.parse(c),f="object"==typeof e&&-1!==["pending","acknowledged","rejected"].indexOf(e.state)&&(void 0===e.error||"object"==typeof e.error);return(f&&e.error&&(f="string"==typeof e.error.message&&"string"==typeof e.error.code)&&(d=new wX(e.error.code,e.error.message)),f)?new Ib(a,b,e.state,d):(wP(Ia,`Failed to parse mutation state for ID '${b}': ${c}`),null)}toWebStorageJSON(){let a={state:this.state,updateTimeMs:Date.now()};return this.error&&(a.error={code:this.error.code,message:this.error.message}),JSON.stringify(a)}}class Ic{constructor(a,b,c){this.targetId=a,this.state=b,this.error=c}static fromWebStorageEntry(a,b){let c,d=JSON.parse(b),e="object"==typeof d&&-1!==["not-current","current","rejected"].indexOf(d.state)&&(void 0===d.error||"object"==typeof d.error);return(e&&d.error&&(e="string"==typeof d.error.message&&"string"==typeof d.error.code)&&(c=new wX(d.error.code,d.error.message)),e)?new Ic(a,d.state,c):(wP(Ia,`Failed to parse target state for ID '${a}': ${b}`),null)}toWebStorageJSON(){let a={state:this.state,updateTimeMs:Date.now()};return this.error&&(a.error={code:this.error.code,message:this.error.message}),JSON.stringify(a)}}class Id{constructor(a,b){this.clientId=a,this.activeTargetIds=b}static fromWebStorageEntry(a,b){let c=JSON.parse(b),d="object"==typeof c&&c.activeTargetIds instanceof Array,e=B5();for(let a=0;d&&a<c.activeTargetIds.length;++a)d=zQ(c.activeTargetIds[a]),e=e.add(c.activeTargetIds[a]);return d?new Id(a,e):(wP(Ia,`Failed to parse client data for instance '${a}': ${b}`),null)}}class Ie{constructor(a,b){this.clientId=a,this.onlineState=b}static fromWebStorageEntry(a){let b=JSON.parse(a);return"object"==typeof b&&-1!==["Unknown","Online","Offline"].indexOf(b.onlineState)&&"string"==typeof b.clientId?new Ie(b.clientId,b.onlineState):(wP(Ia,`Failed to parse online state: ${a}`),null)}}class If{constructor(){this.activeTargetIds=B5()}addQueryTarget(a){this.activeTargetIds=this.activeTargetIds.add(a)}removeQueryTarget(a){this.activeTargetIds=this.activeTargetIds.delete(a)}toWebStorageJSON(){return JSON.stringify({activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()})}}class Ig{constructor(a,b,c,d,e){this.window=a,this.queue=b,this.persistenceKey=c,this.localClientId=d,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.storageListener=this.handleWebStorageEvent.bind(this),this.activeClients=new zj(xa),this.started=!1,this.earlyEvents=[];let f=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=e,this.localClientStorageKey=H_(this.persistenceKey,this.localClientId),this.sequenceNumberKey=H9(this.persistenceKey),this.activeClients=this.activeClients.insert(this.localClientId,new If),this.clientStateKeyRe=RegExp(`^${H$}_${f}_([^_]*)$`),this.mutationBatchKeyRe=RegExp(`^${H0}_${f}_(\\d+)(?:_(.*))?$`),this.queryTargetKeyRe=RegExp(`^${H2}_${f}_(\\d+)$`),this.onlineStateKey=H5(this.persistenceKey),this.bundleLoadedKey=H7(this.persistenceKey),this.window.addEventListener("storage",this.storageListener)}static isAvailable(a){return!!(a&&a.localStorage)}async start(){for(let a of(await this.syncEngine.getActiveClients())){if(a===this.localClientId)continue;let b=this.getItem(H_(this.persistenceKey,a));if(b){let c=Id.fromWebStorageEntry(a,b);c&&(this.activeClients=this.activeClients.insert(c.clientId,c))}}this.persistClientState();let a=this.storage.getItem(this.onlineStateKey);if(a){let b=this.fromWebStorageOnlineState(a);b&&this.handleOnlineStateEvent(b)}for(let a of this.earlyEvents)this.handleWebStorageEvent(a);this.earlyEvents=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(a){this.setItem(this.sequenceNumberKey,JSON.stringify(a))}getAllActiveQueryTargets(){return this.extractActiveQueryTargets(this.activeClients)}isActiveQueryTarget(a){let b=!1;return this.activeClients.forEach((c,d)=>{d.activeTargetIds.has(a)&&(b=!0)}),b}addPendingMutation(a){this.persistMutationState(a,"pending")}updateMutationState(a,b,c){this.persistMutationState(a,b,c),this.removeMutationState(a)}addLocalQueryTarget(a,b=!0){let c="not-current";if(this.isActiveQueryTarget(a)){let b=this.storage.getItem(H3(this.persistenceKey,a));if(b){let d=Ic.fromWebStorageEntry(a,b);d&&(c=d.state)}}return b&&this.localClientState.addQueryTarget(a),this.persistClientState(),c}removeLocalQueryTarget(a){this.localClientState.removeQueryTarget(a),this.persistClientState()}isLocalQueryTarget(a){return this.localClientState.activeTargetIds.has(a)}clearQueryState(a){this.removeItem(H3(this.persistenceKey,a))}updateQueryState(a,b,c){this.persistQueryTargetState(a,b,c)}handleUserChange(a,b,c){b.forEach(a=>{this.removeMutationState(a)}),this.currentUser=a,c.forEach(a=>{this.addPendingMutation(a)})}setOnlineState(a){this.persistOnlineState(a)}notifyBundleLoaded(a){this.persistBundleLoadedState(a)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)}getItem(a){let b=this.storage.getItem(a);return wO(Ia,"READ",a,b),b}setItem(a,b){wO(Ia,"SET",a,b),this.storage.setItem(a,b)}removeItem(a){wO(Ia,"REMOVE",a),this.storage.removeItem(a)}handleWebStorageEvent(a){let b=a;if(b.storageArea===this.storage){if(wO(Ia,"EVENT",b.key,b.newValue),b.key===this.localClientStorageKey)return void wP("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueRetryable(async()=>{if(!this.started)return void this.earlyEvents.push(b);if(null!==b.key){if(this.clientStateKeyRe.test(b.key))if(null!=b.newValue){let a=this.fromWebStorageClientState(b.key,b.newValue);if(a)return this.handleClientStateEvent(a.clientId,a)}else{let a=this.fromWebStorageClientStateKey(b.key);return this.handleClientStateEvent(a,null)}else if(this.mutationBatchKeyRe.test(b.key)){if(null!==b.newValue){let a=this.fromWebStorageMutationMetadata(b.key,b.newValue);if(a)return this.handleMutationBatchEvent(a)}}else if(this.queryTargetKeyRe.test(b.key)){if(null!==b.newValue){let a=this.fromWebStorageQueryTargetMetadata(b.key,b.newValue);if(a)return this.handleQueryTargetEvent(a)}}else if(b.key===this.onlineStateKey){if(null!==b.newValue){let a=this.fromWebStorageOnlineState(b.newValue);if(a)return this.handleOnlineStateEvent(a)}}else if(b.key===this.sequenceNumberKey){let a=Ih(b.newValue);a!==x_.INVALID&&this.sequenceNumberHandler(a)}else if(b.key===this.bundleLoadedKey){let a=this.fromWebStoreBundleLoadedState(b.newValue);await Promise.all(a.map(a=>this.syncEngine.synchronizeWithChangedDocuments(a)))}}})}}get localClientState(){return this.activeClients.get(this.localClientId)}persistClientState(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())}persistMutationState(a,b,c){let d=new Ib(this.currentUser,a,b,c),e=H1(this.persistenceKey,this.currentUser,a);this.setItem(e,d.toWebStorageJSON())}removeMutationState(a){let b=H1(this.persistenceKey,this.currentUser,a);this.removeItem(b)}persistOnlineState(a){let b={clientId:this.localClientId,onlineState:a};this.storage.setItem(this.onlineStateKey,JSON.stringify(b))}persistQueryTargetState(a,b,c){let d=H3(this.persistenceKey,a),e=new Ic(a,b,c);this.setItem(d,e.toWebStorageJSON())}persistBundleLoadedState(a){let b=JSON.stringify(Array.from(a));this.setItem(this.bundleLoadedKey,b)}fromWebStorageClientStateKey(a){let b=this.clientStateKeyRe.exec(a);return b?b[1]:null}fromWebStorageClientState(a,b){let c=this.fromWebStorageClientStateKey(a);return Id.fromWebStorageEntry(c,b)}fromWebStorageMutationMetadata(a,b){let c=this.mutationBatchKeyRe.exec(a),d=Number(c[1]),e=void 0!==c[2]?c[2]:null;return Ib.fromWebStorageEntry(new wI(e),d,b)}fromWebStorageQueryTargetMetadata(a,b){let c=Number(this.queryTargetKeyRe.exec(a)[1]);return Ic.fromWebStorageEntry(c,b)}fromWebStorageOnlineState(a){return Ie.fromWebStorageEntry(a)}fromWebStoreBundleLoadedState(a){return JSON.parse(a)}async handleMutationBatchEvent(a){return a.user.uid!==this.currentUser.uid?void wO(Ia,`Ignoring mutation for non-active user ${a.user.uid}`):this.syncEngine.applyBatchState(a.batchId,a.state,a.error)}handleQueryTargetEvent(a){return this.syncEngine.applyTargetState(a.targetId,a.state,a.error)}handleClientStateEvent(a,b){let c=b?this.activeClients.insert(a,b):this.activeClients.remove(a),d=this.extractActiveQueryTargets(this.activeClients),e=this.extractActiveQueryTargets(c),f=[],g=[];return e.forEach(a=>{d.has(a)||f.push(a)}),d.forEach(a=>{e.has(a)||g.push(a)}),this.syncEngine.applyActiveTargetsChange(f,g).then(()=>{this.activeClients=c})}handleOnlineStateEvent(a){this.activeClients.get(a.clientId)&&this.onlineStateHandler(a.onlineState)}extractActiveQueryTargets(a){let b=B5();return a.forEach((a,c)=>{b=b.unionWith(c.activeTargetIds)}),b}}function Ih(a){let b=x_.INVALID;if(null!=a)try{let c=JSON.parse(a);wU("number"==typeof c,30636,{seqString:a}),b=c}catch(a){wP(Ia,"Failed to read sequence number from WebStorage",a)}return b}class Ii{constructor(){this.localState=new If,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(a){}updateMutationState(a,b,c){}addLocalQueryTarget(a,b=!0){return b&&this.localState.addQueryTarget(a),this.queryState[a]||"not-current"}updateQueryState(a,b,c){this.queryState[a]=b}removeLocalQueryTarget(a){this.localState.removeQueryTarget(a)}isLocalQueryTarget(a){return this.localState.activeTargetIds.has(a)}clearQueryState(a){delete this.queryState[a]}getAllActiveQueryTargets(){return this.localState.activeTargetIds}isActiveQueryTarget(a){return this.localState.activeTargetIds.has(a)}start(){return this.localState=new If,Promise.resolve()}handleUserChange(a,b,c){}setOnlineState(a){}shutdown(){}writeSequenceNumber(a){}notifyBundleLoaded(a){}}class Ij{addCallback(a){}shutdown(){}}class Ik{constructor(a){this.sendFn=a.sendFn,this.closeFn=a.closeFn}onConnected(a){this.wrappedOnConnected=a}onOpen(a){this.wrappedOnOpen=a}onClose(a){this.wrappedOnClose=a}onMessage(a){this.wrappedOnMessage=a}close(){this.closeFn()}send(a){this.sendFn(a)}callOnConnected(){this.wrappedOnConnected()}callOnOpen(){this.wrappedOnOpen()}callOnClose(a){this.wrappedOnClose(a)}callOnMessage(a){this.wrappedOnMessage(a)}}let Il=null;function Im(){return 0x10000000+Math.round(0x80000000*Math.random())}function In(){return null===Il?Il=Im():Il++,"0x"+Il.toString(16)}function Io(a){return new Promise((b,c)=>{a((a,d)=>{a?c(a):b(d)})})}let Ip="1.9.15",Iq="GrpcConnection",Ir=`gl-node/${process.versions.node} fire/${wJ} grpc/${Ip}`;function Is(a,b,c,d){wU(null===b||"OAuth"===b.type,36936);let e=new wE.OS;return b&&b.headers.forEach((a,b)=>e.set(b,a)),c&&c.headers.forEach((a,b)=>e.set(b,a)),d&&e.set("X-Firebase-GMPID",d),e.set("X-Goog-Api-Client",Ir),e.set("Google-Cloud-Resource-Prefix",a),e.set("x-goog-request-params",a),e}class It{get shouldResourcePathBeIncludedInRequest(){return!0}constructor(a,b){this.databaseInfo=b,this.cachedStub=null,this.firestore=a.google.firestore.v1,this.databasePath=`projects/${b.databaseId.projectId}/databases/${b.databaseId.database}`}ensureActiveStub(){if(!this.cachedStub){wO(Iq,"Creating Firestore stub.");let a=this.databaseInfo.ssl?wE.z3.createSsl():wE.z3.createInsecure();this.cachedStub=new this.firestore.Firestore(this.databaseInfo.host,a)}return this.cachedStub}invokeRPC(a,b,c,d,e){let f=In(),g=this.ensureActiveStub(),h=Is(this.databasePath,d,e,this.databaseInfo.appId),i=Object.assign({database:this.databasePath},c);return Io(b=>(wO(Iq,`RPC '${a}' ${f} invoked with request:`,c),g[a](i,h,(c,d)=>{c?(wO(Iq,`RPC '${a}' ${f} failed with error:`,c),b(new wX(CS(c.code),c.message))):(wO(Iq,`RPC '${a}' ${f} completed with response:`,d),b(void 0,d))})))}invokeStreamingRPC(a,b,c,d,e,f){let g=In(),h=[],i=new wY;wO(Iq,`RPC '${a}' ${g} invoked (streaming) with request:`,c);let j=this.ensureActiveStub(),k=Is(this.databasePath,d,e,this.databaseInfo.appId),l=Object.assign(Object.assign({},c),{database:this.databasePath}),m=j[a](l,k),n=!1;return m.on("data",b=>{wO(Iq,`RPC ${a} ${g} received result:`,b),h.push(b),void 0!==f&&h.length===f&&(n=!0,i.resolve(h))}),m.on("end",()=>{wO(Iq,`RPC '${a}' ${g} completed.`),n||(n=!0,i.resolve(h))}),m.on("error",b=>{wO(Iq,`RPC '${a}' ${g} failed with error:`,b);let c=CS(b.code);i.reject(new wX(c,b.message))}),i.promise}openStream(a,b,c){let d=In(),e=this.ensureActiveStub(),f=Is(this.databasePath,b,c,this.databaseInfo.appId),g=e[a](f),h=!1,i=a=>{h||(h=!0,j.callOnClose(a),g.end())},j=new Ik({sendFn:b=>{if(h)wO(Iq,`RPC '${a}' stream ${d} not sending because gRPC stream is closed:`,b);else{wO(Iq,`RPC '${a}' stream ${d} sending:`,b);try{g.write(b)}catch(a){throw wP("Failure sending:",b),wP("Error:",a),a}}},closeFn:()=>{wO(Iq,`RPC '${a}' stream ${d} closed locally via close().`),i()}}),k=!1;return g.on("data",b=>{h||(wO(Iq,`RPC '${a}' stream ${d} received:`,b),k||(j.callOnConnected(),k=!0),j.callOnMessage(b))}),g.on("end",()=>{wO(Iq,`RPC '${a}' stream ${d} ended.`),i()}),g.on("error",b=>{h||(wQ(Iq,`RPC '${a}' stream ${d} error. Code:`,b.code,"Message:",b.message),i(new wX(CS(b.code),b.message)))}),wO(Iq,`Opening RPC '${a}' stream ${d} to ${this.databaseInfo.host}`),setTimeout(()=>{j.callOnOpen()},0),j}terminate(){this.cachedStub&&(this.cachedStub.close(),this.cachedStub=void 0)}}let Iu={google:{nested:{protobuf:{options:{csharp_namespace:"Google.Protobuf.WellKnownTypes",go_package:"github.com/golang/protobuf/ptypes/wrappers",java_package:"com.google.protobuf",java_outer_classname:"WrappersProto",java_multiple_files:!0,objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{Timestamp:{fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}},FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}},Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},Empty:{fields:{}},DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}},Any:{fields:{typeUrl:{type:"string",id:1},value:{type:"bytes",id:2}}}}},firestore:{nested:{v1:{options:{csharp_namespace:"Google.Cloud.Firestore.V1",go_package:"google.golang.org/genproto/googleapis/firestore/v1;firestore",java_multiple_files:!0,java_outer_classname:"WriteProto",java_package:"com.google.firestore.v1",objc_class_prefix:"GCFS",php_namespace:"Google\\Cloud\\Firestore\\V1",ruby_package:"Google::Cloud::Firestore::V1"},nested:{AggregationResult:{fields:{aggregateFields:{keyType:"string",type:"Value",id:2}}},BitSequence:{fields:{bitmap:{type:"bytes",id:1},padding:{type:"int32",id:2}}},BloomFilter:{fields:{bits:{type:"BitSequence",id:1},hashCount:{type:"int32",id:2}}},DocumentMask:{fields:{fieldPaths:{rule:"repeated",type:"string",id:1}}},Precondition:{oneofs:{conditionType:{oneof:["exists","updateTime"]}},fields:{exists:{type:"bool",id:1},updateTime:{type:"google.protobuf.Timestamp",id:2}}},TransactionOptions:{oneofs:{mode:{oneof:["readOnly","readWrite"]}},fields:{readOnly:{type:"ReadOnly",id:2},readWrite:{type:"ReadWrite",id:3}},nested:{ReadWrite:{fields:{retryTransaction:{type:"bytes",id:1}}},ReadOnly:{oneofs:{consistencySelector:{oneof:["readTime"]}},fields:{readTime:{type:"google.protobuf.Timestamp",id:2}}}}},Document:{fields:{name:{type:"string",id:1},fields:{keyType:"string",type:"Value",id:2},createTime:{type:"google.protobuf.Timestamp",id:3},updateTime:{type:"google.protobuf.Timestamp",id:4}}},Value:{oneofs:{valueType:{oneof:["nullValue","booleanValue","integerValue","doubleValue","timestampValue","stringValue","bytesValue","referenceValue","geoPointValue","arrayValue","mapValue"]}},fields:{nullValue:{type:"google.protobuf.NullValue",id:11},booleanValue:{type:"bool",id:1},integerValue:{type:"int64",id:2},doubleValue:{type:"double",id:3},timestampValue:{type:"google.protobuf.Timestamp",id:10},stringValue:{type:"string",id:17},bytesValue:{type:"bytes",id:18},referenceValue:{type:"string",id:5},geoPointValue:{type:"google.type.LatLng",id:8},arrayValue:{type:"ArrayValue",id:9},mapValue:{type:"MapValue",id:6}}},ArrayValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},MapValue:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Firestore:{options:{"(google.api.default_host)":"firestore.googleapis.com","(google.api.oauth_scopes)":"https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/datastore"},methods:{GetDocument:{requestType:"GetDocumentRequest",responseType:"Document",options:{"(google.api.http).get":"/v1/{name=projects/*/databases/*/documents/*/**}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{name=projects/*/databases/*/documents/*/**}"}}]},ListDocuments:{requestType:"ListDocumentsRequest",responseType:"ListDocumentsResponse",options:{"(google.api.http).get":"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"}}]},UpdateDocument:{requestType:"UpdateDocumentRequest",responseType:"Document",options:{"(google.api.http).patch":"/v1/{document.name=projects/*/databases/*/documents/*/**}","(google.api.http).body":"document","(google.api.method_signature)":"document,update_mask"},parsedOptions:[{"(google.api.http)":{patch:"/v1/{document.name=projects/*/databases/*/documents/*/**}",body:"document"}},{"(google.api.method_signature)":"document,update_mask"}]},DeleteDocument:{requestType:"DeleteDocumentRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).delete":"/v1/{name=projects/*/databases/*/documents/*/**}","(google.api.method_signature)":"name"},parsedOptions:[{"(google.api.http)":{delete:"/v1/{name=projects/*/databases/*/documents/*/**}"}},{"(google.api.method_signature)":"name"}]},BatchGetDocuments:{requestType:"BatchGetDocumentsRequest",responseType:"BatchGetDocumentsResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchGet","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchGet",body:"*"}}]},BeginTransaction:{requestType:"BeginTransactionRequest",responseType:"BeginTransactionResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:beginTransaction","(google.api.http).body":"*","(google.api.method_signature)":"database"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:beginTransaction",body:"*"}},{"(google.api.method_signature)":"database"}]},Commit:{requestType:"CommitRequest",responseType:"CommitResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:commit","(google.api.http).body":"*","(google.api.method_signature)":"database,writes"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:commit",body:"*"}},{"(google.api.method_signature)":"database,writes"}]},Rollback:{requestType:"RollbackRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:rollback","(google.api.http).body":"*","(google.api.method_signature)":"database,transaction"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:rollback",body:"*"}},{"(google.api.method_signature)":"database,transaction"}]},RunQuery:{requestType:"RunQueryRequest",responseType:"RunQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery",body:"*"}}}]},RunAggregationQuery:{requestType:"RunAggregationQueryRequest",responseType:"RunAggregationQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery",body:"*"}}}]},PartitionQuery:{requestType:"PartitionQueryRequest",responseType:"PartitionQueryResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:partitionQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:partitionQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery",body:"*"}}}]},Write:{requestType:"WriteRequest",requestStream:!0,responseType:"WriteResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:write","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:write",body:"*"}}]},Listen:{requestType:"ListenRequest",requestStream:!0,responseType:"ListenResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:listen","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:listen",body:"*"}}]},ListCollectionIds:{requestType:"ListCollectionIdsRequest",responseType:"ListCollectionIdsResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds","(google.api.http).additional_bindings.body":"*","(google.api.method_signature)":"parent"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds",body:"*"}}},{"(google.api.method_signature)":"parent"}]},BatchWrite:{requestType:"BatchWriteRequest",responseType:"BatchWriteResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchWrite","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchWrite",body:"*"}}]},CreateDocument:{requestType:"CreateDocumentRequest",responseType:"Document",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}","(google.api.http).body":"document"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}",body:"document"}}]}}},GetDocumentRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:5}}},ListDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:3},pageToken:{type:"string",id:4},orderBy:{type:"string",id:6},mask:{type:"DocumentMask",id:7},transaction:{type:"bytes",id:8},readTime:{type:"google.protobuf.Timestamp",id:10},showMissing:{type:"bool",id:12}}},ListDocumentsResponse:{fields:{documents:{rule:"repeated",type:"Document",id:1},nextPageToken:{type:"string",id:2}}},CreateDocumentRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},documentId:{type:"string",id:3},document:{type:"Document",id:4,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:5}}},UpdateDocumentRequest:{fields:{document:{type:"Document",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},updateMask:{type:"DocumentMask",id:2},mask:{type:"DocumentMask",id:3},currentDocument:{type:"Precondition",id:4}}},DeleteDocumentRequest:{fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},currentDocument:{type:"Precondition",id:2}}},BatchGetDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},documents:{rule:"repeated",type:"string",id:2},mask:{type:"DocumentMask",id:3},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:7}}},BatchGetDocumentsResponse:{oneofs:{result:{oneof:["found","missing"]}},fields:{found:{type:"Document",id:1},missing:{type:"string",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:4}}},BeginTransactionRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},options:{type:"TransactionOptions",id:2}}},BeginTransactionResponse:{fields:{transaction:{type:"bytes",id:1}}},CommitRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},transaction:{type:"bytes",id:3}}},CommitResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},commitTime:{type:"google.protobuf.Timestamp",id:2}}},RollbackRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},transaction:{type:"bytes",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}}}},RunQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},transaction:{type:"bytes",id:5},newTransaction:{type:"TransactionOptions",id:6},readTime:{type:"google.protobuf.Timestamp",id:7}}},RunQueryResponse:{fields:{transaction:{type:"bytes",id:2},document:{type:"Document",id:1},readTime:{type:"google.protobuf.Timestamp",id:3},skippedResults:{type:"int32",id:4}}},RunAggregationQueryRequest:{oneofs:{queryType:{oneof:["structuredAggregationQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredAggregationQuery:{type:"StructuredAggregationQuery",id:2},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:6}}},RunAggregationQueryResponse:{fields:{result:{type:"AggregationResult",id:1},transaction:{type:"bytes",id:2},readTime:{type:"google.protobuf.Timestamp",id:3}}},PartitionQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},partitionCount:{type:"int64",id:3},pageToken:{type:"string",id:4},pageSize:{type:"int32",id:5}}},PartitionQueryResponse:{fields:{partitions:{rule:"repeated",type:"Cursor",id:1},nextPageToken:{type:"string",id:2}}},WriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},streamId:{type:"string",id:2},writes:{rule:"repeated",type:"Write",id:3},streamToken:{type:"bytes",id:4},labels:{keyType:"string",type:"string",id:5}}},WriteResponse:{fields:{streamId:{type:"string",id:1},streamToken:{type:"bytes",id:2},writeResults:{rule:"repeated",type:"WriteResult",id:3},commitTime:{type:"google.protobuf.Timestamp",id:4}}},ListenRequest:{oneofs:{targetChange:{oneof:["addTarget","removeTarget"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},addTarget:{type:"Target",id:2},removeTarget:{type:"int32",id:3},labels:{keyType:"string",type:"string",id:4}}},ListenResponse:{oneofs:{responseType:{oneof:["targetChange","documentChange","documentDelete","documentRemove","filter"]}},fields:{targetChange:{type:"TargetChange",id:2},documentChange:{type:"DocumentChange",id:3},documentDelete:{type:"DocumentDelete",id:4},documentRemove:{type:"DocumentRemove",id:6},filter:{type:"ExistenceFilter",id:5}}},Target:{oneofs:{targetType:{oneof:["query","documents"]},resumeType:{oneof:["resumeToken","readTime"]}},fields:{query:{type:"QueryTarget",id:2},documents:{type:"DocumentsTarget",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:11},targetId:{type:"int32",id:5},once:{type:"bool",id:6},expectedCount:{type:"google.protobuf.Int32Value",id:12}},nested:{DocumentsTarget:{fields:{documents:{rule:"repeated",type:"string",id:2}}},QueryTarget:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1},structuredQuery:{type:"StructuredQuery",id:2}}}}},TargetChange:{fields:{targetChangeType:{type:"TargetChangeType",id:1},targetIds:{rule:"repeated",type:"int32",id:2},cause:{type:"google.rpc.Status",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:6}},nested:{TargetChangeType:{values:{NO_CHANGE:0,ADD:1,REMOVE:2,CURRENT:3,RESET:4}}}},ListCollectionIdsRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:2},pageToken:{type:"string",id:3}}},ListCollectionIdsResponse:{fields:{collectionIds:{rule:"repeated",type:"string",id:1},nextPageToken:{type:"string",id:2}}},BatchWriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},labels:{keyType:"string",type:"string",id:3}}},BatchWriteResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},status:{rule:"repeated",type:"google.rpc.Status",id:2}}},StructuredQuery:{fields:{select:{type:"Projection",id:1},from:{rule:"repeated",type:"CollectionSelector",id:2},where:{type:"Filter",id:3},orderBy:{rule:"repeated",type:"Order",id:4},startAt:{type:"Cursor",id:7},endAt:{type:"Cursor",id:8},offset:{type:"int32",id:6},limit:{type:"google.protobuf.Int32Value",id:5}},nested:{CollectionSelector:{fields:{collectionId:{type:"string",id:2},allDescendants:{type:"bool",id:3}}},Filter:{oneofs:{filterType:{oneof:["compositeFilter","fieldFilter","unaryFilter"]}},fields:{compositeFilter:{type:"CompositeFilter",id:1},fieldFilter:{type:"FieldFilter",id:2},unaryFilter:{type:"UnaryFilter",id:3}}},CompositeFilter:{fields:{op:{type:"Operator",id:1},filters:{rule:"repeated",type:"Filter",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,AND:1,OR:2}}}},FieldFilter:{fields:{field:{type:"FieldReference",id:1},op:{type:"Operator",id:2},value:{type:"Value",id:3}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,LESS_THAN:1,LESS_THAN_OR_EQUAL:2,GREATER_THAN:3,GREATER_THAN_OR_EQUAL:4,EQUAL:5,NOT_EQUAL:6,ARRAY_CONTAINS:7,IN:8,ARRAY_CONTAINS_ANY:9,NOT_IN:10}}}},UnaryFilter:{oneofs:{operandType:{oneof:["field"]}},fields:{op:{type:"Operator",id:1},field:{type:"FieldReference",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,IS_NAN:2,IS_NULL:3,IS_NOT_NAN:4,IS_NOT_NULL:5}}}},Order:{fields:{field:{type:"FieldReference",id:1},direction:{type:"Direction",id:2}}},FieldReference:{fields:{fieldPath:{type:"string",id:2}}},Projection:{fields:{fields:{rule:"repeated",type:"FieldReference",id:2}}},Direction:{values:{DIRECTION_UNSPECIFIED:0,ASCENDING:1,DESCENDING:2}}}},StructuredAggregationQuery:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{structuredQuery:{type:"StructuredQuery",id:1},aggregations:{rule:"repeated",type:"Aggregation",id:3}},nested:{Aggregation:{oneofs:{operator:{oneof:["count","sum","avg"]}},fields:{count:{type:"Count",id:1},sum:{type:"Sum",id:2},avg:{type:"Avg",id:3},alias:{type:"string",id:7}},nested:{Count:{fields:{upTo:{type:"google.protobuf.Int64Value",id:1}}},Sum:{fields:{field:{type:"FieldReference",id:1}}},Avg:{fields:{field:{type:"FieldReference",id:1}}}}}}},Cursor:{fields:{values:{rule:"repeated",type:"Value",id:1},before:{type:"bool",id:2}}},Write:{oneofs:{operation:{oneof:["update","delete","verify","transform"]}},fields:{update:{type:"Document",id:1},delete:{type:"string",id:2},verify:{type:"string",id:5},transform:{type:"DocumentTransform",id:6},updateMask:{type:"DocumentMask",id:3},updateTransforms:{rule:"repeated",type:"DocumentTransform.FieldTransform",id:7},currentDocument:{type:"Precondition",id:4}}},DocumentTransform:{fields:{document:{type:"string",id:1},fieldTransforms:{rule:"repeated",type:"FieldTransform",id:2}},nested:{FieldTransform:{oneofs:{transformType:{oneof:["setToServerValue","increment","maximum","minimum","appendMissingElements","removeAllFromArray"]}},fields:{fieldPath:{type:"string",id:1},setToServerValue:{type:"ServerValue",id:2},increment:{type:"Value",id:3},maximum:{type:"Value",id:4},minimum:{type:"Value",id:5},appendMissingElements:{type:"ArrayValue",id:6},removeAllFromArray:{type:"ArrayValue",id:7}},nested:{ServerValue:{values:{SERVER_VALUE_UNSPECIFIED:0,REQUEST_TIME:1}}}}}},WriteResult:{fields:{updateTime:{type:"google.protobuf.Timestamp",id:1},transformResults:{rule:"repeated",type:"Value",id:2}}},DocumentChange:{fields:{document:{type:"Document",id:1},targetIds:{rule:"repeated",type:"int32",id:5},removedTargetIds:{rule:"repeated",type:"int32",id:6}}},DocumentDelete:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:6},readTime:{type:"google.protobuf.Timestamp",id:4}}},DocumentRemove:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:2},readTime:{type:"google.protobuf.Timestamp",id:4}}},ExistenceFilter:{fields:{targetId:{type:"int32",id:1},count:{type:"int32",id:2},unchangedNames:{type:"BloomFilter",id:3}}}}}}},api:{options:{go_package:"google.golang.org/genproto/googleapis/api/annotations;annotations",java_multiple_files:!0,java_outer_classname:"HttpProto",java_package:"com.google.api",objc_class_prefix:"GAPI",cc_enable_arenas:!0},nested:{http:{type:"HttpRule",id:0x44f2530,extend:"google.protobuf.MethodOptions"},Http:{fields:{rules:{rule:"repeated",type:"HttpRule",id:1}}},HttpRule:{oneofs:{pattern:{oneof:["get","put","post","delete","patch","custom"]}},fields:{get:{type:"string",id:2},put:{type:"string",id:3},post:{type:"string",id:4},delete:{type:"string",id:5},patch:{type:"string",id:6},custom:{type:"CustomHttpPattern",id:8},selector:{type:"string",id:1},body:{type:"string",id:7},additionalBindings:{rule:"repeated",type:"HttpRule",id:11}}},CustomHttpPattern:{fields:{kind:{type:"string",id:1},path:{type:"string",id:2}}},methodSignature:{rule:"repeated",type:"string",id:1051,extend:"google.protobuf.MethodOptions"},defaultHost:{type:"string",id:1049,extend:"google.protobuf.ServiceOptions"},oauthScopes:{type:"string",id:1050,extend:"google.protobuf.ServiceOptions"},fieldBehavior:{rule:"repeated",type:"google.api.FieldBehavior",id:1052,extend:"google.protobuf.FieldOptions"},FieldBehavior:{values:{FIELD_BEHAVIOR_UNSPECIFIED:0,OPTIONAL:1,REQUIRED:2,OUTPUT_ONLY:3,INPUT_ONLY:4,IMMUTABLE:5,UNORDERED_LIST:6,NON_EMPTY_DEFAULT:7}}}},type:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/type/latlng;latlng",java_multiple_files:!0,java_outer_classname:"LatLngProto",java_package:"com.google.type",objc_class_prefix:"GTP"},nested:{LatLng:{fields:{latitude:{type:"double",id:1},longitude:{type:"double",id:2}}}}},rpc:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/rpc/status;status",java_multiple_files:!0,java_outer_classname:"StatusProto",java_package:"com.google.rpc",objc_class_prefix:"RPC"},nested:{Status:{fields:{code:{type:"int32",id:1},message:{type:"string",id:2},details:{rule:"repeated",type:"google.protobuf.Any",id:3}}}}}}}};var Iv={nested:Iu},Iw=Object.freeze({__proto__:null,nested:Iu,default:Iv});let Ix={longs:String,enums:String,defaults:!0,oneofs:!1};function Iy(){let a=wF.rS(Iw,Ix);return wE.ex(a)}function Iz(a){return new It(Iy(),a)}function IA(){return new Ij}function IB(){return"YES"===process.env.USE_MOCK_PERSISTENCE?window:null}function IC(){return null}function ID(a){return new Dd(a,!1)}let IE="ExponentialBackoff",IF=1e3,IG=1.5,IH=6e4;class II{constructor(a,b,c=IF,d=IG,e=IH){this.queue=a,this.timerId=b,this.initialDelayMs=c,this.backoffFactor=d,this.maxDelayMs=e,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(a){this.cancel();let b=Math.floor(this.currentBaseMs+this.jitterDelayMs()),c=Math.max(0,Date.now()-this.lastAttemptTime),d=Math.max(0,b-c);d>0&&wO(IE,`Backing off for ${d} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${b} ms, last attempt: ${c} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,d,()=>(this.lastAttemptTime=Date.now(),a())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){null!==this.timerPromise&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}}let IJ="PersistentStream",IK=6e4,IL=1e4;class IM{constructor(a,b,c,d,e,f,g,h){this.queue=a,this.idleTimerId=c,this.healthTimerId=d,this.connection=e,this.authCredentialsProvider=f,this.appCheckCredentialsProvider=g,this.listener=h,this.state=0,this.closeCount=0,this.idleTimer=null,this.healthCheck=null,this.stream=null,this.responseCount=0,this.backoff=new II(a,b)}isStarted(){return 1===this.state||5===this.state||this.isOpen()}isOpen(){return 2===this.state||3===this.state}start(){if(this.responseCount=0,4===this.state)return void this.performBackoff();this.auth()}async stop(){this.isStarted()&&await this.close(0)}inhibitBackoff(){this.state=0,this.backoff.reset()}markIdle(){this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,IK,()=>this.handleIdleCloseTimer()))}sendRequest(a){this.cancelIdleCheck(),this.stream.send(a)}async handleIdleCloseTimer(){if(this.isOpen())return this.close(0)}cancelIdleCheck(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)}cancelHealthCheck(){this.healthCheck&&(this.healthCheck.cancel(),this.healthCheck=null)}async close(a,b){this.cancelIdleCheck(),this.cancelHealthCheck(),this.backoff.cancel(),this.closeCount++,4!==a?this.backoff.reset():b&&b.code===wW.RESOURCE_EXHAUSTED?(wP(b.toString()),wP("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):b&&b.code===wW.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=a,await this.listener.onClose(b)}tearDown(){}auth(){this.state=1;let a=this.getCloseGuardedDispatcher(this.closeCount),b=this.closeCount;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([a,c])=>{this.closeCount===b&&this.startStream(a,c)},b=>{a(()=>{let a=new wX(wW.UNKNOWN,"Fetching auth token failed: "+b.message);return this.handleStreamClose(a)})})}startStream(a,b){let c=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(a,b),this.stream.onConnected(()=>{c(()=>this.listener.onConnected())}),this.stream.onOpen(()=>{c(()=>(this.state=2,this.healthCheck=this.queue.enqueueAfterDelay(this.healthTimerId,IL,()=>(this.isOpen()&&(this.state=3),Promise.resolve())),this.listener.onOpen()))}),this.stream.onClose(a=>{c(()=>this.handleStreamClose(a))}),this.stream.onMessage(a=>{c(()=>1==++this.responseCount?this.onFirst(a):this.onNext(a))})}performBackoff(){this.state=5,this.backoff.backoffAndRun(async()=>{this.state=0,this.start()})}handleStreamClose(a){return wO(IJ,`close with error: ${a}`),this.stream=null,this.close(4,a)}getCloseGuardedDispatcher(a){return b=>{this.queue.enqueueAndForget(()=>this.closeCount===a?b():(wO(IJ,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class IN extends IM{constructor(a,b,c,d,e,f){super(a,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",b,c,d,f),this.serializer=e}startRpc(a,b){return this.connection.openStream("Listen",a,b)}onFirst(a){return this.onNext(a)}onNext(a){this.backoff.reset();let b=DD(this.serializer,a),c=DF(a);return this.listener.onWatchChange(b,c)}watch(a){let b={};b.database=Du(this.serializer),b.addTarget=DW(this.serializer,a);let c=DU(this.serializer,a);c&&(b.labels=c),this.sendRequest(b)}unwatch(a){let b={};b.database=Du(this.serializer),b.removeTarget=a,this.sendRequest(b)}}class IO extends IM{constructor(a,b,c,d,e,f){super(a,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",b,c,d,f),this.serializer=e}get handshakeComplete(){return this.responseCount>0}start(){this.lastStreamToken=void 0,super.start()}tearDown(){this.handshakeComplete&&this.writeMutations([])}startRpc(a,b){return this.connection.openStream("Write",a,b)}onFirst(a){return wU(!!a.streamToken,31322),this.lastStreamToken=a.streamToken,wU(!a.writeResults||0===a.writeResults.length,55816),this.listener.onHandshakeComplete()}onNext(a){wU(!!a.streamToken,12678),this.lastStreamToken=a.streamToken,this.backoff.reset();let b=DL(a.writeResults,a.commitTime),c=Dm(a.commitTime);return this.listener.onMutationResult(c,b)}writeHandshake(){let a={};a.database=Du(this.serializer),this.sendRequest(a)}writeMutations(a){let b={streamToken:this.lastStreamToken,writes:a.map(a=>DG(this.serializer,a))};this.sendRequest(b)}}class IP{}class IQ extends IP{constructor(a,b,c,d){super(),this.authCredentials=a,this.appCheckCredentials=b,this.connection=c,this.serializer=d,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new wX(wW.FAILED_PRECONDITION,"The client has already been terminated.")}invokeRPC(a,b,c,d){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([e,f])=>this.connection.invokeRPC(a,Do(b,c),d,e,f)).catch(a=>{if("FirebaseError"===a.name)throw a.code===wW.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a;throw new wX(wW.UNKNOWN,a.toString())})}invokeStreamingRPC(a,b,c,d,e){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([f,g])=>this.connection.invokeStreamingRPC(a,Do(b,c),d,f,g,e)).catch(a=>{if("FirebaseError"===a.name)throw a.code===wW.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a;throw new wX(wW.UNKNOWN,a.toString())})}terminate(){this.terminated=!0,this.connection.terminate()}}function IR(a,b,c,d){return new IQ(a,b,c,d)}async function IS(a,b){let c=wV(a),d={writes:b.map(a=>DG(c.serializer,a))};await c.invokeRPC("Commit",c.serializer.databaseId,xm.emptyPath(),d)}async function IT(a,b){let c=wV(a),d={documents:b.map(a=>Dq(c.serializer,a))},e=await c.invokeStreamingRPC("BatchGetDocuments",c.serializer.databaseId,xm.emptyPath(),d,b.length),f=new Map;e.forEach(a=>{let b=DC(c.serializer,a);f.set(b.key.toString(),b)});let g=[];return b.forEach(a=>{let b=f.get(a.toString());wU(!!b,55234,{key:a}),g.push(b)}),g}async function IU(a,b,c){var d;let e=wV(a),{request:f,aliasMap:g,parent:h}=DR(e.serializer,BA(b),c);e.connection.shouldResourcePathBeIncludedInRequest||delete f.parent;let i=(await e.invokeStreamingRPC("RunAggregationQuery",e.serializer.databaseId,h,f,1)).filter(a=>!!a.result);wU(1===i.length,64727);let j=null==(d=i[0].result)?void 0:d.aggregateFields;return Object.keys(j).reduce((a,b)=>(a[g[b]]=j[b],a),{})}function IV(a,b,c){let d=wV(a);return d.verifyInitialized(),new IO(b,d.connection,d.authCredentials,d.appCheckCredentials,d.serializer,c)}function IW(a,b,c){let d=wV(a);return d.verifyInitialized(),new IN(b,d.connection,d.authCredentials,d.appCheckCredentials,d.serializer,c)}let IX="OnlineStateTracker",IY=1,IZ=1e4;class I${constructor(a,b){this.asyncQueue=a,this.onlineStateHandler=b,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}handleWatchStreamStart(){0===this.watchStreamFailures&&(this.setAndBroadcast("Unknown"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",IZ,()=>(this.onlineStateTimer=null,this.logClientOfflineWarningIfNecessary(`Backend didn't respond within ${IZ/1e3} seconds.`),this.setAndBroadcast("Offline"),Promise.resolve())))}handleWatchStreamFailure(a){"Online"===this.state?this.setAndBroadcast("Unknown"):(this.watchStreamFailures++,this.watchStreamFailures>=IY&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(`Connection failed ${IY} times. Most recent error: ${a.toString()}`),this.setAndBroadcast("Offline")))}set(a){this.clearOnlineStateTimer(),this.watchStreamFailures=0,"Online"===a&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(a)}setAndBroadcast(a){a!==this.state&&(this.state=a,this.onlineStateHandler(a))}logClientOfflineWarningIfNecessary(a){let b=`Could not reach Cloud Firestore backend. ${a}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.shouldWarnClientIsOffline?(wP(b),this.shouldWarnClientIsOffline=!1):wO(IX,b)}clearOnlineStateTimer(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)}}let I_="RemoteStore",I0=10;class I1{constructor(a,b,c,d,e){this.localStore=a,this.datastore=b,this.asyncQueue=c,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=e,this.connectivityMonitor.addCallback(a=>{c.enqueueAndForget(async()=>{Je(this)&&(wO(I_,"Restarting streams for network reachability change."),await Jy(this))})}),this.onlineStateTracker=new I$(c,d)}}function I2(a,b,c,d,e){return new I1(a,b,c,d,e)}function I3(a){let b=wV(a);return b.offlineCauses.delete(0),I4(b)}async function I4(a){if(Je(a))for(let b of a.onNetworkStatusChange)await b(!0)}async function I5(a){let b=wV(a);b.offlineCauses.add(0),await I6(b),b.onlineStateTracker.set("Offline")}async function I6(a){for(let b of a.onNetworkStatusChange)await b(!1)}async function I7(a){let b=wV(a);wO(I_,"RemoteStore shutting down."),b.offlineCauses.add(5),await I6(b),b.connectivityMonitor.shutdown(),b.onlineStateTracker.set("Unknown")}function I8(a,b){let c=wV(a);!c.listenTargets.has(b.targetId)&&(c.listenTargets.set(b.targetId,b),Jd(c)?Jc(c):JB(c).isOpen()&&Ja(c,b))}function I9(a,b){let c=wV(a),d=JB(c);c.listenTargets.delete(b),d.isOpen()&&Jb(c,b),0===c.listenTargets.size&&(d.isOpen()?d.markIdle():Je(c)&&c.onlineStateTracker.set("Unknown"))}function Ja(a,b){if(a.watchChangeAggregator.recordPendingTargetRequest(b.targetId),b.resumeToken.approximateByteSize()>0||b.snapshotVersion.compareTo(xj.min())>0){let c=a.remoteSyncer.getRemoteKeysForTarget(b.targetId).size;b=b.withExpectedCount(c)}JB(a).watch(b)}function Jb(a,b){a.watchChangeAggregator.recordPendingTargetRequest(b),JB(a).unwatch(b)}function Jc(a){a.watchChangeAggregator=new C6({getRemoteKeysForTarget:b=>a.remoteSyncer.getRemoteKeysForTarget(b),getTargetDataForTarget:b=>a.listenTargets.get(b)||null,getDatabaseId:()=>a.datastore.serializer.databaseId}),JB(a).start(),a.onlineStateTracker.handleWatchStreamStart()}function Jd(a){return Je(a)&&!JB(a).isStarted()&&a.listenTargets.size>0}function Je(a){return 0===wV(a).offlineCauses.size}function Jf(a){a.watchChangeAggregator=void 0}async function Jg(a){a.onlineStateTracker.set("Online")}async function Jh(a){a.listenTargets.forEach((b,c)=>{Ja(a,b)})}async function Ji(a,b){Jf(a),Jd(a)?(a.onlineStateTracker.handleWatchStreamFailure(b),Jc(a)):a.onlineStateTracker.set("Unknown")}async function Jj(a,b,c){if(a.onlineStateTracker.set("Online"),b instanceof C3&&2===b.state&&b.cause){try{await Jn(a,b)}catch(c){wO(I_,"Failed to remove targets %s: %s ",b.targetIds.join(","),c),await Jk(a,c)}return}if(b instanceof C1?a.watchChangeAggregator.handleDocumentChange(b):b instanceof C2?a.watchChangeAggregator.handleExistenceFilter(b):a.watchChangeAggregator.handleTargetChange(b),!c.isEqual(xj.min()))try{let b=await Hv(a.localStore);c.compareTo(b)>=0&&await Jm(a,c)}catch(b){wO(I_,"Failed to raise snapshot:",b),await Jk(a,b)}}async function Jk(a,b,c){if(xQ(b))a.offlineCauses.add(1),await I6(a),a.onlineStateTracker.set("Offline"),c||(c=()=>Hv(a.localStore)),a.asyncQueue.enqueueRetryable(async()=>{wO(I_,"Retrying IndexedDB access"),await c(),a.offlineCauses.delete(1),await I4(a)});else throw b}function Jl(a,b){return b().catch(c=>Jk(a,c,b))}function Jm(a,b){let c=a.watchChangeAggregator.createRemoteEvent(b);return c.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){let e=a.listenTargets.get(d);e&&a.listenTargets.set(d,e.withResumeToken(c.resumeToken,b))}}),c.targetMismatches.forEach((b,c)=>{let d=a.listenTargets.get(b);d&&(a.listenTargets.set(b,d.withResumeToken(zu.EMPTY_BYTE_STRING,d.snapshotVersion)),Jb(a,b),Ja(a,new En(d.target,b,c,d.sequenceNumber)))}),a.remoteSyncer.applyRemoteEvent(c)}async function Jn(a,b){let c=b.cause;for(let d of b.targetIds)a.listenTargets.has(d)&&(await a.remoteSyncer.rejectListen(d,c),a.listenTargets.delete(d),a.watchChangeAggregator.removeTarget(d))}async function Jo(a){let b=wV(a),c=JC(b),d=b.writePipeline.length>0?b.writePipeline[b.writePipeline.length-1].batchId:zN;for(;Jp(b);)try{let a=await HA(b.localStore,d);if(null===a){0===b.writePipeline.length&&c.markIdle();break}d=a.batchId,Jq(b,a)}catch(a){await Jk(b,a)}Jr(b)&&Js(b)}function Jp(a){return Je(a)&&a.writePipeline.length<I0}function Jq(a,b){a.writePipeline.push(b);let c=JC(a);c.isOpen()&&c.handshakeComplete&&c.writeMutations(b.mutations)}function Jr(a){return Je(a)&&!JC(a).isStarted()&&a.writePipeline.length>0}function Js(a){JC(a).start()}async function Jt(a){JC(a).writeHandshake()}async function Ju(a){let b=JC(a);for(let c of a.writePipeline)b.writeMutations(c.mutations)}async function Jv(a,b,c){let d=a.writePipeline.shift(),e=CN.from(d,b,c);await Jl(a,()=>a.remoteSyncer.applySuccessfulWrite(e)),await Jo(a)}async function Jw(a,b){b&&JC(a).handshakeComplete&&await Jx(a,b),Jr(a)&&Js(a)}async function Jx(a,b){if(CR(b.code)){let c=a.writePipeline.shift();JC(a).inhibitBackoff(),await Jl(a,()=>a.remoteSyncer.rejectFailedWrite(c.batchId,b)),await Jo(a)}}async function Jy(a){let b=wV(a);b.offlineCauses.add(4),await I6(b),b.onlineStateTracker.set("Unknown"),b.offlineCauses.delete(4),await I4(b)}async function Jz(a,b){let c=wV(a);c.asyncQueue.verifyOperationInProgress(),wO(I_,"RemoteStore received new credentials");let d=Je(c);c.offlineCauses.add(3),await I6(c),d&&c.onlineStateTracker.set("Unknown"),await c.remoteSyncer.handleCredentialChange(b),c.offlineCauses.delete(3),await I4(c)}async function JA(a,b){let c=wV(a);b?(c.offlineCauses.delete(2),await I4(c)):b||(c.offlineCauses.add(2),await I6(c),c.onlineStateTracker.set("Unknown"))}function JB(a){return a.watchStream||(a.watchStream=IW(a.datastore,a.asyncQueue,{onConnected:Jg.bind(null,a),onOpen:Jh.bind(null,a),onClose:Ji.bind(null,a),onWatchChange:Jj.bind(null,a)}),a.onNetworkStatusChange.push(async b=>{b?(a.watchStream.inhibitBackoff(),Jd(a)?Jc(a):a.onlineStateTracker.set("Unknown")):(await a.watchStream.stop(),Jf(a))})),a.watchStream}function JC(a){return a.writeStream||(a.writeStream=IV(a.datastore,a.asyncQueue,{onConnected:()=>Promise.resolve(),onOpen:Jt.bind(null,a),onClose:Jw.bind(null,a),onHandshakeComplete:Ju.bind(null,a),onMutationResult:Jv.bind(null,a)}),a.onNetworkStatusChange.push(async b=>{b?(a.writeStream.inhibitBackoff(),await Jo(a)):(await a.writeStream.stop(),a.writePipeline.length>0&&(wO(I_,`Stopping write stream with ${a.writePipeline.length} pending writes`),a.writePipeline=[]))})),a.writeStream}let JD="AsyncQueue";class JE{constructor(a,b,c,d,e){this.asyncQueue=a,this.timerId=b,this.targetTimeMs=c,this.op=d,this.removalCallback=e,this.deferred=new wY,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(a,b,c,d,e){let f=new JE(a,b,Date.now()+c,d,e);return f.start(c),f}start(a){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),a)}skipDelay(){return this.handleDelayElapsed()}cancel(a){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new wX(wW.CANCELLED,"Operation cancelled"+(a?": "+a:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(a=>this.deferred.resolve(a))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function JF(a,b){if(wP(JD,`${b}: ${a}`),xQ(a))return new wX(wW.UNAVAILABLE,`${b}: ${a}`);throw a}class JG{static emptySet(a){return new JG(a.comparator)}constructor(a){a?this.comparator=(b,c)=>a(b,c)||xp.comparator(b.key,c.key):this.comparator=(a,b)=>xp.comparator(a.key,b.key),this.keyedMap=BW(),this.sortedSet=new zj(this.comparator)}has(a){return null!=this.keyedMap.get(a)}get(a){return this.keyedMap.get(a)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(a){let b=this.keyedMap.get(a);return b?this.sortedSet.indexOf(b):-1}get size(){return this.sortedSet.size}forEach(a){this.sortedSet.inorderTraversal((b,c)=>(a(b),!1))}add(a){let b=this.delete(a.key);return b.copy(b.keyedMap.insert(a.key,a),b.sortedSet.insert(a,null))}delete(a){let b=this.get(a);return b?this.copy(this.keyedMap.remove(a),this.sortedSet.remove(b)):this}isEqual(a){if(!(a instanceof JG)||this.size!==a.size)return!1;let b=this.sortedSet.getIterator(),c=a.sortedSet.getIterator();for(;b.hasNext();){let a=b.getNext().key,d=c.getNext().key;if(!a.isEqual(d))return!1}return!0}toString(){let a=[];return(this.forEach(b=>{a.push(b.toString())}),0===a.length)?"DocumentSet ()":"DocumentSet (\n  "+a.join("  \n")+"\n)"}copy(a,b){let c=new JG;return c.comparator=this.comparator,c.keyedMap=a,c.sortedSet=b,c}}class JH{constructor(){this.changeMap=new zj(xp.comparator)}track(a){let b=a.doc.key,c=this.changeMap.get(b);if(!c){this.changeMap=this.changeMap.insert(b,a);return}0!==a.type&&3===c.type?this.changeMap=this.changeMap.insert(b,a):3===a.type&&1!==c.type?this.changeMap=this.changeMap.insert(b,{type:c.type,doc:a.doc}):2===a.type&&2===c.type?this.changeMap=this.changeMap.insert(b,{type:2,doc:a.doc}):2===a.type&&0===c.type?this.changeMap=this.changeMap.insert(b,{type:0,doc:a.doc}):1===a.type&&0===c.type?this.changeMap=this.changeMap.remove(b):1===a.type&&2===c.type?this.changeMap=this.changeMap.insert(b,{type:1,doc:c.doc}):0===a.type&&1===c.type?this.changeMap=this.changeMap.insert(b,{type:2,doc:a.doc}):wS(63341,{change:a,oldChange:c})}getChanges(){let a=[];return this.changeMap.inorderTraversal((b,c)=>{a.push(c)}),a}}class JI{constructor(a,b,c,d,e,f,g,h,i){this.query=a,this.docs=b,this.oldDocs=c,this.docChanges=d,this.mutatedKeys=e,this.fromCache=f,this.syncStateChanged=g,this.excludesMetadataChanges=h,this.hasCachedResults=i}static fromInitialDocuments(a,b,c,d,e){let f=[];return b.forEach(a=>{f.push({type:0,doc:a})}),new JI(a,b,JG.emptySet(b),f,c,d,!0,!1,e)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(a){if(this.fromCache!==a.fromCache||this.hasCachedResults!==a.hasCachedResults||this.syncStateChanged!==a.syncStateChanged||!this.mutatedKeys.isEqual(a.mutatedKeys)||!BH(this.query,a.query)||!this.docs.isEqual(a.docs)||!this.oldDocs.isEqual(a.oldDocs))return!1;let b=this.docChanges,c=a.docChanges;if(b.length!==c.length)return!1;for(let a=0;a<b.length;a++)if(b[a].type!==c[a].type||!b[a].doc.isEqual(c[a].doc))return!1;return!0}}class JJ{constructor(){this.viewSnap=void 0,this.listeners=[]}hasRemoteListeners(){return this.listeners.some(a=>a.listensToRemoteStore())}}function JK(){return new JL}class JL{constructor(){this.queries=JM(),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set}terminate(){JU(this,new wX(wW.ABORTED,"Firestore shutting down"))}}function JM(){return new BS(a=>BI(a),BH)}async function JN(a,b){let c=wV(a),d=3,e=b.query,f=c.queries.get(e);f?!f.hasRemoteListeners()&&b.listensToRemoteStore()&&(d=2):(f=new JJ,d=+!b.listensToRemoteStore());try{switch(d){case 0:f.viewSnap=await c.onListen(e,!0);break;case 1:f.viewSnap=await c.onListen(e,!1);break;case 2:await c.onFirstRemoteStoreListen(e)}}catch(c){let a=JF(c,`Initialization of query '${BJ(b.query)}' failed`);b.onError(a);return}c.queries.set(e,f),f.listeners.push(b),b.applyOnlineStateChange(c.onlineState),f.viewSnap&&b.onViewSnapshot(f.viewSnap)&&JV(c)}async function JO(a,b){let c=wV(a),d=b.query,e=3,f=c.queries.get(d);if(f){let a=f.listeners.indexOf(b);a>=0&&(f.listeners.splice(a,1),0===f.listeners.length?e=+!b.listensToRemoteStore():!f.hasRemoteListeners()&&b.listensToRemoteStore()&&(e=2))}switch(e){case 0:return c.queries.delete(d),c.onUnlisten(d,!0);case 1:return c.queries.delete(d),c.onUnlisten(d,!1);case 2:return c.onLastRemoteStoreUnlisten(d);default:return}}function JP(a,b){let c=wV(a),d=!1;for(let a of b){let b=a.query,e=c.queries.get(b);if(e){for(let b of e.listeners)b.onViewSnapshot(a)&&(d=!0);e.viewSnap=a}}d&&JV(c)}function JQ(a,b,c){let d=wV(a),e=d.queries.get(b);if(e)for(let a of e.listeners)a.onError(c);d.queries.delete(b)}function JR(a,b){let c=wV(a);c.onlineState=b;let d=!1;c.queries.forEach((a,c)=>{for(let a of c.listeners)a.applyOnlineStateChange(b)&&(d=!0)}),d&&JV(c)}function JS(a,b){wV(a).snapshotsInSyncListeners.add(b),b.next()}function JT(a,b){wV(a).snapshotsInSyncListeners.delete(b)}function JU(a,b){let c=wV(a),d=c.queries;c.queries=JM(),d.forEach((a,c)=>{for(let a of c.listeners)a.onError(b)})}function JV(a){a.snapshotsInSyncListeners.forEach(a=>{a.next()})}!function(a){a.Default="default",a.Cache="cache"}(q||(q={}));class JW{constructor(a,b,c){this.query=a,this.queryObserver=b,this.raisedInitialEvent=!1,this.snap=null,this.onlineState="Unknown",this.options=c||{}}onViewSnapshot(a){if(!this.options.includeMetadataChanges){let b=[];for(let c of a.docChanges)3!==c.type&&b.push(c);a=new JI(a.query,a.docs,a.oldDocs,b,a.mutatedKeys,a.fromCache,a.syncStateChanged,!0,a.hasCachedResults)}let b=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(a)&&(this.queryObserver.next(a),b=!0):this.shouldRaiseInitialEvent(a,this.onlineState)&&(this.raiseInitialEvent(a),b=!0),this.snap=a,b}onError(a){this.queryObserver.error(a)}applyOnlineStateChange(a){this.onlineState=a;let b=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,a)&&(this.raiseInitialEvent(this.snap),b=!0),b}shouldRaiseInitialEvent(a,b){if(!a.fromCache||!this.listensToRemoteStore())return!0;let c="Offline"!==b;return(!this.options.waitForSyncWhenOnline||!c)&&(!a.docs.isEmpty()||a.hasCachedResults||"Offline"===b)}shouldRaiseEvent(a){if(a.docChanges.length>0)return!0;let b=this.snap&&this.snap.hasPendingWrites!==a.hasPendingWrites;return(!!a.syncStateChanged||!!b)&&!0===this.options.includeMetadataChanges}raiseInitialEvent(a){a=JI.fromInitialDocuments(a.query,a.docs,a.mutatedKeys,a.fromCache,a.hasCachedResults),this.raisedInitialEvent=!0,this.queryObserver.next(a)}listensToRemoteStore(){return this.options.source!==q.Cache}}class JX{constructor(a,b,c,d){this.targetId=a,this.fromCache=b,this.addedKeys=c,this.removedKeys=d}static fromSnapshot(a,b){let c=B3(),d=B3();for(let a of b.docChanges)switch(a.type){case 0:c=c.add(a.doc.key);break;case 1:d=d.add(a.doc.key)}return new JX(a,b.fromCache,c,d)}}class JY{constructor(a){this.serializer=a}toDocumentKey(a){return Dr(this.serializer,a)}toMutableDocument(a){return a.metadata.exists?Dz(this.serializer,a.document,!1):AF.newNoDocument(this.toDocumentKey(a.metadata.name),this.toSnapshotVersion(a.metadata.readTime))}toSnapshotVersion(a){return Dm(a)}}class JZ{constructor(a,b,c){this.bundleMetadata=a,this.localStore=b,this.serializer=c,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=J$(a)}addSizedElement(a){this.progress.bytesLoaded+=a.byteLength;let b=this.progress.documentsLoaded;if(a.payload.namedQuery)this.queries.push(a.payload.namedQuery);else if(a.payload.documentMetadata){this.documents.push({metadata:a.payload.documentMetadata}),!a.payload.documentMetadata.exists&&++b;let c=xm.fromString(a.payload.documentMetadata.name);this.collectionGroups.add(c.get(c.length-2))}else a.payload.document&&(this.documents[this.documents.length-1].document=a.payload.document,++b);return b!==this.progress.documentsLoaded?(this.progress.documentsLoaded=b,Object.assign({},this.progress)):null}getQueryDocumentMapping(a){let b=new Map,c=new JY(this.serializer);for(let d of a)if(d.metadata.queries){let a=c.toDocumentKey(d.metadata.name);for(let c of d.metadata.queries){let d=(b.get(c)||B3()).add(a);b.set(c,d)}}return b}async complete(){let a=await HO(this.localStore,new JY(this.serializer),this.documents,this.bundleMetadata.id),b=this.getQueryDocumentMapping(this.documents);for(let a of this.queries)await HS(this.localStore,a,b.get(a.name));return this.progress.taskState="Success",{progress:this.progress,changedCollectionGroups:this.collectionGroups,changedDocs:a}}}function J$(a){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:a.totalDocuments,totalBytes:a.totalBytes}}function J_(a){return{taskState:"Success",documentsLoaded:a.totalDocuments,bytesLoaded:a.totalBytes,totalDocuments:a.totalDocuments,totalBytes:a.totalBytes}}class J0{constructor(a){this.key=a}}class J1{constructor(a){this.key=a}}class J2{constructor(a,b){this.query=a,this._syncedDocuments=b,this.syncState=null,this.hasCachedResults=!1,this.current=!1,this.limboDocuments=B3(),this.mutatedKeys=B3(),this.docComparator=BQ(a),this.documentSet=new JG(this.docComparator)}get syncedDocuments(){return this._syncedDocuments}computeDocChanges(a,b){let c=b?b.changeSet:new JH,d=b?b.documentSet:this.documentSet,e=b?b.mutatedKeys:this.mutatedKeys,f=d,g=!1,h="F"===this.query.limitType&&d.size===this.query.limit?d.last():null,i="L"===this.query.limitType&&d.size===this.query.limit?d.first():null;if(a.inorderTraversal((a,b)=>{let j=d.get(a),k=BK(this.query,b)?b:null,l=!!j&&this.mutatedKeys.has(j.key),m=!!k&&(k.hasLocalMutations||this.mutatedKeys.has(k.key)&&k.hasCommittedMutations),n=!1;j&&k?j.data.isEqual(k.data)?l!==m&&(c.track({type:3,doc:k}),n=!0):!this.shouldWaitForSyncedDocument(j,k)&&(c.track({type:2,doc:k}),n=!0,(h&&this.docComparator(k,h)>0||i&&0>this.docComparator(k,i))&&(g=!0)):!j&&k?(c.track({type:0,doc:k}),n=!0):j&&!k&&(c.track({type:1,doc:j}),n=!0,(h||i)&&(g=!0)),n&&(k?(f=f.add(k),e=m?e.add(a):e.delete(a)):(f=f.delete(a),e=e.delete(a)))}),null!==this.query.limit)for(;f.size>this.query.limit;){let a="F"===this.query.limitType?f.last():f.first();f=f.delete(a.key),e=e.delete(a.key),c.track({type:1,doc:a})}return{documentSet:f,changeSet:c,needsRefill:g,mutatedKeys:e}}shouldWaitForSyncedDocument(a,b){return a.hasLocalMutations&&b.hasCommittedMutations&&!b.hasLocalMutations}applyChanges(a,b,c,d){let e=this.documentSet;this.documentSet=a.documentSet,this.mutatedKeys=a.mutatedKeys;let f=a.changeSet.getChanges();f.sort((a,b)=>J3(a.type,b.type)||this.docComparator(a.doc,b.doc)),this.applyTargetChange(c),d=null!=d&&d;let g=b&&!d?this.updateLimboDocuments():[],h=+!!(0===this.limboDocuments.size&&this.current&&!d),i=h!==this.syncState;return(this.syncState=h,0!==f.length||i)?{snapshot:new JI(this.query,a.documentSet,e,f,a.mutatedKeys,0===h,i,!1,!!c&&c.resumeToken.approximateByteSize()>0),limboChanges:g}:{limboChanges:g}}applyOnlineStateChange(a){return this.current&&"Offline"===a?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new JH,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}}shouldBeInLimbo(a){return!this._syncedDocuments.has(a)&&!!this.documentSet.has(a)&&!this.documentSet.get(a).hasLocalMutations}applyTargetChange(a){a&&(a.addedDocuments.forEach(a=>this._syncedDocuments=this._syncedDocuments.add(a)),a.modifiedDocuments.forEach(a=>{}),a.removedDocuments.forEach(a=>this._syncedDocuments=this._syncedDocuments.delete(a)),this.current=a.current)}updateLimboDocuments(){if(!this.current)return[];let a=this.limboDocuments;this.limboDocuments=B3(),this.documentSet.forEach(a=>{this.shouldBeInLimbo(a.key)&&(this.limboDocuments=this.limboDocuments.add(a.key))});let b=[];return a.forEach(a=>{this.limboDocuments.has(a)||b.push(new J1(a))}),this.limboDocuments.forEach(c=>{a.has(c)||b.push(new J0(c))}),b}synchronizeWithPersistedState(a){this._syncedDocuments=a.remoteKeys,this.limboDocuments=B3();let b=this.computeDocChanges(a.documents);return this.applyChanges(b,!0)}computeInitialSnapshot(){return JI.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,0===this.syncState,this.hasCachedResults)}}function J3(a,b){let c=a=>{switch(a){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return wS(20277,{change:a})}};return c(a)-c(b)}let J4="SyncEngine";class J5{constructor(a,b,c){this.query=a,this.targetId=b,this.view=c}}class J6{constructor(a){this.key=a,this.receivedDocument=!1}}class J7{constructor(a,b,c,d,e,f){this.localStore=a,this.remoteStore=b,this.eventManager=c,this.sharedClientState=d,this.currentUser=e,this.maxConcurrentLimboResolutions=f,this.syncEngineListener={},this.queryViewsByQuery=new BS(a=>BI(a),BH),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=new Set,this.activeLimboTargetsByKey=new zj(xp.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new GC,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=F0.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}get isPrimaryClient(){return!0===this._isPrimaryClient}}function J8(a,b,c,d,e,f,g){let h=new J7(a,b,c,d,e,f);return g&&(h._isPrimaryClient=!0),h}async function J9(a,b,c=!0){let d,e=KJ(a),f=e.queryViewsByQuery.get(b);return f?(e.sharedClientState.addLocalQueryTarget(f.targetId),d=f.view.computeInitialSnapshot()):d=await Kb(e,b,c,!0),d}async function Ka(a,b){let c=KJ(a);await Kb(c,b,!0,!1)}async function Kb(a,b,c,d){let e,f=await HC(a.localStore,Bz(b)),g=f.targetId,h=a.sharedClientState.addLocalQueryTarget(g,c);return d&&(e=await Kc(a,b,g,"current"===h,f.resumeToken)),a.isPrimaryClient&&c&&I8(a.remoteStore,f),e}async function Kc(a,b,c,d,e){a.applyDocChanges=(b,c,d)=>Kw(a,b,c,d);let f=await HF(a.localStore,b,!0),g=new J2(b,f.remoteKeys),h=g.computeDocChanges(f.documents),i=C0.createSynthesizedTargetChangeForCurrentChange(c,d&&"Offline"!==a.onlineState,e),j=g.applyChanges(h,a.isPrimaryClient,i);Ks(a,c,j.limboChanges);let k=new J5(b,c,g);return a.queryViewsByQuery.set(b,k),a.queriesByTarget.has(c)?a.queriesByTarget.get(c).push(b):a.queriesByTarget.set(c,[b]),j.snapshot}async function Kd(a,b,c){let d=wV(a),e=d.queryViewsByQuery.get(b),f=d.queriesByTarget.get(e.targetId);if(f.length>1){d.queriesByTarget.set(e.targetId,f.filter(a=>!BH(a,b))),d.queryViewsByQuery.delete(b);return}d.isPrimaryClient?(d.sharedClientState.removeLocalQueryTarget(e.targetId),d.sharedClientState.isActiveQueryTarget(e.targetId)||await HE(d.localStore,e.targetId,!1).then(()=>{d.sharedClientState.clearQueryState(e.targetId),c&&I9(d.remoteStore,e.targetId),Kq(d,e.targetId)}).catch(xH)):(Kq(d,e.targetId),await HE(d.localStore,e.targetId,!0))}async function Ke(a,b){let c=wV(a),d=c.queryViewsByQuery.get(b),e=c.queriesByTarget.get(d.targetId);c.isPrimaryClient&&1===e.length&&(c.sharedClientState.removeLocalQueryTarget(d.targetId),I9(c.remoteStore,d.targetId))}async function Kf(a,b,c){let d=KK(a);try{let a=await Hq(d.localStore,b);d.sharedClientState.addPendingMutation(a.batchId),Ko(d,a.batchId,c),await Kv(d,a.changes),await Jo(d.remoteStore)}catch(b){let a=JF(b,"Failed to persist write");c.reject(a)}}async function Kg(a,b){let c=wV(a);try{let a=await Hw(c.localStore,b);b.targetChanges.forEach((a,b)=>{let d=c.activeLimboResolutionsByTarget.get(b);d&&(wU(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?d.receivedDocument=!0:a.modifiedDocuments.size>0?wU(d.receivedDocument,14607):a.removedDocuments.size>0&&(wU(d.receivedDocument,42227),d.receivedDocument=!1))}),await Kv(c,a,b)}catch(a){await xH(a)}}function Kh(a,b,c){let d=wV(a);if(d.isPrimaryClient&&0===c||!d.isPrimaryClient&&1===c){let a=[];d.queryViewsByQuery.forEach((c,d)=>{let e=d.view.applyOnlineStateChange(b);e.snapshot&&a.push(e.snapshot)}),JR(d.eventManager,b),a.length&&d.syncEngineListener.onWatchChange(a),d.onlineState=b,d.isPrimaryClient&&d.sharedClientState.setOnlineState(b)}}async function Ki(a,b,c){let d=wV(a);d.sharedClientState.updateQueryState(b,"rejected",c);let e=d.activeLimboResolutionsByTarget.get(b),f=e&&e.key;if(f){let a=new zj(xp.comparator);a=a.insert(f,AF.newNoDocument(f,xj.min()));let c=B3().add(f),e=new C_(xj.min(),new Map,new zj(xa),a,c);await Kg(d,e),d.activeLimboTargetsByKey=d.activeLimboTargetsByKey.remove(f),d.activeLimboResolutionsByTarget.delete(b),Ku(d)}else await HE(d.localStore,b,!1).then(()=>Kq(d,b,c)).catch(xH)}async function Kj(a,b){let c=wV(a),d=b.batch.batchId;try{let a=await Hr(c.localStore,b);Kp(c,d,null),Km(c,d),c.sharedClientState.updateMutationState(d,"acknowledged"),await Kv(c,a)}catch(a){await xH(a)}}async function Kk(a,b,c){let d=wV(a);try{let a=await Ht(d.localStore,b);Kp(d,b,c),Km(d,b),d.sharedClientState.updateMutationState(b,"rejected",c),await Kv(d,a)}catch(a){await xH(a)}}async function Kl(a,b){let c=wV(a);Je(c.remoteStore)||wO(J4,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let a=await Hu(c.localStore);if(a===zN)return void b.resolve();let d=c.pendingWritesCallbacks.get(a)||[];d.push(b),c.pendingWritesCallbacks.set(a,d)}catch(c){let a=JF(c,"Initialization of waitForPendingWrites() operation failed");b.reject(a)}}function Km(a,b){(a.pendingWritesCallbacks.get(b)||[]).forEach(a=>{a.resolve()}),a.pendingWritesCallbacks.delete(b)}function Kn(a,b){a.pendingWritesCallbacks.forEach(a=>{a.forEach(a=>{a.reject(new wX(wW.CANCELLED,b))})}),a.pendingWritesCallbacks.clear()}function Ko(a,b,c){let d=a.mutationUserCallbacks[a.currentUser.toKey()];d||(d=new zj(xa)),d=d.insert(b,c),a.mutationUserCallbacks[a.currentUser.toKey()]=d}function Kp(a,b,c){let d=wV(a),e=d.mutationUserCallbacks[d.currentUser.toKey()];if(e){let a=e.get(b);a&&(c?a.reject(c):a.resolve(),e=e.remove(b)),d.mutationUserCallbacks[d.currentUser.toKey()]=e}}function Kq(a,b,c=null){for(let d of(a.sharedClientState.removeLocalQueryTarget(b),a.queriesByTarget.get(b)))a.queryViewsByQuery.delete(d),c&&a.syncEngineListener.onWatchError(d,c);a.queriesByTarget.delete(b),a.isPrimaryClient&&a.limboDocumentRefs.removeReferencesForId(b).forEach(b=>{a.limboDocumentRefs.containsKey(b)||Kr(a,b)})}function Kr(a,b){a.enqueuedLimboResolutions.delete(b.path.canonicalString());let c=a.activeLimboTargetsByKey.get(b);null!==c&&(I9(a.remoteStore,c),a.activeLimboTargetsByKey=a.activeLimboTargetsByKey.remove(b),a.activeLimboResolutionsByTarget.delete(c),Ku(a))}function Ks(a,b,c){for(let d of c)d instanceof J0?(a.limboDocumentRefs.addReference(d.key,b),Kt(a,d)):d instanceof J1?(wO(J4,"Document no longer in limbo: "+d.key),a.limboDocumentRefs.removeReference(d.key,b),a.limboDocumentRefs.containsKey(d.key)||Kr(a,d.key)):wS(19791,{limboChange:d})}function Kt(a,b){let c=b.key,d=c.path.canonicalString();a.activeLimboTargetsByKey.get(c)||a.enqueuedLimboResolutions.has(d)||(wO(J4,"New document in limbo: "+c),a.enqueuedLimboResolutions.add(d),Ku(a))}function Ku(a){for(;a.enqueuedLimboResolutions.size>0&&a.activeLimboTargetsByKey.size<a.maxConcurrentLimboResolutions;){let b=a.enqueuedLimboResolutions.values().next().value;a.enqueuedLimboResolutions.delete(b);let c=new xp(xm.fromString(b)),d=a.limboTargetIdGenerator.next();a.activeLimboResolutionsByTarget.set(d,new J6(c)),a.activeLimboTargetsByKey=a.activeLimboTargetsByKey.insert(c,d),I8(a.remoteStore,new En(Bz(Bs(c.path)),d,"TargetPurposeLimboResolution",x_.INVALID))}}async function Kv(a,b,c){let d=wV(a),e=[],f=[],g=[];d.queryViewsByQuery.isEmpty()||(d.queryViewsByQuery.forEach((a,h)=>{g.push(d.applyDocChanges(h,b,c).then(a=>{var b;if((a||c)&&d.isPrimaryClient){let e=a?!a.fromCache:null==(b=null==c?void 0:c.targetChanges.get(h.targetId))?void 0:b.current;d.sharedClientState.updateQueryState(h.targetId,e?"current":"not-current")}if(a){e.push(a);let b=JX.fromSnapshot(h.targetId,a);f.push(b)}}))}),await Promise.all(g),d.syncEngineListener.onWatchChange(e),await Hz(d.localStore,f))}async function Kw(a,b,c,d){let e=b.view.computeDocChanges(c);e.needsRefill&&(e=await HF(a.localStore,b.query,!1).then(({documents:a})=>b.view.computeDocChanges(a,e)));let f=d&&d.targetChanges.get(b.targetId),g=d&&null!=d.targetMismatches.get(b.targetId),h=b.view.applyChanges(e,a.isPrimaryClient,f,g);return Ks(a,b.targetId,h.limboChanges),h.snapshot}async function Kx(a,b){let c=wV(a);if(!c.currentUser.isEqual(b)){wO(J4,"User change. New user:",b.toKey());let a=await Hp(c.localStore,b);c.currentUser=b,Kn(c,"'waitForPendingWrites' promise is rejected due to a user change."),c.sharedClientState.handleUserChange(b,a.removedBatchIds,a.addedBatchIds),await Kv(c,a.affectedDocuments)}}function Ky(a,b){let c=wV(a),d=c.activeLimboResolutionsByTarget.get(b);if(d&&d.receivedDocument)return B3().add(d.key);{let a=B3(),d=c.queriesByTarget.get(b);if(!d)return a;for(let b of d){let d=c.queryViewsByQuery.get(b);a=a.unionWith(d.view.syncedDocuments)}return a}}async function Kz(a,b){let c=wV(a),d=await HF(c.localStore,b.query,!0),e=b.view.synchronizeWithPersistedState(d);return c.isPrimaryClient&&Ks(c,b.targetId,e.limboChanges),e}async function KA(a,b){let c=wV(a);return HL(c.localStore,b).then(a=>Kv(c,a))}async function KB(a,b,c,d){let e=wV(a),f=await HH(e.localStore,b);if(null===f)return void wO(J4,"Cannot apply mutation batch with id: "+b);"pending"===c?await Jo(e.remoteStore):"acknowledged"===c||"rejected"===c?(Kp(e,b,d||null),Km(e,b),HI(e.localStore,b)):wS(6720,"Unknown batchState",{batchState:c}),await Kv(e,f)}async function KC(a,b){let c=wV(a);if(KJ(c),KK(c),!0===b&&!0!==c._isPrimaryClient){let a=c.sharedClientState.getAllActiveQueryTargets(),b=await KE(c,a.toArray());for(let a of(c._isPrimaryClient=!0,await JA(c.remoteStore,!0),b))I8(c.remoteStore,a)}else if(!1===b&&!1!==c._isPrimaryClient){let a=[],b=Promise.resolve();c.queriesByTarget.forEach((d,e)=>{c.sharedClientState.isLocalQueryTarget(e)?a.push(e):b=b.then(()=>(Kq(c,e),HE(c.localStore,e,!0))),I9(c.remoteStore,e)}),await b,await KE(c,a),KD(c),c._isPrimaryClient=!1,await JA(c.remoteStore,!1)}}function KD(a){let b=wV(a);b.activeLimboResolutionsByTarget.forEach((a,c)=>{I9(b.remoteStore,c)}),b.limboDocumentRefs.removeAllReferences(),b.activeLimboResolutionsByTarget=new Map,b.activeLimboTargetsByKey=new zj(xp.comparator)}async function KE(a,b,c){let d=wV(a),e=[],f=[];for(let a of b){let b,c=d.queriesByTarget.get(a);if(c&&0!==c.length)for(let a of(b=await HC(d.localStore,Bz(c[0])),c)){let b=d.queryViewsByQuery.get(a),c=await Kz(d,b);c.snapshot&&f.push(c.snapshot)}else{let c=await HK(d.localStore,a);b=await HC(d.localStore,c),await Kc(d,KF(c),a,!1,b.resumeToken)}e.push(b)}return d.syncEngineListener.onWatchChange(f),e}function KF(a){return Br(a.path,a.collectionGroup,a.orderBy,a.filters,a.limit,"F",a.startAt,a.endAt)}function KG(a){return HJ(wV(a).localStore)}async function KH(a,b,c,d){let e=wV(a);if(e._isPrimaryClient)return void wO(J4,"Ignoring unexpected query state notification.");let f=e.queriesByTarget.get(b);if(f&&f.length>0)switch(c){case"current":case"not-current":{let a=await HL(e.localStore,BP(f[0])),d=C_.createSynthesizedRemoteEventForCurrentChange(b,"current"===c,zu.EMPTY_BYTE_STRING);await Kv(e,a,d);break}case"rejected":await HE(e.localStore,b,!0),Kq(e,b,d);break;default:wS(64155,c)}}async function KI(a,b,c){let d=KJ(a);if(d._isPrimaryClient){for(let a of b){if(d.queriesByTarget.has(a)&&d.sharedClientState.isActiveQueryTarget(a)){wO(J4,"Adding an already active target "+a);continue}let b=await HK(d.localStore,a),c=await HC(d.localStore,b);await Kc(d,KF(b),c.targetId,!1,c.resumeToken),I8(d.remoteStore,c)}for(let a of c)d.queriesByTarget.has(a)&&await HE(d.localStore,a,!1).then(()=>{I9(d.remoteStore,a),Kq(d,a)}).catch(xH)}}function KJ(a){let b=wV(a);return b.remoteStore.remoteSyncer.applyRemoteEvent=Kg.bind(null,b),b.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ky.bind(null,b),b.remoteStore.remoteSyncer.rejectListen=Ki.bind(null,b),b.syncEngineListener.onWatchChange=JP.bind(null,b.eventManager),b.syncEngineListener.onWatchError=JQ.bind(null,b.eventManager),b}function KK(a){let b=wV(a);return b.remoteStore.remoteSyncer.applySuccessfulWrite=Kj.bind(null,b),b.remoteStore.remoteSyncer.rejectFailedWrite=Kk.bind(null,b),b}function KL(a,b,c){let d=wV(a);KM(d,b,c).then(a=>{d.sharedClientState.notifyBundleLoaded(a)})}async function KM(a,b,c){try{let d=await b.getMetadata();if(await HP(a.localStore,d))return await b.close(),c._completeWith(J_(d)),Promise.resolve(new Set);c._updateProgress(J$(d));let e=new JZ(d,a.localStore,b.serializer),f=await b.nextElement();for(;f;){let a=await e.addSizedElement(f);a&&c._updateProgress(a),f=await b.nextElement()}let g=await e.complete();return await Kv(a,g.changedDocs,void 0),await HQ(a.localStore,d),c._completeWith(g.progress),Promise.resolve(g.changedCollectionGroups)}catch(a){return wQ(J4,`Loading bundle failed with ${a}`),c._failWith(a),Promise.resolve(new Set)}}class KN{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(a){this.serializer=ID(a.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(a),this.persistence=this.createPersistence(a),await this.persistence.start(),this.localStore=this.createLocalStore(a),this.gcScheduler=this.createGarbageCollectionScheduler(a,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(a,this.localStore)}createGarbageCollectionScheduler(a,b){return null}createIndexBackfillerScheduler(a,b){return null}createLocalStore(a){return Ho(this.persistence,new HZ,a.initialUser,this.serializer)}createPersistence(a){return new GM(GO.factory,this.serializer)}createSharedClientState(a){return new Ii}async terminate(){var a,b;null==(a=this.gcScheduler)||a.stop(),null==(b=this.indexBackfillerScheduler)||b.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}KN.provider={build:()=>new KN};class KO extends KN{constructor(a){super(),this.cacheSizeBytes=a}createGarbageCollectionScheduler(a,b){return wU(this.persistence.referenceDelegate instanceof GP,46915),new Gf(this.persistence.referenceDelegate.garbageCollector,a.asyncQueue,b)}createPersistence(a){let b=void 0!==this.cacheSizeBytes?F8.withCacheSize(this.cacheSizeBytes):F8.DEFAULT;return new GM(a=>GP.factory(a,b),this.serializer)}}class KP extends KN{constructor(a,b,c){super(),this.onlineComponentProvider=a,this.cacheSizeBytes=b,this.forceOwnership=c,this.kind="persistent",this.synchronizeTabs=!1}async initialize(a){await super.initialize(a),await this.onlineComponentProvider.initialize(this,a),await KK(this.onlineComponentProvider.syncEngine),await Jo(this.onlineComponentProvider.remoteStore),await this.persistence.setPrimaryStateListener(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(a){return Ho(this.persistence,new HZ,a.initialUser,this.serializer)}createGarbageCollectionScheduler(a,b){return new Gf(this.persistence.referenceDelegate.garbageCollector,a.asyncQueue,b)}createIndexBackfillerScheduler(a,b){let c=new x$(b,this.persistence);return new xZ(a.asyncQueue,c)}createPersistence(a){let b=Hi(a.databaseInfo.databaseId,a.databaseInfo.persistenceKey),c=void 0!==this.cacheSizeBytes?F8.withCacheSize(this.cacheSizeBytes):F8.DEFAULT;return new Hf(this.synchronizeTabs,b,a.clientId,c,a.asyncQueue,IB(),IC(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(a){return new Ii}}class KQ extends KP{constructor(a,b){super(a,b,!1),this.onlineComponentProvider=a,this.cacheSizeBytes=b,this.synchronizeTabs=!0}async initialize(a){await super.initialize(a);let b=this.onlineComponentProvider.syncEngine;this.sharedClientState instanceof Ig&&(this.sharedClientState.syncEngine={applyBatchState:KB.bind(null,b),applyTargetState:KH.bind(null,b),applyActiveTargetsChange:KI.bind(null,b),getActiveClients:KG.bind(null,b),synchronizeWithChangedDocuments:KA.bind(null,b)},await this.sharedClientState.start()),await this.persistence.setPrimaryStateListener(async a=>{await KC(this.onlineComponentProvider.syncEngine,a),this.gcScheduler&&(a&&!this.gcScheduler.started?this.gcScheduler.start():a||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(a&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():a||this.indexBackfillerScheduler.stop())})}createSharedClientState(a){let b=IB();if(!Ig.isAvailable(b))throw new wX(wW.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let c=Hi(a.databaseInfo.databaseId,a.databaseInfo.persistenceKey);return new Ig(b,a.asyncQueue,c,a.clientId,a.initialUser)}}class KR{async initialize(a,b){this.localStore||(this.localStore=a.localStore,this.sharedClientState=a.sharedClientState,this.datastore=this.createDatastore(b),this.remoteStore=this.createRemoteStore(b),this.eventManager=this.createEventManager(b),this.syncEngine=this.createSyncEngine(b,!a.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>Kh(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=Kx.bind(null,this.syncEngine),await JA(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(a){return JK()}createDatastore(a){let b=ID(a.databaseInfo.databaseId),c=Iz(a.databaseInfo);return IR(a.authCredentials,a.appCheckCredentials,c,b)}createRemoteStore(a){return I2(this.localStore,this.datastore,a.asyncQueue,a=>Kh(this.syncEngine,a,0),IA())}createSyncEngine(a,b){return J8(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,a.initialUser,a.maxConcurrentLimboResolutions,b)}async terminate(){var a,b;await I7(this.remoteStore),null==(a=this.datastore)||a.terminate(),null==(b=this.eventManager)||b.terminate()}}KR.provider={build:()=>new KR};let KS=10240;function KT(a,b=KS){let c=0;return{async read(){if(c<a.byteLength){let d={value:a.slice(c,c+b),done:!1};return c+=b,d}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}function KU(a,b,c){if(!c)throw new wX(wW.INVALID_ARGUMENT,`Function ${a}() cannot be called with an empty ${b}.`)}function KV(a,b,c,d){if(!0===b&&!0===d)throw new wX(wW.INVALID_ARGUMENT,`${a} and ${c} cannot be used together.`)}function KW(a){if(!xp.isDocumentKey(a))throw new wX(wW.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${a} has ${a.length}.`)}function KX(a){if(xp.isDocumentKey(a))throw new wX(wW.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${a} has ${a.length}.`)}function KY(a){return"object"==typeof a&&null!==a&&(Object.getPrototypeOf(a)===Object.prototype||null===Object.getPrototypeOf(a))}function KZ(a){if(void 0===a)return"undefined";if(null===a)return"null";if("string"==typeof a)return a.length>20&&(a=`${a.substring(0,20)}...`),JSON.stringify(a);if("number"==typeof a||"boolean"==typeof a)return""+a;if("object"==typeof a)if(a instanceof Array)return"an array";else{let b=K$(a);return b?`a custom ${b} object`:"an object"}else if("function"==typeof a)return"a function";else return wS(12329,{type:typeof a})}function K$(a){return a.constructor?a.constructor.name:null}function K_(a,b){if("_delegate"in a&&(a=a._delegate),!(a instanceof b))if(b.name===a.constructor.name)throw new wX(wW.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");else{let c=KZ(a);throw new wX(wW.INVALID_ARGUMENT,`Expected type '${b.name}', but it was: ${c}`)}return a}function K0(a,b){if(!(a instanceof Uint8Array))throw new wX(wW.INVALID_ARGUMENT,`NodePlatform.toByteStreamReader expects source to be Uint8Array, got ${KZ(a)}`);return KT(a,b)}class K1{constructor(a){this.observer=a,this.muted=!1}next(a){!this.muted&&this.observer.next&&this.scheduleEvent(this.observer.next,a)}error(a){this.muted||(this.observer.error?this.scheduleEvent(this.observer.error,a):wP("Uncaught Error in snapshot listener:",a.toString()))}mute(){this.muted=!0}scheduleEvent(a,b){setTimeout(()=>{this.muted||a(b)},0)}}class K2{constructor(a,b){this.payload=a,this.byteLength=b}isBundleMetadata(){return"metadata"in this.payload}}class K3{constructor(a,b){this.reader=a,this.serializer=b,this.metadata=new wY,this.buffer=new Uint8Array,this.textDecoder=w8(),this.nextElementImpl().then(a=>{a&&a.isBundleMetadata()?this.metadata.resolve(a.payload.metadata):this.metadata.reject(Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(null==a?void 0:a.payload)}`))},a=>this.metadata.reject(a))}close(){return this.reader.cancel()}async getMetadata(){return this.metadata.promise}async nextElement(){return await this.getMetadata(),this.nextElementImpl()}async nextElementImpl(){let a=await this.readLength();if(null===a)return null;let b=this.textDecoder.decode(a),c=Number(b);return isNaN(c)&&this.raiseError(`length string (${b}) is not valid number`),new K2(JSON.parse(await this.readJsonString(c)),a.length+c)}indexOfOpenBracket(){return this.buffer.findIndex(a=>123===a)}async readLength(){for(;0>this.indexOfOpenBracket()&&!await this.pullMoreDataToBuffer(););if(0===this.buffer.length)return null;let a=this.indexOfOpenBracket();a<0&&this.raiseError("Reached the end of bundle when a length string is expected.");let b=this.buffer.slice(0,a);return this.buffer=this.buffer.slice(a),b}async readJsonString(a){for(;this.buffer.length<a;)await this.pullMoreDataToBuffer()&&this.raiseError("Reached the end of bundle when more is expected.");let b=this.textDecoder.decode(this.buffer.slice(0,a));return this.buffer=this.buffer.slice(a),b}raiseError(a){throw this.reader.cancel(),Error(`Invalid bundle format: ${a}`)}async pullMoreDataToBuffer(){let a=await this.reader.read();if(!a.done){let b=new Uint8Array(this.buffer.length+a.value.length);b.set(this.buffer),b.set(a.value,this.buffer.length),this.buffer=b}return a.done}}function K4(a,b){return new K3(a,b)}class K5{constructor(a){this.datastore=a,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(a){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new wX(wW.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let b=await IT(this.datastore,a);return b.forEach(a=>this.recordVersion(a)),b}set(a,b){this.write(b.toMutation(a,this.precondition(a))),this.writtenDocs.add(a.toString())}update(a,b){try{this.write(b.toMutation(a,this.preconditionForUpdate(a)))}catch(a){this.lastTransactionError=a}this.writtenDocs.add(a.toString())}delete(a){this.write(new CI(a,this.precondition(a))),this.writtenDocs.add(a.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let a=this.readVersions;this.mutations.forEach(b=>{a.delete(b.key.toString())}),a.forEach((a,b)=>{let c=xp.fromPath(b);this.mutations.push(new CL(c,this.precondition(c)))}),await IS(this.datastore,this.mutations),this.committed=!0}recordVersion(a){let b;if(a.isFoundDocument())b=a.version;else if(a.isNoDocument())b=xj.min();else throw wS(50498,{documentName:a.constructor.name});let c=this.readVersions.get(a.key.toString());if(c){if(!b.isEqual(c))throw new wX(wW.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(a.key.toString(),b)}precondition(a){let b=this.readVersions.get(a.toString());return this.writtenDocs.has(a.toString())||!b?Cr.none():b.isEqual(xj.min())?Cr.exists(!1):Cr.updateTime(b)}preconditionForUpdate(a){let b=this.readVersions.get(a.toString());if(this.writtenDocs.has(a.toString())||!b)return Cr.exists(!0);if(b.isEqual(xj.min()))throw new wX(wW.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Cr.updateTime(b)}write(a){this.ensureCommitNotCalled(),this.mutations.push(a)}ensureCommitNotCalled(){}}class K6{constructor(a,b,c,d,e){this.asyncQueue=a,this.datastore=b,this.options=c,this.updateFunction=d,this.deferred=e,this.attemptsRemaining=c.maxAttempts,this.backoff=new II(this.asyncQueue,"transaction_retry")}run(){this.attemptsRemaining-=1,this.runWithBackOff()}runWithBackOff(){this.backoff.backoffAndRun(async()=>{let a=new K5(this.datastore),b=this.tryRunUpdateFunction(a);b&&b.then(b=>{this.asyncQueue.enqueueAndForget(()=>a.commit().then(()=>{this.deferred.resolve(b)}).catch(a=>{this.handleTransactionError(a)}))}).catch(a=>{this.handleTransactionError(a)})})}tryRunUpdateFunction(a){try{let b=this.updateFunction(a);if(zO(b)||!b.catch||!b.then)return this.deferred.reject(Error("Transaction callback must return a Promise")),null;return b}catch(a){return this.deferred.reject(a),null}}handleTransactionError(a){this.attemptsRemaining>0&&this.isRetryableTransactionError(a)?(this.attemptsRemaining-=1,this.asyncQueue.enqueueAndForget(()=>(this.runWithBackOff(),Promise.resolve()))):this.deferred.reject(a)}isRetryableTransactionError(a){if("FirebaseError"===a.name){let b=a.code;return"aborted"===b||"failed-precondition"===b||"already-exists"===b||!CQ(b)}return!1}}let K7="FirestoreClient",K8=100,K9=11,La=20,Lb=22;class Lc{constructor(a,b,c,d,e){this.authCredentials=a,this.appCheckCredentials=b,this.asyncQueue=c,this.databaseInfo=d,this.user=wI.UNAUTHENTICATED,this.clientId=w9.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=e,this.authCredentials.start(c,async a=>{wO(K7,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(c,a=>(wO(K7,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:K8}}setCredentialChangeListener(a){this.authCredentialListener=a}setAppCheckTokenChangeListener(a){this.appCheckCredentialListener=a}terminate(){this.asyncQueue.enterRestrictedMode();let a=new wY;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),a.resolve()}catch(c){let b=JF(c,"Failed to shutdown persistence");a.reject(b)}}),a.promise}}async function Ld(a,b){a.asyncQueue.verifyOperationInProgress(),wO(K7,"Initializing OfflineComponentProvider");let c=a.configuration;await b.initialize(c);let d=c.initialUser;a.setCredentialChangeListener(async a=>{d.isEqual(a)||(await Hp(b.localStore,a),d=a)}),b.persistence.setDatabaseDeletedListener(()=>a.terminate()),a._offlineComponents=b}async function Le(a,b){a.asyncQueue.verifyOperationInProgress();let c=await Lg(a);wO(K7,"Initializing OnlineComponentProvider"),await b.initialize(c,a.configuration),a.setCredentialChangeListener(a=>Jz(b.remoteStore,a)),a.setAppCheckTokenChangeListener((a,c)=>Jz(b.remoteStore,c)),a._onlineComponents=b}function Lf(a){return"FirebaseError"===a.name?a.code===wW.FAILED_PRECONDITION||a.code===wW.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&a instanceof DOMException)||a.code===Lb||a.code===La||a.code===K9}async function Lg(a){if(!a._offlineComponents)if(a._uninitializedComponentsProvider){wO(K7,"Using user provided OfflineComponentProvider");try{await Ld(a,a._uninitializedComponentsProvider._offline)}catch(c){let b=c;if(!Lf(b))throw b;wQ("Error using user provided cache. Falling back to memory cache: "+b),await Ld(a,new KN)}}else wO(K7,"Using default OfflineComponentProvider"),await Ld(a,new KO(void 0));return a._offlineComponents}async function Lh(a){return a._onlineComponents||(a._uninitializedComponentsProvider?(wO(K7,"Using user provided OnlineComponentProvider"),await Le(a,a._uninitializedComponentsProvider._online)):(wO(K7,"Using default OnlineComponentProvider"),await Le(a,new KR))),a._onlineComponents}function Li(a){return Lg(a).then(a=>a.persistence)}function Lj(a){return Lg(a).then(a=>a.localStore)}function Lk(a){return Lh(a).then(a=>a.remoteStore)}function Ll(a){return Lh(a).then(a=>a.syncEngine)}function Lm(a){return Lh(a).then(a=>a.datastore)}async function Ln(a){let b=await Lh(a),c=b.eventManager;return c.onListen=J9.bind(null,b.syncEngine),c.onUnlisten=Kd.bind(null,b.syncEngine),c.onFirstRemoteStoreListen=Ka.bind(null,b.syncEngine),c.onLastRemoteStoreUnlisten=Ke.bind(null,b.syncEngine),c}function Lo(a,b,c={}){let d=new wY;return a.asyncQueue.enqueueAndForget(async()=>Lu(await Ln(a),a.asyncQueue,b,c,d)),d.promise}function Lp(a,b,c){let d=new wY;return a.asyncQueue.enqueueAndForget(async()=>{try{let e=await Lm(a);d.resolve(IU(e,b,c))}catch(a){d.reject(a)}}),d.promise}function Lq(a,b){let c=new wY;return a.asyncQueue.enqueueAndForget(async()=>Kf(await Ll(a),b,c)),c.promise}async function Lr(a,b,c){try{let d=await HB(a,b);d.isFoundDocument()?c.resolve(d):d.isNoDocument()?c.resolve(null):c.reject(new wX(wW.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(d){let a=JF(d,`Failed to get document '${b} from cache`);c.reject(a)}}function Ls(a,b,c,d,e){let f=new K1({next:h=>{f.mute(),b.enqueueAndForget(()=>JO(a,g));let i=h.docs.has(c);!i&&h.fromCache?e.reject(new wX(wW.UNAVAILABLE,"Failed to get document because the client is offline.")):i&&h.fromCache&&d&&"server"===d.source?e.reject(new wX(wW.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e.resolve(h)},error:a=>e.reject(a)}),g=new JW(Bs(c.path),f,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return JN(a,g)}async function Lt(a,b,c){try{let d=await HF(a,b,!0),e=new J2(b,d.remoteKeys),f=e.computeDocChanges(d.documents),g=e.applyChanges(f,!1);c.resolve(g.snapshot)}catch(d){let a=JF(d,`Failed to execute query '${b} against cache`);c.reject(a)}}function Lu(a,b,c,d,e){let f=new K1({next:c=>{f.mute(),b.enqueueAndForget(()=>JO(a,g)),c.fromCache&&"server"===d.source?e.reject(new wX(wW.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e.resolve(c)},error:a=>e.reject(a)}),g=new JW(c,f,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return JN(a,g)}function Lv(a,b){let c;return K4(K0(c="string"==typeof a?w7().encode(a):a),b)}function Lw(a,b){return a.asyncQueue.enqueue(async()=>HU(await Lj(a),b))}function Lx(a,b){return a.timeoutSeconds===b.timeoutSeconds}function Ly(a){let b={};return void 0!==a.timeoutSeconds&&(b.timeoutSeconds=a.timeoutSeconds),b}let Lz="ComponentProvider",LA=new Map;function LB(a){let b=LA.get(a);b&&(wO(Lz,"Removing Datastore"),LA.delete(a),b.terminate())}function LC(a,b,c,d){return new zJ(a,b,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,Ly(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}let LD="firestore.googleapis.com",LE=!0,LF=5,LG=30,LH=!0;class LI{constructor(a){var b,c;if(void 0===a.host){if(void 0!==a.ssl)throw new wX(wW.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=LD,this.ssl=LE}else this.host=a.host,this.ssl=null!=(b=a.ssl)?b:LE;if(this.isUsingEmulator=void 0!==a.emulatorOptions,this.credentials=a.credentials,this.ignoreUndefinedProperties=!!a.ignoreUndefinedProperties,this.localCache=a.localCache,void 0===a.cacheSizeBytes)this.cacheSizeBytes=F7;else if(a.cacheSizeBytes!==F6&&a.cacheSizeBytes<Ga)throw new wX(wW.INVALID_ARGUMENT,`cacheSizeBytes must be at least ${Ga}`);else this.cacheSizeBytes=a.cacheSizeBytes;KV("experimentalForceLongPolling",a.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",a.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!a.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===a.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=LH:this.experimentalAutoDetectLongPolling=!!a.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ly(null!=(c=a.experimentalLongPollingOptions)?c:{}),LJ(this.experimentalLongPollingOptions),this.useFetchStreams=!!a.useFetchStreams}isEqual(a){return this.host===a.host&&this.ssl===a.ssl&&this.credentials===a.credentials&&this.cacheSizeBytes===a.cacheSizeBytes&&this.experimentalForceLongPolling===a.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===a.experimentalAutoDetectLongPolling&&Lx(this.experimentalLongPollingOptions,a.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===a.ignoreUndefinedProperties&&this.useFetchStreams===a.useFetchStreams}}function LJ(a){if(void 0!==a.timeoutSeconds){if(isNaN(a.timeoutSeconds))throw new wX(wW.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<LF)throw new wX(wW.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is ${LF})`);if(a.timeoutSeconds>LG)throw new wX(wW.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is ${LG})`)}}class LK{constructor(a,b,c,d){this._authCredentials=a,this._appCheckCredentials=b,this._databaseId=c,this._app=d,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new LI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new wX(wW.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(a){if(this._settingsFrozen)throw new wX(wW.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new LI(a),this._emulatorOptions=a.emulatorOptions||{},void 0!==a.credentials&&(this._authCredentials=w5(a.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return LB(this),Promise.resolve()}}function LL(a,b,c,d={}){var e;a=K_(a,LK);let f=u2(b),g=a._getSettings(),h=Object.assign(Object.assign({},g),{emulatorOptions:a._getEmulatorOptions()}),i=`${b}:${c}`;f&&(u3(`https://${i}`),u9("Firestore",!0)),g.host!==LD&&g.host!==i&&wQ("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let j=Object.assign(Object.assign({},g),{host:i,ssl:f,emulatorOptions:d});if(!vm(j,h)&&(a._setSettings(j),d.mockUserToken)){let b,c;if("string"==typeof d.mockUserToken)b=d.mockUserToken,c=wI.MOCK_USER;else{b=u4(d.mockUserToken,null==(e=a._app)?void 0:e.options.projectId);let f=d.mockUserToken.sub||d.mockUserToken.user_id;if(!f)throw new wX(wW.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new wI(f)}a._authCredentials=new w_(new wZ(b,c))}}class LM{constructor(a,b,c){this.converter=b,this._query=c,this.type="query",this.firestore=a}withConverter(a){return new LM(this.firestore,a,this._query)}}class LN{constructor(a,b,c){this.converter=b,this._key=c,this.type="document",this.firestore=a}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new LO(this.firestore,this.converter,this._key.path.popLast())}withConverter(a){return new LN(this.firestore,a,this._key)}}class LO extends LM{constructor(a,b,c){super(a,b,Bs(c)),this._path=c,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let a=this._path.popLast();return a.isEmpty()?null:new LN(this.firestore,null,new xp(a))}withConverter(a){return new LO(this.firestore,a,this._path)}}function LP(a,b,...c){if(a=vq(a),KU("collection","path",b),a instanceof LK){let d=xm.fromString(b,...c);return KX(d),new LO(a,null,d)}{if(!(a instanceof LN)&&!(a instanceof LO))throw new wX(wW.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let d=a._path.child(xm.fromString(b,...c));return KX(d),new LO(a.firestore,null,d)}}let LQ="AsyncQueue";class LR{constructor(a=Promise.resolve()){this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new II(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()},this.tail=a}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(a){this.enqueue(a)}enqueueAndForgetEvenWhileRestricted(a){this.verifyNotFailed(),this.enqueueInternal(a)}enterRestrictedMode(a){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=a||!1)}enqueue(a){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let b=new wY;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(a().then(b.resolve,b.reject),b.promise)).then(()=>b.promise)}enqueueRetryable(a){this.enqueueAndForget(()=>(this.retryableOps.push(a),this.retryNextOp()))}async retryNextOp(){if(0!==this.retryableOps.length){try{await this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(a){if(xQ(a))wO(LQ,"Operation failed with retryable error: "+a);else throw a}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}}enqueueInternal(a){let b=this.tail.then(()=>(this.operationInProgress=!0,a().catch(a=>{throw this.failure=a,this.operationInProgress=!1,wP("INTERNAL UNHANDLED ERROR: ",LS(a)),a}).then(a=>(this.operationInProgress=!1,a))));return this.tail=b,b}enqueueAfterDelay(a,b,c){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(a)>-1&&(b=0);let d=JE.createAndSchedule(this,a,b,c,a=>this.removeDelayedOperation(a));return this.delayedOperations.push(d),d}verifyNotFailed(){this.failure&&wS(47125,{messageOrStack:LS(this.failure)})}verifyOperationInProgress(){}async drain(){let a;do a=this.tail,await a;while(a!==this.tail)}containsDelayedOperation(a){for(let b of this.delayedOperations)if(b.timerId===a)return!0;return!1}runAllDelayedOperationsUntil(a){return this.drain().then(()=>{for(let b of(this.delayedOperations.sort((a,b)=>a.targetTimeMs-b.targetTimeMs),this.delayedOperations))if(b.skipDelay(),"all"!==a&&b.timerId===a)break;return this.drain()})}skipDelaysForTimerId(a){this.timerIdsToSkip.push(a)}removeDelayedOperation(a){let b=this.delayedOperations.indexOf(a);this.delayedOperations.splice(b,1)}}function LS(a){let b=a.message||"";return a.stack&&(b=a.stack.includes(a.message)?a.stack:a.message+"\n"+a.stack),b}class LT extends LK{constructor(a,b,c,d){super(a,b,c,d),this.type="firestore",this._queue=new LR,this._persistenceKey=(null==d?void 0:d.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let a=this._firestoreClient.terminate();this._queue=new LR(a),this._firestoreClient=void 0,await a}}}function LU(a,b){let c="object"==typeof a?a:wg(),d="string"==typeof a?a:b||zK,e=v9(c,"firestore").getImmediate({identifier:d});if(!e._initialized){let a=u_("firestore");a&&LL(e,...a)}return e}function LV(a){if(a._terminated)throw new wX(wW.FAILED_PRECONDITION,"The client has already been terminated.");return a._firestoreClient||LW(a),a._firestoreClient}function LW(a){var b,c,d;let e=a._freezeSettings(),f=LC(a._databaseId,(null==(b=a._app)?void 0:b.options.appId)||"",a._persistenceKey,e);!a._componentsProvider&&(null==(c=e.localCache)?void 0:c._offlineComponentProvider)&&(null==(d=e.localCache)?void 0:d._onlineComponentProvider)&&(a._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),a._firestoreClient=new Lc(a._authCredentials,a._appCheckCredentials,a._queue,f,a._componentsProvider&&LX(a._componentsProvider))}function LX(a){let b=null==a?void 0:a._online.build();return{_offline:null==a?void 0:a._offline.build(b),_online:b}}function LY(a,b=!0){wK(we),v8(new vr("firestore",(a,{instanceIdentifier:c,options:d})=>{let e=a.getProvider("app").getImmediate(),f=new LT(new w0(a.getProvider("auth-internal")),new w4(e,a.getProvider("app-check-internal")),zM(e,c),e);return d=Object.assign({useFetchStreams:b},d),f._setSettings(d),f},"PUBLIC").setMultipleInstances(!0)),wj(wG,wH,a),wj(wG,wH,"esm2017")}class LZ{constructor(a,b,c){this.alias=a,this.aggregateType=b,this.fieldPath=c}}class L${constructor(a="count",b){this._internalFieldPath=b,this.type="AggregateField",this.aggregateType=a}}class L_{constructor(a,b,c){this._userDataWriter=b,this._data=c,this.type="AggregateQuerySnapshot",this.query=a}data(){return this._userDataWriter.convertObjectMap(this._data)}}class L0{constructor(a){this._byteString=a}static fromBase64String(a){try{return new L0(zu.fromBase64String(a))}catch(a){throw new wX(wW.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+a)}}static fromUint8Array(a){return new L0(zu.fromUint8Array(a))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(a){return this._byteString.isEqual(a._byteString)}}class L1{constructor(...a){for(let b=0;b<a.length;++b)if(0===a[b].length)throw new wX(wW.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xo(a)}isEqual(a){return this._internalPath.isEqual(a._internalPath)}}class L2{constructor(a){this._methodName=a}}class L3{constructor(a,b){if(!isFinite(a)||a<-90||a>90)throw new wX(wW.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+a);if(!isFinite(b)||b<-180||b>180)throw new wX(wW.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+b);this._lat=a,this._long=b}get latitude(){return this._lat}get longitude(){return this._long}isEqual(a){return this._lat===a._lat&&this._long===a._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(a){return xa(this._lat,a._lat)||xa(this._long,a._long)}}class L4{constructor(a){this._values=(a||[]).map(a=>a)}toArray(){return this._values.map(a=>a)}isEqual(a){return Hk(this._values,a._values)}}let L5=/^__.*__$/;class L6{constructor(a,b,c){this.data=a,this.fieldMask=b,this.fieldTransforms=c}toMutation(a,b){return null!==this.fieldMask?new CC(a,this.data,this.fieldMask,b,this.fieldTransforms):new Cz(a,this.data,b,this.fieldTransforms)}}class L7{constructor(a,b,c){this.data=a,this.fieldMask=b,this.fieldTransforms=c}toMutation(a,b){return new CC(a,this.data,this.fieldMask,b,this.fieldTransforms)}}function L8(a){switch(a){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw wS(40011,{dataSource:a})}}class L9{constructor(a,b,c,d,e,f){this.settings=a,this.databaseId=b,this.serializer=c,this.ignoreUndefinedProperties=d,void 0===e&&this.validatePath(),this.fieldTransforms=e||[],this.fieldMask=f||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(a){return new L9(Object.assign(Object.assign({},this.settings),a),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(a){var b;let c=null==(b=this.path)?void 0:b.child(a),d=this.contextWith({path:c,arrayElement:!1});return d.validatePathSegment(a),d}childContextForFieldPath(a){var b;let c=null==(b=this.path)?void 0:b.child(a),d=this.contextWith({path:c,arrayElement:!1});return d.validatePath(),d}childContextForArray(a){return this.contextWith({path:void 0,arrayElement:!0})}createError(a){return Mx(a,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(a){return void 0!==this.fieldMask.find(b=>a.isPrefixOf(b))||void 0!==this.fieldTransforms.find(b=>a.isPrefixOf(b.field))}validatePath(){if(this.path)for(let a=0;a<this.path.length;a++)this.validatePathSegment(this.path.get(a))}validatePathSegment(a){if(0===a.length)throw this.createError("Document fields must not be empty");if(L8(this.dataSource)&&L5.test(a))throw this.createError('Document fields cannot begin and end with "__"')}}class Ma{constructor(a,b,c){this.databaseId=a,this.ignoreUndefinedProperties=b,this.serializer=c||ID(a)}createContext(a,b,c,d=!1){return new L9({dataSource:a,methodName:b,targetDoc:c,path:xo.emptyPath(),arrayElement:!1,hasConverter:d},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Mb(a){let b=a._freezeSettings(),c=ID(a._databaseId);return new Ma(a._databaseId,!!b.ignoreUndefinedProperties,c)}function Mc(a,b,c,d,e,f={}){let g,h,i=a.createContext(f.merge||f.mergeFields?2:0,b,c,e);Mt("Data must be an object, but it was:",i,d);let j=Mn(d,i);if(f.merge)g=new zr(i.fieldMask),h=i.fieldTransforms;else if(f.mergeFields){let a=[];for(let d of f.mergeFields){let e=Mu(b,d,c);if(!i.contains(e))throw new wX(wW.INVALID_ARGUMENT,`Field '${e}' is specified in your field mask but missing from your input data.`);My(a,e)||a.push(e)}g=new zr(a),h=i.fieldTransforms.filter(a=>g.covers(a.field))}else g=null,h=i.fieldTransforms;return new L6(new AD(j),g,h)}class Md extends L2{_toFieldTransform(a){if(2===a.dataSource)a.fieldMask.push(a.path);else if(1===a.dataSource)throw a.createError(`${this._methodName}() can only appear at the top level of your update data`);else throw a.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return null}isEqual(a){return a instanceof Md}}function Me(a,b,c){return new L9({dataSource:3,targetDoc:b.settings.targetDoc,methodName:a._methodName,arrayElement:c},b.databaseId,b.serializer,b.ignoreUndefinedProperties)}class Mf extends null{_toFieldTransform(a){return new Cn(a.path,new Ce)}isEqual(a){return a instanceof Mf}}class Mg extends L2{constructor(a,b){super(a),this._elements=b}_toFieldTransform(a){let b=Me(this,a,!0),c=new Cf(this._elements.map(a=>Mm(a,b)));return new Cn(a.path,c)}isEqual(a){return a instanceof Mg&&vm(this._elements,a._elements)}}class Mh extends L2{constructor(a,b){super(a),this._elements=b}_toFieldTransform(a){let b=Me(this,a,!0),c=new Ch(this._elements.map(a=>Mm(a,b)));return new Cn(a.path,c)}isEqual(a){return a instanceof Mh&&vm(this._elements,a._elements)}}class Mi extends L2{constructor(a,b){super(a),this._operand=b}_toFieldTransform(a){let b=new Cj(a.serializer,B8(a.serializer,this._operand));return new Cn(a.path,b)}isEqual(a){return a instanceof Mi&&this._operand===a._operand}}function Mj(a,b,c,d){let e=a.createContext(1,b,c);Mt("Data must be an object, but it was:",e,d);let f=[],g=AD.empty();return zg(d,(a,d)=>{let h=Mw(b,a,c);d=vq(d);let i=e.childContextForFieldPath(h);if(d instanceof Md)f.push(h);else{let a=Mm(d,i);null!=a&&(f.push(h),g.set(h,a))}}),new L7(g,new zr(f),e.fieldTransforms)}function Mk(a,b,c,d,e,f){let g=a.createContext(1,b,c),h=[Mu(b,d,c)],i=[e];if(f.length%2!=0)throw new wX(wW.INVALID_ARGUMENT,`Function ${b}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let a=0;a<f.length;a+=2)h.push(Mu(b,f[a])),i.push(f[a+1]);let j=[],k=AD.empty();for(let a=h.length-1;a>=0;--a)if(!My(j,h[a])){let b=h[a],c=i[a];c=vq(c);let d=g.childContextForFieldPath(b);if(c instanceof Md)j.push(b);else{let a=Mm(c,d);null!=a&&(j.push(b),k.set(b,a))}}return new L7(k,new zr(j),g.fieldTransforms)}function Ml(a,b,c,d=!1){return Mm(c,a.createContext(d?4:3,b))}function Mm(a,b){if(Ms(a=vq(a)))return Mt("Unsupported field value:",b,a),Mn(a,b);if(a instanceof L2)return Mp(a,b),null;if(void 0===a&&b.ignoreUndefinedProperties)return null;if(b.path&&b.fieldMask.push(b.path),!(a instanceof Array))return Mq(a,b);if(b.settings.arrayElement&&4!==b.dataSource)throw b.createError("Nested arrays are not supported");return Mo(a,b)}function Mn(a,b){let c={};return zi(a)?b.path&&b.path.length>0&&b.fieldMask.push(b.path):zg(a,(a,d)=>{let e=Mm(d,b.childContextForField(a));null!=e&&(c[a]=e)}),{mapValue:{fields:c}}}function Mo(a,b){let c=[],d=0;for(let e of a){let a=Mm(e,b.childContextForArray(d));null==a&&(a={nullValue:"NULL_VALUE"}),c.push(a),d++}return{arrayValue:{values:c}}}function Mp(a,b){if(!L8(b.dataSource))throw b.createError(`${a._methodName}() can only be used with update() and set()`);if(!b.path)throw b.createError(`${a._methodName}() is not currently supported inside arrays`);let c=a._toFieldTransform(b);c&&b.fieldTransforms.push(c)}function Mq(a,b){if(null===(a=vq(a)))return{nullValue:"NULL_VALUE"};if("number"==typeof a)return B8(b.serializer,a);if("boolean"==typeof a)return{booleanValue:a};if("string"==typeof a)return{stringValue:a};if(a instanceof Date){let c=xi.fromDate(a);return{timestampValue:Dh(b.serializer,c)}}else if(a instanceof xi){let c=new xi(a.seconds,1e3*Math.floor(a.nanoseconds/1e3));return{timestampValue:Dh(b.serializer,c)}}else if(a instanceof L3)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};else if(a instanceof L0)return{bytesValue:Dj(b.serializer,a._byteString)};else if(a instanceof LN){let c=b.databaseId,d=a.firestore._databaseId;if(!d.isEqual(c))throw b.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:Dn(a.firestore._databaseId||b.databaseId,a._key.path)}}else if(a instanceof L4)return Mr(a,b);else throw b.createError(`Unsupported field value: ${KZ(a)}`)}function Mr(a,b){return{mapValue:{fields:{[zR]:{stringValue:zU},[zV]:{arrayValue:{values:a.toArray().map(a=>{if("number"!=typeof a)throw b.createError("VectorValues must only contain numeric values.");return B6(b.serializer,a)})}}}}}}function Ms(a){return"object"==typeof a&&null!==a&&!(a instanceof Array)&&!(a instanceof Date)&&!(a instanceof xi)&&!(a instanceof L3)&&!(a instanceof L0)&&!(a instanceof LN)&&!(a instanceof L2)&&!(a instanceof L4)}function Mt(a,b,c){if(!Ms(c)||!KY(c)){let d=KZ(c);if("an object"===d)throw b.createError(a+" a custom object");throw b.createError(a+" "+d)}}function Mu(a,b,c){if((b=vq(b))instanceof L1)return b._internalPath;if("string"==typeof b)return Mw(a,b);throw Mx("Field path arguments must be of type string or ",a,!1,void 0,c)}let Mv=RegExp("[~\\*/\\[\\]]");function Mw(a,b,c){if(b.search(Mv)>=0)throw Mx(`Invalid field path (${b}). Paths must not contain '~', '*', '/', '[', or ']'`,a,!1,void 0,c);try{return new L1(...b.split("."))._internalPath}catch(d){throw Mx(`Invalid field path (${b}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,a,!1,void 0,c)}}function Mx(a,b,c,d,e){let f=d&&!d.isEmpty(),g=void 0!==e,h=`Function ${b}() called with invalid data`;c&&(h+=" (via `toFirestore()`)"),h+=". ";let i="";return(f||g)&&(i+=" (found",f&&(i+=` in field ${d}`),g&&(i+=` in document ${e}`),i+=")"),new wX(wW.INVALID_ARGUMENT,h+a+i)}function My(a,b){return a.some(a=>a.isEqual(b))}class Mz{constructor(a,b,c,d,e){this._firestore=a,this._userDataWriter=b,this._key=c,this._document=d,this._converter=e}get id(){return this._key.path.lastSegment()}get ref(){return new LN(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value);{let a=new MA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(a)}}}get(a){if(this._document){let b=this._document.data.field(MB("DocumentSnapshot.get",a));if(null!==b)return this._userDataWriter.convertValue(b)}}}class MA extends Mz{data(){return super.data()}}function MB(a,b){return"string"==typeof b?Mw(a,b):b instanceof L1?b._internalPath:b._delegate._internalPath}function MC(a){if("L"===a.limitType&&0===a.explicitOrderBy.length)throw new wX(wW.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class MD{}class ME extends MD{}function MF(a,b,...c){let d=[];for(let e of(b instanceof MD&&d.push(b),MY(d=d.concat(c)),d))a=e._apply(a);return a}class MG extends ME{constructor(a,b,c){super(),this._field=a,this._op=b,this._value=c,this.type="where"}static _create(a,b,c){return new MG(a,b,c)}_apply(a){let b=this._parse(a);return MV(a._query,b),new LM(a.firestore,a.converter,BC(a._query,b))}_parse(a){let b=Mb(a.firestore);return MO(a._query,"where",b,a.firestore._databaseId,this._field,this._op,this._value)}}class MH extends MD{constructor(a,b){super(),this.type=a,this._queryConstraints=b}static _create(a,b){return new MH(a,b)}_parse(a){let b=this._queryConstraints.map(b=>b._parse(a)).filter(a=>a.getFilters().length>0);return 1===b.length?b[0]:AS.create(b,this._getOperator())}_apply(a){let b=this._parse(a);return 0===b.getFilters().length?a:(MW(a._query,b),new LM(a.firestore,a.converter,BC(a._query,b)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class MI extends ME{constructor(a,b){super(),this._field=a,this._direction=b,this.type="orderBy"}static _create(a,b){return new MI(a,b)}_apply(a){let b=MP(a._query,this._field,this._direction);return new LM(a.firestore,a.converter,BD(a._query,b))}}function MJ(a,b="asc"){let c=b,d=MB("orderBy",a);return MI._create(d,c)}class MK extends ME{constructor(a,b,c){super(),this.type=a,this._limit=b,this._limitType=c}static _create(a,b,c){return new MK(a,b,c)}_apply(a){return new LM(a.firestore,a.converter,BE(a._query,this._limit,this._limitType))}}class ML extends ME{constructor(a,b,c){super(),this.type=a,this._docOrFields=b,this._inclusive=c}static _create(a,b,c){return new ML(a,b,c)}_apply(a){let b=MN(a,this.type,this._docOrFields,this._inclusive);return new LM(a.firestore,a.converter,BF(a._query,b))}}class MM extends ME{constructor(a,b,c){super(),this.type=a,this._docOrFields=b,this._inclusive=c}static _create(a,b,c){return new MM(a,b,c)}_apply(a){let b=MN(a,this.type,this._docOrFields,this._inclusive);return new LM(a.firestore,a.converter,BG(a._query,b))}}function MN(a,b,c,d){if(c[0]=vq(c[0]),c[0]instanceof Mz)return MQ(a._query,a.firestore._databaseId,b,c[0]._document,d);{let e=Mb(a.firestore);return MR(a._query,a.firestore._databaseId,e,b,c,d)}}function MO(a,b,c,d,e,f,g){let h;if(e.isKeyField())if("array-contains"===f||"array-contains-any"===f)throw new wX(wW.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);else if("in"===f||"not-in"===f){MT(g,f);let b=[];for(let c of g)b.push(MS(d,a,c));h={arrayValue:{values:b}}}else h=MS(d,a,g);else("in"===f||"not-in"===f||"array-contains-any"===f)&&MT(g,f),h=Ml(c,b,g,"in"===f||"not-in"===f);return AR.create(e,f,h)}function MP(a,b,c){if(null!==a.startAt)throw new wX(wW.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==a.endAt)throw new wX(wW.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new AM(b,c)}function MQ(a,b,c,d,e){if(!d)throw new wX(wW.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${c}().`);let f=[];for(let c of By(a))if(c.field.isKeyField())f.push(An(b,d.key));else{let a=d.data.field(c.field);if(zF(a))throw new wX(wW.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+c.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null!==a)f.push(a);else{let a=c.field.canonicalString();throw new wX(wW.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${a}' (used as the orderBy) does not exist.`)}}return new AH(f,e)}function MR(a,b,c,d,e,f){let g=a.explicitOrderBy;if(e.length>g.length)throw new wX(wW.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let h=[];for(let f=0;f<e.length;f++){let i=e[f];if(g[f].field.isKeyField()){if("string"!=typeof i)throw new wX(wW.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof i}`);if(!Bx(a)&&-1!==i.indexOf("/"))throw new wX(wW.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${i}' contains a slash.`);let c=a.path.child(xm.fromString(i));if(!xp.isDocumentKey(c))throw new wX(wW.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${c}' is not because it contains an odd number of segments.`);let e=new xp(c);h.push(An(b,e))}else{let a=Ml(c,d,i);h.push(a)}}return new AH(h,f)}function MS(a,b,c){if("string"==typeof(c=vq(c))){if(""===c)throw new wX(wW.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Bx(b)&&-1!==c.indexOf("/"))throw new wX(wW.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${c}' contains a '/' character.`);let d=b.path.child(xm.fromString(c));if(!xp.isDocumentKey(d))throw new wX(wW.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${d}' is not because it has an odd number of segments (${d.length}).`);return An(a,new xp(d))}if(c instanceof LN)return An(a,c._key);throw new wX(wW.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${KZ(c)}.`)}function MT(a,b){if(!Array.isArray(a)||0===a.length)throw new wX(wW.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${b.toString()}' filters.`)}function MU(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}function MV(a,b){let c=MX(a.filters,MU(b.op));if(null!==c)if(c===b.op)throw new wX(wW.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${b.op.toString()}' filter.`);else throw new wX(wW.INVALID_ARGUMENT,`Invalid query. You cannot use '${b.op.toString()}' filters with '${c.toString()}' filters.`)}function MW(a,b){let c=a;for(let a of b.getFlattenedFilters())MV(c,a),c=BC(c,a)}function MX(a,b){for(let c of a)for(let a of c.getFlattenedFilters())if(b.indexOf(a.op)>=0)return a.op;return null}function MY(a){let b=a.filter(a=>a instanceof MH).length,c=a.filter(a=>a instanceof MG).length;if(b>1||b>0&&c>0)throw new wX(wW.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}class MZ{convertValue(a,b="none"){switch(zX(a)){case 0:return null;case 1:return a.booleanValue;case 2:return zz(a.integerValue||a.doubleValue);case 3:return this.convertTimestamp(a.timestampValue);case 4:return this.convertServerTimestamp(a,b);case 5:return a.stringValue;case 6:return this.convertBytes(zA(a.bytesValue));case 7:return this.convertReference(a.referenceValue);case 8:return this.convertGeoPoint(a.geoPointValue);case 9:return this.convertArray(a.arrayValue,b);case 11:return this.convertObject(a.mapValue,b);case 10:return this.convertVectorValue(a.mapValue);default:throw wS(62114,{value:a})}}convertObject(a,b){return this.convertObjectMap(a.fields,b)}convertObjectMap(a,b="none"){let c={};return zg(a,(a,d)=>{c[a]=this.convertValue(d,b)}),c}convertVectorValue(a){var b,c,d;return new L4(null==(d=null==(c=null==(b=a.fields)?void 0:b[zV].arrayValue)?void 0:c.values)?void 0:d.map(a=>zz(a.doubleValue)))}convertGeoPoint(a){return new L3(zz(a.latitude),zz(a.longitude))}convertArray(a,b){return(a.values||[]).map(a=>this.convertValue(a,b))}convertServerTimestamp(a,b){switch(b){case"previous":let c=zH(a);if(null==c)return null;return this.convertValue(c,b);case"estimate":return this.convertTimestamp(zI(a));default:return null}}convertTimestamp(a){let b=zy(a);return new xi(b.seconds,b.nanos)}convertDocumentKey(a,b){let c=xm.fromString(a);wU(Em(c),9688,{name:a});let d=new zL(c.get(1),c.get(3)),e=new xp(c.popFirst(5));return d.isEqual(b)||wP(`Document ${e} contains a document reference within a different database (${d.projectId}/${d.database}) which is not supported. It will be treated as a reference in the current database (${b.projectId}/${b.database}) instead.`),e}}function M$(a,b,c){let d;return a?c&&(c.merge||c.mergeFields)?a.toFirestore(b,c):a.toFirestore(b):b}class M_ extends MZ{constructor(a){super(),this.firestore=a}convertBytes(a){return new L0(a)}convertReference(a){let b=this.convertDocumentKey(a,this.firestore._databaseId);return new LN(this.firestore,null,b)}}function M0(a,b){if("object"!=typeof a||null===a)return!1;let c=a;for(let a of b)if(a in c&&"function"==typeof c[a])return!0;return!1}class M1{constructor(a,b){this.hasPendingWrites=a,this.fromCache=b}isEqual(a){return this.hasPendingWrites===a.hasPendingWrites&&this.fromCache===a.fromCache}}class M2 extends Mz{constructor(a,b,c,d,e,f){super(a,b,c,d,f),this._firestore=a,this._firestoreImpl=a,this.metadata=e}exists(){return super.exists()}data(a={}){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value,a.serverTimestamps);{let b=new M3(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(b,a)}}}get(a,b={}){if(this._document){let c=this._document.data.field(MB("DocumentSnapshot.get",a));if(null!==c)return this._userDataWriter.convertValue(c,b.serverTimestamps)}}}class M3 extends M2{data(a={}){return super.data(a)}}class M4{constructor(a,b,c,d){this._firestore=a,this._userDataWriter=b,this._snapshot=d,this.metadata=new M1(d.hasPendingWrites,d.fromCache),this.query=c}get docs(){let a=[];return this.forEach(b=>a.push(b)),a}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(a,b){this._snapshot.docs.forEach(c=>{a.call(b,new M3(this._firestore,this._userDataWriter,c.key,c,new M1(this._snapshot.mutatedKeys.has(c.key),this._snapshot.fromCache),this.query.converter))})}docChanges(a={}){let b=!!a.includeMetadataChanges;if(b&&this._snapshot.excludesMetadataChanges)throw new wX(wW.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===b||(this._cachedChanges=M5(this,b),this._cachedChangesIncludeMetadataChanges=b),this._cachedChanges}}function M5(a,b){if(a._snapshot.oldDocs.isEmpty()){let b=0;return a._snapshot.docChanges.map(c=>{let d=new M3(a._firestore,a._userDataWriter,c.doc.key,c.doc,new M1(a._snapshot.mutatedKeys.has(c.doc.key),a._snapshot.fromCache),a.query.converter);return c.doc,{type:"added",doc:d,oldIndex:-1,newIndex:b++}})}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(a=>b||3!==a.type).map(b=>{let d=new M3(a._firestore,a._userDataWriter,b.doc.key,b.doc,new M1(a._snapshot.mutatedKeys.has(b.doc.key),a._snapshot.fromCache),a.query.converter),e=-1,f=-1;return 0!==b.type&&(e=c.indexOf(b.doc.key),c=c.delete(b.doc.key)),1!==b.type&&(f=(c=c.add(b.doc)).indexOf(b.doc.key)),{type:M6(b.type),doc:d,oldIndex:e,newIndex:f}})}}function M6(a){switch(a){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return wS(61501,{type:a})}}class M7 extends MZ{constructor(a){super(),this.firestore=a}convertBytes(a){return new L0(a)}convertReference(a){let b=this.convertDocumentKey(a,this.firestore._databaseId);return new LN(this.firestore,null,b)}}function M8(a){a=K_(a,LM);let b=K_(a.firestore,LT),c=LV(b),d=new M7(b);return MC(a._query),Lo(c,a._query).then(c=>new M4(b,d,a,c))}function M9(a,b,c){return new L_(b,new M7(a),c)}class Na{constructor(a){this.forceOwnership=a,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(a){this._onlineComponentProvider=KR.provider,this._offlineComponentProvider={build:b=>new KP(b,null==a?void 0:a.cacheSizeBytes,this.forceOwnership)}}}function Nb(a){return new Na(null==a?void 0:a.forceOwnership)}function Nc(a,b){if((a=vq(a)).firestore===b)return a;throw new wX(wW.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.")}class Nd{constructor(a,b){this._firestore=a,this._transaction=b,this._dataReader=Mb(a)}get(a){let b=Nc(a,this._firestore),c=new M_(this._firestore);return this._transaction.lookup([b._key]).then(a=>{if(!a||1!==a.length)return wS(24041);let d=a[0];if(d.isFoundDocument())return new Mz(this._firestore,c,d.key,d,b.converter);if(d.isNoDocument())return new Mz(this._firestore,c,b._key,null,b.converter);throw wS(18433,{doc:d})})}set(a,b,c){let d=Nc(a,this._firestore),e=M$(d.converter,b,c),f=Mc(this._dataReader,"Transaction.set",d._key,e,null!==d.converter,c);return this._transaction.set(d._key,f),this}update(a,b,c,...d){let e,f=Nc(a,this._firestore);return e="string"==typeof(b=vq(b))||b instanceof L1?Mk(this._dataReader,"Transaction.update",f._key,b,c,d):Mj(this._dataReader,"Transaction.update",f._key,b),this._transaction.update(f._key,e),this}delete(a){let b=Nc(a,this._firestore);return this._transaction.delete(b._key),this}}function Ne(a){try{return JSON.parse(a)}catch(a){throw new wX(wW.INVALID_ARGUMENT,"Failed to parse JSON: "+(null==a?void 0:a.message))}}function Nf(a,b){if("string"!=typeof a[b])throw new wX(wW.INVALID_ARGUMENT,"Missing string value for: "+b);return a[b]}new WeakMap;class Ng{constructor(){this.existenceFilterMismatchCallbacksById=new Map}static get instance(){return Nh||CV(Nh=new Ng),Nh}notifyOnExistenceFilterMismatch(a){this.existenceFilterMismatchCallbacksById.forEach(b=>b(a))}onExistenceFilterMismatch(a){let b=Symbol(),c=this.existenceFilterMismatchCallbacksById;return c.set(b,a),()=>c.delete(b)}}let Nh=null;LY("node");let Ni={apiKey:process.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:process.env.NEXT_PUBLIC_FIREBASE_APP_ID},Nj=LU(wh().length>0?wg():wf(Ni));async function Nk(a){try{let b=await fetch("https://api.web3forms.com/submit",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({access_key:"54ecb307-eec9-4652-a8b8-6f3fec42099a",...a})}),c=await b.json();if(c.success)return{success:!0};return console.error("Web3Forms error:",c),{success:!1,error:c}}catch(a){return console.error("Error submitting contact form:",a),{success:!1,error:a}}}async function Nl(){try{let a=MF(LP(Nj,"projects"),MJ("order","asc")),b=await M8(a);if(b.empty)throw Error("No projects found");return b.docs.map(a=>({id:a.id,...a.data()}))}catch(a){return[{id:"1",title:"Workforce One Solutions",description:"A comprehensive professional business ecosystem developed for service-based operations. I architected a responsive UI with a focus on user-centric design to streamline client interaction and service presentation.",tags:["Web Architecture","Business Logic"],image:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxQTERUTEhMWFhUWGRoYGBcYGB0YHhkdIhgdJR8dGyAYHSggGB4lIB0eIjEhJikrLi4uGCA1ODMsNygtLisBCgoKDg0OGhAQGzUmHSUtLS0vKystLS8tNzUtLS0tLSs3Ky0tLS0rLS0tLS0tNS0tKysrLS0tLS0tLS0tLSs1Lf/AABEIASwAqAMBIgACEQEDEQH/xAAcAAEAAgMBAQEAAAAAAAAAAAAABgcDBAUIAgH/xABCEAACAQIEAwUFBgMIAgEFAAABAgMAEQQSITEFBkETIlFhcQcygZGhFEJSYrHBI4LRM1NykqKy4fAkQ3MVg8Li8f/EABkBAQADAQEAAAAAAAAAAAAAAAABAgQDBf/EACsRAQACAgEDAwMDBQEAAAAAAAABAgMRIQQSMRMiMkFRYSNxgUKhsdHwFP/aAAwDAQACEQMRAD8AvGlKUClKUClKUClKUClKUClKUClKUClKUClKUClKUClKUClKUClKUClKUClKUClKUClKUClKUClKUClfEkyr7zAX2uQP1osgOxB9DUbgfdKUqQpSlApSlApWrxTFmKGSUIZDGjPkW12sL2F+prnYrmnDx4Jcc7HsWVWFhcnNawAG511HkfCg7dK4/GeYI4I4XAMvbyRxxKlruX2Iv0C3YnwFfmN5rwcU3YS4mNZNAVJ2J2DHZSfMig7NKjvH+csLhlmBkR5olZuwDAOSqZreWhBvXzzDznhsLEzM6mUIriHMAxze6PLqb+AJqdCSUqNYfnTDrBFLipIoGlBZVEglDKD76lBqpGt7C3Wt7E80YOMRl8TEBKA0feHfBIAK231NtKjQ69K40fNWDaf7OuJjMuYrlvuw3UHYt+W96R81YNp/s4xMZlzZct/vfhB2Lflveg7NK5nMHG0wsYdlZ2dhHHGgu0jnZVvp0JudABXPwPMz9vHBi8K+GeW/ZEukiOQLlcyHutbWx3toaCR1p8V4isEfaOCRcCw319a5sXOWBaRI1xURZyAoB3JOgvsCegOtZeL8y4OB+xxE8auQCVY3sDsW6KPM2qt4tNZivEoneuHB4rxLCYhgz9spAtoF2v6mvjC4BIsdAqEkEB7ta+qsenoK3+do0EKFFUXfcAC4ynqK7EXCE7VJzmzqoAF9Pdt+hrx//PbJnmJ1NqzWd61+/wDhl9OZvz5jTp0pSvaaylKUClKUCq+4ZyjKMaYZVB4fA7zwKbEM8g9wi+0d3tcfeG/SwaUED5V5YnjxYE+uHwQdMGSQcwkN8x1vdE/h628q1ZcDiYYMdgvsTztipJmSYFOzYSk2aUswZSl9rH3RarGpU7FcJyxiEwnFI+zLySxxxxtcXmy4ZF0udBmDb2rDNyziosLicIsPbdqYplxF1zuRLHmjlubllAJVhplHQ72bWPES5FZiL5QTTYieMjmw3EZsUMLJiY54o0UxZC0ZQtdSHYd1rg3HUa1zOUeWJ4sTE8sQQdjiToVIgaXEZljFjuFJ1Gm9TdeIKBdhbr3byAj8V1Gg9QNjX1DjlZWN7ZSb9dAxAOm97XpsQ7lhMRBh4MA+AYtE2UzZo+yAzE9upJLFtc2XLfN1G9cLhPLeKEcOBmGMyJIpYoMKIAFkzCVXKdre4Bt71yRVlQ8URrHvC4BAytm1zfdy7d3f9Ov2vEYydGPQE5WsCdgTawOuxpscfnHh0r/Z58OgkkwsvadkSF7RSpVlBOgazXF9NK0JvtGOxOFJwsuHhw8nbM0xQMzhGCoiozad65Y6aVLcPiFcXW9vNSvT8wGlZabFex8uSjgBwwgtiDdsnduX7a4N72vlA1v0FanE+EYyLEYzKuKZMS2dfs4wzK4KBckpxClkta1x3bHxvVm0psaHBuHCHDQwasIo0QZyGPdUAXIFidNxW/SlQFKUoFKUoFKUoFKUoFKUoFfMi3BFyL9RuPMXr6pQaK8OsWZXYM/vEBdfQW0I/c3vXyOFgAqrMqncC34i1tRpvb0+ddClBopw0A5ldgwAUHTYFtNtfe+g+P3Hw9QpW7d5g5Ol7gg326kX+NfEPE0bESQZlzoqtlv3iGvrbw0tp/St6iZjTXweFEYIBvc32AG3QKAB4mtilKIKVpcX4rFhozLO4RL2uTa58B/3oT0qp+afaNmiLsqmKQHsYiLtKPxtf3EPQEXI165aL1pNll8R5qwsL9m0oaT+7jBkb4hL2+NYk5xwmYK7tETt2qNHf4sLfWq65N9oOGeFUkhGHZdG7IXjPnYd5b/zetSbib4efDmQMk0JIDi+x2zDqjC/1HhUxG/Eu1scU+VZ19/+hOoJ1cBkYMDsQQQfiKyV5wxnMX/07FPHDMXiIBtqtwehtbUfiGo0IIqf8J59mgSF8QrS4adQ0cumdfFWtozL8L2v4gU7vumem3zSdrQpWhwnjMOJTPDIrj6j1B1HxpVmaYmJ1LfpSlEFY551QEsbWrV4zxSPDwvLIyjKpIBNsx6Aep0261UfHeZsVjEE0cZw7KUF82Ym2YlR3QCt9yx+AvQWPJzfArWZwvlYkj1tXcwWLWVA6EEHYivPZ4RM0oP2mJmI6OuUX3Da3v8ADw2vU25P5oOBjdcaLRX7jRqXC5Rqptdjc6g2sb70Fq0r5je4BGxF9dK+qBXPxPHMNHIYnniWQWJQuMwB2JF7gHxNVP7W+fcdBiHwcC/Z0ABEoOZ5VI3Q2tGt7jS5uNxXP9jeEa+Kkc5gSgLMbkv3ibk6nQj50+unT057e6Ut555alxOMixGCmjMiqAyiQKwsTZltc7G3TasmB9oT4Zxh+JwyK66dqi5rjoWVf1W9/AVyfaDzQmCiXs7faGN4vy2+/wCQH12rNg+fsPjyhkwJfKvvZVcA21F5FUDXwb4VExqWml++mrxuI/iUvxfP+BQDLKZGYgKiKbsTsBmAAPkTWjxfncQDPiHjgXoi3mmb0AAC+tmHnUI5o5mhw7pL9nyZtFMcUWZbdM73I8soFVxzRzEMUVCQmNQSSTIzs5PVidPhak8Oda1n41nX5S7i/M0HE5gZzLIVJ7HDXKoB+JyoGdza5y2A2F7XOTGcK7cHtkGwAyqFygbAEa6V+cv8l4d0jnjklIYBlOexHyAsQdK7fNkGJiwZbDP3o9WuquxXrqwJuP0q9a8bmFZvG4isq8n4NJgw0rkGIuEDbEmxO2+mxt41KOG8JmCHIxKyZSbHuta5U/Wq6x2NkmIaaRnI2udvQbD4VYvst5jBH2SQ94XMRPVeqeo3HlfwqtNdzvmnJ6epcrnPliYw9vluYx3rfh6/Lf505Y9oqwYNcFisIs2HFwTnIYAkm6gjcE6WIqzOP8XhwsDTT+4NMu5cnZQOpP8AWvPcksbSO5XIpJKRqb5bnQXPQfWr2pzwyVy6hbHDsJFIe24VjQxGvZMwjmXyIYgOPMWv50qoY33IQeFzrb0pVfS+zvHXW17qxP7va1KUqGVS3tV4yPtnfiCPhgVVmswKOL59PHuhV3uG8qqnG8wEtdFB6B5O8fgvup6AVJ/bXK//ANSlUknUG3kI0ygfMn+Y1xY+Vf4qqXJXKM2moYj3VHX9rUHNj5jxA/8AYCPAxoR/tru8D5r1CSBY1a17X7Jv/kjNwAerLYj0rq4nlSJY7mOQLa+YFTbfdR6moVxPAdjJluGBFwRsR4+Xp0oPT/s5x5lwS55MzIzIVNiYwPdW41bu2OY6nNepRVXewV3bCyE+73F+Klx/sCD4CrRoK99svK32rB9vGt5sMGYAbsn318zYZh/ht1qP+zuLLgI82mctKfMlja/ooFXCy3FqqTlAZMP2D6Ph3eBgd+4xA+a5T8atSPcvN57O1WftIlLY5ixuci6fhGtgPgb/ABqbezfHrNgxGffhOQjy1Kn5aeqmoFz1hJEx0pkHvnMh6FbWFvS1vhXzybxs4PFLISezbuSj8p628VOvzHWqxbVuWq2PuxRpa/M3LwxWGeP726HwYbfPb41RrwlWKsCCpII8CDqK9JwgEXBuDsfGqx9qvLuRxi4x3XIWQeDdG+O3r61fLXjcOXS5NT2z9Wp7LuYOyk+yynuSG8ZPR/w+jfr61bBWvN2ax038ulXl7P8AmL7ZhhnP8aKyyefg/wDN+oNRit9E9Vh174Vv7QOWPss3aRj+BISR+Ruq+nUVFoZijB1JVkIYMNwQdCPOvR3FuFR4iF4ZRdXFvQ9CPMVQHNfAZcJN2Uo7u6P0ceP/ABS2PnhNOpiMereTmjmDEY4pJMAqAZUVdBcDvNbe5PyuB68ySBVVcpDMRdutvAeG1ZMxdFVmNl2HQa1sT4Jo8gcWzAMDra39fKu0Qw7YZe9lstgAAALm/mfE0rexOVJAYjdBYi997X18aURt66pSlZ3VW/tV5CbGNFi8PYywkZ0P/sQMDp0zC3x28KgGAypK8gdQxGryXKoD+FQO8xr0PVD+0PsMLi5OwUG7Cy2uocgXtfTfp0oMj8VkkGSPEo2h3jy5tNhqRqdNbb1xMVynPxHFQrCFUlcsuYZeytuxG7XBGg6+t63cBg8TMoZp0sfeQrmAFztfS+h6VIPZvhzFxIr3grF8t9mXJuPiNvKgs3ljgUeCw0eHi1CDVju7dWPmfpoK6tKUCq45ywow2PSbaPGARsegnQdwnzdO7/8AbFWPUY9o/ADjeHyxJ/aLaWL/ABrqAPUXX+am9cwtXW9SgXOHAftWHIAHaJdoz59VPkf6VTB6g3HiPOru5N4z9rwquT/EXuSf4h1+IsfifCoJ7S+AdjOJ0H8OY963R+v+bf51bJG47oaemtNbTjslHsp5h7WH7LIf4kI7l/vR/wD66D0K1OMfgUnieKQXVwVI9f3rzxwnGyQTJNEbOhuPPxB8iLg+tXzy1zDFjIg6GzC2eM7of3Hg3X6VOO241Ln1OKaW7o8KS5g5ffCTtDIPNG6OvQj9x0NfnBMfJhZlmhNmXQg7MvVW8j/Q9KvTj3BYsXF2cw21Vh7yHxB/brVQ8zcrz4MksueLpKo0/mH3D66edc70ms7hoxZ65I7beVrcscyRY2PNGbOts8Z95D+6+DD9bitjj3BIcXEYpluNwRup8VPQ1RGCxbxOJInKOuzD9+hHkdDVl8ue0WN7JirRvtnHuN6/3fx08+ldKZYnyz5emmvNeYQHmjlGfAsSwzxE92UDT0YfdP0rlNIZAMxJsLC9eihIkiWNnRh5FWH6EVBOYvZhFJd8G3Ztv2RuUPod0/SuzJKu34a4w4lOqE5dAbjfU+Wm/nSvziHDJ8K3ZTxtHc/e91iL2II0bQnalFXrWlKVmdiqT9qfDsuNY20fJIB57f7lNXZVfe13Aq8ULnRrsmm9it/oR9aCDYLjcMYyBWbcFrXB1O2otv5iu97PsZ2vEEy6qFkcaWyi1tb9btUL4bxHszlzKlrL3hmuRv1Fh86tD2T8MAWfFEANKyoANlVVBIHjcnf8ooLApSlAoaUoKHxcR4VxmWN9MPijmVugDMSp/lYlD5G9TPH8OTERNDKt0Ya+XgR4EU9uPCVkwAxB97Dupv8AldlRh8yp/lqL+z/mhHiEE0gEqaKWPvr01OhYbW3NgfGrUtr2y0Xr30jJXzHn/aDcycry4JznBaI+5KBofJvwmtTAYt4nEkTFHGzLv/QjyOlXtPKpUqwBU7gi4PreobxbkTCy3MJbDsei95P8p2+BFRbFMeF6dVExq7FwT2jKbLilyn+8QEg+q7r8L/Cppg+IxyrmjdXU6aEMPQ/0NVPj+RMXHcxlJh+U5G+TafWo/Ks+Ge7LJC/jqhPoRuPSnqWr8oJ6el+aStTjfIOFnu0d4JD1T3SfNTp8rVBuK+z/ABkJJQLMvjGdfira/K9ZOF8+4uP3iso/OLH/ADLb6g1KeF+0fDtYTxyRHxH8Rf8ASM3+mn6dvwmIz4/zCusFxXF4NrK0kR6owsD/ACuLfGptwP2nbLioiB+OL91b9j8KsLBLh8XFcNHOh32cDyIOx9bVHOO+zCGQFsMeybfISSh/dPqPKp7bV+Mo9XDknWSNSkHD8Vh8dEQhimjPvK3eI/xK2q/EV+1TmL4fiMDMLrJDKPdZTuPysNGHl8xX7SM33TboN80tw9P0pSqsZVe+1tu7h1G93Pw7tWFVZ+1CTNiI0vtHf5sf6CgqpuH5sTc6qCL+HpXoHkTDhMDFb72Zvmx/aqcjwtidCDvVwcgTZsCg6oWX/Vf9DQSOlKUClKUHF5y4F9uwM+FvlMijKegZWDLe3TMov5V5o4hwKfCM0OJiaI3td9FP+Fvdcehr1jX4ygixFxUTG3bFlmn0eTcNiMTFpDPIoGwD3HyvauvgudcbF/aZJR+ZQD80t9b16Om4Nh297Dwt6xqf1FaE/JuAcWODg18I1U/NQDTmPEunr0n5VVRwr2jYdtJ43iPiP4i/QBvpUw4fi8PikIjkjlXqoIPzU6j4isXH/Y/hJAThS0D9ASXQ+uY5h6g6eBqp+M8tz4ObJKpjkFyrA+8B95GG/wCovqBVvUtHlaMOHJ8J1KyOJezzCy6ophbxj0H+U6fK1RPjHs9xEILJaZR1Ud4eqk3+RNOAc+4qCyy/+RGOjaOB5P19Gv6irP5d5igxi3hfvAXaNtHX1HUeYuPOpiKX8cSWnPh88wo7BTSQydpC7RyDTMpsfQjYjyOlWhyh7QllIhxmWOQ6LINEc+f92fofLauvzPybFiwWW0c3RwNG8nHX13qo+L8Kkw8himTKw+RHip6g1Se6jtE4upjU+f7r94hw6OeMxzIGU9D08wdwfMUqsuQOc2hZMNiCWiYhY3J1jPRSeqE6fl9NvyukTW3LHemXDPbEz/C7aUpVHEqrufWvjj5Ig/f96tGqo54H/nTEnYIAP5BQcSa3ar5g1PPZpiO7NF4EP8xY/wC0fOq6lkGdG87H5Gpb7PcRbGZfxRsPkQf2oLOpXzK4UFjsASa/QaD9pSlApWpBi800iDaMID/iYE2+C5T/ADVt0ClKUCtHjHCYcVEYp0DofHQg+KkaqfMa1vUoKG515DlwRMiXlw/47d6PykA6fnGnjbS8WiLIyujFXU3VlNip8iK9QsoIIIuDoQaqbnv2edlmxGDUmPUvCNSni0fiv5OnTTQUmv2bsPU/03bXJHO4nIgxNlm2R9ll8vBX8tj08Kk3H+BRYyLs5RqNUcbofEfuOtUMwvqPIgg/UH96tz2e80/ao+xlb/yIxqf7xfxeo2b4Hrp0pfftlXPg7P1MarOYuFvhp2hlFiNj0YdGHkf+KVa/tL5c+04XtEF5YbsLbsn3l8/EennX5XO9e2W3p80ZKbnysSlKVd4xVTe0bu41vzKp+FrftVs1WftViHbxEC7GO1vRjY/WghmHwxcrZrEG/jUm5JQpj4b9c4/0N/SoZh+2RwQKkvK2Nvj8NffPYjrqp/rQXMwuLHrUd5IxpaKTDubyYWRoTfcqD/Db4rp/LUjquuK4v7Fx1HvaPFRqsl9r3Kg/AqvzNBYtYsViFjRpGNlRSxPkBc1lqD+1rjHY4MQqe9Ocv8gsW+eg/mNB0/Z/M0uEOIf3sRLJKfLvZVHoFUD4VJa5/L+C7HCwxdUjUH1tr9b10KBSsOLxSRIXkdUUbsxsB86/cPNnGaxAO1xYkeNtx6HWgy0pSgUpSgrH2i8h3zYrBp3tWliUe94ug/F1Kjfca+9WcGJeGVJomyupDKw19fUdCOoJr01VXe0rkn3sXhl01aaMemrqB/qHx8b0tH1ht6bPr2W8JPynx9MbAJAMrr3ZE3ytb6qRqD+4NKqfkzjRwmKEh/sjZJQOq9GHmp19LjrSutbxMcuebpbVt7I3D0FSlKqzFVx7SZLYmP8A+MfVmqb8d4vHhYGmlOijQDdj0A8zVQ8V43JjWaWVAhUhVQalV3Gbz1NBhSUZ1B8ay4fFrHjIHI9yVT8Li/0NYYyLjSuzg+EK8hd9lPX/ALr6UFuVXfthwCvHBJdQyMVNyB3SL39AVHzrT41zPicAElEiGFu72MguVAB7wYEHa1wdATVWcQ4ricfirvmd76xZhleJja6nYWv/ANsaC08F7Vo0jiiZGlm7PMzKbKwUG7Aka6KT86i/GubYcfi8JPITHDcAIRe6q/8AEItqTptbpW9wTk+KJE7SRbxMSjWuQCdVOoFjrf8AxkVp8Q4Bg1CouJGZTIVuBZQy95dD8vM0F3YDHRzRiSJw6Nsym4/4PlUZ5i58hgbsYB9oxBOUImwbwYjr5DX0qnOzxWBhypKRhWRFLI5tI7Md7arpYagaC1XLyJyjDhIxKCJJZFB7S2gBF7J4DXfc/SgycC4DM7LieIuJJhrHEP7OH0A0Z/zG9uh61KKUoFKUoFKUoFKUoKl9oXJnYZsTh1/hNq6D/wBZ8R+Qnp09NlWy6ggggEHQg9RX5VJo34utmtdWjb6pStDj2IMeGlcbhDt08/hvV2BXfP3G1kLHtljSK+UkZrnqQPGoDyvNdJTdjme4LaE6Cxt0vUp5k5dibDSSIod3sqMx2va5uTlU62riQYbsYQ81kkC2ZVYPmyiynumymw1vp+lB0+EcNaaTKoJsbk9FHialf26NWEUTBpB4a5fzHxf6D6VADzdaEpF/CRtWc7tcaC3X0Fa8HF5cnZ4YfZ1IvJPJ7+Xx/IPAbnzoO57QuLw9gMGpV3YgH73eFza/Q77761HMLjl4fFkVT2jC5La202HkK6WLxGG+wrJGLhJQLkWJbIT2h6kte+vlUOEhnYsTpsBQduHGNOc+LmZI9wi2ufS+gqYcpJw2YtFDETJlN+0BY262NyPlauDy/wADw75TI5DdLjMvoR0rp8RbC8MmjmjJBJzNa5uL2IAtYDfegxYrLgnYRuJcIxyspOYoT0PUa7GpHwP2iRYPDphpI5ZDEMquCtmS90OpGuUgHTcVCuJ4SNkkx8JYwTtIpVha2a++uhDAEfCrP9l3B4zgIZpYUMrZrOygtlDELqdhQfOB9orTf2HD8TJ5ra3z2qQYDiuKk97AmIeMkyfogY13AKUH4K/aUoFKUoFKUoFKUoFYMdhu0ieMmwdWW46XFr1npQUhzBiDhO3wM/fXulWGh6MCP3F6i2N4zAUUXlKjQRg5Pna7H51NfbhjI+1iiWMmbLctbQg7C5001N+lVfJhCgXUGRxcBNAL+e5+dBtvjNMxVMOg8O9I3ldrvWXGYCRlUNdM9ssY+7c2BfxbXrqPhWHljh8bzNK+qQ2Yn8T30HoNz42HjUiuZWRrXLMXt5D3R+vzoN0cMMeIkV1AwpypJnW6sFQAZb7sSNLa71HuLcvNhJTGb5DfI3Qi/wCo6j+tTiAvYzYqJAFNkUalmvtvZRfci1djjOB+0YQoSC+Xu33zhLgj47+tBW2DnynfaxqQ8QiWfKBKhGUdxiUN/UK3108qryaWUe8LG9ZEm63PregsriF4+GSRMgSyvaxVgb+agA6+Q6V8csYfiiwx4jBHNFbKY8wIupN7o9vmDeuFyMRjZxg8S79nJcXBs2ikgA2P4f1q9+AcFjwkIhhzZASe8bm53oI1w3nxl7vEMLLhT/eFWMfxNrr9R51MMLiklUPG6up2ZSGB+IrMa1ocBGjF0jVWO5UBb+tt/jQbNKUoFKUoFKUoFKUoFKUoPPXtQ4gn22VYmLZj3ifu6d5V62uKg2IxDNcLe57tx/tWurx7CSNips4u3ayAjb7536n0FbPDIOxvMw1XRbj73QAeW5+FBtxYbs4Uw6e8dXP5v+NvhUw4dgIo5E7XRbWA6tpuPLTU/KoxwmJw+YjNM/eCnQIN8znoBv8A911eNcTy5gjGS/vzfjP4U8F8/wDigk3GOLnEzWTSOIEgdAB1/wC+VTLhSN2UZJ1Nja3lr9Tb4VAOFcPZcOikWkmsW8hcX+FyF9FqfYjF5DkFiEAX6X/eg4PHOR1nzNFlRjrubE+YGmu9xa3nUFl5WljlEbpl0Iv033BGhqyhxIi5+AHj4V+4NvtCssgtrppt4EUEA5aw/wBkxvaK1zFY6+e/9PRjXobCziRFddmAYehFUPxbl14Z5X7aMiQWCm6sbDcXGUn41dvAMMkeGhSO+QItrm51F7nzN70HQpSlApSlApSlApSlApSlApSlBw+YuX8HMrS4iJe6pYyDusABe+ZdTbzqkZMQksgaJCQLiIObgC/vED3ja3Tcjfar15rVDgsQsrZEaJwW8LqRXnDjXMgRexw/cUDvOBZn+O6r5UGzxbjAgBVCcx99zuT/AN2FYOBwticREZje/wDEb8sa69Op/cVwcJgjIFeTZm0B8Nyfl+tTPgUH8J5QLNMwjT8sYsSf9tBNOGrmbtj99lCL4RoTb5n9KztGWeXreT/8RWLg2HdggXYE3PgFJAHxqSLAsamwAvcnxJoOUnDlBzSEnwUbfEivvFY8LHmCkR+73Qbu34V8NdL1+yYlXF3NoU3/ADn8ItuP1OlbGEjLN2klgB7i9EH6X86Dijgryt22IAudAg17NOijzO5PwFSrA8TaBTezRjW21vIHr6VGeN85YeJrZizL91dvif2rnYLFT4ohpVMcWYZFO7HW1+oUb+dhQWxwzHrMgddPFTa6nqDbStuofABGAsegC9NP0+NdXhHFi0nZObki6n56fIE0HbpSlApSlApSlApSlApSlBX3tqwsr4FcjhI1kBl8bbD1Fz9R4VRb8OjusSEs0lrsRawPXX6V6i5k4QMXhpIC2XMO62+Vgbg2O+vSvPnGeAS4PFqk6EEtnLk3DgXPdI3Fx6+IFBpSLnn7IaKgyeg3f9LVNcBgC+HjCizOAo/KGOZz6ZbCoLwuYqkr2BaRio8rtarX4eBFGB1tb0FBsM4iURxHXUk9SepPnWji+IZj2ZPS8jX2X18zpWnPxQB2PRRb49a4GK4rkuWkCuTfMRms3TQbhRsOpPlQSTHcXhgUSzsEC/2cXXb3iOhP0FcWWfGY4akwQHZRozjyG4HmbehrBgeCrmE+Iu8jaqJNSPzMNgfBdh5mprgYMts3vHpvb/mg5nLnJ8MFntmk/E2uXzHS/nvUkwkC3Fhomgv1PU+fT61q4rFW0H/9Nb2CFlAoM5Xc9SK5BxZWVLGzZCV/xKQR63BrsE1GuOXR4HHRiP8ASTQT7l3i4xMKyWAa3eA6Hy8q6lVxwDiQweIaNychJIAF7Btb+l/0qwMHi0lQPGbqdj/3Y0GelKUClKUClKUClKUCoH7YgPscfj2ot/kfap5UL9rGCWTAqSWBSaIgg23bKb330NBUvJuCHZmWQe67FAf8R1/p8/Cu/juL2vbpub7VzeKuUSy6Db/SP+/CuBinJiOu+nzIFBs4jioVC5NyTmA8Sfdv6b/KuhynwjORip793+zQ/wC8jxJ1FcDA4NZcRFG98vvW8TYb/wDelWjHCFYINtB+lBr4WAljO+wNkU9TXVZuyBZjc2rmcWlOawNsikrboRoP1rS47iWMKa+8Bf5Cg6eCmzsXuLdKkOHGg1qP8Lw6iFbf92qQxRDLtQfROtcjmCHNhSeq2cfDU/S4+NdORLK510B6+Va7d/Dm/VP2oIRz1F2kEEucoHCoXX7ja2J8VOoI9K6nsM4nIrz4SY97WQLfqCASvkQQb9dKyLhlfhzK2oFyPhqK43KEfY8UwjJcZxkN9e6yXI+BOnoPCgvWlKUClKUClKUH/9k=",link:"https://www.workforceoneit.com/"},{id:"2",title:"Presence Track",description:"A sophisticated web-based attendance management system. I engineered real-time form handling and a dynamic dashboard to simplify the process of recording and auditing attendance through a modern, mobile-first interface.",tags:["System Design","Real-time UI"],image:"/images/presencetrack.png",link:"https://presencetrack-five.vercel.app/"},{id:"3",title:"KMR PrepVault",description:"An educational resource portal designed to bridge the gap between students and quality study material. I implemented a structured content delivery system with a minimalist, distraction-free UI to optimize student learning workflows.",tags:["Ed-Tech","Content Strategy"],image:"/images/prepvault.png",link:"https://kmr-prepvault.vercel.app/"},{id:"4",title:"CUK-IT Portal",description:"A university-style digital hub for IT services. I developed this portal using advanced multi-page navigation and modular layouts, demonstrating how institutional services can be modernized for better accessibility.",tags:["UI Engineering","Accessibility"],image:"/images/cukweb.png",link:"https://cuk-it.vercel.app/"}]}}var Nm=c(8808);let Nn=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],No=(0,Nm.A)("ExternalLink",Nn),Np=({project:a})=>{let b=lZ(0),c=lZ(0),d=n7(b),e=n3(n7(c),[-.5,.5],["15deg","-15deg"]),f=n3(d,[-.5,.5],["-15deg","15deg"]),g=a=>{let d=a.currentTarget.getBoundingClientRect(),e=(a.clientX-d.left)/d.width-.5,f=(a.clientY-d.top)/d.height-.5;b.set(e),c.set(f)};return(0,x.jsxs)(uz.div,{onMouseMove:g,onMouseLeave:()=>{b.set(0),c.set(0)},style:{rotateY:f,rotateX:e,transformStyle:"preserve-3d"},className:"relative flex-shrink-0 w-[300px] md:w-[450px] aspect-[4/5] snap-center rounded-2xl bg-card/20 border border-white/5 p-8 backdrop-blur-xl group overflow-hidden",children:[(0,x.jsxs)("div",{className:"absolute inset-0 -z-10 h-full w-full bg-black",children:[(0,x.jsx)("img",{src:a.image,alt:a.title,className:"w-full h-full object-cover opacity-50 group-hover:opacity-80 transition-all duration-700"}),(0,x.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/80 to-transparent opacity-90"})]}),(0,x.jsxs)("div",{style:{transform:"translateZ(60px)"},className:"h-full flex flex-col relative z-10",children:[(0,x.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[(0,x.jsx)("div",{className:"flex flex-wrap gap-2",children:a.tags?.slice(0,2).map(a=>(0,x.jsx)("span",{className:"text-[9px] font-headline uppercase tracking-widest text-primary/80 border border-primary/20 px-2 py-0.5 rounded backdrop-blur-md",children:a},a))}),a.link&&(0,x.jsx)("a",{href:a.link,target:"_blank",className:"text-primary opacity-60 hover:opacity-100 transition-opacity",children:(0,x.jsx)(No,{size:16})})]}),(0,x.jsx)("h4",{className:"text-2xl font-headline font-bold mb-4 text-white group-hover:text-primary transition-colors",children:a.title}),(0,x.jsx)("p",{className:"text-sm text-gray-200 mb-8 leading-relaxed font-light",children:a.description}),(0,x.jsxs)("div",{style:{transform:"translateZ(40px)"},className:"mt-auto grid grid-cols-2 gap-4 border-t border-white/10 pt-6",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"block text-[8px] uppercase tracking-widest text-gray-400 mb-1",children:"Architecture"}),(0,x.jsx)("span",{className:"text-[10px] font-bold text-white uppercase",children:a.metrics?.architecture||"Responsive Grid"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"block text-[8px] uppercase tracking-widest text-gray-400 mb-1",children:"Performance"}),(0,x.jsx)("span",{className:"text-[10px] font-bold text-white uppercase",children:a.metrics?.performance||"90+ Lighthouse"})]})]})]}),(0,x.jsx)(uz.div,{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent pointer-events-none opacity-0 group-hover:opacity-100 transition-opacity",style:{transform:"translateZ(100px)",background:"radial-gradient(circle at var(--mouse-x) var(--mouse-y), rgba(255,255,255,0.1) 0%, transparent 80%)"}})]})},Nq=()=>{let[a,b]=(0,y.useState)(0),c=z().useRef(null),[d,e]=(0,y.useState)([]);(0,y.useEffect)(()=>{Nl().then(a=>{e(a.map((a,b)=>({...a,metrics:{architecture:1===b?"Event-Driven":"Modular SSR",performance:1===b?"1.2s TTI":"0ms CLS"}})))})},[]);let f=()=>{if(c.current){let a=c.current.scrollLeft,e=(c.current.offsetWidth,300);b(Math.min(Math.max(0,Math.round(a/(e+24))),d.length-1))}},g=a=>{if(c.current){let d=324;c.current.scrollTo({left:a*d,behavior:"smooth"}),b(a)}};return(0,x.jsxs)(uB,{id:"projects",fullWidth:!0,className:"bg-transparent",children:[(0,x.jsxs)("div",{className:"px-6 md:px-12 mb-16",children:[(0,x.jsx)("h2",{className:"text-primary font-headline text-sm uppercase tracking-[0.5em] mb-4",children:"Implementation"}),(0,x.jsxs)("h3",{className:"text-4xl md:text-7xl font-headline font-bold",children:["Project ",(0,x.jsx)("span",{className:"text-primary/40",children:"Infrastructure."})]})]}),(0,x.jsx)("div",{ref:c,onScroll:f,className:"flex overflow-x-auto pb-12 gap-6 md:gap-12 px-6 md:px-12 no-scrollbar snap-x snap-mandatory items-center perspective-1000",children:d.map(a=>(0,x.jsx)(Np,{project:a},a.id))}),(0,x.jsx)("div",{className:"flex justify-center gap-3 mt-4 md:hidden",children:d.map((b,c)=>(0,x.jsx)("button",{onClick:()=>g(c),className:`h-1.5 rounded-full transition-all duration-300 ${c===a?"w-8 bg-primary":"w-1.5 bg-primary/20 hover:bg-primary/40"}`,"aria-label":`Go to project ${c+1}`},c))})]})},Nr=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Ns=(0,Nm.A)("BookOpen",Nr),Nt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],Nu=(0,Nm.A)("Clock",Nt),Nv=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],Nw=(0,Nm.A)("ArrowUpRight",Nv),Nx=[{title:"Why Evaluation Matters More Than Accuracy",date:"Feb 2025",read:"4 min",excerpt:"Exploring the nuances of model error analysis in production systems."},{title:"What I Learned Training My First Neural Network",date:"Jan 2025",read:"6 min",excerpt:"Backpropagation is more than just mathit's a lesson in patience."}],Ny=()=>(0,x.jsx)(uB,{id:"research",className:"bg-transparent",children:(0,x.jsxs)("div",{className:"max-w-4xl mx-auto w-full",children:[(0,x.jsx)("h2",{className:"text-primary font-headline text-sm uppercase tracking-[0.5em] mb-6",children:"Technical Writing"}),(0,x.jsx)("h3",{className:"text-4xl md:text-6xl font-headline font-bold mb-12",children:"Notes & Research"}),(0,x.jsxs)("div",{className:"space-y-0",children:[Nx.map((a,b)=>(0,x.jsx)("div",{className:"group border-t border-white/5 py-10 hover:bg-white/5 transition-colors px-6 -mx-6",children:(0,x.jsxs)("div",{className:"flex justify-between items-start gap-8",children:[(0,x.jsxs)("div",{className:"flex-1",children:[(0,x.jsxs)("div",{className:"flex items-center gap-4 mb-4 text-[10px] uppercase tracking-widest text-muted-foreground",children:[(0,x.jsxs)("span",{className:"flex items-center gap-1",children:[(0,x.jsx)(Ns,{size:10})," ",a.date]}),(0,x.jsxs)("span",{className:"flex items-center gap-1",children:[(0,x.jsx)(Nu,{size:10})," ",a.read," read"]})]}),(0,x.jsx)("h4",{className:"text-2xl font-headline group-hover:text-primary transition-colors mb-2",children:a.title}),(0,x.jsx)("p",{className:"text-sm text-muted-foreground font-light",children:a.excerpt})]}),(0,x.jsx)(Nw,{className:"opacity-20 group-hover:opacity-100 group-hover:text-primary transition-all"})]})},b)),(0,x.jsx)("div",{className:"border-t border-white/5"})]})]})});var Nz=a=>"checkbox"===a.type,NA=a=>a instanceof Date,NB=a=>null==a;let NC=a=>"object"==typeof a;var ND=a=>!NB(a)&&!Array.isArray(a)&&NC(a)&&!NA(a),NE=a=>ND(a)&&a.target?Nz(a.target)?a.target.checked:a.target.value:a,NF=a=>a.substring(0,a.search(/\.\d+(\.|$)/))||a,NG=(a,b)=>a.has(NF(b)),NH=a=>{let b=a.constructor&&a.constructor.prototype;return ND(b)&&b.hasOwnProperty("isPrototypeOf")},NI="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function NJ(a){let b,c=Array.isArray(a),d="undefined"!=typeof FileList&&a instanceof FileList;if(a instanceof Date)b=new Date(a);else if(a instanceof Set)b=new Set(a);else if(!(!(NI&&(a instanceof Blob||d))&&(c||ND(a))))return a;else if(b=c?[]:{},c||NH(a))for(let c in a)a.hasOwnProperty(c)&&(b[c]=NJ(a[c]));else b=a;return b}var NK=a=>Array.isArray(a)?a.filter(Boolean):[],NL=a=>void 0===a,NM=(a,b,c)=>{if(!b||!ND(a))return c;let d=NK(b.split(/[,[\].]+?/)).reduce((a,b)=>NB(a)?a:a[b],a);return NL(d)||d===a?NL(a[b])?c:a[b]:d},NN=a=>"boolean"==typeof a,NO=a=>/^\w*$/.test(a),NP=a=>NK(a.replace(/["|']|\]/g,"").split(/\.|\[/)),NQ=(a,b,c)=>{let d=-1,e=NO(b)?[b]:NP(b),f=e.length,g=f-1;for(;++d<f;){let b=e[d],f=c;if(d!==g){let c=a[b];f=ND(c)||Array.isArray(c)?c:isNaN(+e[d+1])?{}:[]}if("__proto__"===b||"constructor"===b||"prototype"===b)return;a[b]=f,a=a[b]}return a};let NR={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},NS={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},NT={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},NU=y.createContext(null),NV=()=>y.useContext(NU),NW=a=>{let{children:b,...c}=a;return y.createElement(NU.Provider,{value:c},b)};var NX=(a,b,c,d=!0)=>{let e={defaultValues:b._defaultValues};for(let f in a)Object.defineProperty(e,f,{get:()=>{let e=f;return b._proxyFormState[e]!==NS.all&&(b._proxyFormState[e]=!d||NS.all),c&&(c[e]=!0),a[e]}});return e},NY=a=>ND(a)&&!Object.keys(a).length,NZ=(a,b,c,d)=>{c(a);let{name:e,...f}=a;return NY(f)||Object.keys(f).length>=Object.keys(b).length||Object.keys(f).find(a=>b[a]===(!d||NS.all))},N$=a=>Array.isArray(a)?a:[a],N_=(a,b,c)=>!a||!b||a===b||N$(a).some(a=>a&&(c?a===b:a.startsWith(b)||b.startsWith(a)));function N0(a){let b=y.useRef(a);b.current=a,y.useEffect(()=>{let c=!a.disabled&&b.current.subject&&b.current.subject.subscribe({next:b.current.next});return()=>{c&&c.unsubscribe()}},[a.disabled])}function N1(a){let b=NV(),{control:c=b.control,disabled:d,name:e,exact:f}=a||{},[g,h]=y.useState(c._formState),i=y.useRef(!0),j=y.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),k=y.useRef(e);return k.current=e,N0({disabled:d,next:a=>i.current&&N_(k.current,a.name,f)&&NZ(a,j.current,c._updateFormState)&&h({...c._formState,...a}),subject:c._subjects.state}),y.useEffect(()=>(i.current=!0,j.current.isValid&&c._updateValid(!0),()=>{i.current=!1}),[c]),y.useMemo(()=>NX(g,c,j.current,!1),[g,c])}var N2=a=>"string"==typeof a,N3=(a,b,c,d,e)=>N2(a)?(d&&b.watch.add(a),NM(c,a,e)):Array.isArray(a)?a.map(a=>(d&&b.watch.add(a),NM(c,a))):(d&&(b.watchAll=!0),c);function N4(a){let b=NV(),{control:c=b.control,name:d,defaultValue:e,disabled:f,exact:g}=a||{},h=y.useRef(d);h.current=d,N0({disabled:f,subject:c._subjects.values,next:a=>{N_(h.current,a.name,g)&&j(NJ(N3(h.current,c._names,a.values||c._formValues,!1,e)))}});let[i,j]=y.useState(c._getWatch(d,e));return y.useEffect(()=>c._removeUnmounted()),i}function N5(a){let b=NV(),{name:c,disabled:d,control:e=b.control,shouldUnregister:f}=a,g=NG(e._names.array,c),h=N4({control:e,name:c,defaultValue:NM(e._formValues,c,NM(e._defaultValues,c,a.defaultValue)),exact:!0}),i=N1({control:e,name:c,exact:!0}),j=y.useRef(e.register(c,{...a.rules,value:h,...NN(a.disabled)?{disabled:a.disabled}:{}})),k=y.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!NM(i.errors,c)},isDirty:{enumerable:!0,get:()=>!!NM(i.dirtyFields,c)},isTouched:{enumerable:!0,get:()=>!!NM(i.touchedFields,c)},isValidating:{enumerable:!0,get:()=>!!NM(i.validatingFields,c)},error:{enumerable:!0,get:()=>NM(i.errors,c)}}),[i,c]),l=y.useMemo(()=>({name:c,value:h,...NN(d)||i.disabled?{disabled:i.disabled||d}:{},onChange:a=>j.current.onChange({target:{value:NE(a),name:c},type:NR.CHANGE}),onBlur:()=>j.current.onBlur({target:{value:NM(e._formValues,c),name:c},type:NR.BLUR}),ref:a=>{let b=NM(e._fields,c);b&&a&&(b._f.ref={focus:()=>a.focus(),select:()=>a.select(),setCustomValidity:b=>a.setCustomValidity(b),reportValidity:()=>a.reportValidity()})}}),[c,e._formValues,d,i.disabled,h,e._fields]);return y.useEffect(()=>{let a=e._options.shouldUnregister||f,b=(a,b)=>{let c=NM(e._fields,a);c&&c._f&&(c._f.mount=b)};if(b(c,!0),a){let a=NJ(NM(e._options.defaultValues,c));NQ(e._defaultValues,c,a),NL(NM(e._formValues,c))&&NQ(e._formValues,c,a)}return g||e.register(c),()=>{(g?a&&!e._state.action:a)?e.unregister(c):b(c,!1)}},[c,e,g,f]),y.useEffect(()=>{e._updateDisabledField({disabled:d,fields:e._fields,name:c})},[d,c,e]),y.useMemo(()=>({field:l,formState:i,fieldState:k}),[l,i,k])}let N6=a=>a.render(N5(a));var N7=(a,b,c,d,e)=>b?{...c[a],types:{...c[a]&&c[a].types?c[a].types:{},[d]:e||!0}}:{},N8=a=>({isOnSubmit:!a||a===NS.onSubmit,isOnBlur:a===NS.onBlur,isOnChange:a===NS.onChange,isOnAll:a===NS.all,isOnTouch:a===NS.onTouched}),N9=(a,b,c)=>!c&&(b.watchAll||b.watch.has(a)||[...b.watch].some(b=>a.startsWith(b)&&/^\.\w+/.test(a.slice(b.length))));let Oa=(a,b,c,d)=>{for(let e of c||Object.keys(a)){let c=NM(a,e);if(c){let{_f:a,...f}=c;if(a){if(a.refs&&a.refs[0]&&b(a.refs[0],e)&&!d)return!0;else if(a.ref&&b(a.ref,a.name)&&!d)return!0;else if(Oa(f,b))break}else if(ND(f)&&Oa(f,b))break}}};var Ob=(a,b,c)=>{let d=N$(NM(a,c));return NQ(d,"root",b[c]),NQ(a,c,d),a},Oc=a=>"file"===a.type,Od=a=>"function"==typeof a,Oe=a=>{if(!NI)return!1;let b=a?a.ownerDocument:0;return a instanceof(b&&b.defaultView?b.defaultView.HTMLElement:HTMLElement)},Of=a=>N2(a),Og=a=>"radio"===a.type,Oh=a=>a instanceof RegExp;let Oi={value:!1,isValid:!1},Oj={value:!0,isValid:!0};var Ok=a=>{if(Array.isArray(a)){if(a.length>1){let b=a.filter(a=>a&&a.checked&&!a.disabled).map(a=>a.value);return{value:b,isValid:!!b.length}}return a[0].checked&&!a[0].disabled?a[0].attributes&&!NL(a[0].attributes.value)?NL(a[0].value)||""===a[0].value?Oj:{value:a[0].value,isValid:!0}:Oj:Oi}return Oi};let Ol={isValid:!1,value:null};var Om=a=>Array.isArray(a)?a.reduce((a,b)=>b&&b.checked&&!b.disabled?{isValid:!0,value:b.value}:a,Ol):Ol;function On(a,b,c="validate"){if(Of(a)||Array.isArray(a)&&a.every(Of)||NN(a)&&!a)return{type:c,message:Of(a)?a:"",ref:b}}var Oo=a=>ND(a)&&!Oh(a)?a:{value:a,message:""},Op=async(a,b,c,d,e,f)=>{let{ref:g,refs:h,required:i,maxLength:j,minLength:k,min:l,max:m,pattern:n,validate:o,name:p,valueAsNumber:q,mount:r}=a._f,s=NM(c,p);if(!r||b.has(p))return{};let t=h?h[0]:g,u=a=>{e&&t.reportValidity&&(t.setCustomValidity(NN(a)?"":a||""),t.reportValidity())},v={},w=Og(g),x=Nz(g),y=w||x,z=(q||Oc(g))&&NL(g.value)&&NL(s)||Oe(g)&&""===g.value||""===s||Array.isArray(s)&&!s.length,A=N7.bind(null,p,d,v),B=(a,b,c,d=NT.maxLength,e=NT.minLength)=>{let f=a?b:c;v[p]={type:a?d:e,message:f,ref:g,...A(a?d:e,f)}};if(f?!Array.isArray(s)||!s.length:i&&(!y&&(z||NB(s))||NN(s)&&!s||x&&!Ok(h).isValid||w&&!Om(h).isValid)){let{value:a,message:b}=Of(i)?{value:!!i,message:i}:Oo(i);if(a&&(v[p]={type:NT.required,message:b,ref:t,...A(NT.required,b)},!d))return u(b),v}if(!z&&(!NB(l)||!NB(m))){let a,b,c=Oo(m),e=Oo(l);if(NB(s)||isNaN(s)){let d=g.valueAsDate||new Date(s),f=a=>new Date(new Date().toDateString()+" "+a),h="time"==g.type,i="week"==g.type;N2(c.value)&&s&&(a=h?f(s)>f(c.value):i?s>c.value:d>new Date(c.value)),N2(e.value)&&s&&(b=h?f(s)<f(e.value):i?s<e.value:d<new Date(e.value))}else{let d=g.valueAsNumber||(s?+s:s);NB(c.value)||(a=d>c.value),NB(e.value)||(b=d<e.value)}if((a||b)&&(B(!!a,c.message,e.message,NT.max,NT.min),!d))return u(v[p].message),v}if((j||k)&&!z&&(N2(s)||f&&Array.isArray(s))){let a=Oo(j),b=Oo(k),c=!NB(a.value)&&s.length>+a.value,e=!NB(b.value)&&s.length<+b.value;if((c||e)&&(B(c,a.message,b.message),!d))return u(v[p].message),v}if(n&&!z&&N2(s)){let{value:a,message:b}=Oo(n);if(Oh(a)&&!s.match(a)&&(v[p]={type:NT.pattern,message:b,ref:g,...A(NT.pattern,b)},!d))return u(b),v}if(o){if(Od(o)){let a=On(await o(s,c),t);if(a&&(v[p]={...a,...A(NT.validate,a.message)},!d))return u(a.message),v}else if(ND(o)){let a={};for(let b in o){if(!NY(a)&&!d)break;let e=On(await o[b](s,c),t,b);e&&(a={...e,...A(b,e.message)},u(e.message),d&&(v[p]=a))}if(!NY(a)&&(v[p]={ref:t,...a},!d))return v}}return u(!0),v};function Oq(a,b){let c=0,d=[...a];for(let a of b)d.splice(a-c,1),c++;return NK(d).length?d:[]}function Or(a,b){let c=b.slice(0,-1).length,d=0;for(;d<c;)a=NL(a)?d++:a[b[d++]];return a}function Os(a){for(let b in a)if(a.hasOwnProperty(b)&&!NL(a[b]))return!1;return!0}function Ot(a,b){let c=Array.isArray(b)?b:NO(b)?[b]:NP(b),d=1===c.length?a:Or(a,c),e=c.length-1,f=c[e];return d&&delete d[f],0!==e&&(ND(d)&&NY(d)||Array.isArray(d)&&Os(d))&&Ot(a,c.slice(0,-1)),a}var Ou=()=>{let a=[];return{get observers(){return a},next:b=>{for(let c of a)c.next&&c.next(b)},subscribe:b=>(a.push(b),{unsubscribe:()=>{a=a.filter(a=>a!==b)}}),unsubscribe:()=>{a=[]}}},Ov=a=>NB(a)||!NC(a);function Ow(a,b){if(Ov(a)||Ov(b))return a===b;if(NA(a)&&NA(b))return a.getTime()===b.getTime();let c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(let e of c){let c=a[e];if(!d.includes(e))return!1;if("ref"!==e){let a=b[e];if(NA(c)&&NA(a)||ND(c)&&ND(a)||Array.isArray(c)&&Array.isArray(a)?!Ow(c,a):c!==a)return!1}}return!0}var Ox=a=>"select-multiple"===a.type,Oy=a=>Og(a)||Nz(a),Oz=a=>Oe(a)&&a.isConnected,OA=a=>{for(let b in a)if(Od(a[b]))return!0;return!1};function OB(a,b={}){let c=Array.isArray(a);if(ND(a)||c)for(let c in a)Array.isArray(a[c])||ND(a[c])&&!OA(a[c])?(b[c]=Array.isArray(a[c])?[]:{},OB(a[c],b[c])):NB(a[c])||(b[c]=!0);return b}function OC(a,b,c){let d=Array.isArray(a);if(ND(a)||d)for(let d in a)Array.isArray(a[d])||ND(a[d])&&!OA(a[d])?NL(b)||Ov(c[d])?c[d]=Array.isArray(a[d])?OB(a[d],[]):{...OB(a[d])}:OC(a[d],NB(b)?{}:b[d],c[d]):c[d]=!Ow(a[d],b[d]);return c}var OD=(a,b)=>OC(a,b,OB(b)),OE=(a,{valueAsNumber:b,valueAsDate:c,setValueAs:d})=>NL(a)?a:b?""===a?NaN:a?+a:a:c&&N2(a)?new Date(a):d?d(a):a;function OF(a){let b=a.ref;return Oc(b)?b.files:Og(b)?Om(a.refs).value:Ox(b)?[...b.selectedOptions].map(({value:a})=>a):Nz(b)?Ok(a.refs).value:OE(NL(b.value)?a.ref.value:b.value,a)}var OG=(a,b,c,d)=>{let e={};for(let c of a){let a=NM(b,c);a&&NQ(e,c,a._f)}return{criteriaMode:c,names:[...a],fields:e,shouldUseNativeValidation:d}},OH=a=>NL(a)?a:Oh(a)?a.source:ND(a)?Oh(a.value)?a.value.source:a.value:a;let OI="AsyncFunction";var OJ=a=>!!a&&!!a.validate&&!!(Od(a.validate)&&a.validate.constructor.name===OI||ND(a.validate)&&Object.values(a.validate).find(a=>a.constructor.name===OI)),OK=a=>a.mount&&(a.required||a.min||a.max||a.maxLength||a.minLength||a.pattern||a.validate);function OL(a,b,c){let d=NM(a,c);if(d||NO(c))return{error:d,name:c};let e=c.split(".");for(;e.length;){let d=e.join("."),f=NM(b,d),g=NM(a,d);if(f&&!Array.isArray(f)&&c!==d)break;if(g&&g.type)return{name:d,error:g};e.pop()}return{name:c}}var OM=(a,b,c,d,e)=>!e.isOnAll&&(!c&&e.isOnTouch?!(b||a):(c?d.isOnBlur:e.isOnBlur)?!a:(c?!d.isOnChange:!e.isOnChange)||a),ON=(a,b)=>!NK(NM(a,b)).length&&Ot(a,b);let OO={mode:NS.onSubmit,reValidateMode:NS.onChange,shouldFocusError:!0};function OP(a={}){let b,c={...OO,...a},d={submitCount:0,isDirty:!1,isLoading:Od(c.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:c.errors||{},disabled:c.disabled||!1},e={},f=(ND(c.defaultValues)||ND(c.values))&&NJ(c.defaultValues||c.values)||{},g=c.shouldUnregister?{}:NJ(f),h={action:!1,mount:!1,watch:!1},i={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},j=0,k={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},l={values:Ou(),array:Ou(),state:Ou()},m=N8(c.mode),n=N8(c.reValidateMode),o=c.criteriaMode===NS.all,p=a=>b=>{clearTimeout(j),j=setTimeout(a,b)},q=async a=>{if(!c.disabled&&(k.isValid||a)){let a=c.resolver?NY((await y()).errors):await A(e,!0);a!==d.isValid&&l.state.next({isValid:a})}},r=(a,b)=>{!c.disabled&&(k.isValidating||k.validatingFields)&&((a||Array.from(i.mount)).forEach(a=>{a&&(b?NQ(d.validatingFields,a,b):Ot(d.validatingFields,a))}),l.state.next({validatingFields:d.validatingFields,isValidating:!NY(d.validatingFields)}))},s=(a,b=[],i,j,m=!0,n=!0)=>{if(j&&i&&!c.disabled){if(h.action=!0,n&&Array.isArray(NM(e,a))){let b=i(NM(e,a),j.argA,j.argB);m&&NQ(e,a,b)}if(n&&Array.isArray(NM(d.errors,a))){let b=i(NM(d.errors,a),j.argA,j.argB);m&&NQ(d.errors,a,b),ON(d.errors,a)}if(k.touchedFields&&n&&Array.isArray(NM(d.touchedFields,a))){let b=i(NM(d.touchedFields,a),j.argA,j.argB);m&&NQ(d.touchedFields,a,b)}k.dirtyFields&&(d.dirtyFields=OD(f,g)),l.state.next({name:a,isDirty:C(a,b),dirtyFields:d.dirtyFields,errors:d.errors,isValid:d.isValid})}else NQ(g,a,b)},t=(a,b)=>{NQ(d.errors,a,b),l.state.next({errors:d.errors})},u=a=>{d.errors=a,l.state.next({errors:d.errors,isValid:!1})},v=(a,b,c,d)=>{let i=NM(e,a);if(i){let e=NM(g,a,NL(c)?NM(f,a):c);NL(e)||d&&d.defaultChecked||b?NQ(g,a,b?e:OF(i._f)):E(a,e),h.mount&&q()}},w=(a,b,g,h,i)=>{let j=!1,m=!1,n={name:a};if(!c.disabled){let c=!!(NM(e,a)&&NM(e,a)._f&&NM(e,a)._f.disabled);if(!g||h){k.isDirty&&(m=d.isDirty,d.isDirty=n.isDirty=C(),j=m!==n.isDirty);let e=c||Ow(NM(f,a),b);m=!!(!c&&NM(d.dirtyFields,a)),e||c?Ot(d.dirtyFields,a):NQ(d.dirtyFields,a,!0),n.dirtyFields=d.dirtyFields,j=j||k.dirtyFields&&!e!==m}if(g){let b=NM(d.touchedFields,a);b||(NQ(d.touchedFields,a,g),n.touchedFields=d.touchedFields,j=j||k.touchedFields&&b!==g)}j&&i&&l.state.next(n)}return j?n:{}},x=(a,e,f,g)=>{let h=NM(d.errors,a),i=k.isValid&&NN(e)&&d.isValid!==e;if(c.delayError&&f?(b=p(()=>t(a,f)))(c.delayError):(clearTimeout(j),b=null,f?NQ(d.errors,a,f):Ot(d.errors,a)),(f?!Ow(h,f):h)||!NY(g)||i){let b={...g,...i&&NN(e)?{isValid:e}:{},errors:d.errors,name:a};d={...d,...b},l.state.next(b)}},y=async a=>{r(a,!0);let b=await c.resolver(g,c.context,OG(a||i.mount,e,c.criteriaMode,c.shouldUseNativeValidation));return r(a),b},z=async a=>{let{errors:b}=await y(a);if(a)for(let c of a){let a=NM(b,c);a?NQ(d.errors,c,a):Ot(d.errors,c)}else d.errors=b;return b},A=async(a,b,e={valid:!0})=>{for(let f in a){let h=a[f];if(h){let{_f:a,...j}=h;if(a){let j=i.array.has(a.name),l=h._f&&OJ(h._f);l&&k.validatingFields&&r([f],!0);let m=await Op(h,i.disabled,g,o,c.shouldUseNativeValidation&&!b,j);if(l&&k.validatingFields&&r([f]),m[a.name]&&(e.valid=!1,b))break;b||(NM(m,a.name)?j?Ob(d.errors,m,a.name):NQ(d.errors,a.name,m[a.name]):Ot(d.errors,a.name))}NY(j)||await A(j,b,e)}}return e.valid},B=()=>{for(let a of i.unMount){let b=NM(e,a);b&&(b._f.refs?b._f.refs.every(a=>!Oz(a)):!Oz(b._f.ref))&&P(a)}i.unMount=new Set},C=(a,b)=>!c.disabled&&(a&&b&&NQ(g,a,b),!Ow(K(),f)),D=(a,b,c)=>N3(a,i,{...h.mount?g:NL(b)?f:N2(a)?{[a]:b}:b},c,b),E=(a,b,c={})=>{let d=NM(e,a),f=b;if(d){let c=d._f;c&&(c.disabled||NQ(g,a,OE(b,c)),f=Oe(c.ref)&&NB(b)?"":b,Ox(c.ref)?[...c.ref.options].forEach(a=>a.selected=f.includes(a.value)):c.refs?Nz(c.ref)?c.refs.length>1?c.refs.forEach(a=>(!a.defaultChecked||!a.disabled)&&(a.checked=Array.isArray(f)?!!f.find(b=>b===a.value):f===a.value)):c.refs[0]&&(c.refs[0].checked=!!f):c.refs.forEach(a=>a.checked=a.value===f):Oc(c.ref)?c.ref.value="":(c.ref.value=f,c.ref.type||l.values.next({name:a,values:{...g}})))}(c.shouldDirty||c.shouldTouch)&&w(a,f,c.shouldTouch,c.shouldDirty,!0),c.shouldValidate&&J(a)},F=(a,b,c)=>{for(let d in b){let f=b[d],g=`${a}.${d}`,h=NM(e,g);(i.array.has(a)||ND(f)||h&&!h._f)&&!NA(f)?F(g,f,c):E(g,f,c)}},G=(a,b,c={})=>{let j=NM(e,a),m=i.array.has(a),n=NJ(b);NQ(g,a,n),m?(l.array.next({name:a,values:{...g}}),(k.isDirty||k.dirtyFields)&&c.shouldDirty&&l.state.next({name:a,dirtyFields:OD(f,g),isDirty:C(a,n)})):!j||j._f||NB(n)?E(a,n,c):F(a,n,c),N9(a,i)&&l.state.next({...d}),l.values.next({name:h.mount?a:void 0,values:{...g}})},H=async a=>{h.mount=!0;let f=a.target,j=f.name,p=!0,s=NM(e,j),t=()=>f.type?OF(s._f):NE(a),u=a=>{p=Number.isNaN(a)||NA(a)&&isNaN(a.getTime())||Ow(a,NM(g,j,a))};if(s){let f,h,v=t(),z=a.type===NR.BLUR||a.type===NR.FOCUS_OUT,B=!OK(s._f)&&!c.resolver&&!NM(d.errors,j)&&!s._f.deps||OM(z,NM(d.touchedFields,j),d.isSubmitted,n,m),C=N9(j,i,z);NQ(g,j,v),z?(s._f.onBlur&&s._f.onBlur(a),b&&b(0)):s._f.onChange&&s._f.onChange(a);let D=w(j,v,z,!1),E=!NY(D)||C;if(z||l.values.next({name:j,type:a.type,values:{...g}}),B)return k.isValid&&("onBlur"===c.mode&&z?q():z||q()),E&&l.state.next({name:j,...C?{}:D});if(!z&&C&&l.state.next({...d}),c.resolver){let{errors:a}=await y([j]);if(u(v),p){let b=OL(d.errors,e,j),c=OL(a,e,b.name||j);f=c.error,j=c.name,h=NY(a)}}else r([j],!0),f=(await Op(s,i.disabled,g,o,c.shouldUseNativeValidation))[j],r([j]),u(v),p&&(f?h=!1:k.isValid&&(h=await A(e,!0)));p&&(s._f.deps&&J(s._f.deps),x(j,h,f,D))}},I=(a,b)=>{if(NM(d.errors,b)&&a.focus)return a.focus(),1},J=async(a,b={})=>{let f,g,h=N$(a);if(c.resolver){let b=await z(NL(a)?a:h);f=NY(b),g=a?!h.some(a=>NM(b,a)):f}else a?((g=(await Promise.all(h.map(async a=>{let b=NM(e,a);return await A(b&&b._f?{[a]:b}:b)}))).every(Boolean))||d.isValid)&&q():g=f=await A(e);return l.state.next({...!N2(a)||k.isValid&&f!==d.isValid?{}:{name:a},...c.resolver||!a?{isValid:f}:{},errors:d.errors}),b.shouldFocus&&!g&&Oa(e,I,a?h:i.mount),g},K=a=>{let b={...h.mount?g:f};return NL(a)?b:N2(a)?NM(b,a):a.map(a=>NM(b,a))},L=(a,b)=>({invalid:!!NM((b||d).errors,a),isDirty:!!NM((b||d).dirtyFields,a),error:NM((b||d).errors,a),isValidating:!!NM(d.validatingFields,a),isTouched:!!NM((b||d).touchedFields,a)}),M=a=>{a&&N$(a).forEach(a=>Ot(d.errors,a)),l.state.next({errors:a?d.errors:{}})},N=(a,b,c)=>{let f=(NM(e,a,{_f:{}})._f||{}).ref,{ref:g,message:h,type:i,...j}=NM(d.errors,a)||{};NQ(d.errors,a,{...j,...b,ref:f}),l.state.next({name:a,errors:d.errors,isValid:!1}),c&&c.shouldFocus&&f&&f.focus&&f.focus()},O=(a,b)=>Od(a)?l.values.subscribe({next:c=>a(D(void 0,b),c)}):D(a,b,!0),P=(a,b={})=>{for(let h of a?N$(a):i.mount)i.mount.delete(h),i.array.delete(h),b.keepValue||(Ot(e,h),Ot(g,h)),b.keepError||Ot(d.errors,h),b.keepDirty||Ot(d.dirtyFields,h),b.keepTouched||Ot(d.touchedFields,h),b.keepIsValidating||Ot(d.validatingFields,h),c.shouldUnregister||b.keepDefaultValue||Ot(f,h);l.values.next({values:{...g}}),l.state.next({...d,...!b.keepDirty?{}:{isDirty:C()}}),b.keepIsValid||q()},Q=({disabled:a,name:b,field:c,fields:d})=>{(NN(a)&&h.mount||a||i.disabled.has(b))&&(a?i.disabled.add(b):i.disabled.delete(b),w(b,OF(c?c._f:NM(d,b)._f),!1,!1,!0))},R=(a,b={})=>{let d=NM(e,a),g=NN(b.disabled)||NN(c.disabled);return NQ(e,a,{...d||{},_f:{...d&&d._f?d._f:{ref:{name:a}},name:a,mount:!0,...b}}),i.mount.add(a),d?Q({field:d,disabled:NN(b.disabled)?b.disabled:c.disabled,name:a}):v(a,!0,b.value),{...g?{disabled:b.disabled||c.disabled}:{},...c.progressive?{required:!!b.required,min:OH(b.min),max:OH(b.max),minLength:OH(b.minLength),maxLength:OH(b.maxLength),pattern:OH(b.pattern)}:{},name:a,onChange:H,onBlur:H,ref:g=>{if(g){R(a,b),d=NM(e,a);let c=NL(g.value)&&g.querySelectorAll&&g.querySelectorAll("input,select,textarea")[0]||g,h=Oy(c),i=d._f.refs||[];(h?i.find(a=>a===c):c===d._f.ref)||(NQ(e,a,{_f:{...d._f,...h?{refs:[...i.filter(Oz),c,...Array.isArray(NM(f,a))?[{}]:[]],ref:{type:c.type,name:a}}:{ref:c}}}),v(a,!1,void 0,c))}else(d=NM(e,a,{}))._f&&(d._f.mount=!1),(c.shouldUnregister||b.shouldUnregister)&&!(NG(i.array,a)&&h.action)&&i.unMount.add(a)}}},S=()=>c.shouldFocusError&&Oa(e,I,i.mount),T=(a,b)=>async f=>{let h;f&&(f.preventDefault&&f.preventDefault(),f.persist&&f.persist());let j=NJ(g);if(i.disabled.size)for(let a of i.disabled)NQ(j,a,void 0);if(l.state.next({isSubmitting:!0}),c.resolver){let{errors:a,values:b}=await y();d.errors=a,j=b}else await A(e);if(Ot(d.errors,"root"),NY(d.errors)){l.state.next({errors:{}});try{await a(j,f)}catch(a){h=a}}else b&&await b({...d.errors},f),S(),setTimeout(S);if(l.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:NY(d.errors)&&!h,submitCount:d.submitCount+1,errors:d.errors}),h)throw h},U=(a,b={})=>{NM(e,a)&&(NL(b.defaultValue)?G(a,NJ(NM(f,a))):(G(a,b.defaultValue),NQ(f,a,NJ(b.defaultValue))),b.keepTouched||Ot(d.touchedFields,a),b.keepDirty||(Ot(d.dirtyFields,a),d.isDirty=b.defaultValue?C(a,NJ(NM(f,a))):C()),!b.keepError&&(Ot(d.errors,a),k.isValid&&q()),l.state.next({...d}))},V=(a,b={})=>{let j=a?NJ(a):f,m=NJ(j),n=NY(a),o=n?f:m;if(b.keepDefaultValues||(f=j),!b.keepValues){if(b.keepDirtyValues)for(let a of Array.from(new Set([...i.mount,...Object.keys(OD(f,g))])))NM(d.dirtyFields,a)?NQ(o,a,NM(g,a)):G(a,NM(o,a));else{if(NI&&NL(a))for(let a of i.mount){let b=NM(e,a);if(b&&b._f){let a=Array.isArray(b._f.refs)?b._f.refs[0]:b._f.ref;if(Oe(a)){let b=a.closest("form");if(b){b.reset();break}}}}e={}}g=c.shouldUnregister?b.keepDefaultValues?NJ(f):{}:NJ(o),l.array.next({values:{...o}}),l.values.next({values:{...o}})}i={mount:b.keepDirtyValues?i.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},h.mount=!k.isValid||!!b.keepIsValid||!!b.keepDirtyValues,h.watch=!!c.shouldUnregister,l.state.next({submitCount:b.keepSubmitCount?d.submitCount:0,isDirty:!n&&(b.keepDirty?d.isDirty:!!(b.keepDefaultValues&&!Ow(a,f))),isSubmitted:!!b.keepIsSubmitted&&d.isSubmitted,dirtyFields:n?{}:b.keepDirtyValues?b.keepDefaultValues&&g?OD(f,g):d.dirtyFields:b.keepDefaultValues&&a?OD(f,a):b.keepDirty?d.dirtyFields:{},touchedFields:b.keepTouched?d.touchedFields:{},errors:b.keepErrors?d.errors:{},isSubmitSuccessful:!!b.keepIsSubmitSuccessful&&d.isSubmitSuccessful,isSubmitting:!1})},W=(a,b)=>V(Od(a)?a(g):a,b),X=(a,b={})=>{let c=NM(e,a),d=c&&c._f;if(d){let a=d.refs?d.refs[0]:d.ref;a.focus&&(a.focus(),b.shouldSelect&&Od(a.select)&&a.select())}};return{control:{register:R,unregister:P,getFieldState:L,handleSubmit:T,setError:N,_executeSchema:y,_getWatch:D,_getDirty:C,_updateValid:q,_removeUnmounted:B,_updateFieldArray:s,_updateDisabledField:Q,_getFieldArray:a=>NK(NM(h.mount?g:f,a,c.shouldUnregister?NM(f,a,[]):[])),_reset:V,_resetDefaultValues:()=>Od(c.defaultValues)&&c.defaultValues().then(a=>{W(a,c.resetOptions),l.state.next({isLoading:!1})}),_updateFormState:a=>{d={...d,...a}},_disableForm:a=>{NN(a)&&(l.state.next({disabled:a}),Oa(e,(b,c)=>{let d=NM(e,c);d&&(b.disabled=d._f.disabled||a,Array.isArray(d._f.refs)&&d._f.refs.forEach(b=>{b.disabled=d._f.disabled||a}))},0,!1))},_subjects:l,_proxyFormState:k,_setErrors:u,get _fields(){return e},get _formValues(){return g},get _state(){return h},set _state(value){h=value},get _defaultValues(){return f},get _names(){return i},set _names(value){i=value},get _formState(){return d},set _formState(value){d=value},get _options(){return c},set _options(value){c={...c,...value}}},trigger:J,register:R,handleSubmit:T,watch:O,setValue:G,getValues:K,reset:W,resetField:U,clearErrors:M,unregister:P,setError:N,setFocus:X,getFieldState:L}}function OQ(a={}){let b=y.useRef(void 0),c=y.useRef(void 0),[d,e]=y.useState({isDirty:!1,isValidating:!1,isLoading:Od(a.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:a.errors||{},disabled:a.disabled||!1,defaultValues:Od(a.defaultValues)?void 0:a.defaultValues});b.current||(b.current={...OP(a),formState:d});let f=b.current.control;return f._options=a,N0({subject:f._subjects.state,next:a=>{NZ(a,f._proxyFormState,f._updateFormState,!0)&&e({...f._formState})}}),y.useEffect(()=>f._disableForm(a.disabled),[f,a.disabled]),y.useEffect(()=>{if(f._proxyFormState.isDirty){let a=f._getDirty();a!==d.isDirty&&f._subjects.state.next({isDirty:a})}},[f,d.isDirty]),y.useEffect(()=>{a.values&&!Ow(a.values,c.current)?(f._reset(a.values,f._options.resetOptions),c.current=a.values,e(a=>({...a}))):f._resetDefaultValues()},[a.values,f]),y.useEffect(()=>{a.errors&&f._setErrors(a.errors)},[a.errors,f]),y.useEffect(()=>{f._state.mount||(f._updateValid(),f._state.mount=!0),f._state.watch&&(f._state.watch=!1,f._subjects.state.next({...f._formState})),f._removeUnmounted()}),y.useEffect(()=>{a.shouldUnregister&&f._subjects.values.next({values:f._getWatch()})},[a.shouldUnregister,f]),b.current.formState=NX(d,f),b.current}let OR=(a,b,c)=>{if(a&&"reportValidity"in a){let d=NM(c,b);a.setCustomValidity(d&&d.message||""),a.reportValidity()}},OS=(a,b)=>{for(let c in b.fields){let d=b.fields[c];d&&d.ref&&"reportValidity"in d.ref?OR(d.ref,c,a):d&&d.refs&&d.refs.forEach(b=>OR(b,c,a))}},OT=(a,b)=>{b.shouldUseNativeValidation&&OS(a,b);let c={};for(let d in a){let e=NM(b.fields,d),f=Object.assign(a[d]||{},{ref:e&&e.ref});if(OU(b.names||Object.keys(a),d)){let a=Object.assign({},NM(c,d));NQ(a,"root",f),NQ(c,d,a)}else NQ(c,d,f)}return c},OU=(a,b)=>{let c=OV(b);return a.some(a=>OV(a).match(`^${c}\\.\\d+`))};function OV(a){return a.replace(/\]|\[/g,"")}function OW(a,b){for(var c={};a.length;){var d=a[0],e=d.code,f=d.message,g=d.path.join(".");if(!c[g])if("unionErrors"in d){var h=d.unionErrors[0].errors[0];c[g]={message:h.message,type:h.code}}else c[g]={message:f,type:e};if("unionErrors"in d&&d.unionErrors.forEach(function(b){return b.errors.forEach(function(b){return a.push(b)})}),b){var i=c[g].types,j=i&&i[d.code];c[g]=N7(g,b,c,e,j?[].concat(j,d.message):d.message)}a.shift()}return c}function OX(a,b,c){return void 0===c&&(c={}),function(d,e,f){try{return Promise.resolve(function(e,g){try{var h=Promise.resolve(a["sync"===c.mode?"parse":"parseAsync"](d,b)).then(function(a){return f.shouldUseNativeValidation&&OS({},f),{errors:{},values:c.raw?Object.assign({},d):a}})}catch(a){return g(a)}return h&&h.then?h.then(void 0,g):h}(0,function(a){if(function(a){return Array.isArray(null==a?void 0:a.errors)}(a))return{values:{},errors:OT(OW(a.errors,!f.shouldUseNativeValidation&&"all"===f.criteriaMode),f)};throw a}))}catch(a){return Promise.reject(a)}}}!function(a){a.assertEqual=a=>a,a.assertIs=function(a){},a.assertNever=function(a){throw Error()},a.arrayToEnum=a=>{let b={};for(let c of a)b[c]=c;return b},a.getValidEnumValues=b=>{let c=a.objectKeys(b).filter(a=>"number"!=typeof b[b[a]]),d={};for(let a of c)d[a]=b[a];return a.objectValues(d)},a.objectValues=b=>a.objectKeys(b).map(function(a){return b[a]}),a.objectKeys="function"==typeof Object.keys?a=>Object.keys(a):a=>{let b=[];for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b},a.find=(a,b)=>{for(let c of a)if(b(c))return c},a.isInteger="function"==typeof Number.isInteger?a=>Number.isInteger(a):a=>"number"==typeof a&&isFinite(a)&&Math.floor(a)===a,a.joinValues=function(a,b=" | "){return a.map(a=>"string"==typeof a?`'${a}'`:a).join(b)},a.jsonStringifyReplacer=(a,b)=>"bigint"==typeof b?b.toString():b}(r||(r={})),function(a){a.mergeShapes=(a,b)=>({...a,...b})}(s||(s={}));let OY=r.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),OZ=a=>{switch(typeof a){case"undefined":return OY.undefined;case"string":return OY.string;case"number":return isNaN(a)?OY.nan:OY.number;case"boolean":return OY.boolean;case"function":return OY.function;case"bigint":return OY.bigint;case"symbol":return OY.symbol;case"object":if(Array.isArray(a))return OY.array;if(null===a)return OY.null;if(a.then&&"function"==typeof a.then&&a.catch&&"function"==typeof a.catch)return OY.promise;if("undefined"!=typeof Map&&a instanceof Map)return OY.map;if("undefined"!=typeof Set&&a instanceof Set)return OY.set;if("undefined"!=typeof Date&&a instanceof Date)return OY.date;return OY.object;default:return OY.unknown}},O$=r.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class O_ extends Error{get errors(){return this.issues}constructor(a){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};let b=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,b):this.__proto__=b,this.name="ZodError",this.issues=a}format(a){let b=a||function(a){return a.message},c={_errors:[]},d=a=>{for(let e of a.issues)if("invalid_union"===e.code)e.unionErrors.map(d);else if("invalid_return_type"===e.code)d(e.returnTypeError);else if("invalid_arguments"===e.code)d(e.argumentsError);else if(0===e.path.length)c._errors.push(b(e));else{let a=c,d=0;for(;d<e.path.length;){let c=e.path[d];d===e.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(b(e))):a[c]=a[c]||{_errors:[]},a=a[c],d++}}};return d(this),c}static assert(a){if(!(a instanceof O_))throw Error(`Not a ZodError: ${a}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,r.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(a=a=>a.message){let b={},c=[];for(let d of this.issues)d.path.length>0?(b[d.path[0]]=b[d.path[0]]||[],b[d.path[0]].push(a(d))):c.push(a(d));return{formErrors:c,fieldErrors:b}}get formErrors(){return this.flatten()}}O_.create=a=>new O_(a);let O0=(a,b)=>{let c;switch(a.code){case O$.invalid_type:c=a.received===OY.undefined?"Required":`Expected ${a.expected}, received ${a.received}`;break;case O$.invalid_literal:c=`Invalid literal value, expected ${JSON.stringify(a.expected,r.jsonStringifyReplacer)}`;break;case O$.unrecognized_keys:c=`Unrecognized key(s) in object: ${r.joinValues(a.keys,", ")}`;break;case O$.invalid_union:c="Invalid input";break;case O$.invalid_union_discriminator:c=`Invalid discriminator value. Expected ${r.joinValues(a.options)}`;break;case O$.invalid_enum_value:c=`Invalid enum value. Expected ${r.joinValues(a.options)}, received '${a.received}'`;break;case O$.invalid_arguments:c="Invalid function arguments";break;case O$.invalid_return_type:c="Invalid function return type";break;case O$.invalid_date:c="Invalid date";break;case O$.invalid_string:"object"==typeof a.validation?"includes"in a.validation?(c=`Invalid input: must include "${a.validation.includes}"`,"number"==typeof a.validation.position&&(c=`${c} at one or more positions greater than or equal to ${a.validation.position}`)):"startsWith"in a.validation?c=`Invalid input: must start with "${a.validation.startsWith}"`:"endsWith"in a.validation?c=`Invalid input: must end with "${a.validation.endsWith}"`:r.assertNever(a.validation):c="regex"!==a.validation?`Invalid ${a.validation}`:"Invalid";break;case O$.too_small:c="array"===a.type?`Array must contain ${a.exact?"exactly":a.inclusive?"at least":"more than"} ${a.minimum} element(s)`:"string"===a.type?`String must contain ${a.exact?"exactly":a.inclusive?"at least":"over"} ${a.minimum} character(s)`:"number"===a.type?`Number must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${a.minimum}`:"date"===a.type?`Date must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(a.minimum))}`:"Invalid input";break;case O$.too_big:c="array"===a.type?`Array must contain ${a.exact?"exactly":a.inclusive?"at most":"less than"} ${a.maximum} element(s)`:"string"===a.type?`String must contain ${a.exact?"exactly":a.inclusive?"at most":"under"} ${a.maximum} character(s)`:"number"===a.type?`Number must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:"bigint"===a.type?`BigInt must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:"date"===a.type?`Date must be ${a.exact?"exactly":a.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(a.maximum))}`:"Invalid input";break;case O$.custom:c="Invalid input";break;case O$.invalid_intersection_types:c="Intersection results could not be merged";break;case O$.not_multiple_of:c=`Number must be a multiple of ${a.multipleOf}`;break;case O$.not_finite:c="Number must be finite";break;default:c=b.defaultError,r.assertNever(a)}return{message:c}},O1=O0;function O2(){return O1}let O3=a=>{let{data:b,path:c,errorMaps:d,issueData:e}=a,f=[...c,...e.path||[]],g={...e,path:f};if(void 0!==e.message)return{...e,path:f,message:e.message};let h="";for(let a of d.filter(a=>!!a).slice().reverse())h=a(g,{data:b,defaultError:h}).message;return{...e,path:f,message:h}};function O4(a,b){let c=O2(),d=O3({issueData:b,data:a.data,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,c,c===O0?void 0:O0].filter(a=>!!a)});a.common.issues.push(d)}class O5{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(a,b){let c=[];for(let d of b){if("aborted"===d.status)return O6;"dirty"===d.status&&a.dirty(),c.push(d.value)}return{status:a.value,value:c}}static async mergeObjectAsync(a,b){let c=[];for(let a of b){let b=await a.key,d=await a.value;c.push({key:b,value:d})}return O5.mergeObjectSync(a,c)}static mergeObjectSync(a,b){let c={};for(let d of b){let{key:b,value:e}=d;if("aborted"===b.status||"aborted"===e.status)return O6;"dirty"===b.status&&a.dirty(),"dirty"===e.status&&a.dirty(),"__proto__"!==b.value&&(void 0!==e.value||d.alwaysSet)&&(c[b.value]=e.value)}return{status:a.value,value:c}}}let O6=Object.freeze({status:"aborted"}),O7=a=>({status:"dirty",value:a}),O8=a=>({status:"valid",value:a}),O9=a=>"aborted"===a.status,Pa=a=>"dirty"===a.status,Pb=a=>"valid"===a.status,Pc=a=>"undefined"!=typeof Promise&&a instanceof Promise;function Pd(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)}function Pe(a,b,c,d,e){if("m"===d)throw TypeError("Private method is not writable");if("a"===d&&!e)throw TypeError("Private accessor was defined without a setter");if("function"==typeof b?a!==b||!e:!b.has(a))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===d?e.call(a,c):e?e.value=c:b.set(a,c),c}"function"==typeof SuppressedError&&SuppressedError,function(a){a.errToObj=a=>"string"==typeof a?{message:a}:a||{},a.toString=a=>"string"==typeof a?a:null==a?void 0:a.message}(t||(t={}));class Pf{constructor(a,b,c,d){this._cachedPath=[],this.parent=a,this.data=b,this._path=c,this._key=d}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let Pg=(a,b)=>{if(Pb(b))return{success:!0,data:b.value};if(!a.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let b=new O_(a.common.issues);return this._error=b,this._error}}};function Ph(a){if(!a)return{};let{errorMap:b,invalid_type_error:c,required_error:d,description:e}=a;if(b&&(c||d))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return b?{errorMap:b,description:e}:{errorMap:(b,e)=>{var f,g;let{message:h}=a;return"invalid_enum_value"===b.code?{message:null!=h?h:e.defaultError}:void 0===e.data?{message:null!=(f=null!=h?h:d)?f:e.defaultError}:"invalid_type"!==b.code?{message:e.defaultError}:{message:null!=(g=null!=h?h:c)?g:e.defaultError}},description:e}}class Pi{get description(){return this._def.description}_getType(a){return OZ(a.data)}_getOrReturnCtx(a,b){return b||{common:a.parent.common,data:a.data,parsedType:OZ(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}_processInputParams(a){return{status:new O5,ctx:{common:a.parent.common,data:a.data,parsedType:OZ(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}}_parseSync(a){let b=this._parse(a);if(Pc(b))throw Error("Synchronous parse encountered promise.");return b}_parseAsync(a){return Promise.resolve(this._parse(a))}parse(a,b){let c=this.safeParse(a,b);if(c.success)return c.data;throw c.error}safeParse(a,b){var c;let d={common:{issues:[],async:null!=(c=null==b?void 0:b.async)&&c,contextualErrorMap:null==b?void 0:b.errorMap},path:(null==b?void 0:b.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:OZ(a)},e=this._parseSync({data:a,path:d.path,parent:d});return Pg(d,e)}"~validate"(a){var b,c;let d={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:OZ(a)};if(!this["~standard"].async)try{let b=this._parseSync({data:a,path:[],parent:d});return Pb(b)?{value:b.value}:{issues:d.common.issues}}catch(a){(null==(c=null==(b=null==a?void 0:a.message)?void 0:b.toLowerCase())?void 0:c.includes("encountered"))&&(this["~standard"].async=!0),d.common={issues:[],async:!0}}return this._parseAsync({data:a,path:[],parent:d}).then(a=>Pb(a)?{value:a.value}:{issues:d.common.issues})}async parseAsync(a,b){let c=await this.safeParseAsync(a,b);if(c.success)return c.data;throw c.error}async safeParseAsync(a,b){let c={common:{issues:[],contextualErrorMap:null==b?void 0:b.errorMap,async:!0},path:(null==b?void 0:b.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:OZ(a)},d=this._parse({data:a,path:c.path,parent:c});return Pg(c,await (Pc(d)?d:Promise.resolve(d)))}refine(a,b){let c=a=>"string"==typeof b||void 0===b?{message:b}:"function"==typeof b?b(a):b;return this._refinement((b,d)=>{let e=a(b),f=()=>d.addIssue({code:O$.custom,...c(b)});return"undefined"!=typeof Promise&&e instanceof Promise?e.then(a=>!!a||(f(),!1)):!!e||(f(),!1)})}refinement(a,b){return this._refinement((c,d)=>!!a(c)||(d.addIssue("function"==typeof b?b(c,d):b),!1))}_refinement(a){return new Qa({schema:this,typeName:w.ZodEffects,effect:{type:"refinement",refinement:a}})}superRefine(a){return this._refinement(a)}constructor(a){this.spa=this.safeParseAsync,this._def=a,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return Qb.create(this,this._def)}nullable(){return Qc.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return PT.create(this)}promise(){return P9.create(this,this._def)}or(a){return PW.create([this,a],this._def)}and(a){return P$.create(this,a,this._def)}transform(a){return new Qa({...Ph(this._def),schema:this,typeName:w.ZodEffects,effect:{type:"transform",transform:a}})}default(a){let b="function"==typeof a?a:()=>a;return new Qd({...Ph(this._def),innerType:this,defaultValue:b,typeName:w.ZodDefault})}brand(){return new Qg({typeName:w.ZodBranded,type:this,...Ph(this._def)})}catch(a){let b="function"==typeof a?a:()=>a;return new Qe({...Ph(this._def),innerType:this,catchValue:b,typeName:w.ZodCatch})}describe(a){return new this.constructor({...this._def,description:a})}pipe(a){return Qh.create(this,a)}readonly(){return Qi.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let Pj=/^c[^\s-]{8,}$/i,Pk=/^[0-9a-z]+$/,Pl=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Pm=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Pn=/^[a-z0-9_-]{21}$/i,Po=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Pp=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Pq=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Pr="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Ps=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Pt=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Pu=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Pv=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Pw=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Px=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Py="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Pz=RegExp(`^${Py}$`);function PA(a){let b="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return a.precision?b=`${b}\\.\\d{${a.precision}}`:null==a.precision&&(b=`${b}(\\.\\d+)?`),b}function PB(a){return RegExp(`^${PA(a)}$`)}function PC(a){let b=`${Py}T${PA(a)}`,c=[];return c.push(a.local?"Z?":"Z"),a.offset&&c.push("([+-]\\d{2}:?\\d{2})"),b=`${b}(${c.join("|")})`,RegExp(`^${b}$`)}function PD(a,b){return!!(("v4"===b||!b)&&Ps.test(a)||("v6"===b||!b)&&Pu.test(a))}function PE(a,b){if(!Po.test(a))return!1;try{let[c]=a.split("."),d=c.replace(/-/g,"+").replace(/_/g,"/").padEnd(c.length+(4-c.length%4)%4,"="),e=JSON.parse(atob(d));if("object"!=typeof e||null===e||!e.typ||!e.alg||b&&e.alg!==b)return!1;return!0}catch(a){return!1}}function PF(a,b){return!!(("v4"===b||!b)&&Pt.test(a)||("v6"===b||!b)&&Pv.test(a))}class PG extends Pi{_parse(a){let b;if(this._def.coerce&&(a.data=String(a.data)),this._getType(a)!==OY.string){let b=this._getOrReturnCtx(a);return O4(b,{code:O$.invalid_type,expected:OY.string,received:b.parsedType}),O6}let c=new O5;for(let d of this._def.checks)if("min"===d.kind)a.data.length<d.value&&(O4(b=this._getOrReturnCtx(a,b),{code:O$.too_small,minimum:d.value,type:"string",inclusive:!0,exact:!1,message:d.message}),c.dirty());else if("max"===d.kind)a.data.length>d.value&&(O4(b=this._getOrReturnCtx(a,b),{code:O$.too_big,maximum:d.value,type:"string",inclusive:!0,exact:!1,message:d.message}),c.dirty());else if("length"===d.kind){let e=a.data.length>d.value,f=a.data.length<d.value;(e||f)&&(b=this._getOrReturnCtx(a,b),e?O4(b,{code:O$.too_big,maximum:d.value,type:"string",inclusive:!0,exact:!0,message:d.message}):f&&O4(b,{code:O$.too_small,minimum:d.value,type:"string",inclusive:!0,exact:!0,message:d.message}),c.dirty())}else if("email"===d.kind)Pq.test(a.data)||(O4(b=this._getOrReturnCtx(a,b),{validation:"email",code:O$.invalid_string,message:d.message}),c.dirty());else if("emoji"===d.kind)l||(l=RegExp(Pr,"u")),l.test(a.data)||(O4(b=this._getOrReturnCtx(a,b),{validation:"emoji",code:O$.invalid_string,message:d.message}),c.dirty());else if("uuid"===d.kind)Pm.test(a.data)||(O4(b=this._getOrReturnCtx(a,b),{validation:"uuid",code:O$.invalid_string,message:d.message}),c.dirty());else if("nanoid"===d.kind)Pn.test(a.data)||(O4(b=this._getOrReturnCtx(a,b),{validation:"nanoid",code:O$.invalid_string,message:d.message}),c.dirty());else if("cuid"===d.kind)Pj.test(a.data)||(O4(b=this._getOrReturnCtx(a,b),{validation:"cuid",code:O$.invalid_string,message:d.message}),c.dirty());else if("cuid2"===d.kind)Pk.test(a.data)||(O4(b=this._getOrReturnCtx(a,b),{validation:"cuid2",code:O$.invalid_string,message:d.message}),c.dirty());else if("ulid"===d.kind)Pl.test(a.data)||(O4(b=this._getOrReturnCtx(a,b),{validation:"ulid",code:O$.invalid_string,message:d.message}),c.dirty());else if("url"===d.kind)try{new URL(a.data)}catch(e){O4(b=this._getOrReturnCtx(a,b),{validation:"url",code:O$.invalid_string,message:d.message}),c.dirty()}else"regex"===d.kind?(d.regex.lastIndex=0,d.regex.test(a.data)||(O4(b=this._getOrReturnCtx(a,b),{validation:"regex",code:O$.invalid_string,message:d.message}),c.dirty())):"trim"===d.kind?a.data=a.data.trim():"includes"===d.kind?a.data.includes(d.value,d.position)||(O4(b=this._getOrReturnCtx(a,b),{code:O$.invalid_string,validation:{includes:d.value,position:d.position},message:d.message}),c.dirty()):"toLowerCase"===d.kind?a.data=a.data.toLowerCase():"toUpperCase"===d.kind?a.data=a.data.toUpperCase():"startsWith"===d.kind?a.data.startsWith(d.value)||(O4(b=this._getOrReturnCtx(a,b),{code:O$.invalid_string,validation:{startsWith:d.value},message:d.message}),c.dirty()):"endsWith"===d.kind?a.data.endsWith(d.value)||(O4(b=this._getOrReturnCtx(a,b),{code:O$.invalid_string,validation:{endsWith:d.value},message:d.message}),c.dirty()):"datetime"===d.kind?PC(d).test(a.data)||(O4(b=this._getOrReturnCtx(a,b),{code:O$.invalid_string,validation:"datetime",message:d.message}),c.dirty()):"date"===d.kind?Pz.test(a.data)||(O4(b=this._getOrReturnCtx(a,b),{code:O$.invalid_string,validation:"date",message:d.message}),c.dirty()):"time"===d.kind?PB(d).test(a.data)||(O4(b=this._getOrReturnCtx(a,b),{code:O$.invalid_string,validation:"time",message:d.message}),c.dirty()):"duration"===d.kind?Pp.test(a.data)||(O4(b=this._getOrReturnCtx(a,b),{validation:"duration",code:O$.invalid_string,message:d.message}),c.dirty()):"ip"===d.kind?PD(a.data,d.version)||(O4(b=this._getOrReturnCtx(a,b),{validation:"ip",code:O$.invalid_string,message:d.message}),c.dirty()):"jwt"===d.kind?PE(a.data,d.alg)||(O4(b=this._getOrReturnCtx(a,b),{validation:"jwt",code:O$.invalid_string,message:d.message}),c.dirty()):"cidr"===d.kind?PF(a.data,d.version)||(O4(b=this._getOrReturnCtx(a,b),{validation:"cidr",code:O$.invalid_string,message:d.message}),c.dirty()):"base64"===d.kind?Pw.test(a.data)||(O4(b=this._getOrReturnCtx(a,b),{validation:"base64",code:O$.invalid_string,message:d.message}),c.dirty()):"base64url"===d.kind?Px.test(a.data)||(O4(b=this._getOrReturnCtx(a,b),{validation:"base64url",code:O$.invalid_string,message:d.message}),c.dirty()):r.assertNever(d);return{status:c.value,value:a.data}}_regex(a,b,c){return this.refinement(b=>a.test(b),{validation:b,code:O$.invalid_string,...t.errToObj(c)})}_addCheck(a){return new PG({...this._def,checks:[...this._def.checks,a]})}email(a){return this._addCheck({kind:"email",...t.errToObj(a)})}url(a){return this._addCheck({kind:"url",...t.errToObj(a)})}emoji(a){return this._addCheck({kind:"emoji",...t.errToObj(a)})}uuid(a){return this._addCheck({kind:"uuid",...t.errToObj(a)})}nanoid(a){return this._addCheck({kind:"nanoid",...t.errToObj(a)})}cuid(a){return this._addCheck({kind:"cuid",...t.errToObj(a)})}cuid2(a){return this._addCheck({kind:"cuid2",...t.errToObj(a)})}ulid(a){return this._addCheck({kind:"ulid",...t.errToObj(a)})}base64(a){return this._addCheck({kind:"base64",...t.errToObj(a)})}base64url(a){return this._addCheck({kind:"base64url",...t.errToObj(a)})}jwt(a){return this._addCheck({kind:"jwt",...t.errToObj(a)})}ip(a){return this._addCheck({kind:"ip",...t.errToObj(a)})}cidr(a){return this._addCheck({kind:"cidr",...t.errToObj(a)})}datetime(a){var b,c;return"string"==typeof a?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:a}):this._addCheck({kind:"datetime",precision:void 0===(null==a?void 0:a.precision)?null:null==a?void 0:a.precision,offset:null!=(b=null==a?void 0:a.offset)&&b,local:null!=(c=null==a?void 0:a.local)&&c,...t.errToObj(null==a?void 0:a.message)})}date(a){return this._addCheck({kind:"date",message:a})}time(a){return"string"==typeof a?this._addCheck({kind:"time",precision:null,message:a}):this._addCheck({kind:"time",precision:void 0===(null==a?void 0:a.precision)?null:null==a?void 0:a.precision,...t.errToObj(null==a?void 0:a.message)})}duration(a){return this._addCheck({kind:"duration",...t.errToObj(a)})}regex(a,b){return this._addCheck({kind:"regex",regex:a,...t.errToObj(b)})}includes(a,b){return this._addCheck({kind:"includes",value:a,position:null==b?void 0:b.position,...t.errToObj(null==b?void 0:b.message)})}startsWith(a,b){return this._addCheck({kind:"startsWith",value:a,...t.errToObj(b)})}endsWith(a,b){return this._addCheck({kind:"endsWith",value:a,...t.errToObj(b)})}min(a,b){return this._addCheck({kind:"min",value:a,...t.errToObj(b)})}max(a,b){return this._addCheck({kind:"max",value:a,...t.errToObj(b)})}length(a,b){return this._addCheck({kind:"length",value:a,...t.errToObj(b)})}nonempty(a){return this.min(1,t.errToObj(a))}trim(){return new PG({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new PG({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new PG({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(a=>"datetime"===a.kind)}get isDate(){return!!this._def.checks.find(a=>"date"===a.kind)}get isTime(){return!!this._def.checks.find(a=>"time"===a.kind)}get isDuration(){return!!this._def.checks.find(a=>"duration"===a.kind)}get isEmail(){return!!this._def.checks.find(a=>"email"===a.kind)}get isURL(){return!!this._def.checks.find(a=>"url"===a.kind)}get isEmoji(){return!!this._def.checks.find(a=>"emoji"===a.kind)}get isUUID(){return!!this._def.checks.find(a=>"uuid"===a.kind)}get isNANOID(){return!!this._def.checks.find(a=>"nanoid"===a.kind)}get isCUID(){return!!this._def.checks.find(a=>"cuid"===a.kind)}get isCUID2(){return!!this._def.checks.find(a=>"cuid2"===a.kind)}get isULID(){return!!this._def.checks.find(a=>"ulid"===a.kind)}get isIP(){return!!this._def.checks.find(a=>"ip"===a.kind)}get isCIDR(){return!!this._def.checks.find(a=>"cidr"===a.kind)}get isBase64(){return!!this._def.checks.find(a=>"base64"===a.kind)}get isBase64url(){return!!this._def.checks.find(a=>"base64url"===a.kind)}get minLength(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxLength(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}}function PH(a,b){let c=(a.toString().split(".")[1]||"").length,d=(b.toString().split(".")[1]||"").length,e=c>d?c:d;return parseInt(a.toFixed(e).replace(".",""))%parseInt(b.toFixed(e).replace(".",""))/Math.pow(10,e)}PG.create=a=>{var b;return new PG({checks:[],typeName:w.ZodString,coerce:null!=(b=null==a?void 0:a.coerce)&&b,...Ph(a)})};class PI extends Pi{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(a){let b;if(this._def.coerce&&(a.data=Number(a.data)),this._getType(a)!==OY.number){let b=this._getOrReturnCtx(a);return O4(b,{code:O$.invalid_type,expected:OY.number,received:b.parsedType}),O6}let c=new O5;for(let d of this._def.checks)"int"===d.kind?r.isInteger(a.data)||(O4(b=this._getOrReturnCtx(a,b),{code:O$.invalid_type,expected:"integer",received:"float",message:d.message}),c.dirty()):"min"===d.kind?(d.inclusive?a.data<d.value:a.data<=d.value)&&(O4(b=this._getOrReturnCtx(a,b),{code:O$.too_small,minimum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):"max"===d.kind?(d.inclusive?a.data>d.value:a.data>=d.value)&&(O4(b=this._getOrReturnCtx(a,b),{code:O$.too_big,maximum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):"multipleOf"===d.kind?0!==PH(a.data,d.value)&&(O4(b=this._getOrReturnCtx(a,b),{code:O$.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):"finite"===d.kind?Number.isFinite(a.data)||(O4(b=this._getOrReturnCtx(a,b),{code:O$.not_finite,message:d.message}),c.dirty()):r.assertNever(d);return{status:c.value,value:a.data}}gte(a,b){return this.setLimit("min",a,!0,t.toString(b))}gt(a,b){return this.setLimit("min",a,!1,t.toString(b))}lte(a,b){return this.setLimit("max",a,!0,t.toString(b))}lt(a,b){return this.setLimit("max",a,!1,t.toString(b))}setLimit(a,b,c,d){return new PI({...this._def,checks:[...this._def.checks,{kind:a,value:b,inclusive:c,message:t.toString(d)}]})}_addCheck(a){return new PI({...this._def,checks:[...this._def.checks,a]})}int(a){return this._addCheck({kind:"int",message:t.toString(a)})}positive(a){return this._addCheck({kind:"min",value:0,inclusive:!1,message:t.toString(a)})}negative(a){return this._addCheck({kind:"max",value:0,inclusive:!1,message:t.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:0,inclusive:!0,message:t.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:0,inclusive:!0,message:t.toString(a)})}multipleOf(a,b){return this._addCheck({kind:"multipleOf",value:a,message:t.toString(b)})}finite(a){return this._addCheck({kind:"finite",message:t.toString(a)})}safe(a){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:t.toString(a)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:t.toString(a)})}get minValue(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxValue(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}get isInt(){return!!this._def.checks.find(a=>"int"===a.kind||"multipleOf"===a.kind&&r.isInteger(a.value))}get isFinite(){let a=null,b=null;for(let c of this._def.checks)if("finite"===c.kind||"int"===c.kind||"multipleOf"===c.kind)return!0;else"min"===c.kind?(null===b||c.value>b)&&(b=c.value):"max"===c.kind&&(null===a||c.value<a)&&(a=c.value);return Number.isFinite(b)&&Number.isFinite(a)}}PI.create=a=>new PI({checks:[],typeName:w.ZodNumber,coerce:(null==a?void 0:a.coerce)||!1,...Ph(a)});class PJ extends Pi{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(a){let b;if(this._def.coerce)try{a.data=BigInt(a.data)}catch(b){return this._getInvalidInput(a)}if(this._getType(a)!==OY.bigint)return this._getInvalidInput(a);let c=new O5;for(let d of this._def.checks)"min"===d.kind?(d.inclusive?a.data<d.value:a.data<=d.value)&&(O4(b=this._getOrReturnCtx(a,b),{code:O$.too_small,type:"bigint",minimum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):"max"===d.kind?(d.inclusive?a.data>d.value:a.data>=d.value)&&(O4(b=this._getOrReturnCtx(a,b),{code:O$.too_big,type:"bigint",maximum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):"multipleOf"===d.kind?a.data%d.value!==BigInt(0)&&(O4(b=this._getOrReturnCtx(a,b),{code:O$.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):r.assertNever(d);return{status:c.value,value:a.data}}_getInvalidInput(a){let b=this._getOrReturnCtx(a);return O4(b,{code:O$.invalid_type,expected:OY.bigint,received:b.parsedType}),O6}gte(a,b){return this.setLimit("min",a,!0,t.toString(b))}gt(a,b){return this.setLimit("min",a,!1,t.toString(b))}lte(a,b){return this.setLimit("max",a,!0,t.toString(b))}lt(a,b){return this.setLimit("max",a,!1,t.toString(b))}setLimit(a,b,c,d){return new PJ({...this._def,checks:[...this._def.checks,{kind:a,value:b,inclusive:c,message:t.toString(d)}]})}_addCheck(a){return new PJ({...this._def,checks:[...this._def.checks,a]})}positive(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:t.toString(a)})}negative(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:t.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:t.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:t.toString(a)})}multipleOf(a,b){return this._addCheck({kind:"multipleOf",value:a,message:t.toString(b)})}get minValue(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxValue(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}}PJ.create=a=>{var b;return new PJ({checks:[],typeName:w.ZodBigInt,coerce:null!=(b=null==a?void 0:a.coerce)&&b,...Ph(a)})};class PK extends Pi{_parse(a){if(this._def.coerce&&(a.data=!!a.data),this._getType(a)!==OY.boolean){let b=this._getOrReturnCtx(a);return O4(b,{code:O$.invalid_type,expected:OY.boolean,received:b.parsedType}),O6}return O8(a.data)}}PK.create=a=>new PK({typeName:w.ZodBoolean,coerce:(null==a?void 0:a.coerce)||!1,...Ph(a)});class PL extends Pi{_parse(a){let b;if(this._def.coerce&&(a.data=new Date(a.data)),this._getType(a)!==OY.date){let b=this._getOrReturnCtx(a);return O4(b,{code:O$.invalid_type,expected:OY.date,received:b.parsedType}),O6}if(isNaN(a.data.getTime()))return O4(this._getOrReturnCtx(a),{code:O$.invalid_date}),O6;let c=new O5;for(let d of this._def.checks)"min"===d.kind?a.data.getTime()<d.value&&(O4(b=this._getOrReturnCtx(a,b),{code:O$.too_small,message:d.message,inclusive:!0,exact:!1,minimum:d.value,type:"date"}),c.dirty()):"max"===d.kind?a.data.getTime()>d.value&&(O4(b=this._getOrReturnCtx(a,b),{code:O$.too_big,message:d.message,inclusive:!0,exact:!1,maximum:d.value,type:"date"}),c.dirty()):r.assertNever(d);return{status:c.value,value:new Date(a.data.getTime())}}_addCheck(a){return new PL({...this._def,checks:[...this._def.checks,a]})}min(a,b){return this._addCheck({kind:"min",value:a.getTime(),message:t.toString(b)})}max(a,b){return this._addCheck({kind:"max",value:a.getTime(),message:t.toString(b)})}get minDate(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return null!=a?new Date(a):null}get maxDate(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return null!=a?new Date(a):null}}PL.create=a=>new PL({checks:[],coerce:(null==a?void 0:a.coerce)||!1,typeName:w.ZodDate,...Ph(a)});class PM extends Pi{_parse(a){if(this._getType(a)!==OY.symbol){let b=this._getOrReturnCtx(a);return O4(b,{code:O$.invalid_type,expected:OY.symbol,received:b.parsedType}),O6}return O8(a.data)}}PM.create=a=>new PM({typeName:w.ZodSymbol,...Ph(a)});class PN extends Pi{_parse(a){if(this._getType(a)!==OY.undefined){let b=this._getOrReturnCtx(a);return O4(b,{code:O$.invalid_type,expected:OY.undefined,received:b.parsedType}),O6}return O8(a.data)}}PN.create=a=>new PN({typeName:w.ZodUndefined,...Ph(a)});class PO extends Pi{_parse(a){if(this._getType(a)!==OY.null){let b=this._getOrReturnCtx(a);return O4(b,{code:O$.invalid_type,expected:OY.null,received:b.parsedType}),O6}return O8(a.data)}}PO.create=a=>new PO({typeName:w.ZodNull,...Ph(a)});class PP extends Pi{constructor(){super(...arguments),this._any=!0}_parse(a){return O8(a.data)}}PP.create=a=>new PP({typeName:w.ZodAny,...Ph(a)});class PQ extends Pi{constructor(){super(...arguments),this._unknown=!0}_parse(a){return O8(a.data)}}PQ.create=a=>new PQ({typeName:w.ZodUnknown,...Ph(a)});class PR extends Pi{_parse(a){let b=this._getOrReturnCtx(a);return O4(b,{code:O$.invalid_type,expected:OY.never,received:b.parsedType}),O6}}PR.create=a=>new PR({typeName:w.ZodNever,...Ph(a)});class PS extends Pi{_parse(a){if(this._getType(a)!==OY.undefined){let b=this._getOrReturnCtx(a);return O4(b,{code:O$.invalid_type,expected:OY.void,received:b.parsedType}),O6}return O8(a.data)}}PS.create=a=>new PS({typeName:w.ZodVoid,...Ph(a)});class PT extends Pi{_parse(a){let{ctx:b,status:c}=this._processInputParams(a),d=this._def;if(b.parsedType!==OY.array)return O4(b,{code:O$.invalid_type,expected:OY.array,received:b.parsedType}),O6;if(null!==d.exactLength){let a=b.data.length>d.exactLength.value,e=b.data.length<d.exactLength.value;(a||e)&&(O4(b,{code:a?O$.too_big:O$.too_small,minimum:e?d.exactLength.value:void 0,maximum:a?d.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:d.exactLength.message}),c.dirty())}if(null!==d.minLength&&b.data.length<d.minLength.value&&(O4(b,{code:O$.too_small,minimum:d.minLength.value,type:"array",inclusive:!0,exact:!1,message:d.minLength.message}),c.dirty()),null!==d.maxLength&&b.data.length>d.maxLength.value&&(O4(b,{code:O$.too_big,maximum:d.maxLength.value,type:"array",inclusive:!0,exact:!1,message:d.maxLength.message}),c.dirty()),b.common.async)return Promise.all([...b.data].map((a,c)=>d.type._parseAsync(new Pf(b,a,b.path,c)))).then(a=>O5.mergeArray(c,a));let e=[...b.data].map((a,c)=>d.type._parseSync(new Pf(b,a,b.path,c)));return O5.mergeArray(c,e)}get element(){return this._def.type}min(a,b){return new PT({...this._def,minLength:{value:a,message:t.toString(b)}})}max(a,b){return new PT({...this._def,maxLength:{value:a,message:t.toString(b)}})}length(a,b){return new PT({...this._def,exactLength:{value:a,message:t.toString(b)}})}nonempty(a){return this.min(1,a)}}function PU(a){if(a instanceof PV){let b={};for(let c in a.shape){let d=a.shape[c];b[c]=Qb.create(PU(d))}return new PV({...a._def,shape:()=>b})}if(a instanceof PT)return new PT({...a._def,type:PU(a.element)});if(a instanceof Qb)return Qb.create(PU(a.unwrap()));if(a instanceof Qc)return Qc.create(PU(a.unwrap()));if(a instanceof P_)return P_.create(a.items.map(a=>PU(a)));else return a}PT.create=(a,b)=>new PT({type:a,minLength:null,maxLength:null,exactLength:null,typeName:w.ZodArray,...Ph(b)});class PV extends Pi{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let a=this._def.shape(),b=r.objectKeys(a);return this._cached={shape:a,keys:b}}_parse(a){if(this._getType(a)!==OY.object){let b=this._getOrReturnCtx(a);return O4(b,{code:O$.invalid_type,expected:OY.object,received:b.parsedType}),O6}let{status:b,ctx:c}=this._processInputParams(a),{shape:d,keys:e}=this._getCached(),f=[];if(!(this._def.catchall instanceof PR&&"strip"===this._def.unknownKeys))for(let a in c.data)e.includes(a)||f.push(a);let g=[];for(let a of e){let b=d[a],e=c.data[a];g.push({key:{status:"valid",value:a},value:b._parse(new Pf(c,e,c.path,a)),alwaysSet:a in c.data})}if(this._def.catchall instanceof PR){let a=this._def.unknownKeys;if("passthrough"===a)for(let a of f)g.push({key:{status:"valid",value:a},value:{status:"valid",value:c.data[a]}});else if("strict"===a)f.length>0&&(O4(c,{code:O$.unrecognized_keys,keys:f}),b.dirty());else if("strip"===a);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let a=this._def.catchall;for(let b of f){let d=c.data[b];g.push({key:{status:"valid",value:b},value:a._parse(new Pf(c,d,c.path,b)),alwaysSet:b in c.data})}}return c.common.async?Promise.resolve().then(async()=>{let a=[];for(let b of g){let c=await b.key,d=await b.value;a.push({key:c,value:d,alwaysSet:b.alwaysSet})}return a}).then(a=>O5.mergeObjectSync(b,a)):O5.mergeObjectSync(b,g)}get shape(){return this._def.shape()}strict(a){return t.errToObj,new PV({...this._def,unknownKeys:"strict",...void 0!==a?{errorMap:(b,c)=>{var d,e,f,g;let h=null!=(f=null==(e=(d=this._def).errorMap)?void 0:e.call(d,b,c).message)?f:c.defaultError;return"unrecognized_keys"===b.code?{message:null!=(g=t.errToObj(a).message)?g:h}:{message:h}}}:{}})}strip(){return new PV({...this._def,unknownKeys:"strip"})}passthrough(){return new PV({...this._def,unknownKeys:"passthrough"})}extend(a){return new PV({...this._def,shape:()=>({...this._def.shape(),...a})})}merge(a){return new PV({unknownKeys:a._def.unknownKeys,catchall:a._def.catchall,shape:()=>({...this._def.shape(),...a._def.shape()}),typeName:w.ZodObject})}setKey(a,b){return this.augment({[a]:b})}catchall(a){return new PV({...this._def,catchall:a})}pick(a){let b={};return r.objectKeys(a).forEach(c=>{a[c]&&this.shape[c]&&(b[c]=this.shape[c])}),new PV({...this._def,shape:()=>b})}omit(a){let b={};return r.objectKeys(this.shape).forEach(c=>{a[c]||(b[c]=this.shape[c])}),new PV({...this._def,shape:()=>b})}deepPartial(){return PU(this)}partial(a){let b={};return r.objectKeys(this.shape).forEach(c=>{let d=this.shape[c];a&&!a[c]?b[c]=d:b[c]=d.optional()}),new PV({...this._def,shape:()=>b})}required(a){let b={};return r.objectKeys(this.shape).forEach(c=>{if(a&&!a[c])b[c]=this.shape[c];else{let a=this.shape[c];for(;a instanceof Qb;)a=a._def.innerType;b[c]=a}}),new PV({...this._def,shape:()=>b})}keyof(){return P6(r.objectKeys(this.shape))}}PV.create=(a,b)=>new PV({shape:()=>a,unknownKeys:"strip",catchall:PR.create(),typeName:w.ZodObject,...Ph(b)}),PV.strictCreate=(a,b)=>new PV({shape:()=>a,unknownKeys:"strict",catchall:PR.create(),typeName:w.ZodObject,...Ph(b)}),PV.lazycreate=(a,b)=>new PV({shape:a,unknownKeys:"strip",catchall:PR.create(),typeName:w.ZodObject,...Ph(b)});class PW extends Pi{_parse(a){let{ctx:b}=this._processInputParams(a),c=this._def.options;function d(a){for(let b of a)if("valid"===b.result.status)return b.result;for(let c of a)if("dirty"===c.result.status)return b.common.issues.push(...c.ctx.common.issues),c.result;let c=a.map(a=>new O_(a.ctx.common.issues));return O4(b,{code:O$.invalid_union,unionErrors:c}),O6}if(b.common.async)return Promise.all(c.map(async a=>{let c={...b,common:{...b.common,issues:[]},parent:null};return{result:await a._parseAsync({data:b.data,path:b.path,parent:c}),ctx:c}})).then(d);{let a,d=[];for(let e of c){let c={...b,common:{...b.common,issues:[]},parent:null},f=e._parseSync({data:b.data,path:b.path,parent:c});if("valid"===f.status)return f;"dirty"!==f.status||a||(a={result:f,ctx:c}),c.common.issues.length&&d.push(c.common.issues)}if(a)return b.common.issues.push(...a.ctx.common.issues),a.result;let e=d.map(a=>new O_(a));return O4(b,{code:O$.invalid_union,unionErrors:e}),O6}}get options(){return this._def.options}}PW.create=(a,b)=>new PW({options:a,typeName:w.ZodUnion,...Ph(b)});let PX=a=>{if(a instanceof P4)return PX(a.schema);if(a instanceof Qa)return PX(a.innerType());if(a instanceof P5)return[a.value];if(a instanceof P7)return a.options;if(a instanceof P8)return r.objectValues(a.enum);else if(a instanceof Qd)return PX(a._def.innerType);else if(a instanceof PN)return[void 0];else if(a instanceof PO)return[null];else if(a instanceof Qb)return[void 0,...PX(a.unwrap())];else if(a instanceof Qc)return[null,...PX(a.unwrap())];else if(a instanceof Qg)return PX(a.unwrap());else if(a instanceof Qi)return PX(a.unwrap());else if(a instanceof Qe)return PX(a._def.innerType);else return[]};class PY extends Pi{_parse(a){let{ctx:b}=this._processInputParams(a);if(b.parsedType!==OY.object)return O4(b,{code:O$.invalid_type,expected:OY.object,received:b.parsedType}),O6;let c=this.discriminator,d=b.data[c],e=this.optionsMap.get(d);return e?b.common.async?e._parseAsync({data:b.data,path:b.path,parent:b}):e._parseSync({data:b.data,path:b.path,parent:b}):(O4(b,{code:O$.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[c]}),O6)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(a,b,c){let d=new Map;for(let c of b){let b=PX(c.shape[a]);if(!b.length)throw Error(`A discriminator value for key \`${a}\` could not be extracted from all schema options`);for(let e of b){if(d.has(e))throw Error(`Discriminator property ${String(a)} has duplicate value ${String(e)}`);d.set(e,c)}}return new PY({typeName:w.ZodDiscriminatedUnion,discriminator:a,options:b,optionsMap:d,...Ph(c)})}}function PZ(a,b){let c=OZ(a),d=OZ(b);if(a===b)return{valid:!0,data:a};if(c===OY.object&&d===OY.object){let c=r.objectKeys(b),d=r.objectKeys(a).filter(a=>-1!==c.indexOf(a)),e={...a,...b};for(let c of d){let d=PZ(a[c],b[c]);if(!d.valid)return{valid:!1};e[c]=d.data}return{valid:!0,data:e}}if(c===OY.array&&d===OY.array){if(a.length!==b.length)return{valid:!1};let c=[];for(let d=0;d<a.length;d++){let e=PZ(a[d],b[d]);if(!e.valid)return{valid:!1};c.push(e.data)}return{valid:!0,data:c}}if(c===OY.date&&d===OY.date&&+a==+b)return{valid:!0,data:a};return{valid:!1}}class P$ extends Pi{_parse(a){let{status:b,ctx:c}=this._processInputParams(a),d=(a,d)=>{if(O9(a)||O9(d))return O6;let e=PZ(a.value,d.value);return e.valid?((Pa(a)||Pa(d))&&b.dirty(),{status:b.value,value:e.data}):(O4(c,{code:O$.invalid_intersection_types}),O6)};return c.common.async?Promise.all([this._def.left._parseAsync({data:c.data,path:c.path,parent:c}),this._def.right._parseAsync({data:c.data,path:c.path,parent:c})]).then(([a,b])=>d(a,b)):d(this._def.left._parseSync({data:c.data,path:c.path,parent:c}),this._def.right._parseSync({data:c.data,path:c.path,parent:c}))}}P$.create=(a,b,c)=>new P$({left:a,right:b,typeName:w.ZodIntersection,...Ph(c)});class P_ extends Pi{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==OY.array)return O4(c,{code:O$.invalid_type,expected:OY.array,received:c.parsedType}),O6;if(c.data.length<this._def.items.length)return O4(c,{code:O$.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),O6;!this._def.rest&&c.data.length>this._def.items.length&&(O4(c,{code:O$.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),b.dirty());let d=[...c.data].map((a,b)=>{let d=this._def.items[b]||this._def.rest;return d?d._parse(new Pf(c,a,c.path,b)):null}).filter(a=>!!a);return c.common.async?Promise.all(d).then(a=>O5.mergeArray(b,a)):O5.mergeArray(b,d)}get items(){return this._def.items}rest(a){return new P_({...this._def,rest:a})}}P_.create=(a,b)=>{if(!Array.isArray(a))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new P_({items:a,typeName:w.ZodTuple,rest:null,...Ph(b)})};class P0 extends Pi{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==OY.object)return O4(c,{code:O$.invalid_type,expected:OY.object,received:c.parsedType}),O6;let d=[],e=this._def.keyType,f=this._def.valueType;for(let a in c.data)d.push({key:e._parse(new Pf(c,a,c.path,a)),value:f._parse(new Pf(c,c.data[a],c.path,a)),alwaysSet:a in c.data});return c.common.async?O5.mergeObjectAsync(b,d):O5.mergeObjectSync(b,d)}get element(){return this._def.valueType}static create(a,b,c){return new P0(b instanceof Pi?{keyType:a,valueType:b,typeName:w.ZodRecord,...Ph(c)}:{keyType:PG.create(),valueType:a,typeName:w.ZodRecord,...Ph(b)})}}class P1 extends Pi{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==OY.map)return O4(c,{code:O$.invalid_type,expected:OY.map,received:c.parsedType}),O6;let d=this._def.keyType,e=this._def.valueType,f=[...c.data.entries()].map(([a,b],f)=>({key:d._parse(new Pf(c,a,c.path,[f,"key"])),value:e._parse(new Pf(c,b,c.path,[f,"value"]))}));if(c.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of f){let d=await c.key,e=await c.value;if("aborted"===d.status||"aborted"===e.status)return O6;("dirty"===d.status||"dirty"===e.status)&&b.dirty(),a.set(d.value,e.value)}return{status:b.value,value:a}})}{let a=new Map;for(let c of f){let d=c.key,e=c.value;if("aborted"===d.status||"aborted"===e.status)return O6;("dirty"===d.status||"dirty"===e.status)&&b.dirty(),a.set(d.value,e.value)}return{status:b.value,value:a}}}}P1.create=(a,b,c)=>new P1({valueType:b,keyType:a,typeName:w.ZodMap,...Ph(c)});class P2 extends Pi{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==OY.set)return O4(c,{code:O$.invalid_type,expected:OY.set,received:c.parsedType}),O6;let d=this._def;null!==d.minSize&&c.data.size<d.minSize.value&&(O4(c,{code:O$.too_small,minimum:d.minSize.value,type:"set",inclusive:!0,exact:!1,message:d.minSize.message}),b.dirty()),null!==d.maxSize&&c.data.size>d.maxSize.value&&(O4(c,{code:O$.too_big,maximum:d.maxSize.value,type:"set",inclusive:!0,exact:!1,message:d.maxSize.message}),b.dirty());let e=this._def.valueType;function f(a){let c=new Set;for(let d of a){if("aborted"===d.status)return O6;"dirty"===d.status&&b.dirty(),c.add(d.value)}return{status:b.value,value:c}}let g=[...c.data.values()].map((a,b)=>e._parse(new Pf(c,a,c.path,b)));return c.common.async?Promise.all(g).then(a=>f(a)):f(g)}min(a,b){return new P2({...this._def,minSize:{value:a,message:t.toString(b)}})}max(a,b){return new P2({...this._def,maxSize:{value:a,message:t.toString(b)}})}size(a,b){return this.min(a,b).max(a,b)}nonempty(a){return this.min(1,a)}}P2.create=(a,b)=>new P2({valueType:a,minSize:null,maxSize:null,typeName:w.ZodSet,...Ph(b)});class P3 extends Pi{constructor(){super(...arguments),this.validate=this.implement}_parse(a){let{ctx:b}=this._processInputParams(a);if(b.parsedType!==OY.function)return O4(b,{code:O$.invalid_type,expected:OY.function,received:b.parsedType}),O6;function c(a,c){return O3({data:a,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,O2(),O0].filter(a=>!!a),issueData:{code:O$.invalid_arguments,argumentsError:c}})}function d(a,c){return O3({data:a,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,O2(),O0].filter(a=>!!a),issueData:{code:O$.invalid_return_type,returnTypeError:c}})}let e={errorMap:b.common.contextualErrorMap},f=b.data;if(this._def.returns instanceof P9){let a=this;return O8(async function(...b){let g=new O_([]),h=await a._def.args.parseAsync(b,e).catch(a=>{throw g.addIssue(c(b,a)),g}),i=await Reflect.apply(f,this,h);return await a._def.returns._def.type.parseAsync(i,e).catch(a=>{throw g.addIssue(d(i,a)),g})})}{let a=this;return O8(function(...b){let g=a._def.args.safeParse(b,e);if(!g.success)throw new O_([c(b,g.error)]);let h=Reflect.apply(f,this,g.data),i=a._def.returns.safeParse(h,e);if(!i.success)throw new O_([d(h,i.error)]);return i.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...a){return new P3({...this._def,args:P_.create(a).rest(PQ.create())})}returns(a){return new P3({...this._def,returns:a})}implement(a){return this.parse(a)}strictImplement(a){return this.parse(a)}static create(a,b,c){return new P3({args:a||P_.create([]).rest(PQ.create()),returns:b||PQ.create(),typeName:w.ZodFunction,...Ph(c)})}}class P4 extends Pi{get schema(){return this._def.getter()}_parse(a){let{ctx:b}=this._processInputParams(a);return this._def.getter()._parse({data:b.data,path:b.path,parent:b})}}P4.create=(a,b)=>new P4({getter:a,typeName:w.ZodLazy,...Ph(b)});class P5 extends Pi{_parse(a){if(a.data!==this._def.value){let b=this._getOrReturnCtx(a);return O4(b,{received:b.data,code:O$.invalid_literal,expected:this._def.value}),O6}return{status:"valid",value:a.data}}get value(){return this._def.value}}function P6(a,b){return new P7({values:a,typeName:w.ZodEnum,...Ph(b)})}P5.create=(a,b)=>new P5({value:a,typeName:w.ZodLiteral,...Ph(b)});class P7 extends Pi{constructor(){super(...arguments),u.set(this,void 0)}_parse(a){if("string"!=typeof a.data){let b=this._getOrReturnCtx(a),c=this._def.values;return O4(b,{expected:r.joinValues(c),received:b.parsedType,code:O$.invalid_type}),O6}if(Pd(this,u,"f")||Pe(this,u,new Set(this._def.values),"f"),!Pd(this,u,"f").has(a.data)){let b=this._getOrReturnCtx(a),c=this._def.values;return O4(b,{received:b.data,code:O$.invalid_enum_value,options:c}),O6}return O8(a.data)}get options(){return this._def.values}get enum(){let a={};for(let b of this._def.values)a[b]=b;return a}get Values(){let a={};for(let b of this._def.values)a[b]=b;return a}get Enum(){let a={};for(let b of this._def.values)a[b]=b;return a}extract(a,b=this._def){return P7.create(a,{...this._def,...b})}exclude(a,b=this._def){return P7.create(this.options.filter(b=>!a.includes(b)),{...this._def,...b})}}u=new WeakMap,P7.create=P6;class P8 extends Pi{constructor(){super(...arguments),v.set(this,void 0)}_parse(a){let b=r.getValidEnumValues(this._def.values),c=this._getOrReturnCtx(a);if(c.parsedType!==OY.string&&c.parsedType!==OY.number){let a=r.objectValues(b);return O4(c,{expected:r.joinValues(a),received:c.parsedType,code:O$.invalid_type}),O6}if(Pd(this,v,"f")||Pe(this,v,new Set(r.getValidEnumValues(this._def.values)),"f"),!Pd(this,v,"f").has(a.data)){let a=r.objectValues(b);return O4(c,{received:c.data,code:O$.invalid_enum_value,options:a}),O6}return O8(a.data)}get enum(){return this._def.values}}v=new WeakMap,P8.create=(a,b)=>new P8({values:a,typeName:w.ZodNativeEnum,...Ph(b)});class P9 extends Pi{unwrap(){return this._def.type}_parse(a){let{ctx:b}=this._processInputParams(a);return b.parsedType!==OY.promise&&!1===b.common.async?(O4(b,{code:O$.invalid_type,expected:OY.promise,received:b.parsedType}),O6):O8((b.parsedType===OY.promise?b.data:Promise.resolve(b.data)).then(a=>this._def.type.parseAsync(a,{path:b.path,errorMap:b.common.contextualErrorMap})))}}P9.create=(a,b)=>new P9({type:a,typeName:w.ZodPromise,...Ph(b)});class Qa extends Pi{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===w.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(a){let{status:b,ctx:c}=this._processInputParams(a),d=this._def.effect||null,e={addIssue:a=>{O4(c,a),a.fatal?b.abort():b.dirty()},get path(){return c.path}};if(e.addIssue=e.addIssue.bind(e),"preprocess"===d.type){let a=d.transform(c.data,e);if(c.common.async)return Promise.resolve(a).then(async a=>{if("aborted"===b.value)return O6;let d=await this._def.schema._parseAsync({data:a,path:c.path,parent:c});return"aborted"===d.status?O6:"dirty"===d.status||"dirty"===b.value?O7(d.value):d});{if("aborted"===b.value)return O6;let d=this._def.schema._parseSync({data:a,path:c.path,parent:c});return"aborted"===d.status?O6:"dirty"===d.status||"dirty"===b.value?O7(d.value):d}}if("refinement"===d.type){let a=a=>{let b=d.refinement(a,e);if(c.common.async)return Promise.resolve(b);if(b instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(!1!==c.common.async)return this._def.schema._parseAsync({data:c.data,path:c.path,parent:c}).then(c=>"aborted"===c.status?O6:("dirty"===c.status&&b.dirty(),a(c.value).then(()=>({status:b.value,value:c.value}))));{let d=this._def.schema._parseSync({data:c.data,path:c.path,parent:c});return"aborted"===d.status?O6:("dirty"===d.status&&b.dirty(),a(d.value),{status:b.value,value:d.value})}}if("transform"===d.type)if(!1!==c.common.async)return this._def.schema._parseAsync({data:c.data,path:c.path,parent:c}).then(a=>Pb(a)?Promise.resolve(d.transform(a.value,e)).then(a=>({status:b.value,value:a})):a);else{let a=this._def.schema._parseSync({data:c.data,path:c.path,parent:c});if(!Pb(a))return a;let f=d.transform(a.value,e);if(f instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:b.value,value:f}}r.assertNever(d)}}Qa.create=(a,b,c)=>new Qa({schema:a,typeName:w.ZodEffects,effect:b,...Ph(c)}),Qa.createWithPreprocess=(a,b,c)=>new Qa({schema:b,effect:{type:"preprocess",transform:a},typeName:w.ZodEffects,...Ph(c)});class Qb extends Pi{_parse(a){return this._getType(a)===OY.undefined?O8(void 0):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}Qb.create=(a,b)=>new Qb({innerType:a,typeName:w.ZodOptional,...Ph(b)});class Qc extends Pi{_parse(a){return this._getType(a)===OY.null?O8(null):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}Qc.create=(a,b)=>new Qc({innerType:a,typeName:w.ZodNullable,...Ph(b)});class Qd extends Pi{_parse(a){let{ctx:b}=this._processInputParams(a),c=b.data;return b.parsedType===OY.undefined&&(c=this._def.defaultValue()),this._def.innerType._parse({data:c,path:b.path,parent:b})}removeDefault(){return this._def.innerType}}Qd.create=(a,b)=>new Qd({innerType:a,typeName:w.ZodDefault,defaultValue:"function"==typeof b.default?b.default:()=>b.default,...Ph(b)});class Qe extends Pi{_parse(a){let{ctx:b}=this._processInputParams(a),c={...b,common:{...b.common,issues:[]}},d=this._def.innerType._parse({data:c.data,path:c.path,parent:{...c}});return Pc(d)?d.then(a=>({status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new O_(c.common.issues)},input:c.data})})):{status:"valid",value:"valid"===d.status?d.value:this._def.catchValue({get error(){return new O_(c.common.issues)},input:c.data})}}removeCatch(){return this._def.innerType}}Qe.create=(a,b)=>new Qe({innerType:a,typeName:w.ZodCatch,catchValue:"function"==typeof b.catch?b.catch:()=>b.catch,...Ph(b)});class Qf extends Pi{_parse(a){if(this._getType(a)!==OY.nan){let b=this._getOrReturnCtx(a);return O4(b,{code:O$.invalid_type,expected:OY.nan,received:b.parsedType}),O6}return{status:"valid",value:a.data}}}Qf.create=a=>new Qf({typeName:w.ZodNaN,...Ph(a)}),Symbol("zod_brand");class Qg extends Pi{_parse(a){let{ctx:b}=this._processInputParams(a),c=b.data;return this._def.type._parse({data:c,path:b.path,parent:b})}unwrap(){return this._def.type}}class Qh extends Pi{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.common.async)return(async()=>{let a=await this._def.in._parseAsync({data:c.data,path:c.path,parent:c});return"aborted"===a.status?O6:"dirty"===a.status?(b.dirty(),O7(a.value)):this._def.out._parseAsync({data:a.value,path:c.path,parent:c})})();{let a=this._def.in._parseSync({data:c.data,path:c.path,parent:c});return"aborted"===a.status?O6:"dirty"===a.status?(b.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:c.path,parent:c})}}static create(a,b){return new Qh({in:a,out:b,typeName:w.ZodPipeline})}}class Qi extends Pi{_parse(a){let b=this._def.innerType._parse(a),c=a=>(Pb(a)&&(a.value=Object.freeze(a.value)),a);return Pc(b)?b.then(a=>c(a)):c(b)}unwrap(){return this._def.innerType}}function Qj(a,b){let c="function"==typeof a?a(b):"string"==typeof a?{message:a}:a;return"string"==typeof c?{message:c}:c}function Qk(a,b={},c){return a?PP.create().superRefine((d,e)=>{var f,g;let h=a(d);if(h instanceof Promise)return h.then(a=>{var f,g;if(!a){let a=Qj(b,d),h=null==(g=null!=(f=a.fatal)?f:c)||g;e.addIssue({code:"custom",...a,fatal:h})}});if(!h){let a=Qj(b,d),h=null==(g=null!=(f=a.fatal)?f:c)||g;e.addIssue({code:"custom",...a,fatal:h})}}):PP.create()}Qi.create=(a,b)=>new Qi({innerType:a,typeName:w.ZodReadonly,...Ph(b)}),PV.lazycreate,!function(a){a.ZodString="ZodString",a.ZodNumber="ZodNumber",a.ZodNaN="ZodNaN",a.ZodBigInt="ZodBigInt",a.ZodBoolean="ZodBoolean",a.ZodDate="ZodDate",a.ZodSymbol="ZodSymbol",a.ZodUndefined="ZodUndefined",a.ZodNull="ZodNull",a.ZodAny="ZodAny",a.ZodUnknown="ZodUnknown",a.ZodNever="ZodNever",a.ZodVoid="ZodVoid",a.ZodArray="ZodArray",a.ZodObject="ZodObject",a.ZodUnion="ZodUnion",a.ZodDiscriminatedUnion="ZodDiscriminatedUnion",a.ZodIntersection="ZodIntersection",a.ZodTuple="ZodTuple",a.ZodRecord="ZodRecord",a.ZodMap="ZodMap",a.ZodSet="ZodSet",a.ZodFunction="ZodFunction",a.ZodLazy="ZodLazy",a.ZodLiteral="ZodLiteral",a.ZodEnum="ZodEnum",a.ZodEffects="ZodEffects",a.ZodNativeEnum="ZodNativeEnum",a.ZodOptional="ZodOptional",a.ZodNullable="ZodNullable",a.ZodDefault="ZodDefault",a.ZodCatch="ZodCatch",a.ZodPromise="ZodPromise",a.ZodBranded="ZodBranded",a.ZodPipeline="ZodPipeline",a.ZodReadonly="ZodReadonly"}(w||(w={}));let Ql=PG.create,Qm=PI.create,Qn=(Qf.create,PJ.create,PK.create),Qo=(PL.create,PM.create,PN.create,PO.create,PP.create,PQ.create,PR.create,PS.create,PT.create,PV.create);PV.strictCreate,PW.create,PY.create,P$.create,P_.create,P0.create,P1.create,P2.create,P3.create,P4.create,P5.create,P7.create,P8.create,P9.create,Qa.create,Qb.create,Qc.create,Qa.createWithPreprocess,Qh.create;var Qp=c(37448);function Qq(a,b){if("function"==typeof a)return a(b);null!=a&&(a.current=b)}function Qr(...a){return b=>{let c=!1,d=a.map(a=>{let d=Qq(a,b);return c||"function"!=typeof d||(c=!0),d});if(c)return()=>{for(let b=0;b<d.length;b++){let c=d[b];"function"==typeof c?c():Qq(a[b],null)}}}}var Qs=function(a){let b=Qt(a),c=y.forwardRef((a,c)=>{let{children:d,...e}=a,f=y.Children.toArray(d),g=f.find(Qv);if(g){let a=g.props.children,d=f.map(b=>b!==g?b:y.Children.count(a)>1?y.Children.only(null):y.isValidElement(a)?a.props.children:null);return(0,x.jsx)(b,{...e,ref:c,children:y.isValidElement(a)?y.cloneElement(a,void 0,d):null})}return(0,x.jsx)(b,{...e,ref:c,children:d})});return c.displayName=`${a}.Slot`,c}("Slot");function Qt(a){let b=y.forwardRef((a,b)=>{let{children:c,...d}=a;if(y.isValidElement(c)){let a=Qx(c),e=Qw(d,c.props);return c.type!==y.Fragment&&(e.ref=b?Qr(b,a):a),y.cloneElement(c,e)}return y.Children.count(c)>1?y.Children.only(null):null});return b.displayName=`${a}.SlotClone`,b}var Qu=Symbol("radix.slottable");function Qv(a){return y.isValidElement(a)&&"function"==typeof a.type&&"__radixId"in a.type&&a.type.__radixId===Qu}function Qw(a,b){let c={...b};for(let d in b){let e=a[d],f=b[d];/^on[A-Z]/.test(d)?e&&f?c[d]=(...a)=>{let b=f(...a);return e(...a),b}:e&&(c[d]=e):"style"===d?c[d]={...e,...f}:"className"===d&&(c[d]=[e,f].filter(Boolean).join(" "))}return{...a,...c}}function Qx(a){let b=Object.getOwnPropertyDescriptor(a.props,"ref")?.get,c=b&&"isReactWarning"in b&&b.isReactWarning;return c?a.ref:(c=(b=Object.getOwnPropertyDescriptor(a,"ref")?.get)&&"isReactWarning"in b&&b.isReactWarning)?a.props.ref:a.props.ref||a.ref}var Qy=c(99978),Qz="Label",QA=y.forwardRef((a,b)=>(0,x.jsx)(Qy.sG.label,{...a,ref:b,onMouseDown:b=>{b.target.closest("button, input, select, textarea")||(a.onMouseDown?.(b),!b.defaultPrevented&&b.detail>1&&b.preventDefault())}}));QA.displayName=Qz;var QB=QA,QC=c(26691);let QD=(0,QC.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),QE=y.forwardRef(({className:a,...b},c)=>(0,x.jsx)(QB,{ref:c,className:(0,uA.cn)(QD(),a),...b}));QE.displayName=QB.displayName;let QF=NW,QG=y.createContext({}),QH=({...a})=>(0,x.jsx)(QG.Provider,{value:{name:a.name},children:(0,x.jsx)(N6,{...a})}),QI=()=>{let a=y.useContext(QG),b=y.useContext(QJ),{getFieldState:c,formState:d}=NV(),e=c(a.name,d);if(!a)throw Error("useFormField should be used within <FormField>");let{id:f}=b;return{id:f,name:a.name,formItemId:`${f}-form-item`,formDescriptionId:`${f}-form-item-description`,formMessageId:`${f}-form-item-message`,...e}},QJ=y.createContext({}),QK=y.forwardRef(({className:a,...b},c)=>{let d=y.useId();return(0,x.jsx)(QJ.Provider,{value:{id:d},children:(0,x.jsx)("div",{ref:c,className:(0,uA.cn)("space-y-2",a),...b})})});QK.displayName="FormItem",y.forwardRef(({className:a,...b},c)=>{let{error:d,formItemId:e}=QI();return(0,x.jsx)(QE,{ref:c,className:(0,uA.cn)(d&&"text-destructive",a),htmlFor:e,...b})}).displayName="FormLabel";let QL=y.forwardRef(({...a},b)=>{let{error:c,formItemId:d,formDescriptionId:e,formMessageId:f}=QI();return(0,x.jsx)(Qs,{ref:b,id:d,"aria-describedby":c?`${e} ${f}`:`${e}`,"aria-invalid":!!c,...a})});QL.displayName="FormControl",y.forwardRef(({className:a,...b},c)=>{let{formDescriptionId:d}=QI();return(0,x.jsx)("p",{ref:c,id:d,className:(0,uA.cn)("text-sm text-muted-foreground",a),...b})}).displayName="FormDescription";let QM=y.forwardRef(({className:a,children:b,...c},d)=>{let{error:e,formMessageId:f}=QI(),g=e?String(e?.message??""):b;return g?(0,x.jsx)("p",{ref:d,id:f,className:(0,uA.cn)("text-sm font-medium text-destructive",a),...c,children:g}):null});QM.displayName="FormMessage";let QN=y.forwardRef(({className:a,type:b,...c},d)=>(0,x.jsx)("input",{type:b,className:(0,uA.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:d,...c}));QN.displayName="Input";let QO=y.forwardRef(({className:a,...b},c)=>(0,x.jsx)("textarea",{className:(0,uA.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:c,...b}));QO.displayName="Textarea";let QP=(0,QC.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),QQ=y.forwardRef(({className:a,variant:b,size:c,asChild:d=!1,...e},f)=>{let g=d?Qs:"button";return(0,x.jsx)(g,{className:(0,uA.cn)(QP({variant:b,size:c,className:a})),ref:f,...e})});QQ.displayName="Button";let QR=[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]],QS=(0,Nm.A)("Mail",QR),QT=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],QU=(0,Nm.A)("MapPin",QT),QV=[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]],QW=(0,Nm.A)("Linkedin",QV),QX=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]],QY=(0,Nm.A)("Github",QX),QZ=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Q$=(0,Nm.A)("Send",QZ),Q_=Qo({name:Ql().min(2,"Name is required"),email:Ql().email("Invalid email address"),message:Ql().min(10,"Message must be at least 10 characters")}),Q0=()=>{let{toast:a}=(0,Qp.dj)(),[b,c]=(0,y.useState)(!1),d=OQ({resolver:OX(Q_),defaultValues:{name:"",email:"",message:""}});async function e(b){c(!0);let e=await Nk(b);c(!1),e.success?(a({title:"Transmission Successful",description:"Your inquiry has been stored in the neural cloud."}),d.reset()):a({variant:"destructive",title:"Transmission Failed",description:"A systemic error occurred. Please try again."})}return(0,x.jsxs)(uB,{id:"contact",className:"bg-transparent",children:[(0,x.jsxs)("div",{className:"grid md:grid-cols-2 gap-20",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{className:"text-primary font-headline text-lg uppercase tracking-widest mb-4",children:"Connection"}),(0,x.jsx)("h3",{className:"text-4xl md:text-6xl font-headline font-bold mb-8",children:"Let's Collaborate."}),(0,x.jsx)("p",{className:"text-muted-foreground text-lg mb-12 max-w-md",children:"Interested in web development, AI projects, or student resource collaborations? Reach out below."}),(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("a",{href:"mailto:atifmuneeb909@gmail.com",className:"flex items-center gap-4 text-muted-foreground hover:text-primary transition-colors group",children:[(0,x.jsx)("div",{className:"w-12 h-12 rounded-full border border-border flex items-center justify-center group-hover:border-primary",children:(0,x.jsx)(QS,{className:"h-5 w-5"})}),(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"text-xs uppercase tracking-widest block opacity-50",children:"Email"}),(0,x.jsx)("span",{className:"text-lg",children:"atifmuneeb909@gmail.com"})]})]}),(0,x.jsxs)("div",{className:"flex items-center gap-4 text-muted-foreground",children:[(0,x.jsx)("div",{className:"w-12 h-12 rounded-full border border-border flex items-center justify-center",children:(0,x.jsx)(QU,{className:"h-5 w-5"})}),(0,x.jsxs)("div",{children:[(0,x.jsx)("span",{className:"text-xs uppercase tracking-widest block opacity-50",children:"Location"}),(0,x.jsx)("span",{className:"text-lg",children:"Srinagar, Jammu & Kashmir"})]})]}),(0,x.jsxs)("div",{className:"flex gap-4",children:[(0,x.jsx)("a",{href:"https://linkedin.com/in/aatif-khan-390036273/",target:"_blank",className:"w-12 h-12 rounded-full border border-border flex items-center justify-center hover:border-primary hover:text-primary transition-colors",children:(0,x.jsx)(QW,{className:"h-5 w-5"})}),(0,x.jsx)("a",{href:"#",className:"w-12 h-12 rounded-full border border-border flex items-center justify-center hover:border-primary hover:text-primary transition-colors",children:(0,x.jsx)(QY,{className:"h-5 w-5"})})]})]})]}),(0,x.jsx)("div",{className:"border border-border p-8 md:p-12 bg-card/20 backdrop-blur-sm",children:(0,x.jsx)(QF,{...d,children:(0,x.jsxs)("form",{onSubmit:d.handleSubmit(e),className:"space-y-8",children:[(0,x.jsx)(QH,{control:d.control,name:"name",render:({field:a})=>(0,x.jsxs)(QK,{children:[(0,x.jsx)(QL,{children:(0,x.jsx)(QN,{placeholder:"NAME",...a,className:"bg-transparent border-0 border-b border-border rounded-none px-0 h-12 focus-visible:ring-0 focus-visible:border-primary transition-colors placeholder:text-muted-foreground/30 uppercase tracking-widest text-sm"})}),(0,x.jsx)(QM,{})]})}),(0,x.jsx)(QH,{control:d.control,name:"email",render:({field:a})=>(0,x.jsxs)(QK,{children:[(0,x.jsx)(QL,{children:(0,x.jsx)(QN,{placeholder:"EMAIL",...a,className:"bg-transparent border-0 border-b border-border rounded-none px-0 h-12 focus-visible:ring-0 focus-visible:border-primary transition-colors placeholder:text-muted-foreground/30 uppercase tracking-widest text-sm"})}),(0,x.jsx)(QM,{})]})}),(0,x.jsx)(QH,{control:d.control,name:"message",render:({field:a})=>(0,x.jsxs)(QK,{children:[(0,x.jsx)(QL,{children:(0,x.jsx)(QO,{placeholder:"MESSAGE",...a,className:"bg-transparent border-0 border-b border-border rounded-none px-0 min-h-[120px] focus-visible:ring-0 focus-visible:border-primary transition-colors placeholder:text-muted-foreground/30 uppercase tracking-widest text-sm resize-none"})}),(0,x.jsx)(QM,{})]})}),(0,x.jsxs)(QQ,{type:"submit",disabled:b,className:"w-full h-14 rounded-none bg-primary text-background font-headline font-bold uppercase tracking-widest hover:bg-primary/90 transition-all flex items-center justify-center gap-2",children:[b?"TRANSMITTING...":"INITIATE TRANSMISSION",!b&&(0,x.jsx)(Q$,{className:"h-4 w-4"})]})]})})})]}),(0,x.jsxs)("footer",{className:"mt-32 border-t border-border pt-12 flex flex-col md:flex-row justify-between gap-8 opacity-40",children:[(0,x.jsx)("div",{className:"text-[10px] uppercase tracking-[0.3em]",children:"\xa9 2025 AATIF MUNEEB KHAN  CSE & AI ARCHITECTURE"}),(0,x.jsxs)("div",{className:"text-[10px] uppercase tracking-[0.3em] flex gap-8",children:[(0,x.jsx)("span",{children:"SRINAGAR, J&K"}),(0,x.jsx)("span",{children:"EST. 2024"})]})]})]})};function Q1(a,b){if("function"==typeof a)return a(b);null!=a&&(a.current=b)}function Q2(...a){return b=>{let c=!1,d=a.map(a=>{let d=Q1(a,b);return c||"function"!=typeof d||(c=!0),d});if(c)return()=>{for(let b=0;b<d.length;b++){let c=d[b];"function"==typeof c?c():Q1(a[b],null)}}}}function Q3(...a){return y.useCallback(Q2(...a),a)}class Q4 extends y.Component{getSnapshotBeforeUpdate(a){let b=this.props.childRef.current;if(b&&a.isPresent&&!this.props.isPresent&&!1!==this.props.pop){let a=b.offsetParent,c=ud(a)&&a.offsetWidth||0,d=ud(a)&&a.offsetHeight||0,e=this.props.sizeRef.current;e.height=b.offsetHeight||0,e.width=b.offsetWidth||0,e.top=b.offsetTop,e.left=b.offsetLeft,e.right=c-e.width-e.left,e.bottom=d-e.height-e.top}return null}componentDidUpdate(){}render(){return this.props.children}}function Q5({children:a,isPresent:b,anchorX:c,anchorY:d,root:e,pop:f}){let g=(0,y.useId)(),h=(0,y.useRef)(null),i=(0,y.useRef)({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:j}=(0,y.useContext)(lX),k=Q3(h,a.props?.ref??a?.ref);return(0,y.useInsertionEffect)(()=>{let{width:a,height:k,top:l,left:m,right:n,bottom:o}=i.current;if(b||!1===f||!h.current||!a||!k)return;let p="left"===c?`left: ${m}`:`right: ${n}`,q="bottom"===d?`bottom: ${o}`:`top: ${l}`;h.current.dataset.motionPopId=g;let r=document.createElement("style");j&&(r.nonce=j);let s=e??document.head;return s.appendChild(r),r.sheet&&r.sheet.insertRule(`
          [data-motion-pop-id="${g}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${k}px !important;
            ${p}px !important;
            ${q}px !important;
          }
        `),()=>{s.contains(r)&&s.removeChild(r)}},[b]),(0,x.jsx)(Q4,{isPresent:b,childRef:h,sizeRef:i,pop:f,children:!1===f?a:y.cloneElement(a,{ref:k})})}let Q6=({children:a,initial:b,isPresent:c,onExitComplete:d,custom:e,presenceAffectsLayout:f,mode:g,anchorX:h,anchorY:i,root:j})=>{let k=lY(Q7),l=(0,y.useId)(),m=!0,n=(0,y.useMemo)(()=>(m=!1,{id:l,initial:b,isPresent:c,custom:e,onExitComplete:a=>{for(let b of(k.set(a,!0),k.values()))if(!b)return;d&&d()},register:a=>(k.set(a,!1),()=>k.delete(a))}),[c,k,d]);return f&&m&&(n={...n}),(0,y.useMemo)(()=>{k.forEach((a,b)=>k.set(b,!1))},[c]),y.useEffect(()=>{c||k.size||!d||d()},[c]),a=(0,x.jsx)(Q5,{pop:"popLayout"===g,isPresent:c,anchorX:h,anchorY:i,root:j,children:a}),(0,x.jsx)(qF.Provider,{value:n,children:a})};function Q7(){return new Map}let Q8=a=>a.key||"";function Q9(a){let b=[];return y.Children.forEach(a,a=>{(0,y.isValidElement)(a)&&b.push(a)}),b}let Ra=({children:a,custom:b,initial:c=!0,onExitComplete:d,presenceAffectsLayout:e=!0,mode:f="sync",propagate:g=!1,anchorX:h="left",anchorY:i="top",root:j})=>{let[k,l]=s_(g),m=(0,y.useMemo)(()=>Q9(a),[a]),n=g&&!k?[]:m.map(Q8),o=(0,y.useRef)(!0),p=(0,y.useRef)(m),q=lY(()=>new Map),r=(0,y.useRef)(new Set),[s,t]=(0,y.useState)(m),[u,v]=(0,y.useState)(m);n0(()=>{o.current=!1,p.current=m;for(let a=0;a<u.length;a++){let b=Q8(u[a]);n.includes(b)?(q.delete(b),r.current.delete(b)):!0!==q.get(b)&&q.set(b,!1)}},[u,n.length,n.join("-")]);let w=[];if(m!==s){let a=[...m];for(let b=0;b<u.length;b++){let c=u[b],d=Q8(c);n.includes(d)||(a.splice(b,0,c),w.push(c))}return"wait"===f&&w.length&&(a=w),v(Q9(a)),t(m),null}let{forceRender:z}=(0,y.useContext)(ql);return(0,x.jsx)(x.Fragment,{children:u.map(a=>{let s=Q8(a),t=(!g||!!k)&&(m===u||n.includes(s)),w=()=>{if(r.current.has(s)||(r.current.add(s),!q.has(s)))return;q.set(s,!0);let a=!0;q.forEach(b=>{b||(a=!1)}),a&&(z?.(),v(p.current),g&&l?.(),d&&d())};return(0,x.jsx)(Q6,{isPresent:t,initial:(!o.current||!!c)&&void 0,custom:b,presenceAffectsLayout:e,mode:f,root:j,onExitComplete:t?void 0:w,anchorX:h,anchorY:i,children:a},s)})})};function Rb(){let[a,b]=(0,y.useState)(!1);return(0,x.jsxs)("main",{className:"relative",children:[(0,x.jsx)(Ra,{children:!a&&(0,x.jsxs)(uz.div,{initial:{opacity:1},exit:{opacity:0},transition:{duration:1.2},className:"fixed inset-0 z-[100] bg-background flex flex-col items-center justify-center",children:[(0,x.jsx)(uz.div,{initial:{width:0},animate:{width:120},transition:{duration:1,ease:"easeInOut"},className:"h-[1px] bg-primary mb-4"}),(0,x.jsx)("span",{className:"text-[9px] font-headline uppercase tracking-[1em] text-primary opacity-60",children:"Architecting Neural Nodes"})]},"loader")}),(0,x.jsx)(lA,{}),(0,x.jsxs)("div",{className:"main-container",children:[(0,x.jsx)(uD,{}),(0,x.jsx)(uG,{}),(0,x.jsx)(uJ,{}),(0,x.jsx)(Nq,{}),(0,x.jsx)(Ny,{}),(0,x.jsx)(Q0,{})]}),(0,x.jsx)("nav",{className:"fixed right-6 md:right-12 top-1/2 -translate-y-1/2 z-50 hidden lg:flex flex-col gap-8",children:["hero","about","system-thinking","projects","research","contact"].map(a=>(0,x.jsxs)("a",{href:`#${a}`,className:"group flex items-center gap-4 justify-end",children:[(0,x.jsx)("span",{className:"text-[8px] uppercase tracking-widest text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity",children:a.replace("-"," ")}),(0,x.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-border group-hover:bg-primary transition-colors"})]},a))}),(0,x.jsx)("div",{className:"fixed left-8 bottom-12 z-50 pointer-events-none hidden md:block",children:(0,x.jsx)("div",{className:"text-[9px] font-headline text-primary uppercase tracking-[0.5em] origin-left rotate-[-90deg] translate-y-[-100%] opacity-20",children:"Neural Architecture v2.0 // AATIF KHAN"})})]})}},27791:(a,b,c)=>{"use strict";a.exports=g;var d=c(72481);((g.prototype=Object.create(d.prototype)).constructor=g).className="Enum";var e=c(26991),f=c(90290);function g(a,b,c,e,f,g){if(d.call(this,a,c),b&&"object"!=typeof b)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=e,this.comments=f||{},this.valuesOptions=g,this._valuesFeatures={},this.reserved=void 0,b)for(var h=Object.keys(b),i=0;i<h.length;++i)"number"==typeof b[h[i]]&&(this.valuesById[this.values[h[i]]=b[h[i]]]=h[i])}g.prototype._resolveFeatures=function(a){return a=this._edition||a,d.prototype._resolveFeatures.call(this,a),Object.keys(this.values).forEach(a=>{var b=Object.assign({},this._features);this._valuesFeatures[a]=Object.assign(b,this.valuesOptions&&this.valuesOptions[a]&&this.valuesOptions[a].features)}),this},g.fromJSON=function(a,b){var c=new g(a,b.values,b.options,b.comment,b.comments);return c.reserved=b.reserved,b.edition&&(c._edition=b.edition),c._defaultEdition="proto3",c},g.prototype.toJSON=function(a){var b=!!a&&!!a.keepComments;return f.toObject(["edition",this._editionToJSON(),"options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",b?this.comment:void 0,"comments",b?this.comments:void 0])},g.prototype.add=function(a,b,c,d){if(!f.isString(a))throw TypeError("name must be a string");if(!f.isInteger(b))throw TypeError("id must be an integer");if(void 0!==this.values[a])throw Error("duplicate name '"+a+"' in "+this);if(this.isReservedId(b))throw Error("id "+b+" is reserved in "+this);if(this.isReservedName(a))throw Error("name '"+a+"' is reserved in "+this);if(void 0!==this.valuesById[b]){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+b+" in "+this);this.values[a]=b}else this.valuesById[this.values[a]=b]=a;return d&&(void 0===this.valuesOptions&&(this.valuesOptions={}),this.valuesOptions[a]=d||null),this.comments[a]=c||null,this},g.prototype.remove=function(a){if(!f.isString(a))throw TypeError("name must be a string");var b=this.values[a];if(null==b)throw Error("name '"+a+"' does not exist in "+this);return delete this.valuesById[b],delete this.values[a],delete this.comments[a],this.valuesOptions&&delete this.valuesOptions[a],this},g.prototype.isReservedId=function(a){return e.isReservedId(this.reserved,a)},g.prototype.isReservedName=function(a){return e.isReservedName(this.reserved,a)}},27885:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.extractAndSelectServiceConfig=b.validateServiceConfig=b.validateRetryThrottling=void 0;let d=c(21820),e=c(74216),f=c(64432),g=/^\d+(\.\d{1,9})?s$/,h="node";function i(a){if("service"in a&&""!==a.service){if("string"!=typeof a.service)throw Error(`Invalid method config name: invalid service: expected type string, got ${typeof a.service}`);if(!("method"in a)||""===a.method)return{service:a.service};if("string"!=typeof a.method)throw Error(`Invalid method config name: invalid method: expected type string, got ${typeof a.service}`);return{service:a.service,method:a.method}}if("method"in a&&void 0!==a.method)throw Error("Invalid method config name: method set with empty or unset service");return{}}function j(a){if(!("maxAttempts"in a)||!Number.isInteger(a.maxAttempts)||a.maxAttempts<2)throw Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in a)||"string"!=typeof a.initialBackoff||!g.test(a.initialBackoff))throw Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in a)||"string"!=typeof a.maxBackoff||!g.test(a.maxBackoff))throw Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in a)||"number"!=typeof a.backoffMultiplier||a.backoffMultiplier<=0)throw Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in a&&Array.isArray(a.retryableStatusCodes)))throw Error("Invalid method config retry policy: retryableStatusCodes is required");if(0===a.retryableStatusCodes.length)throw Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let b of a.retryableStatusCodes)if("number"==typeof b){if(!Object.values(e.Status).includes(b))throw Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if("string"==typeof b){if(!Object.values(e.Status).includes(b.toUpperCase()))throw Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:a.maxAttempts,initialBackoff:a.initialBackoff,maxBackoff:a.maxBackoff,backoffMultiplier:a.backoffMultiplier,retryableStatusCodes:a.retryableStatusCodes}}function k(a){if(!("maxAttempts"in a)||!Number.isInteger(a.maxAttempts)||a.maxAttempts<2)throw Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in a&&("string"!=typeof a.hedgingDelay||!g.test(a.hedgingDelay)))throw Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in a&&Array.isArray(a.nonFatalStatusCodes))for(let b of a.nonFatalStatusCodes)if("number"==typeof b){if(!Object.values(e.Status).includes(b))throw Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if("string"==typeof b){if(!Object.values(e.Status).includes(b.toUpperCase()))throw Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let b={maxAttempts:a.maxAttempts};return a.hedgingDelay&&(b.hedgingDelay=a.hedgingDelay),a.nonFatalStatusCodes&&(b.nonFatalStatusCodes=a.nonFatalStatusCodes),b}function l(a){var b;let c={name:[]};if(!("name"in a)||!Array.isArray(a.name))throw Error("Invalid method config: invalid name array");for(let b of a.name)c.name.push(i(b));if("waitForReady"in a){if("boolean"!=typeof a.waitForReady)throw Error("Invalid method config: invalid waitForReady");c.waitForReady=a.waitForReady}if("timeout"in a)if("object"==typeof a.timeout){if(!("seconds"in a.timeout)||"number"!=typeof a.timeout.seconds)throw Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in a.timeout)||"number"!=typeof a.timeout.nanos)throw Error("Invalid method config: invalid timeout.nanos");c.timeout=a.timeout}else if("string"==typeof a.timeout&&g.test(a.timeout)){let d=a.timeout.substring(0,a.timeout.length-1).split(".");c.timeout={seconds:0|d[0],nanos:(null!=(b=d[1])?b:0)|0}}else throw Error("Invalid method config: invalid timeout");if("maxRequestBytes"in a){if("number"!=typeof a.maxRequestBytes)throw Error("Invalid method config: invalid maxRequestBytes");c.maxRequestBytes=a.maxRequestBytes}if("maxResponseBytes"in a){if("number"!=typeof a.maxResponseBytes)throw Error("Invalid method config: invalid maxRequestBytes");c.maxResponseBytes=a.maxResponseBytes}if("retryPolicy"in a)if("hedgingPolicy"in a)throw Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");else c.retryPolicy=j(a.retryPolicy);else"hedgingPolicy"in a&&(c.hedgingPolicy=k(a.hedgingPolicy));return c}function m(a){if(!("maxTokens"in a)||"number"!=typeof a.maxTokens||a.maxTokens<=0||a.maxTokens>1e3)throw Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in a)||"number"!=typeof a.tokenRatio||a.tokenRatio<=0)throw Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+a.maxTokens.toFixed(3),tokenRatio:+a.tokenRatio.toFixed(3)}}function n(a){let b={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in a)if("string"==typeof a.loadBalancingPolicy)b.loadBalancingPolicy=a.loadBalancingPolicy;else throw Error("Invalid service config: invalid loadBalancingPolicy");if("loadBalancingConfig"in a)if(Array.isArray(a.loadBalancingConfig))for(let c of a.loadBalancingConfig)b.loadBalancingConfig.push((0,f.validateLoadBalancingConfig)(c));else throw Error("Invalid service config: invalid loadBalancingConfig");if("methodConfig"in a&&Array.isArray(a.methodConfig))for(let c of a.methodConfig)b.methodConfig.push(l(c));"retryThrottling"in a&&(b.retryThrottling=m(a.retryThrottling));let c=[];for(let a of b.methodConfig)for(let b of a.name){for(let a of c)if(b.service===a.service&&b.method===a.method)throw Error(`Invalid service config: duplicate name ${b.service}/${b.method}`);c.push(b)}return b}function o(a){if(!("serviceConfig"in a))throw Error("Invalid service config choice: missing service config");let b={serviceConfig:n(a.serviceConfig)};if("clientLanguage"in a)if(Array.isArray(a.clientLanguage))for(let c of(b.clientLanguage=[],a.clientLanguage))if("string"==typeof c)b.clientLanguage.push(c);else throw Error("Invalid service config choice: invalid clientLanguage");else throw Error("Invalid service config choice: invalid clientLanguage");if("clientHostname"in a)if(Array.isArray(a.clientHostname))for(let c of(b.clientHostname=[],a.clientHostname))if("string"==typeof c)b.clientHostname.push(c);else throw Error("Invalid service config choice: invalid clientHostname");else throw Error("Invalid service config choice: invalid clientHostname");if("percentage"in a)if("number"==typeof a.percentage&&0<=a.percentage&&a.percentage<=100)b.percentage=a.percentage;else throw Error("Invalid service config choice: invalid percentage");let c=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let b in a)if(!c.includes(b))throw Error(`Invalid service config choice: unexpected field ${b}`);return b}function p(a,b){if(!Array.isArray(a))throw Error("Invalid service config list");for(let c of a){let a=o(c);if("number"!=typeof a.percentage||!(b>a.percentage)){if(Array.isArray(a.clientHostname)){let b=!1;for(let c of a.clientHostname)c===d.hostname()&&(b=!0);if(!b)continue}if(Array.isArray(a.clientLanguage)){let b=!1;for(let c of a.clientLanguage)c===h&&(b=!0);if(!b)continue}return a.serviceConfig}}throw Error("No matching service config found")}b.validateRetryThrottling=m,b.validateServiceConfig=n,b.extractAndSelectServiceConfig=function(a,b){for(let c of a)if(c.length>0&&c[0].startsWith("grpc_config="))return p(JSON.parse(c.join("").substring(12)),b);return null}},27910:a=>{"use strict";a.exports=require("stream")},28354:a=>{"use strict";a.exports=require("util")},28460:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.getDefaultRootsData=b.CIPHER_SUITES=void 0;let d=c(29021);b.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;let e=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,f=null;b.getDefaultRootsData=function(){return e?(null===f&&(f=d.readFileSync(e)),f):null}},28592:a=>{"use strict";a.exports={rE:"1.9.15"}},29021:a=>{"use strict";a.exports=require("fs")},29115:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Http2ServerCallStream=b.ServerDuplexStreamImpl=b.ServerWritableStreamImpl=b.ServerReadableStreamImpl=b.ServerUnaryCallImpl=void 0;let d=c(94735),e=c(73496),f=c(27910),g=c(74075),h=c(74216),i=c(39316),j=c(77508),k=c(49152),l=c(42503),m="server_call";function n(a){k.trace(h.LogVerbosity.DEBUG,m,a)}let o="grpc-message",p="grpc-status",q="grpc-timeout",r=/(\d{1,8})\s*([HMSmun])/,s={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},t={"grpc-accept-encoding":"identity,deflate,gzip","grpc-encoding":"identity"},u={[e.constants.HTTP2_HEADER_STATUS]:e.constants.HTTP_STATUS_OK,[e.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},v={waitForTrailers:!0};class w extends d.EventEmitter{constructor(a,b,c){super(),this.call=a,this.metadata=b,this.request=c,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(a){this.call.sendMetadata(a)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}b.ServerUnaryCallImpl=w;class x extends f.Readable{constructor(a,b,c,d){super({objectMode:!0}),this.call=a,this.metadata=b,this.deserialize=c,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,d)}_read(a){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(a){this.call.sendMetadata(a)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}b.ServerReadableStreamImpl=x;class y extends f.Writable{constructor(a,b,c,d){super({objectMode:!0}),this.call=a,this.metadata=b,this.serialize=c,this.request=d,this.cancelled=!1,this.trailingMetadata=new i.Metadata,this.call.setupSurfaceCall(this),this.on("error",a=>{this.call.sendError(a),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(a){this.call.sendMetadata(a)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(a,b,c){try{let b=this.call.serializeMessage(a);if(!this.call.write(b))return void this.call.once("drain",c)}catch(a){this.emit("error",{details:(0,l.getErrorMessage)(a),code:h.Status.INTERNAL})}c()}_final(a){this.call.sendStatus({code:h.Status.OK,details:"OK",metadata:this.trailingMetadata}),a(null)}end(a){return a&&(this.trailingMetadata=a),super.end()}}b.ServerWritableStreamImpl=y;class z extends f.Duplex{constructor(a,b,c,d,e){super({objectMode:!0}),this.call=a,this.metadata=b,this.serialize=c,this.deserialize=d,this.cancelled=!1,this.trailingMetadata=new i.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,e),this.on("error",a=>{this.call.sendError(a),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(a){this.call.sendMetadata(a)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(a){return a&&(this.trailingMetadata=a),super.end()}}b.ServerDuplexStreamImpl=z,z.prototype._read=x.prototype._read,z.prototype._write=y.prototype._write,z.prototype._final=y.prototype._final;class A extends d.EventEmitter{constructor(a,b,c){super(),this.stream=a,this.handler=b,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=h.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=h.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",a=>{}),this.stream.once("close",()=>{var a;n("Request to method "+(null==(a=this.handler)?void 0:a.path)+" stream closed with rstCode "+this.stream.rstCode),!this.statusSent&&(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:h.Status.CANCELLED,details:"Cancelled by client",metadata:null}),this.deadlineTimer&&clearTimeout(this.deadlineTimer))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in c&&(this.maxSendMessageSize=c["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in c&&(this.maxReceiveMessageSize=c["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(a,b){let c=a.subarray(5);if("identity"===b)return c;if("deflate"!==b&&"gzip"!==b)return Promise.reject({code:h.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${b}"`});{let a;return a="deflate"===b?g.createInflate():g.createGunzip(),new Promise((b,d)=>{let e=0,f=[];a.on("data",b=>{f.push(b),e+=b.byteLength,-1!==this.maxReceiveMessageSize&&e>this.maxReceiveMessageSize&&(a.destroy(),d({code:h.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxReceiveMessageSize}`}))}),a.on("end",()=>{b(Buffer.concat(f))}),a.write(c),a.end()})}}sendMetadata(a){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let b=a?a.toHttp2Headers():null,c=Object.assign(Object.assign(Object.assign({},u),t),b);this.stream.respond(c,v)}receiveMetadata(a){let b=i.Metadata.fromHttp2Headers(a);k.isTracerEnabled(m)&&n("Request to "+this.handler.path+" received headers "+JSON.stringify(b.toJSON()));let c=b.get(q);if(c.length>0){let a=c[0].toString().match(r);if(null===a){let a=Error("Invalid deadline");return a.code=h.Status.OUT_OF_RANGE,this.sendError(a),b}let d=a[1]*s[a[2]]|0,e=new Date;this.deadline=e.setMilliseconds(e.getMilliseconds()+d),this.deadlineTimer=setTimeout(B,d,this),b.remove(q)}return b.remove(e.constants.HTTP2_HEADER_ACCEPT_ENCODING),b.remove(e.constants.HTTP2_HEADER_TE),b.remove(e.constants.HTTP2_HEADER_CONTENT_TYPE),b.remove("grpc-accept-encoding"),b}receiveUnaryMessage(a){return new Promise((b,c)=>{let{stream:d}=this,e=0,f=this,g=[],i=this.maxReceiveMessageSize;function j(a){if(e+=a.byteLength,-1!==i&&e>i){d.removeListener("data",j),d.removeListener("end",k),d.removeListener("error",k),c({code:h.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${e} vs. ${i})`});return}g.push(a)}function k(i){if(d.removeListener("data",j),d.removeListener("end",k),d.removeListener("error",k),void 0!==i)return void c({code:h.Status.INTERNAL,details:i.message});if(0===e)return void c({code:h.Status.INTERNAL,details:"received empty unary message"});f.emit("receiveMessage");let l=Buffer.concat(g,e),m=1===l.readUInt8(0)?a:"identity",n=f.getDecompressedMessage(l,m);if(Buffer.isBuffer(n))return void b(f.deserializeMessageWithInternalError(n));n.then(a=>b(f.deserializeMessageWithInternalError(a)),b=>c(b.code?b:{code:h.Status.INTERNAL,details:`Received "grpc-encoding" header "${a}" but ${a} decompression failed`}))}this.stream.on("data",j),this.stream.on("end",k),this.stream.on("error",k)})}async deserializeMessageWithInternalError(a){try{return this.deserializeMessage(a)}catch(a){throw{details:(0,l.getErrorMessage)(a),code:h.Status.INTERNAL}}}serializeMessage(a){let b=this.handler.serialize(a),c=b.byteLength,d=Buffer.allocUnsafe(c+5);return d.writeUInt8(0,0),d.writeUInt32BE(c,1),b.copy(d,5),d}deserializeMessage(a){return this.handler.deserialize(a)}async sendUnaryMessage(a,b,c,d){if(!this.checkCancelled()){if(void 0===c&&(c=null),a){!Object.prototype.hasOwnProperty.call(a,"metadata")&&c&&(a.metadata=c),this.sendError(a);return}try{let a=this.serializeMessage(b);this.write(a),this.sendStatus({code:h.Status.OK,details:"OK",metadata:c})}catch(a){this.sendError({details:(0,l.getErrorMessage)(a),code:h.Status.INTERNAL})}}}sendStatus(a){var b,c;if(this.emit("callEnd",a.code),this.emit("streamEnd",a.code===h.Status.OK),!this.checkCancelled())if(n("Request to method "+(null==(b=this.handler)?void 0:b.path)+" ended with status code: "+h.Status[a.code]+" details: "+a.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var b;let c=Object.assign({[p]:a.code,[o]:encodeURI(a.details)},null==(b=a.metadata)?void 0:b.toHttp2Headers());this.stream.sendTrailers(c),this.statusSent=!0}),this.stream.end());else{let b=Object.assign(Object.assign({[p]:a.code,[o]:encodeURI(a.details)},u),null==(c=a.metadata)?void 0:c.toHttp2Headers());this.stream.respond(b,{endStream:!0}),this.statusSent=!0}}sendError(a){let b={code:h.Status.UNKNOWN,details:"message"in a?a.message:"Unknown Error",metadata:"metadata"in a&&void 0!==a.metadata?a.metadata:null};"code"in a&&"number"==typeof a.code&&Number.isInteger(a.code)&&(b.code=a.code,"details"in a&&"string"==typeof a.details&&(b.details=a.details)),this.sendStatus(b)}write(a){if(!this.checkCancelled())return -1!==this.maxSendMessageSize&&a.length>this.maxSendMessageSize?void this.sendError({code:h.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${a.length} vs. ${this.maxSendMessageSize})`}):(this.sendMetadata(),this.emit("sendMessage"),this.stream.write(a))}resume(){this.stream.resume()}setupSurfaceCall(a){this.once("cancelled",b=>{a.cancelled=!0,a.emit("cancelled",b)}),this.once("callEnd",b=>a.emit("callEnd",b))}setupReadable(a,b){let c=new j.StreamDecoder(this.maxReceiveMessageSize),d=!1,e=!1,f=!1,g=async()=>{f||!d||e||(f=!0,await this.pushOrBufferMessage(a,null))};this.stream.on("data",async d=>{let f;try{f=c.write(d)}catch(a){this.sendError({code:h.Status.RESOURCE_EXHAUSTED,details:a.message});return}for(let c of(e=!0,this.stream.pause(),f)){let d;this.emit("receiveMessage");let e=1===c.readUInt8(0)?b:"identity";try{d=await this.getDecompressedMessage(c,e)}catch(a){this.sendError(a);return}if(!d)return;await this.pushOrBufferMessage(a,d)}e=!1,this.stream.resume(),await g()}),this.stream.once("end",async()=>{d=!0,await g()})}consumeUnpushedMessages(a){for(this.canPush=!0;this.messagesToPush.length>0;){let b=this.messagesToPush.shift(),c=a.push(b);if(null===b||!1===c){this.canPush=!1;break}}return this.canPush}async pushOrBufferMessage(a,b){this.isPushPending?this.bufferedMessages.push(b):await this.pushMessage(a,b)}async pushMessage(a,b){if(null===b){n("Received end of stream"),this.canPush?a.push(null):this.messagesToPush.push(null);return}n("Received message of length "+b.length),this.isPushPending=!0;try{let c=await this.deserializeMessage(b);this.canPush?a.push(c)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(c)}catch(c){this.bufferedMessages.length=0;let b=(0,l.getErrorCode)(c);(null===b||b<h.Status.OK||b>h.Status.UNAUTHENTICATED)&&(b=h.Status.INTERNAL),a.emit("error",{details:(0,l.getErrorMessage)(c),code:b})}this.isPushPending=!1,this.bufferedMessages.length>0&&await this.pushMessage(a,this.bufferedMessages.shift())}getPeer(){var a;let b=null==(a=this.stream.session)?void 0:a.socket;return null!=b&&b.remoteAddress?b.remotePort?`${b.remoteAddress}:${b.remotePort}`:b.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}}function B(a){let b=Error("Deadline exceeded");b.code=h.Status.DEADLINE_EXCEEDED,a.sendError(b),a.cancelled=!0,a.emit("cancelled","deadline")}b.Http2ServerCallStream=A},29178:a=>{"use strict";function b(){this._listeners={}}a.exports=b,b.prototype.on=function(a,b,c){return(this._listeners[a]||(this._listeners[a]=[])).push({fn:b,ctx:c||this}),this},b.prototype.off=function(a,b){if(void 0===a)this._listeners={};else if(void 0===b)this._listeners[a]=[];else for(var c=this._listeners[a],d=0;d<c.length;)c[d].fn===b?c.splice(d,1):++d;return this},b.prototype.emit=function(a){var b=this._listeners[a];if(b){for(var c=[],d=1;d<arguments.length;)c.push(arguments[d++]);for(d=0;d<b.length;)b[d].fn.apply(b[d++].ctx,c)}return this}},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30999:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.uriToString=b.splitHostPort=b.parseUri=void 0;let c=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;b.parseUri=function(a){let b=c.exec(a);return null===b?null:{scheme:b[1],authority:b[2],path:b[3]}};let d=/^\d+$/;b.splitHostPort=function(a){if(a.startsWith("[")){let b=a.indexOf("]");if(-1===b)return null;let c=a.substring(1,b);if(-1===c.indexOf(":"))return null;if(!(a.length>b+1))return{host:c};if(":"!==a[b+1])return null;{let e=a.substring(b+2);return d.test(e)?{host:c,port:+e}:null}}{let b=a.split(":");return 2!==b.length?{host:a}:d.test(b[1])?{host:b[0],port:+b[1]}:null}},b.uriToString=function(a){let b="";return void 0!==a.scheme&&(b+=a.scheme+":"),void 0!==a.authority&&(b+="//"+a.authority+"/"),b+=a.path}},31502:(a,b,c)=>{"use strict";a.exports=l;var d,e,f,g=c(26991);((l.prototype=Object.create(g.prototype)).constructor=l).className="Root";var h=c(99408),i=c(27791),j=c(67369),k=c(90290);function l(a){g.call(this,"",a),this.deferred=[],this.files=[],this._edition="proto2",this._fullyQualifiedObjects={}}function m(){}l.fromJSON=function(a,b){return b||(b=new l),a.options&&b.setOptions(a.options),b.addJSON(a.nested).resolveAll()},l.prototype.resolvePath=k.path.resolve,l.prototype.fetch=k.fetch,l.prototype.load=function a(b,c,d){"function"==typeof c&&(d=c,c=void 0);var g=this;if(!d)return k.asPromise(a,g,b,c);var h=d===m;function i(a,b){if(d){if(h)throw a;b&&b.resolveAll();var c=d;d=null,c(a,b)}}function j(a){var b=a.lastIndexOf("google/protobuf/");if(b>-1){var c=a.substring(b);if(c in f)return c}return null}function l(a,b){try{if(k.isString(b)&&"{"===b.charAt(0)&&(b=JSON.parse(b)),k.isString(b)){e.filename=a;var d,f=e(b,g,c),l=0;if(f.imports)for(;l<f.imports.length;++l)(d=j(f.imports[l])||g.resolvePath(a,f.imports[l]))&&n(d);if(f.weakImports)for(l=0;l<f.weakImports.length;++l)(d=j(f.weakImports[l])||g.resolvePath(a,f.weakImports[l]))&&n(d,!0)}else g.setOptions(b.options).addJSON(b.nested)}catch(a){i(a)}h||o||i(null,g)}function n(a,b){if(a=j(a)||a,!(g.files.indexOf(a)>-1)){if(g.files.push(a),a in f)return void(h?l(a,f[a]):(++o,setTimeout(function(){--o,l(a,f[a])})));if(h){var c;try{c=k.fs.readFileSync(a).toString("utf8")}catch(a){b||i(a);return}l(a,c)}else++o,g.fetch(a,function(c,e){if(--o,d){if(c)return void(b?o||i(null,g):i(c));l(a,e)}})}}var o=0;k.isString(b)&&(b=[b]);for(var p,q=0;q<b.length;++q)(p=g.resolvePath("",b[q]))&&n(p);return h?g.resolveAll():o||i(null,g),g},l.prototype.loadSync=function(a,b){if(!k.isNode)throw Error("not supported");return this.load(a,b,m)},l.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(a){return"'extend "+a.extend+"' in "+a.parent.fullName}).join(", "));return g.prototype.resolveAll.call(this)};var n=/^[A-Z]/;function o(a,b){var c=b.parent.lookup(b.extend);if(c){var d=new h(b.fullName,b.id,b.type,b.rule,void 0,b.options);return!!c.get(d.name)||(d.declaringField=b,b.extensionField=d,c.add(d),!0)}return!1}l.prototype._handleAdd=function(a){if(a instanceof h)void 0===a.extend||a.extensionField||o(this,a)||this.deferred.push(a);else if(a instanceof i)n.test(a.name)&&(a.parent[a.name]=a.values);else if(!(a instanceof j)){if(a instanceof d)for(var b=0;b<this.deferred.length;)o(this,this.deferred[b])?this.deferred.splice(b,1):++b;for(var c=0;c<a.nestedArray.length;++c)this._handleAdd(a._nestedArray[c]);n.test(a.name)&&(a.parent[a.name]=a)}(a instanceof d||a instanceof i||a instanceof h)&&(this._fullyQualifiedObjects[a.fullName]=a)},l.prototype._handleRemove=function(a){if(a instanceof h){if(void 0!==a.extend)if(a.extensionField)a.extensionField.parent.remove(a.extensionField),a.extensionField=null;else{var b=this.deferred.indexOf(a);b>-1&&this.deferred.splice(b,1)}}else if(a instanceof i)n.test(a.name)&&delete a.parent[a.name];else if(a instanceof g){for(var c=0;c<a.nestedArray.length;++c)this._handleRemove(a._nestedArray[c]);n.test(a.name)&&delete a.parent[a.name]}delete this._fullyQualifiedObjects[a.fullName]},l._configure=function(a,b,c){d=a,e=b,f=c}},31872:(a,b,c)=>{Promise.resolve().then(c.bind(c,27484))},32497:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},32663:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.InterceptingListenerImpl=b.isInterceptingListener=void 0,b.isInterceptingListener=function(a){return void 0!==a.onReceiveMetadata&&1===a.onReceiveMetadata.length};class c{constructor(a,b){this.listener=a,this.nextListener=b,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(a){this.processingMetadata=!0,this.listener.onReceiveMetadata(a,a=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(a),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(a){this.processingMessage=!0,this.listener.onReceiveMessage(a,a=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=a,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(a),this.processPendingStatus())})}onReceiveStatus(a){this.listener.onReceiveStatus(a,a=>{this.processingMetadata||this.processingMessage?this.pendingStatus=a:this.nextListener.onReceiveStatus(a)})}}b.InterceptingListenerImpl=c},33873:a=>{"use strict";a.exports=require("path")},34631:a=>{"use strict";a.exports=require("tls")},34891:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.getSubchannelPool=b.SubchannelPool=void 0;let d=c(73993),e=c(71464),f=c(41509),g=c(30999),h=c(78548),i=1e4;class j{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let a=!0;for(let b in this.pool){let c=this.pool[b].filter(a=>!a.subchannel.unrefIfOneRef());c.length>0&&(a=!1),this.pool[b]=c}a&&null!==this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var a,b;null===this.cleanupTimer&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},i),null==(b=(a=this.cleanupTimer).unref)||b.call(a))}getOrCreateSubchannel(a,b,c,i){this.ensureCleanupTask();let j=(0,g.uriToString)(a);if(j in this.pool){for(let a of this.pool[j])if((0,f.subchannelAddressEqual)(b,a.subchannelAddress)&&(0,d.channelOptionsEqual)(c,a.channelArguments)&&i._equals(a.channelCredentials))return a.subchannel}let k=new e.Subchannel(a,b,c,i,new h.Http2SubchannelConnector(a));return j in this.pool||(this.pool[j]=[]),this.pool[j].push({subchannelAddress:b,channelArguments:c,channelCredentials:i,subchannel:k}),k.ref(),k}}b.SubchannelPool=j;let k=new j;b.getSubchannelPool=function(a){return a?k:new j}},34979:(a,b,c)=>{"use strict";var d;Object.defineProperty(b,"__esModule",{value:!0}),b.QueuePicker=b.UnavailablePicker=b.PickResultType=void 0;let e=c(39316),f=c(74216);!function(a){a[a.COMPLETE=0]="COMPLETE",a[a.QUEUE=1]="QUEUE",a[a.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",a[a.DROP=3]="DROP"}(d||(b.PickResultType=d={}));class g{constructor(a){this.status=Object.assign({code:f.Status.UNAVAILABLE,details:"No connection established",metadata:new e.Metadata},a)}pick(a){return{pickResultType:d.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}}b.UnavailablePicker=g;class h{constructor(a){this.loadBalancer=a,this.calledExitIdle=!1}pick(a){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:d.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}}b.QueuePicker=h},36454:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.BaseSubchannelWrapper=void 0;class c{constructor(a){this.child=a}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(a){this.child.addConnectivityStateListener(a)}removeConnectivityStateListener(a){this.child.removeConnectivityStateListener(a)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(a){this.child.throttleKeepalive(a)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(a){return this.getRealSubchannel()===a.getRealSubchannel()}}b.BaseSubchannelWrapper=c},36827:(a,b,c)=>{"use strict";var d=c(64869);a.exports=b=d.descriptor=d.Root.fromJSON(c(97659)).lookup(".google.protobuf");var e=d.Namespace,f=d.Root,g=d.Enum,h=d.Type,i=d.Field,j=d.MapField,k=d.OneOf,l=d.Service,m=d.Method;function n(a,c,d){var j=b.FileDescriptorProto.create({name:a.filename||(a.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});E(d,j),a instanceof f||(j.package=a.fullName.substring(1));for(var k,m=0;m<a.nestedArray.length;++m)(k=a._nestedArray[m])instanceof h?j.messageType.push(k.toDescriptor(d)):k instanceof g?j.enumType.push(k.toDescriptor()):k instanceof i?j.extension.push(k.toDescriptor(d)):k instanceof l?j.service.push(k.toDescriptor()):k instanceof e&&n(k,c,d);j.options=A(a.options,b.FileOptions),j.messageType.length+j.enumType.length+j.extension.length+j.service.length&&c.push(j)}f.fromDescriptor=function(a){"number"==typeof a.length&&(a=b.FileDescriptorSet.decode(a));var c=new f;if(a.file)for(var d,e,j,k=0;k<a.file.length;++k){e=c,(d=a.file[k]).package&&d.package.length&&(e=c.define(d.package));var m=D(d);if(d.name&&d.name.length&&c.files.push(e.filename=d.name),d.messageType)for(j=0;j<d.messageType.length;++j)e.add(h.fromDescriptor(d.messageType[j],m));if(d.enumType)for(j=0;j<d.enumType.length;++j)e.add(g.fromDescriptor(d.enumType[j],m));if(d.extension)for(j=0;j<d.extension.length;++j)e.add(i.fromDescriptor(d.extension[j],m));if(d.service)for(j=0;j<d.service.length;++j)e.add(l.fromDescriptor(d.service[j],m));var n=y(d.options,b.FileOptions);if(n){var o=Object.keys(n);for(j=0;j<o.length;++j)e.setOption(o[j],n[o[j]])}}return c.resolveAll()},f.prototype.toDescriptor=function(a){var c=b.FileDescriptorSet.create();return n(this,c.file,a),c};var o=0;h.fromDescriptor=function(a,c,d){"number"==typeof a.length&&(a=b.DescriptorProto.decode(a));var e,f=new h(a.name.length?a.name:"Type"+o++,y(a.options,b.MessageOptions));if(d||(f._edition=c),a.oneofDecl)for(e=0;e<a.oneofDecl.length;++e)f.add(k.fromDescriptor(a.oneofDecl[e]));if(a.field)for(e=0;e<a.field.length;++e){var j=i.fromDescriptor(a.field[e],c,!0);f.add(j),a.field[e].hasOwnProperty("oneofIndex")&&f.oneofsArray[a.field[e].oneofIndex].add(j)}if(a.extension)for(e=0;e<a.extension.length;++e)f.add(i.fromDescriptor(a.extension[e],c,!0));if(a.nestedType)for(e=0;e<a.nestedType.length;++e)f.add(h.fromDescriptor(a.nestedType[e],c,!0)),a.nestedType[e].options&&a.nestedType[e].options.mapEntry&&f.setOption("map_entry",!0);if(a.enumType)for(e=0;e<a.enumType.length;++e)f.add(g.fromDescriptor(a.enumType[e],c,!0));if(a.extensionRange&&a.extensionRange.length)for(e=0,f.extensions=[];e<a.extensionRange.length;++e)f.extensions.push([a.extensionRange[e].start,a.extensionRange[e].end]);if(a.reservedRange&&a.reservedRange.length||a.reservedName&&a.reservedName.length){if(f.reserved=[],a.reservedRange)for(e=0;e<a.reservedRange.length;++e)f.reserved.push([a.reservedRange[e].start,a.reservedRange[e].end]);if(a.reservedName)for(e=0;e<a.reservedName.length;++e)f.reserved.push(a.reservedName[e])}return f},h.prototype.toDescriptor=function(a){var c,d,e=b.DescriptorProto.create({name:this.name});for(d=0;d<this.fieldsArray.length;++d)if(e.field.push(c=this._fieldsArray[d].toDescriptor(a)),this._fieldsArray[d]instanceof j){var f=w(this._fieldsArray[d].keyType,this._fieldsArray[d].resolvedKeyType,!1),k=w(this._fieldsArray[d].type,this._fieldsArray[d].resolvedType,!1),l=11===k||14===k?this._fieldsArray[d].resolvedType&&B(this.parent,this._fieldsArray[d].resolvedType)||this._fieldsArray[d].type:void 0;e.nestedType.push(b.DescriptorProto.create({name:c.typeName,field:[b.FieldDescriptorProto.create({name:"key",number:1,label:1,type:f}),b.FieldDescriptorProto.create({name:"value",number:2,label:1,type:k,typeName:l})],options:b.MessageOptions.create({mapEntry:!0})}))}for(d=0;d<this.oneofsArray.length;++d)e.oneofDecl.push(this._oneofsArray[d].toDescriptor());for(d=0;d<this.nestedArray.length;++d)this._nestedArray[d]instanceof i?e.field.push(this._nestedArray[d].toDescriptor(a)):this._nestedArray[d]instanceof h?e.nestedType.push(this._nestedArray[d].toDescriptor(a)):this._nestedArray[d]instanceof g&&e.enumType.push(this._nestedArray[d].toDescriptor());if(this.extensions)for(d=0;d<this.extensions.length;++d)e.extensionRange.push(b.DescriptorProto.ExtensionRange.create({start:this.extensions[d][0],end:this.extensions[d][1]}));if(this.reserved)for(d=0;d<this.reserved.length;++d)"string"==typeof this.reserved[d]?e.reservedName.push(this.reserved[d]):e.reservedRange.push(b.DescriptorProto.ReservedRange.create({start:this.reserved[d][0],end:this.reserved[d][1]}));return e.options=A(this.options,b.MessageOptions),e};var p=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;i.fromDescriptor=function(a,c,d){if("number"==typeof a.length&&(a=b.DescriptorProto.decode(a)),"number"!=typeof a.number)throw Error("missing field id");switch(e=a.typeName&&a.typeName.length?a.typeName:u(a.type),a.label){case 1:f=void 0;break;case 2:f="required";break;case 3:f="repeated";break;default:throw Error("illegal label: "+a.label)}var e,f,g=a.extendee;void 0!==a.extendee&&(g=g.length?g:void 0);var h=new i(a.name.length?a.name:"field"+a.number,a.number,e,f,g);if(d||(h._edition=c),h.options=y(a.options,b.FieldOptions),a.proto3_optional&&(h.options.proto3_optional=!0),a.defaultValue&&a.defaultValue.length){var j=a.defaultValue;switch(j){case"true":case"TRUE":j=!0;break;case"false":case"FALSE":j=!1;break;default:p.exec(j)&&(j=parseInt(j))}h.setOption("default",j)}return v(a.type)&&("proto3"===c?a.options&&!a.options.packed&&h.setOption("packed",!1):(!c||"proto2"===c)&&a.options&&a.options.packed&&h.setOption("packed",!0)),h},i.prototype.toDescriptor=function(a){var c=b.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)c.type=11,c.typeName=d.util.ucFirst(this.name),c.label=3;else{switch(c.type=w(this.type,this.resolve().resolvedType,this.delimited)){case 10:case 11:case 14:c.typeName=this.resolvedType?B(this.parent,this.resolvedType):this.type}"repeated"===this.rule?c.label=3:this.required&&"proto2"===a?c.label=2:c.label=1}if(c.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(c.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(c.options=A(this.options,b.FieldOptions),null!=this.options.default&&(c.defaultValue=String(this.options.default)),this.options.proto3_optional&&(c.proto3_optional=!0)),"proto3"===a?this.packed||((c.options||(c.options=b.FieldOptions.create())).packed=!1):(!a||"proto2"===a)&&this.packed&&((c.options||(c.options=b.FieldOptions.create())).packed=!0),c};var q=0;g.fromDescriptor=function(a,c,d){"number"==typeof a.length&&(a=b.EnumDescriptorProto.decode(a));var e={};if(a.value)for(var f=0;f<a.value.length;++f){var h=a.value[f].name,i=a.value[f].number||0;e[h&&h.length?h:"NAME"+i]=i}var j=new g(a.name&&a.name.length?a.name:"Enum"+q++,e,y(a.options,b.EnumOptions));return d||(j._edition=c),j},g.prototype.toDescriptor=function(){for(var a=[],c=0,d=Object.keys(this.values);c<d.length;++c)a.push(b.EnumValueDescriptorProto.create({name:d[c],number:this.values[d[c]]}));return b.EnumDescriptorProto.create({name:this.name,value:a,options:A(this.options,b.EnumOptions)})};var r=0;k.fromDescriptor=function(a){return"number"==typeof a.length&&(a=b.OneofDescriptorProto.decode(a)),new k(a.name&&a.name.length?a.name:"oneof"+r++)},k.prototype.toDescriptor=function(){return b.OneofDescriptorProto.create({name:this.name})};var s=0;l.fromDescriptor=function(a,c,d){"number"==typeof a.length&&(a=b.ServiceDescriptorProto.decode(a));var e=new l(a.name&&a.name.length?a.name:"Service"+s++,y(a.options,b.ServiceOptions));if(d||(e._edition=c),a.method)for(var f=0;f<a.method.length;++f)e.add(m.fromDescriptor(a.method[f]));return e},l.prototype.toDescriptor=function(){for(var a=[],c=0;c<this.methodsArray.length;++c)a.push(this._methodsArray[c].toDescriptor());return b.ServiceDescriptorProto.create({name:this.name,method:a,options:A(this.options,b.ServiceOptions)})};var t=0;function u(a){switch(a){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+a)}function v(a){switch(a){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function w(a,b,c){switch(a){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(b instanceof g)return 14;if(b instanceof h)return c?10:11;throw Error("illegal type: "+a)}function x(a,b){for(var c,d,e={},f=0;f<b.fieldsArray.length;++f)if("uninterpretedOption"!==(d=(c=b._fieldsArray[f]).name)&&Object.prototype.hasOwnProperty.call(a,d)){var i=C(d);c.resolvedType instanceof h?e[i]=x(a[d],c.resolvedType):c.resolvedType instanceof g?e[i]=c.resolvedType.valuesById[a[d]]:e[i]=a[d]}return e}function y(a,b){if(a)return x(b.toObject(a),b)}function z(a,b){for(var c={},e=Object.keys(a),f=0;f<e.length;++f){var g=e[f],i=d.util.camelCase(g);if(Object.prototype.hasOwnProperty.call(b.fields,i)){var j=b.fields[i];j.resolvedType instanceof h?c[i]=z(a[g],j.resolvedType):c[i]=a[g],j.repeated&&!Array.isArray(c[i])&&(c[i]=[c[i]])}}return c}function A(a,b){if(a)return b.fromObject(z(a,b))}function B(a,b){var c=a.fullName.split("."),d=b.fullName.split("."),g=0,h=0,i=d.length-1;if(!(a instanceof f)&&b instanceof e)for(;g<c.length&&h<i&&c[g]===d[h];){var j=b.lookup(c[g++],!0);if(null!==j&&j!==b)break;++h}else for(;g<c.length&&h<i&&c[g]===d[h];++g,++h);return d.slice(h).join(".")}function C(a){return a.substring(0,1)+a.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(a,b){return"_"+b.toLowerCase()})}function D(a){if("editions"===a.syntax)if(a.edition===b.Edition.EDITION_2023)return"2023";else throw Error("Unsupported edition "+a.edition);return"proto3"===a.syntax?"proto3":"proto2"}function E(a,c){if(a)if("proto2"===a||"proto3"===a)c.syntax=a;else if(c.syntax="editions","2023"===a)c.edition=b.Edition.EDITION_2023;else throw Error("Unsupported edition "+a)}m.fromDescriptor=function(a){return"number"==typeof a.length&&(a=b.MethodDescriptorProto.decode(a)),new m(a.name&&a.name.length?a.name:"Method"+t++,"rpc",a.inputType,a.outputType,!!a.clientStreaming,!!a.serverStreaming,y(a.options,b.MethodOptions))},m.prototype.toDescriptor=function(){return b.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:A(this.options,b.MethodOptions)})}},39316:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Metadata=void 0;let d=c(49152),e=c(74216),f=c(42503),g=/^[0-9a-z_.-]+$/,h=/^[ -~]*$/;function i(a){return g.test(a)}function j(a){return h.test(a)}function k(a){return a.endsWith("-bin")}function l(a){return!a.startsWith("grpc-")}function m(a){return a.toLowerCase()}function n(a,b){if(!i(a))throw Error('Metadata key "'+a+'" contains illegal characters');if(null!=b)if(k(a)){if(!Buffer.isBuffer(b))throw Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(b))throw Error("keys that don't end with '-bin' must have String values");if(!j(b))throw Error('Metadata string value "'+b+'" contains illegal characters')}}class o{constructor(a={}){this.internalRepr=new Map,this.options=a}set(a,b){n(a=m(a),b),this.internalRepr.set(a,[b])}add(a,b){n(a=m(a),b);let c=this.internalRepr.get(a);void 0===c?this.internalRepr.set(a,[b]):c.push(b)}remove(a){a=m(a),this.internalRepr.delete(a)}get(a){return a=m(a),this.internalRepr.get(a)||[]}getMap(){let a={};for(let[b,c]of this.internalRepr)if(c.length>0){let d=c[0];a[b]=Buffer.isBuffer(d)?Buffer.from(d):d}return a}clone(){let a=new o(this.options),b=a.internalRepr;for(let[a,c]of this.internalRepr){let d=c.map(a=>Buffer.isBuffer(a)?Buffer.from(a):a);b.set(a,d)}return a}merge(a){for(let[b,c]of a.internalRepr){let a=(this.internalRepr.get(b)||[]).concat(c);this.internalRepr.set(b,a)}}setOptions(a){this.options=a}getOptions(){return this.options}toHttp2Headers(){let a={};for(let[b,c]of this.internalRepr)a[b]=c.map(p);return a}toJSON(){let a={};for(let[b,c]of this.internalRepr)a[b]=c;return a}static fromHttp2Headers(a){let b=new o;for(let c of Object.keys(a)){if(":"===c.charAt(0))continue;let g=a[c];try{k(c)?Array.isArray(g)?g.forEach(a=>{b.add(c,Buffer.from(a,"base64"))}):void 0!==g&&(l(c)?g.split(",").forEach(a=>{b.add(c,Buffer.from(a.trim(),"base64"))}):b.add(c,Buffer.from(g,"base64"))):Array.isArray(g)?g.forEach(a=>{b.add(c,a)}):void 0!==g&&b.add(c,g)}catch(b){let a=`Failed to add metadata entry ${c}: ${g}. ${(0,f.getErrorMessage)(b)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,d.log)(e.LogVerbosity.ERROR,a)}}return b}}b.Metadata=o;let p=a=>Buffer.isBuffer(a)?a.toString("base64"):a},40543:(a,b,c)=>{"use strict";a.exports=e;var d=c(60054);function e(a,b,c){if("function"!=typeof a)throw TypeError("rpcImpl must be a function");d.EventEmitter.call(this),this.rpcImpl=a,this.requestDelimited=!!b,this.responseDelimited=!!c}(e.prototype=Object.create(d.EventEmitter.prototype)).constructor=e,e.prototype.rpcCall=function a(b,c,e,f,g){if(!f)throw TypeError("request must be specified");var h=this;if(!g)return d.asPromise(a,h,b,c,e,f);if(!h.rpcImpl)return void setTimeout(function(){g(Error("already ended"))},0);try{return h.rpcImpl(b,c[h.requestDelimited?"encodeDelimited":"encode"](f).finish(),function(a,c){if(a)return h.emit("error",a,b),g(a);if(null===c)return void h.end(!0);if(!(c instanceof e))try{c=e[h.responseDelimited?"decodeDelimited":"decode"](c)}catch(a){return h.emit("error",a,b),g(a)}return h.emit("data",c,b),g(null,c)})}catch(a){h.emit("error",a,b),setTimeout(function(){g(a)},0);return}},e.prototype.end=function(a){return this.rpcImpl&&(a||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},41509:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.stringToSubchannelAddress=b.subchannelAddressToString=b.subchannelAddressEqual=b.isTcpSubchannelAddress=void 0;let d=c(91645);function e(a){return"port"in a}b.isTcpSubchannelAddress=e,b.subchannelAddressEqual=function(a,b){return!a&&!b||!!a&&!!b&&(e(a)?e(b)&&a.host===b.host&&a.port===b.port:!e(b)&&a.path===b.path)},b.subchannelAddressToString=function(a){return e(a)?a.host+":"+a.port:a.path};let f=443;b.stringToSubchannelAddress=function(a,b){return(0,d.isIP)(a)?{host:a,port:null!=b?b:f}:{path:a}}},42503:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.getErrorCode=b.getErrorMessage=void 0,b.getErrorMessage=function(a){return a instanceof Error?a.message:String(a)},b.getErrorCode=function(a){return"object"==typeof a&&null!==a&&"code"in a&&"number"==typeof a.code?a.code:null}},46401:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ChannelCredentials=void 0;let d=c(34631),e=c(85842),f=c(28460);function g(a,b){if(a&&!(a instanceof Buffer))throw TypeError(`${b}, if provided, must be a Buffer.`)}class h{constructor(a){this.callCredentials=a||e.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(a,b,c,e){var h;if(g(a,"Root certificate"),g(b,"Private key"),g(c,"Certificate chain"),b&&!c)throw Error("Private key must be given with accompanying certificate chain");if(!b&&c)throw Error("Certificate chain must be given with accompanying private key");return new j((0,d.createSecureContext)({ca:null!=(h=null!=a?a:(0,f.getDefaultRootsData)())?h:void 0,key:null!=b?b:void 0,cert:null!=c?c:void 0,ciphers:f.CIPHER_SUITES}),null!=e?e:{})}static createFromSecureContext(a,b){return new j(a,null!=b?b:{})}static createInsecure(){return new i}}b.ChannelCredentials=h;class i extends h{constructor(a){super(a)}compose(a){throw Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(a){return a instanceof i}}class j extends h{constructor(a,b){super(),this.secureContext=a,this.verifyOptions=b,this.connectionOptions={secureContext:a},(null==b?void 0:b.checkServerIdentity)&&(this.connectionOptions.checkServerIdentity=b.checkServerIdentity)}compose(a){return new k(this,this.callCredentials.compose(a))}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(a){return this===a||a instanceof j&&this.secureContext===a.secureContext&&this.verifyOptions.checkServerIdentity===a.verifyOptions.checkServerIdentity}}class k extends h{constructor(a,b){super(b),this.channelCredentials=a}compose(a){let b=this.callCredentials.compose(a);return new k(this.channelCredentials,b)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(a){return this===a||a instanceof k&&this.channelCredentials._equals(a.channelCredentials)&&this.callCredentials._equals(a.callCredentials)}}},47372:(a,b,c)=>{"use strict";var d,e;d={value:!0},d=d=b.rS=b.Yi=d=b.Ib=d=d=void 0;let f=c(16452),g=c(64869),h=c(36827),i=c(55274);d=c(66666),d=function(a){return"@type"in a&&"string"==typeof a["@type"]},function(a){a.IDEMPOTENCY_UNKNOWN="IDEMPOTENCY_UNKNOWN",a.NO_SIDE_EFFECTS="NO_SIDE_EFFECTS",a.IDEMPOTENT="IDEMPOTENT"}(e=b.Ib||(b.Ib={}));let j={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function k(a,b){return""===a?b:a+"."+b}function l(a){return a instanceof g.Service||a instanceof g.Type||a instanceof g.Enum}function m(a){return a instanceof g.Namespace||a instanceof g.Root}function n(a,b){let c=k(b,a.name);return l(a)?[[c,a]]:m(a)&&void 0!==a.nested?Object.keys(a.nested).map(b=>n(a.nested[b],c)).reduce((a,b)=>a.concat(b),[]):[]}function o(a,b){return function(c){return a.toObject(a.decode(c),b)}}function p(a){return function(b){if(Array.isArray(b))throw Error(`Failed to serialize message: expected object with ${a.name} structure, got array instead`);let c=a.fromObject(b);return a.encode(c).finish()}}function q(a){return(a||[]).reduce((a,b)=>{for(let[c,d]of Object.entries(b))"uninterpreted_option"===c?a.uninterpreted_option.push(b.uninterpreted_option):a[c]=d;return a},{deprecated:!1,idempotency_level:e.IDEMPOTENCY_UNKNOWN,uninterpreted_option:[]})}function r(a,b,c,d){let e=a.resolvedRequestType,g=a.resolvedResponseType;return{path:"/"+b+"/"+a.name,requestStream:!!a.requestStream,responseStream:!!a.responseStream,requestSerialize:p(e),requestDeserialize:o(e,c),responseSerialize:p(g),responseDeserialize:o(g,c),originalName:f(a.name),requestType:t(e,d),responseType:t(g,d),options:q(a.parsedOptions)}}function s(a,b,c,d){let e={};for(let f of a.methodsArray)e[f.name]=r(f,b,c,d);return e}function t(a,b){let c=a.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:c.$type.toObject(c,j),fileDescriptorProtos:b}}function u(a,b){let c=a.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:c.$type.toObject(c,j),fileDescriptorProtos:b}}function v(a,b,c,d){if(a instanceof g.Service)return s(a,b,c,d);if(a instanceof g.Type)return t(a,d);if(a instanceof g.Enum)return u(a,d);throw Error("Type mismatch in reflection object handling")}function w(a,b){let c={};a.resolveAll();let d=a.toDescriptor("proto3").file.map(a=>Buffer.from(h.FileDescriptorProto.encode(a).finish()));for(let[e,f]of n(a,""))c[e]=v(f,e,b,d);return c}function x(a,b){b=b||{};let c=g.Root.fromDescriptor(a);return c.resolveAll(),w(c,b)}d=function(a,b){return(0,i.loadProtosWithOptions)(a,b).then(a=>w(a,b))},b.Yi=function(a,b){return w((0,i.loadProtosWithOptionsSync)(a,b),b)},b.rS=function(a,b){b=b||{};let c=g.Root.fromJSON(a);return c.resolveAll(),w(c,b)},d=function(a,b){return x(h.FileDescriptorSet.decode(a),b)},d=function(a,b){return x(h.FileDescriptorSet.fromObject(a),b)},(0,i.addCommonProtos)()},47989:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.deadlineToString=b.getRelativeTimeout=b.getDeadlineTimeoutString=b.minDeadline=void 0,b.minDeadline=function(...a){let b=1/0;for(let c of a){let a=c instanceof Date?c.getTime():c;a<b&&(b=a)}return b};let c=[["m",1],["S",1e3],["M",6e4],["H",36e5]];b.getDeadlineTimeoutString=function(a){let b=new Date().getTime();a instanceof Date&&(a=a.getTime());let d=Math.max(a-b,0);for(let[a,b]of c){let c=d/b;if(c<1e8)return String(Math.ceil(c))+a}throw Error("Deadline is too far in the future")};let d=0x7fffffff;b.getRelativeTimeout=function(a){let b=(a instanceof Date?a.getTime():a)-new Date().getTime();return b<0?0:b>d?1/0:b},b.deadlineToString=function(a){if(a instanceof Date)return a.toISOString();{let b=new Date(a);return Number.isNaN(b.getTime())?""+a:b.toISOString()}}},48888:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.LoadBalancingCall=void 0;let d=c(13678),e=c(74216),f=c(47989),g=c(39316),h=c(34979),i=c(30999),j=c(49152),k=c(88174),l=c(73496),m="load_balancing_call";class n{constructor(a,b,c,d,e,f,g){var h,j;this.channel=a,this.callConfig=b,this.methodName=c,this.host=d,this.credentials=e,this.deadline=f,this.callNumber=g,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;let k=this.methodName.split("/"),l="";k.length>=2&&(l=k[1]);let m=null!=(j=null==(h=(0,i.splitHostPort)(this.host))?void 0:h.host)?j:"localhost";this.serviceUrl=`https://${m}/${l}`}trace(a){j.trace(e.LogVerbosity.DEBUG,m,"["+this.callNumber+"] "+a)}outputStatus(a,b){var c,d;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+a.code+' details="'+a.details+'"');let e=Object.assign(Object.assign({},a),{progress:b});null==(c=this.listener)||c.onReceiveStatus(e),null==(d=this.onCallEnded)||d.call(this,e.code)}}doPick(){var a,b;if(this.ended)return;if(!this.metadata)throw Error("doPick called before start");this.trace("Pick called");let c=this.channel.doPick(this.metadata,this.callConfig.pickInformation),i=c.subchannel?"("+c.subchannel.getChannelzRef().id+") "+c.subchannel.getAddress():""+c.subchannel;switch(this.trace("Pick result: "+h.PickResultType[c.pickResultType]+" subchannel: "+i+" status: "+(null==(a=c.status)?void 0:a.code)+" "+(null==(b=c.status)?void 0:b.details)),c.pickResultType){case h.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(a=>{var b,h,j;if(this.ended)return void this.trace("Credentials metadata generation finished after call ended");let k=this.metadata.clone();if(k.merge(a),k.get("authorization").length>1&&this.outputStatus({code:e.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new g.Metadata},"PROCESSED"),c.subchannel.getConnectivityState()!==d.ConnectivityState.READY){this.trace("Picked subchannel "+i+" has state "+d.ConnectivityState[c.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&k.set("grpc-timeout",(0,f.getDeadlineTimeoutString)(this.deadline));try{this.child=c.subchannel.getRealSubchannel().createCall(k,this.host,this.methodName,{onReceiveMetadata:a=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(a)},onReceiveMessage:a=>{this.trace("Received message"),this.listener.onReceiveMessage(a)},onReceiveStatus:a=>{this.trace("Received status"),a.rstCode===l.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(a,"REFUSED"):this.outputStatus(a,"PROCESSED")}})}catch(a){this.trace("Failed to start call on picked subchannel "+i+" with error "+a.message),this.outputStatus({code:e.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+a.message,metadata:new g.Metadata},"NOT_STARTED");return}null==(h=(b=this.callConfig).onCommitted)||h.call(b),null==(j=c.onCallStarted)||j.call(c),this.onCallEnded=c.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},a=>{let{code:b,details:c}=(0,k.restrictControlPlaneStatusCode)("number"==typeof a.code?a.code:e.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${a.message}`);this.outputStatus({code:b,details:c,metadata:new g.Metadata},"PROCESSED")});break;case h.PickResultType.DROP:let{code:j,details:m}=(0,k.restrictControlPlaneStatusCode)(c.status.code,c.status.details);setImmediate(()=>{this.outputStatus({code:j,details:m,metadata:c.status.metadata},"DROP")});break;case h.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:a,details:b}=(0,k.restrictControlPlaneStatusCode)(c.status.code,c.status.details);setImmediate(()=>{this.outputStatus({code:a,details:b,metadata:c.status.metadata},"PROCESSED")})}break;case h.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(a,b){var c;this.trace("cancelWithStatus code: "+a+' details: "'+b+'"'),null==(c=this.child)||c.cancelWithStatus(a,b),this.outputStatus({code:a,details:b,metadata:new g.Metadata},"PROCESSED")}getPeer(){var a,b;return null!=(b=null==(a=this.child)?void 0:a.getPeer())?b:this.channel.getTarget()}start(a,b){this.trace("start called"),this.listener=b,this.metadata=a,this.doPick()}sendMessageWithContext(a,b){this.trace("write() called with message of length "+b.length),this.child?this.child.sendMessageWithContext(a,b):this.pendingMessage={context:a,message:b}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(a){throw Error("Method not implemented.")}getCallNumber(){return this.callNumber}}b.LoadBalancingCall=n},49152:(a,b,c)=>{"use strict";var d,e,f,g;Object.defineProperty(b,"__esModule",{value:!0}),b.isTracerEnabled=b.trace=b.log=b.setLoggerVerbosity=b.setLogger=b.getLogger=void 0;let h=c(74216),i=c(19771),j=c(28592).rE,k={error:(a,...b)=>{console.error("E "+a,...b)},info:(a,...b)=>{console.error("I "+a,...b)},debug:(a,...b)=>{console.error("D "+a,...b)}},l=h.LogVerbosity.ERROR;switch((null!=(e=null!=(d=process.env.GRPC_NODE_VERBOSITY)?d:process.env.GRPC_VERBOSITY)?e:"").toUpperCase()){case"DEBUG":l=h.LogVerbosity.DEBUG;break;case"INFO":l=h.LogVerbosity.INFO;break;case"ERROR":l=h.LogVerbosity.ERROR;break;case"NONE":l=h.LogVerbosity.NONE}b.getLogger=()=>k,b.setLogger=a=>{k=a},b.setLoggerVerbosity=a=>{l=a},b.log=(a,...b)=>{let c;if(a>=l){switch(a){case h.LogVerbosity.DEBUG:c=k.debug;break;case h.LogVerbosity.INFO:c=k.info;break;case h.LogVerbosity.ERROR:c=k.error}c||(c=k.error),c&&c.bind(k)(...b)}};let m=null!=(g=null!=(f=process.env.GRPC_NODE_TRACE)?f:process.env.GRPC_TRACE)?g:"",n=new Set,o=new Set;for(let a of m.split(","))a.startsWith("-")?o.add(a.substring(1)):n.add(a);let p=n.has("all");function q(a,c,d){r(c)&&(0,b.log)(a,new Date().toISOString()+" | v"+j+" "+i.pid+" | "+c+" | "+d)}function r(a){return!o.has(a)&&(p||n.has(a))}b.trace=q,b.isTracerEnabled=r},49316:(a,b,c)=>{"use strict";a.exports=g;var d=c(99408);((g.prototype=Object.create(d.prototype)).constructor=g).className="MapField";var e=c(18657),f=c(90290);function g(a,b,c,e,g,h){if(d.call(this,a,b,e,void 0,void 0,g,h),!f.isString(c))throw TypeError("keyType must be a string");this.keyType=c,this.resolvedKeyType=null,this.map=!0}g.fromJSON=function(a,b){return new g(a,b.id,b.keyType,b.type,b.options,b.comment)},g.prototype.toJSON=function(a){var b=!!a&&!!a.keepComments;return f.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",b?this.comment:void 0])},g.prototype.resolve=function(){if(this.resolved)return this;if(void 0===e.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return d.prototype.resolve.call(this)},g.d=function(a,b,c){return"function"==typeof c?c=f.decorateType(c).name:c&&"object"==typeof c&&(c=f.decorateEnum(c).name),function(d,e){f.decorateType(d.constructor).add(new g(e,a,b,c))}}},54447:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.BackoffTimeout=void 0;let c=1e3,d=1.6,e=12e4,f=.2;function g(a,b){return Math.random()*(b-a)+a}class h{constructor(a,b){this.callback=a,this.initialDelay=c,this.multiplier=d,this.maxDelay=e,this.jitter=f,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,b&&(b.initialDelay&&(this.initialDelay=b.initialDelay),b.multiplier&&(this.multiplier=b.multiplier),b.jitter&&(this.jitter=b.jitter),b.maxDelay&&(this.maxDelay=b.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(a){var b,c;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},a),this.hasRef||null==(c=(b=this.timerId).unref)||c.call(b)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let a=Math.min(this.nextDelay*this.multiplier,this.maxDelay),b=a*this.jitter;this.nextDelay=a+g(-b,b)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let a=new Date,b=this.startTime;b.setMilliseconds(b.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),a<b?this.runTimer(b.getTime()-a.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var a,b;this.hasRef=!0,null==(b=(a=this.timerId).ref)||b.call(a)}unref(){var a,b;this.hasRef=!1,null==(b=(a=this.timerId).unref)||b.call(a)}getEndTime(){return this.endTime}}b.BackoffTimeout=h},54900:(a,b,c)=>{"use strict";var d=a.exports=c(75005);d.build="full",d.tokenize=c(76043),d.parse=c(9259),d.common=c(72451),d.Root._configure(d.Type,d.parse,d.common)},55274:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.addCommonProtos=b.loadProtosWithOptionsSync=b.loadProtosWithOptions=void 0;let d=c(29021),e=c(33873),f=c(64869);function g(a,b){let c=a.resolvePath;a.resolvePath=(a,f)=>{if(e.isAbsolute(f))return f;for(let a of b){let b=e.join(a,f);try{return d.accessSync(b,d.constants.R_OK),b}catch(a){continue}}return process.emitWarning(`${f} not found in any of the include paths ${b}`),c(a,f)}}b.loadProtosWithOptions=async function(a,b){let c=new f.Root;if((b=b||{}).includeDirs){if(!Array.isArray(b.includeDirs))return Promise.reject(Error("The includeDirs option must be an array"));g(c,b.includeDirs)}let d=await c.load(a,b);return d.resolveAll(),d},b.loadProtosWithOptionsSync=function(a,b){let c=new f.Root;if((b=b||{}).includeDirs){if(!Array.isArray(b.includeDirs))throw Error("The includeDirs option must be an array");g(c,b.includeDirs)}let d=c.loadSync(a,b);return d.resolveAll(),d},b.addCommonProtos=function(){let a=c(82566),b=c(97659),d=c(56271),e=c(96138);f.common("api",a.nested.google.nested.protobuf.nested),f.common("descriptor",b.nested.google.nested.protobuf.nested),f.common("source_context",d.nested.google.nested.protobuf.nested),f.common("type",e.nested.google.nested.protobuf.nested)}},56271:a=>{"use strict";a.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')},58130:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ChannelImplementation=void 0;let d=c(46401),e=c(4198);class f{constructor(a,b,c){if("string"!=typeof a)throw TypeError("Channel target must be a string");if(!(b instanceof d.ChannelCredentials))throw TypeError("Channel credentials must be a ChannelCredentials object");if(c&&"object"!=typeof c)throw TypeError("Channel options must be an object");this.internalChannel=new e.InternalChannel(a,b,c)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(a){return this.internalChannel.getConnectivityState(a)}watchConnectivityState(a,b,c){this.internalChannel.watchConnectivityState(a,b,c)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(a,b,c,d,e){if("string"!=typeof a)throw TypeError("Channel#createCall: method must be a string");if(!("number"==typeof b||b instanceof Date))throw TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(a,b,c,d,e)}}b.ChannelImplementation=f},59665:(a,b,c)=>{"use strict";a.exports=l;var d,e=c(60054),f=e.LongBits,g=e.base64,h=e.utf8;function i(a,b,c){this.fn=a,this.len=b,this.next=void 0,this.val=c}function j(){}function k(a){this.head=a.head,this.tail=a.tail,this.len=a.len,this.next=a.states}function l(){this.len=0,this.head=new i(j,0,0),this.tail=this.head,this.states=null}var m=function(){return e.Buffer?function(){return(l.create=function(){return new d})()}:function(){return new l}};function n(a,b,c){b[c]=255&a}function o(a,b,c){for(;a>127;)b[c++]=127&a|128,a>>>=7;b[c]=a}function p(a,b){this.len=a,this.next=void 0,this.val=b}function q(a,b,c){for(;a.hi;)b[c++]=127&a.lo|128,a.lo=(a.lo>>>7|a.hi<<25)>>>0,a.hi>>>=7;for(;a.lo>127;)b[c++]=127&a.lo|128,a.lo=a.lo>>>7;b[c++]=a.lo}function r(a,b,c){b[c]=255&a,b[c+1]=a>>>8&255,b[c+2]=a>>>16&255,b[c+3]=a>>>24}l.create=m(),l.alloc=function(a){return new e.Array(a)},e.Array!==Array&&(l.alloc=e.pool(l.alloc,e.Array.prototype.subarray)),l.prototype._push=function(a,b,c){return this.tail=this.tail.next=new i(a,b,c),this.len+=b,this},p.prototype=Object.create(i.prototype),p.prototype.fn=o,l.prototype.uint32=function(a){return this.len+=(this.tail=this.tail.next=new p((a>>>=0)<128?1:a<16384?2:a<2097152?3:a<0x10000000?4:5,a)).len,this},l.prototype.int32=function(a){return a<0?this._push(q,10,f.fromNumber(a)):this.uint32(a)},l.prototype.sint32=function(a){return this.uint32((a<<1^a>>31)>>>0)},l.prototype.uint64=function(a){var b=f.from(a);return this._push(q,b.length(),b)},l.prototype.int64=l.prototype.uint64,l.prototype.sint64=function(a){var b=f.from(a).zzEncode();return this._push(q,b.length(),b)},l.prototype.bool=function(a){return this._push(n,1,+!!a)},l.prototype.fixed32=function(a){return this._push(r,4,a>>>0)},l.prototype.sfixed32=l.prototype.fixed32,l.prototype.fixed64=function(a){var b=f.from(a);return this._push(r,4,b.lo)._push(r,4,b.hi)},l.prototype.sfixed64=l.prototype.fixed64,l.prototype.float=function(a){return this._push(e.float.writeFloatLE,4,a)},l.prototype.double=function(a){return this._push(e.float.writeDoubleLE,8,a)};var s=e.Array.prototype.set?function(a,b,c){b.set(a,c)}:function(a,b,c){for(var d=0;d<a.length;++d)b[c+d]=a[d]};l.prototype.bytes=function(a){var b=a.length>>>0;if(!b)return this._push(n,1,0);if(e.isString(a)){var c=l.alloc(b=g.length(a));g.decode(a,c,0),a=c}return this.uint32(b)._push(s,b,a)},l.prototype.string=function(a){var b=h.length(a);return b?this.uint32(b)._push(h.write,b,a):this._push(n,1,0)},l.prototype.fork=function(){return this.states=new k(this),this.head=this.tail=new i(j,0,0),this.len=0,this},l.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new i(j,0,0),this.len=0),this},l.prototype.ldelim=function(){var a=this.head,b=this.tail,c=this.len;return this.reset().uint32(c),c&&(this.tail.next=a.next,this.tail=b,this.len+=c),this},l.prototype.finish=function(){for(var a=this.head.next,b=this.constructor.alloc(this.len),c=0;a;)a.fn(a.val,b,c),c+=a.len,a=a.next;return b},l._configure=function(a){d=a,l.create=m(),d._configure()}},60054:function(a,b,c){"use strict";var d=b;function e(a,b,c){for(var d=Object.keys(b),e=0;e<d.length;++e)void 0!==a[d[e]]&&c||(a[d[e]]=b[d[e]]);return a}function f(a){function b(a,c){if(!(this instanceof b))return new b(a,c);Object.defineProperty(this,"message",{get:function(){return a}}),Error.captureStackTrace?Error.captureStackTrace(this,b):Object.defineProperty(this,"stack",{value:Error().stack||""}),c&&e(this,c)}return b.prototype=Object.create(Error.prototype,{constructor:{value:b,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return a},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),b}d.asPromise=c(81165),d.base64=c(27203),d.EventEmitter=c(29178),d.float=c(24286),d.inquire=c(32497),d.utf8=c(63363),d.pool=c(90146),d.LongBits=c(65531),d.isNode=!!("undefined"!=typeof global&&global&&global.process&&global.process.versions&&global.process.versions.node),d.global=d.isNode&&global||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,d.emptyArray=Object.freeze?Object.freeze([]):[],d.emptyObject=Object.freeze?Object.freeze({}):{},d.isInteger=Number.isInteger||function(a){return"number"==typeof a&&isFinite(a)&&Math.floor(a)===a},d.isString=function(a){return"string"==typeof a||a instanceof String},d.isObject=function(a){return a&&"object"==typeof a},d.isset=d.isSet=function(a,b){var c=a[b];return!!(null!=c&&a.hasOwnProperty(b))&&("object"!=typeof c||(Array.isArray(c)?c.length:Object.keys(c).length)>0)},d.Buffer=function(){try{var a=d.inquire("buffer").Buffer;return a.prototype.utf8Write?a:null}catch(a){return null}}(),d._Buffer_from=null,d._Buffer_allocUnsafe=null,d.newBuffer=function(a){return"number"==typeof a?d.Buffer?d._Buffer_allocUnsafe(a):new d.Array(a):d.Buffer?d._Buffer_from(a):"undefined"==typeof Uint8Array?a:new Uint8Array(a)},d.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,d.Long=d.global.dcodeIO&&d.global.dcodeIO.Long||d.global.Long||d.inquire("long"),d.key2Re=/^true|false|0|1$/,d.key32Re=/^-?(?:0|[1-9][0-9]*)$/,d.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,d.longToHash=function(a){return a?d.LongBits.from(a).toHash():d.LongBits.zeroHash},d.longFromHash=function(a,b){var c=d.LongBits.fromHash(a);return d.Long?d.Long.fromBits(c.lo,c.hi,b):c.toNumber(!!b)},d.merge=e,d.lcFirst=function(a){return a.charAt(0).toLowerCase()+a.substring(1)},d.newError=f,d.ProtocolError=f("ProtocolError"),d.oneOfGetter=function(a){for(var b={},c=0;c<a.length;++c)b[a[c]]=1;return function(){for(var a=Object.keys(this),c=a.length-1;c>-1;--c)if(1===b[a[c]]&&void 0!==this[a[c]]&&null!==this[a[c]])return a[c]}},d.oneOfSetter=function(a){return function(b){for(var c=0;c<a.length;++c)a[c]!==b&&delete this[a[c]]}},d.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},d._configure=function(){var a=d.Buffer;if(!a){d._Buffer_from=d._Buffer_allocUnsafe=null;return}d._Buffer_from=a.from!==Uint8Array.from&&a.from||function(b,c){return new a(b,c)},d._Buffer_allocUnsafe=a.allocUnsafe||function(b){return new a(b)}}},60649:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.isDuration=b.durationToMs=b.msToDuration=void 0,b.msToDuration=function(a){return{seconds:a/1e3|0,nanos:a%1e3*1e6|0}},b.durationToMs=function(a){return 1e3*a.seconds+a.nanos/1e6|0},b.isDuration=function(a){return"number"==typeof a.seconds&&"number"==typeof a.nanos}},60967:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\atifm\\\\OneDrive\\\\Desktop\\\\portfolio\\\\src\\\\app\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\atifm\\OneDrive\\Desktop\\portfolio\\src\\app\\page.tsx","default")},61134:(a,b,c)=>{"use strict";a.exports=f;var d=c(59665);(f.prototype=Object.create(d.prototype)).constructor=f;var e=c(60054);function f(){d.call(this)}function g(a,b,c){a.length<40?e.utf8.write(a,b,c):b.utf8Write?b.utf8Write(a,c):b.write(a,c)}f._configure=function(){f.alloc=e._Buffer_allocUnsafe,f.writeBytesBuffer=e.Buffer&&e.Buffer.prototype instanceof Uint8Array&&"set"===e.Buffer.prototype.set.name?function(a,b,c){b.set(a,c)}:function(a,b,c){if(a.copy)a.copy(b,c,0,a.length);else for(var d=0;d<a.length;)b[c++]=a[d++]}},f.prototype.bytes=function(a){e.isString(a)&&(a=e._Buffer_from(a,"base64"));var b=a.length>>>0;return this.uint32(b),b&&this._push(f.writeBytesBuffer,b,a),this},f.prototype.string=function(a){var b=e.Buffer.byteLength(a);return this.uint32(b),b&&this._push(g,b,a),this},f._configure()},62262:(a,b)=>{"use strict";var c;Object.defineProperty(b,"__esModule",{value:!0}),b.CompressionAlgorithms=void 0,function(a){a[a.identity=0]="identity",a[a.deflate=1]="deflate",a[a.gzip=2]="gzip"}(c||(b.CompressionAlgorithms=c={}))},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63363:(a,b)=>{"use strict";var c=b;c.length=function(a){for(var b=0,c=0,d=0;d<a.length;++d)(c=a.charCodeAt(d))<128?b+=1:c<2048?b+=2:(64512&c)==55296&&(64512&a.charCodeAt(d+1))==56320?(++d,b+=4):b+=3;return b},c.read=function(a,b,c){if(c-b<1)return"";for(var d,e=null,f=[],g=0;b<c;)(d=a[b++])<128?f[g++]=d:d>191&&d<224?f[g++]=(31&d)<<6|63&a[b++]:d>239&&d<365?(d=((7&d)<<18|(63&a[b++])<<12|(63&a[b++])<<6|63&a[b++])-65536,f[g++]=55296+(d>>10),f[g++]=56320+(1023&d)):f[g++]=(15&d)<<12|(63&a[b++])<<6|63&a[b++],g>8191&&((e||(e=[])).push(String.fromCharCode.apply(String,f)),g=0);return e?(g&&e.push(String.fromCharCode.apply(String,f.slice(0,g))),e.join("")):String.fromCharCode.apply(String,f.slice(0,g))},c.write=function(a,b,c){for(var d,e,f=c,g=0;g<a.length;++g)(d=a.charCodeAt(g))<128?b[c++]=d:(d<2048?b[c++]=d>>6|192:((64512&d)==55296&&(64512&(e=a.charCodeAt(g+1)))==56320?(d=65536+((1023&d)<<10)+(1023&e),++g,b[c++]=d>>18|240,b[c++]=d>>12&63|128):b[c++]=d>>12|224,b[c++]=d>>6&63|128),b[c++]=63&d|128);return c-f}},64432:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.validateLoadBalancingConfig=b.getFirstUsableConfig=b.isLoadBalancerNameRegistered=b.createLoadBalancer=b.registerDefaultLoadBalancerType=b.registerLoadBalancerType=b.createChildChannelControlHelper=void 0,b.createChildChannelControlHelper=function(a,b){var c,d,e,f,g,h,i,j,k,l;return{createSubchannel:null!=(d=null==(c=b.createSubchannel)?void 0:c.bind(b))?d:a.createSubchannel.bind(a),updateState:null!=(f=null==(e=b.updateState)?void 0:e.bind(b))?f:a.updateState.bind(a),requestReresolution:null!=(h=null==(g=b.requestReresolution)?void 0:g.bind(b))?h:a.requestReresolution.bind(a),addChannelzChild:null!=(j=null==(i=b.addChannelzChild)?void 0:i.bind(b))?j:a.addChannelzChild.bind(a),removeChannelzChild:null!=(l=null==(k=b.removeChannelzChild)?void 0:k.bind(b))?l:a.removeChannelzChild.bind(a)}};let c={},d=null;b.registerLoadBalancerType=function(a,b,d){c[a]={LoadBalancer:b,LoadBalancingConfig:d}},b.registerDefaultLoadBalancerType=function(a){d=a},b.createLoadBalancer=function(a,b){let d=a.getLoadBalancerName();return d in c?new c[d].LoadBalancer(b):null},b.isLoadBalancerNameRegistered=function(a){return a in c},b.getFirstUsableConfig=function(a,b=!1){for(let b of a)if(b.getLoadBalancerName()in c)return b;return b&&d?new c[d].LoadBalancingConfig:null},b.validateLoadBalancingConfig=function(a){if(null===a||"object"!=typeof a)throw Error("Load balancing config must be an object");let b=Object.keys(a);if(1!==b.length)throw Error("Provided load balancing config has multiple conflicting entries");let d=b[0];if(d in c)return c[d].LoadBalancingConfig.createFromJson(a[d]);throw Error(`Unrecognized load balancing config name ${d}`)}},64869:(a,b,c)=>{"use strict";a.exports=c(54900)},65531:(a,b,c)=>{"use strict";a.exports=e;var d=c(60054);function e(a,b){this.lo=a>>>0,this.hi=b>>>0}var f=e.zero=new e(0,0);f.toNumber=function(){return 0},f.zzEncode=f.zzDecode=function(){return this},f.length=function(){return 1};var g=e.zeroHash="\0\0\0\0\0\0\0\0";e.fromNumber=function(a){if(0===a)return f;var b=a<0;b&&(a=-a);var c=a>>>0,d=(a-c)/0x100000000>>>0;return b&&(d=~d>>>0,c=~c>>>0,++c>0xffffffff&&(c=0,++d>0xffffffff&&(d=0))),new e(c,d)},e.from=function(a){if("number"==typeof a)return e.fromNumber(a);if(d.isString(a))if(!d.Long)return e.fromNumber(parseInt(a,10));else a=d.Long.fromString(a);return a.low||a.high?new e(a.low>>>0,a.high>>>0):f},e.prototype.toNumber=function(a){if(!a&&this.hi>>>31){var b=~this.lo+1>>>0,c=~this.hi>>>0;return b||(c=c+1>>>0),-(b+0x100000000*c)}return this.lo+0x100000000*this.hi},e.prototype.toLong=function(a){return d.Long?new d.Long(0|this.lo,0|this.hi,!!a):{low:0|this.lo,high:0|this.hi,unsigned:!!a}};var h=String.prototype.charCodeAt;e.fromHash=function(a){return a===g?f:new e((h.call(a,0)|h.call(a,1)<<8|h.call(a,2)<<16|h.call(a,3)<<24)>>>0,(h.call(a,4)|h.call(a,5)<<8|h.call(a,6)<<16|h.call(a,7)<<24)>>>0)},e.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},e.prototype.zzEncode=function(){var a=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^a)>>>0,this.lo=(this.lo<<1^a)>>>0,this},e.prototype.zzDecode=function(){var a=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^a)>>>0,this.hi=(this.hi>>>1^a)>>>0,this},e.prototype.length=function(){var a=this.lo,b=(this.lo>>>28|this.hi<<4)>>>0,c=this.hi>>>24;return 0===c?0===b?a<16384?a<128?1:2:a<2097152?3:4:b<16384?b<128?5:6:b<2097152?7:8:c<128?9:10}},65724:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>D.a,__next_app__:()=>J,handler:()=>L,pages:()=>I,routeModule:()=>K,tree:()=>H});var d=c(49754),e=c(9117),f=c(46595),g=c(32324),h=c(39326),i=c(38928),j=c(20175),k=c(12),l=c(54290),m=c(12696),n=c(82802),o=c(77533),p=c(45229),q=c(32822),r=c(261),s=c(26453),t=c(52474),u=c(26713),v=c(51356),w=c(62685),x=c(36225),y=c(63446),z=c(2762),A=c(45742),B=c(86439),C=c(81170),D=c.n(C),E=c(62506),F=c(91203),G={};for(let a in E)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(G[a]=()=>E[a]);c.d(b,G);let H={children:["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,60967)),"C:\\Users\\atifm\\OneDrive\\Desktop\\portfolio\\src\\app\\page.tsx"],metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,33044))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(c.bind(c,51472)),"C:\\Users\\atifm\\OneDrive\\Desktop\\portfolio\\src\\app\\layout.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,81170,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,87028,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,90461,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,32768,23)),"next/dist/client/components/builtin/unauthorized.js"],metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,33044))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,I=["C:\\Users\\atifm\\OneDrive\\Desktop\\portfolio\\src\\app\\page.tsx"],J={require:c,loadChunk:()=>Promise.resolve()},K=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:H},distDir:".next",relativeProjectDir:""});async function L(a,b,d){var C;let G="/page";"/index"===G&&(G="/");let M=!1,N=(0,h.getRequestMeta)(a,"postponed"),O=(0,h.getRequestMeta)(a,"minimalMode"),P=await K.prepare(a,b,{srcPage:G,multiZoneDraftMode:M});if(!P)return b.statusCode=400,b.end("Bad Request"),null==d.waitUntil||d.waitUntil.call(d,Promise.resolve()),null;let{buildId:Q,query:R,params:S,parsedUrl:T,pageIsDynamic:U,buildManifest:V,nextFontManifest:W,reactLoadableManifest:X,serverActionsManifest:Y,clientReferenceManifest:Z,subresourceIntegrityManifest:$,prerenderManifest:_,isDraftMode:aa,resolvedPathname:ab,revalidateOnlyGenerated:ac,routerServerContext:ad,nextConfig:ae,interceptionRoutePatterns:af}=P,ag=T.pathname||"/",ah=(0,r.normalizeAppPath)(G),{isOnDemandRevalidate:ai}=P,aj=K.match(ag,_),ak=!!_.routes[ab],al=!!(aj||ak||_.routes[ah]),am=a.headers["user-agent"]||"",an=(0,u.getBotType)(am),ao=(0,p.isHtmlBotRequest)(a),ap=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??"1"===a.headers[t.NEXT_ROUTER_PREFETCH_HEADER],aq=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[t.RSC_HEADER],ar=(0,s.getIsPossibleServerAction)(a),as=(0,m.checkIsAppPPREnabled)(ae.experimental.ppr),at=!1,au=!1,av=as&&((null==(C=_.routes[ah]??_.dynamicRoutes[ah])?void 0:C.renderingMode)==="PARTIALLY_STATIC"||at&&(!0===K.isDev||(null==ad?void 0:ad.experimentalTestProxy)===!0)),aw=at&&av,ax=aw&&!0===K.isDev,ay=au&&av,az=av?N:void 0,aA=av&&aq&&!ap,aB=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),aC=!am||(0,p.shouldServeStreamingMetadata)(am,ae.htmlLimitedBots);ao&&av&&(al=!1,aC=!1);let aD=!0===K.isDev||!al||"string"==typeof N||aA,aE=ao&&av,aF=null;aa||!al||aD||ar||az||aA||(aF=ab);let aG=aF;!aG&&K.isDev&&(aG=ab),K.isDev||aa||!al||!aq||aA||(0,k.d)(a.headers);let aH={...E,tree:H,pages:I,GlobalError:D(),handler:L,routeModule:K,__next_app__:J};Y&&Z&&(0,o.setReferenceManifestsSingleton)({page:G,clientReferenceManifest:Z,serverActionsManifest:Y,serverModuleMap:(0,q.createServerModuleMap)({serverActionsManifest:Y})});let aI=a.method||"GET",aJ=(0,g.getTracer)(),aK=aJ.getActiveScopeSpan();try{let f=K.getVaryHeader(ab,af);b.setHeader("Vary",f);let k=async(c,d)=>{let e=new l.NodeNextRequest(a),f=new l.NodeNextResponse(b);return K.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aJ.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aI} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aI} ${a.url}`)})},m=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:R,params:S,page:ah,sharedContext:{buildId:Q},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aH,Component:(0,j.T)(aH),params:S,routeModule:K,page:G,postponed:f,shouldWaitOnAllReady:aE,serveStreamingMetadata:aC,supportsDynamicResponse:"string"==typeof f||aD,buildManifest:V,nextFontManifest:W,reactLoadableManifest:X,subresourceIntegrityManifest:$,serverActionsManifest:Y,clientReferenceManifest:Z,setIsrStatus:null==ad?void 0:ad.setIsrStatus,dir:c(33873).join(process.cwd(),K.relativeProjectDir),isDraftMode:aa,isRevalidate:al&&!f&&!aA,botType:an,isOnDemandRevalidate:ai,isPossibleServerAction:ar,assetPrefix:ae.assetPrefix,nextConfigOutput:ae.output,crossOrigin:ae.crossOrigin,trailingSlash:ae.trailingSlash,previewProps:_.preview,deploymentId:ae.deploymentId,enableTainting:ae.experimental.taint,htmlLimitedBots:ae.htmlLimitedBots,devtoolSegmentExplorer:ae.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ae.reactMaxHeadersLength,multiZoneDraftMode:M,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ae.experimental.cacheLife,basePath:ae.basePath,serverActions:ae.experimental.serverActions,...aw||ax?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:ax}:{},experimental:{isRoutePPREnabled:av,expireTime:ae.expireTime,staleTimes:ae.experimental.staleTimes,cacheComponents:!!ae.experimental.cacheComponents,clientSegmentCache:!!ae.experimental.clientSegmentCache,clientParamParsing:!!ae.experimental.clientParamParsing,dynamicOnHover:!!ae.experimental.dynamicOnHover,inlineCss:!!ae.experimental.inlineCss,authInterrupts:!!ae.experimental.authInterrupts,clientTraceMetadata:ae.experimental.clientTraceMetadata||[]},waitUntil:d.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>K.onRequestError(a,b,d,ad),err:(0,h.getRequestMeta)(a,"invokeError"),dev:K.isDev}},l=await k(e,i),{metadata:m}=l,{cacheControl:n,headers:o={},fetchTags:p}=m;if(p&&(o[y.NEXT_CACHE_TAGS_HEADER]=p),a.fetchMetrics=m.fetchMetrics,al&&(null==n?void 0:n.revalidate)===0&&!K.isDev&&!av){let a=m.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${ab}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:v.CachedRouteKind.APP_PAGE,html:l,headers:o,rscData:m.flightData,postponed:m.postponed,status:m.statusCode,segmentData:m.segmentData},cacheControl:n}},o=async({hasResolved:c,previousCacheEntry:f,isRevalidating:g,span:i})=>{let j,k=!1===K.isDev,l=c||b.writableEnded;if(ai&&ac&&!f&&!O)return(null==ad?void 0:ad.render404)?await ad.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(aj&&(j=(0,w.parseFallbackField)(aj.fallback)),j===w.FallbackMode.PRERENDER&&(0,u.isBot)(am)&&(!av||ao)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),(null==f?void 0:f.isStale)===-1&&(ai=!0),ai&&(j!==w.FallbackMode.NOT_FOUND||f)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),!O&&j!==w.FallbackMode.BLOCKING_STATIC_RENDER&&aG&&!l&&!aa&&U&&(k||!ak)){let b;if((k||aj)&&j===w.FallbackMode.NOT_FOUND)throw new B.NoFallbackError;if(av&&!aq){let c="string"==typeof(null==aj?void 0:aj.fallback)?aj.fallback:k?ah:null;if(b=await K.handleResponse({cacheKey:c,req:a,nextConfig:ae,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:_,isRoutePPREnabled:av,responseGenerator:async()=>m({span:i,postponed:void 0,fallbackRouteParams:k||ay?(0,n.u)(ah):null}),waitUntil:d.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let o=ai||g||!az?void 0:az;if((aw||ax)&&void 0!==o)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:v.CachedRouteKind.PAGES,html:x.default.EMPTY,pageData:{},headers:void 0,status:void 0}};let p=U&&av&&((0,h.getRequestMeta)(a,"renderFallbackShell")||ay)?(0,n.u)(ag):null;return m({span:i,postponed:o,fallbackRouteParams:p})},p=async c=>{var f,g,i,j,k;let l,n=await K.handleResponse({cacheKey:aF,responseGenerator:a=>o({span:c,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:ai,isRoutePPREnabled:av,req:a,nextConfig:ae,prerenderManifest:_,waitUntil:d.waitUntil});if(aa&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),K.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!n){if(aF)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(f=n.value)?void 0:f.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(i=n.value)?void 0:i.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let p="string"==typeof n.value.postponed;al&&!aA&&(!p||ap)&&(O||b.setHeader("x-nextjs-cache",ai?"REVALIDATED":n.isMiss?"MISS":n.isStale?"STALE":"HIT"),b.setHeader(t.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=n;if(az)l={revalidate:0,expire:void 0};else if(O&&aq&&!ap&&av)l={revalidate:0,expire:void 0};else if(!K.isDev)if(aa)l={revalidate:0,expire:void 0};else if(al){if(n.cacheControl)if("number"==typeof n.cacheControl.revalidate){if(n.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${n.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});l={revalidate:n.cacheControl.revalidate,expire:(null==(j=n.cacheControl)?void 0:j.expire)??ae.expireTime}}else l={revalidate:y.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(l={revalidate:0,expire:void 0});if(n.cacheControl=l,"string"==typeof aB&&(null==q?void 0:q.kind)===v.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(k=q.headers)?void 0:k[y.NEXT_CACHE_TAGS_HEADER];O&&al&&c&&"string"==typeof c&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(aB);return void 0!==d?(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:x.default.fromStatic(d,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl}):(b.statusCode=204,(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:x.default.EMPTY,cacheControl:n.cacheControl}))}let r=(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r({...n,value:{...n.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(p&&az)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(q.headers){let a={...q.headers};for(let[c,d]of(O&&al||delete a[y.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let s=null==(g=q.headers)?void 0:g[y.NEXT_CACHE_TAGS_HEADER];if(O&&al&&s&&"string"==typeof s&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,s),!q.status||aq&&av||(b.statusCode=q.status),!O&&q.status&&F.RedirectStatusCode[q.status]&&aq&&(b.statusCode=200),p&&b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"1"),aq&&!aa){if(void 0===q.rscData){if(q.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:q.html,cacheControl:aA?{revalidate:0,expire:void 0}:n.cacheControl})}return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:x.default.fromStatic(q.rscData,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl})}let u=q.html;if(!p||O||aq)return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:u,cacheControl:n.cacheControl});if(aw||ax)return u.push(new ReadableStream({start(a){a.enqueue(z.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}});let w=new TransformStream;return u.push(w.readable),m({span:c,postponed:q.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(w.writable)}).catch(a=>{w.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}})};if(!aK)return await aJ.withPropagatedContext(a.headers,()=>aJ.trace(i.BaseServerSpan.handleRequest,{spanName:`${aI} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aI,"http.target":a.url}},p));await p(aK)}catch(b){throw b instanceof B.NoFallbackError||await K.onRequestError(a,b,{routerKind:"App Router",routePath:G,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:al,isOnDemandRevalidate:ai})},ad),b}}},66565:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.StatusBuilder=void 0;class c{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(a){return this.code=a,this}withDetails(a){return this.details=a,this}withMetadata(a){return this.metadata=a,this}build(){let a={};return null!==this.code&&(a.code=this.code),null!==this.details&&(a.details=this.details),null!==this.metadata&&(a.metadata=this.metadata),a}}b.StatusBuilder=c},66666:(a,b)=>{var c,d=function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var b=null;try{b=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function c(a,b,c){this.low=0|a,this.high=0|b,this.unsigned=!!c}function d(a){return!0===(a&&a.__isLong__)}function e(a){var b=Math.clz32(a&-a);return a?31-b:b}c.prototype.__isLong__,Object.defineProperty(c.prototype,"__isLong__",{value:!0}),c.isLong=d;var f={},g={};function h(a,b){var c,d,e;if(b)return(a>>>=0,(e=0<=a&&a<256)&&(d=g[a]))?d:(c=j(a,0,!0),e&&(g[a]=c),c);return(a|=0,(e=-128<=a&&a<128)&&(d=f[a]))?d:(c=j(a,a<0?-1:0,!1),e&&(f[a]=c),c)}function i(a,b){if(isNaN(a))return b?s:r;if(b){if(a<0)return s;if(a>=o)return x}else{if(a<=-p)return y;if(a+1>=p)return w}return a<0?i(-a,b).neg():j(a%n|0,a/n|0,b)}function j(a,b,d){return new c(a,b,d)}c.fromInt=h,c.fromNumber=i,c.fromBits=j;var k=Math.pow;function l(a,b,c){if(0===a.length)throw Error("empty string");if("number"==typeof b?(c=b,b=!1):b=!!b,"NaN"===a||"Infinity"===a||"+Infinity"===a||"-Infinity"===a)return b?s:r;if((c=c||10)<2||36<c)throw RangeError("radix");if((d=a.indexOf("-"))>0)throw Error("interior hyphen");if(0===d)return l(a.substring(1),b,c).neg();for(var d,e=i(k(c,8)),f=r,g=0;g<a.length;g+=8){var h=Math.min(8,a.length-g),j=parseInt(a.substring(g,g+h),c);if(h<8){var m=i(k(c,h));f=f.mul(m).add(i(j))}else f=(f=f.mul(e)).add(i(j))}return f.unsigned=b,f}function m(a,b){return"number"==typeof a?i(a,b):"string"==typeof a?l(a,b):j(a.low,a.high,"boolean"==typeof b?b:a.unsigned)}c.fromString=l,c.fromValue=m;var n=0x100000000,o=0xffffffffffffffff,p=0x8000000000000000,q=h(0x1000000),r=h(0);c.ZERO=r;var s=h(0,!0);c.UZERO=s;var t=h(1);c.ONE=t;var u=h(1,!0);c.UONE=u;var v=h(-1);c.NEG_ONE=v;var w=j(-1,0x7fffffff,!1);c.MAX_VALUE=w;var x=j(-1,-1,!0);c.MAX_UNSIGNED_VALUE=x;var y=j(0,-0x80000000,!1);c.MIN_VALUE=y;var z=c.prototype;return z.toInt=function(){return this.unsigned?this.low>>>0:this.low},z.toNumber=function(){return this.unsigned?(this.high>>>0)*n+(this.low>>>0):this.high*n+(this.low>>>0)},z.toString=function(a){if((a=a||10)<2||36<a)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(!this.eq(y))return"-"+this.neg().toString(a);else{var b=i(a),c=this.div(b),d=c.mul(b).sub(this);return c.toString(a)+d.toInt().toString(a)}for(var e=i(k(a,6),this.unsigned),f=this,g="";;){var h=f.div(e),j=(f.sub(h.mul(e)).toInt()>>>0).toString(a);if((f=h).isZero())return j+g;for(;j.length<6;)j="0"+j;g=""+j+g}},z.getHighBits=function(){return this.high},z.getHighBitsUnsigned=function(){return this.high>>>0},z.getLowBits=function(){return this.low},z.getLowBitsUnsigned=function(){return this.low>>>0},z.getNumBitsAbs=function(){if(this.isNegative())return this.eq(y)?64:this.neg().getNumBitsAbs();for(var a=0!=this.high?this.high:this.low,b=31;b>0&&(a&1<<b)==0;b--);return 0!=this.high?b+33:b+1},z.isSafeInteger=function(){var a=this.high>>21;return!a||!this.unsigned&&-1===a&&(0!==this.low||-2097152!==this.high)},z.isZero=function(){return 0===this.high&&0===this.low},z.eqz=z.isZero,z.isNegative=function(){return!this.unsigned&&this.high<0},z.isPositive=function(){return this.unsigned||this.high>=0},z.isOdd=function(){return(1&this.low)==1},z.isEven=function(){return(1&this.low)==0},z.equals=function(a){return d(a)||(a=m(a)),(this.unsigned===a.unsigned||this.high>>>31!=1||a.high>>>31!=1)&&this.high===a.high&&this.low===a.low},z.eq=z.equals,z.notEquals=function(a){return!this.eq(a)},z.neq=z.notEquals,z.ne=z.notEquals,z.lessThan=function(a){return 0>this.comp(a)},z.lt=z.lessThan,z.lessThanOrEqual=function(a){return 0>=this.comp(a)},z.lte=z.lessThanOrEqual,z.le=z.lessThanOrEqual,z.greaterThan=function(a){return this.comp(a)>0},z.gt=z.greaterThan,z.greaterThanOrEqual=function(a){return this.comp(a)>=0},z.gte=z.greaterThanOrEqual,z.ge=z.greaterThanOrEqual,z.compare=function(a){if(d(a)||(a=m(a)),this.eq(a))return 0;var b=this.isNegative(),c=a.isNegative();return b&&!c?-1:!b&&c?1:this.unsigned?a.high>>>0>this.high>>>0||a.high===this.high&&a.low>>>0>this.low>>>0?-1:1:this.sub(a).isNegative()?-1:1},z.comp=z.compare,z.negate=function(){return!this.unsigned&&this.eq(y)?y:this.not().add(t)},z.neg=z.negate,z.add=function(a){d(a)||(a=m(a));var b,c,e=this.high>>>16,f=65535&this.high,g=this.low>>>16,h=65535&this.low,i=a.high>>>16,k=65535&a.high,l=a.low>>>16,n=65535&a.low,o=0,p=0;return b=0+((c=0+(h+n))>>>16),c&=65535,b+=g+l,p+=b>>>16,b&=65535,p+=f+k,o+=p>>>16,p&=65535,o+=e+i,j(b<<16|c,(o&=65535)<<16|p,this.unsigned)},z.subtract=function(a){return d(a)||(a=m(a)),this.add(a.neg())},z.sub=z.subtract,z.multiply=function(a){if(this.isZero())return this;if(d(a)||(a=m(a)),b)return j(b.mul(this.low,this.high,a.low,a.high),b.get_high(),this.unsigned);if(a.isZero())return this.unsigned?s:r;if(this.eq(y))return a.isOdd()?y:r;if(a.eq(y))return this.isOdd()?y:r;if(this.isNegative())if(a.isNegative())return this.neg().mul(a.neg());else return this.neg().mul(a).neg();if(a.isNegative())return this.mul(a.neg()).neg();if(this.lt(q)&&a.lt(q))return i(this.toNumber()*a.toNumber(),this.unsigned);var c,e,f=this.high>>>16,g=65535&this.high,h=this.low>>>16,k=65535&this.low,l=a.high>>>16,n=65535&a.high,o=a.low>>>16,p=65535&a.low,t=0,u=0;return c=0+((e=0+k*p)>>>16),e&=65535,c+=h*p,u+=c>>>16,c&=65535,c+=k*o,u+=c>>>16,c&=65535,u+=g*p,t+=u>>>16,u&=65535,u+=h*o,t+=u>>>16,u&=65535,u+=k*n,t+=u>>>16,u&=65535,t+=f*p+g*o+h*n+k*l,j(c<<16|e,(t&=65535)<<16|u,this.unsigned)},z.mul=z.multiply,z.divide=function(a){if(d(a)||(a=m(a)),a.isZero())throw Error("division by zero");if(b){var c,e,f;return this.unsigned||-0x80000000!==this.high||-1!==a.low||-1!==a.high?j((this.unsigned?b.div_u:b.div_s)(this.low,this.high,a.low,a.high),b.get_high(),this.unsigned):this}if(this.isZero())return this.unsigned?s:r;if(this.unsigned){if(a.unsigned||(a=a.toUnsigned()),a.gt(this))return s;if(a.gt(this.shru(1)))return u;f=s}else{if(this.eq(y))if(a.eq(t)||a.eq(v))return y;else return a.eq(y)?t:(c=this.shr(1).div(a).shl(1)).eq(r)?a.isNegative()?t:v:(e=this.sub(a.mul(c)),f=c.add(e.div(a)));if(a.eq(y))return this.unsigned?s:r;if(this.isNegative())return a.isNegative()?this.neg().div(a.neg()):this.neg().div(a).neg();if(a.isNegative())return this.div(a.neg()).neg();f=r}for(e=this;e.gte(a);){for(var g=Math.ceil(Math.log(c=Math.max(1,Math.floor(e.toNumber()/a.toNumber())))/Math.LN2),h=g<=48?1:k(2,g-48),l=i(c),n=l.mul(a);n.isNegative()||n.gt(e);)c-=h,n=(l=i(c,this.unsigned)).mul(a);l.isZero()&&(l=t),f=f.add(l),e=e.sub(n)}return f},z.div=z.divide,z.modulo=function(a){return(d(a)||(a=m(a)),b)?j((this.unsigned?b.rem_u:b.rem_s)(this.low,this.high,a.low,a.high),b.get_high(),this.unsigned):this.sub(this.div(a).mul(a))},z.mod=z.modulo,z.rem=z.modulo,z.not=function(){return j(~this.low,~this.high,this.unsigned)},z.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},z.clz=z.countLeadingZeros,z.countTrailingZeros=function(){return this.low?e(this.low):e(this.high)+32},z.ctz=z.countTrailingZeros,z.and=function(a){return d(a)||(a=m(a)),j(this.low&a.low,this.high&a.high,this.unsigned)},z.or=function(a){return d(a)||(a=m(a)),j(this.low|a.low,this.high|a.high,this.unsigned)},z.xor=function(a){return d(a)||(a=m(a)),j(this.low^a.low,this.high^a.high,this.unsigned)},z.shiftLeft=function(a){return(d(a)&&(a=a.toInt()),0==(a&=63))?this:a<32?j(this.low<<a,this.high<<a|this.low>>>32-a,this.unsigned):j(0,this.low<<a-32,this.unsigned)},z.shl=z.shiftLeft,z.shiftRight=function(a){return(d(a)&&(a=a.toInt()),0==(a&=63))?this:a<32?j(this.low>>>a|this.high<<32-a,this.high>>a,this.unsigned):j(this.high>>a-32,this.high>=0?0:-1,this.unsigned)},z.shr=z.shiftRight,z.shiftRightUnsigned=function(a){return(d(a)&&(a=a.toInt()),0==(a&=63))?this:a<32?j(this.low>>>a|this.high<<32-a,this.high>>>a,this.unsigned):32===a?j(this.high,0,this.unsigned):j(this.high>>>a-32,0,this.unsigned)},z.shru=z.shiftRightUnsigned,z.shr_u=z.shiftRightUnsigned,z.rotateLeft=function(a){var b;return(d(a)&&(a=a.toInt()),0==(a&=63))?this:32===a?j(this.high,this.low,this.unsigned):a<32?(b=32-a,j(this.low<<a|this.high>>>b,this.high<<a|this.low>>>b,this.unsigned)):(a-=32,b=32-a,j(this.high<<a|this.low>>>b,this.low<<a|this.high>>>b,this.unsigned))},z.rotl=z.rotateLeft,z.rotateRight=function(a){var b;return(d(a)&&(a=a.toInt()),0==(a&=63))?this:32===a?j(this.high,this.low,this.unsigned):a<32?(b=32-a,j(this.high<<b|this.low>>>a,this.low<<b|this.high>>>a,this.unsigned)):(a-=32,b=32-a,j(this.low<<b|this.high>>>a,this.high<<b|this.low>>>a,this.unsigned))},z.rotr=z.rotateRight,z.toSigned=function(){return this.unsigned?j(this.low,this.high,!1):this},z.toUnsigned=function(){return this.unsigned?this:j(this.low,this.high,!0)},z.toBytes=function(a){return a?this.toBytesLE():this.toBytesBE()},z.toBytesLE=function(){var a=this.high,b=this.low;return[255&b,b>>>8&255,b>>>16&255,b>>>24,255&a,a>>>8&255,a>>>16&255,a>>>24]},z.toBytesBE=function(){var a=this.high,b=this.low;return[a>>>24,a>>>16&255,a>>>8&255,255&a,b>>>24,b>>>16&255,b>>>8&255,255&b]},c.fromBytes=function(a,b,d){return d?c.fromBytesLE(a,b):c.fromBytesBE(a,b)},c.fromBytesLE=function(a,b){return new c(a[0]|a[1]<<8|a[2]<<16|a[3]<<24,a[4]|a[5]<<8|a[6]<<16|a[7]<<24,b)},c.fromBytesBE=function(a,b){return new c(a[4]<<24|a[5]<<16|a[6]<<8|a[7],a[0]<<24|a[1]<<16|a[2]<<8|a[3],b)},"function"==typeof BigInt&&(c.fromBigInt=function(a,b){return j(Number(BigInt.asIntN(32,a)),Number(BigInt.asIntN(32,a>>BigInt(32))),b)},c.fromValue=function(a,b){return"bigint"==typeof a?fromBigInt(a,b):m(a,b)},z.toBigInt=function(){var a=BigInt(this.low>>>0);return BigInt(this.unsigned?this.high>>>0:this.high)<<BigInt(32)|a}),a.default=c,"default"in a?a.default:a}({});void 0===(c=(function(){return d}).apply(b,[]))||(a.exports=c)},67369:(a,b,c)=>{"use strict";a.exports=g;var d=c(72481);((g.prototype=Object.create(d.prototype)).constructor=g).className="OneOf";var e=c(99408),f=c(90290);function g(a,b,c,e){if(Array.isArray(b)||(c=b,b=void 0),d.call(this,a,c),!(void 0===b||Array.isArray(b)))throw TypeError("fieldNames must be an Array");this.oneof=b||[],this.fieldsArray=[],this.comment=e}function h(a){if(a.parent)for(var b=0;b<a.fieldsArray.length;++b)a.fieldsArray[b].parent||a.parent.add(a.fieldsArray[b])}g.fromJSON=function(a,b){return new g(a,b.oneof,b.options,b.comment)},g.prototype.toJSON=function(a){var b=!!a&&!!a.keepComments;return f.toObject(["options",this.options,"oneof",this.oneof,"comment",b?this.comment:void 0])},g.prototype.add=function(a){if(!(a instanceof e))throw TypeError("field must be a Field");return a.parent&&a.parent!==this.parent&&a.parent.remove(a),this.oneof.push(a.name),this.fieldsArray.push(a),a.partOf=this,h(this),this},g.prototype.remove=function(a){if(!(a instanceof e))throw TypeError("field must be a Field");var b=this.fieldsArray.indexOf(a);if(b<0)throw Error(a+" is not a member of "+this);return this.fieldsArray.splice(b,1),(b=this.oneof.indexOf(a.name))>-1&&this.oneof.splice(b,1),a.partOf=null,this},g.prototype.onAdd=function(a){d.prototype.onAdd.call(this,a);for(var b=this,c=0;c<this.oneof.length;++c){var e=a.get(this.oneof[c]);e&&!e.partOf&&(e.partOf=b,b.fieldsArray.push(e))}h(this)},g.prototype.onRemove=function(a){for(var b,c=0;c<this.fieldsArray.length;++c)(b=this.fieldsArray[c]).parent&&b.parent.remove(b);d.prototype.onRemove.call(this,a)},Object.defineProperty(g.prototype,"isProto3Optional",{get:function(){if(null==this.fieldsArray||1!==this.fieldsArray.length)return!1;var a=this.fieldsArray[0];return null!=a.options&&!0===a.options.proto3_optional}}),g.d=function(){for(var a=Array(arguments.length),b=0;b<arguments.length;)a[b]=arguments[b++];return function(b,c){f.decorateType(b.constructor).add(new g(c,a)),Object.defineProperty(b,c,{get:f.oneOfGetter(a),set:f.oneOfSetter(a)})}}},68134:(a,b,c)=>{"use strict";a.exports=s;var d=c(26991);((s.prototype=Object.create(d.prototype)).constructor=s).className="Type";var e=c(27791),f=c(67369),g=c(99408),h=c(49316),i=c(25811),j=c(4755),k=c(75645),l=c(59665),m=c(90290),n=c(23464),o=c(71600),p=c(6620),q=c(6792),r=c(19006);function s(a,b){d.call(this,a,b),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function t(a){return a._fieldsById=a._fieldsArray=a._oneofsArray=null,delete a.encode,delete a.decode,delete a.verify,a}Object.defineProperties(s.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var a=Object.keys(this.fields),b=0;b<a.length;++b){var c=this.fields[a[b]],d=c.id;if(this._fieldsById[d])throw Error("duplicate id "+d+" in "+this);this._fieldsById[d]=c}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=m.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=m.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=s.generateConstructor(this)())},set:function(a){var b=a.prototype;b instanceof j||((a.prototype=new j).constructor=a,m.merge(a.prototype,b)),a.$type=a.prototype.$type=this,m.merge(a,j,!0),this._ctor=a;for(var c=0;c<this.fieldsArray.length;++c)this._fieldsArray[c].resolve();var d={};for(c=0;c<this.oneofsArray.length;++c)d[this._oneofsArray[c].resolve().name]={get:m.oneOfGetter(this._oneofsArray[c].oneof),set:m.oneOfSetter(this._oneofsArray[c].oneof)};c&&Object.defineProperties(a.prototype,d)}}}),s.generateConstructor=function(a){for(var b,c=m.codegen(["p"],a.name),d=0;d<a.fieldsArray.length;++d)(b=a._fieldsArray[d]).map?c("this%s={}",m.safeProp(b.name)):b.repeated&&c("this%s=[]",m.safeProp(b.name));return c("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},s.fromJSON=function(a,b){var c=new s(a,b.options);c.extensions=b.extensions,c.reserved=b.reserved;for(var j=Object.keys(b.fields),k=0;k<j.length;++k)c.add((void 0!==b.fields[j[k]].keyType?h.fromJSON:g.fromJSON)(j[k],b.fields[j[k]]));if(b.oneofs)for(j=Object.keys(b.oneofs),k=0;k<j.length;++k)c.add(f.fromJSON(j[k],b.oneofs[j[k]]));if(b.nested)for(j=Object.keys(b.nested),k=0;k<j.length;++k){var l=b.nested[j[k]];c.add((void 0!==l.id?g.fromJSON:void 0!==l.fields?s.fromJSON:void 0!==l.values?e.fromJSON:void 0!==l.methods?i.fromJSON:d.fromJSON)(j[k],l))}return b.extensions&&b.extensions.length&&(c.extensions=b.extensions),b.reserved&&b.reserved.length&&(c.reserved=b.reserved),b.group&&(c.group=!0),b.comment&&(c.comment=b.comment),b.edition&&(c._edition=b.edition),c._defaultEdition="proto3",c},s.prototype.toJSON=function(a){var b=d.prototype.toJSON.call(this,a),c=!!a&&!!a.keepComments;return m.toObject(["edition",this._editionToJSON(),"options",b&&b.options||void 0,"oneofs",d.arrayToJSON(this.oneofsArray,a),"fields",d.arrayToJSON(this.fieldsArray.filter(function(a){return!a.declaringField}),a)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",b&&b.nested||void 0,"comment",c?this.comment:void 0])},s.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;d.prototype.resolveAll.call(this);var a=this.oneofsArray;for(c=0;c<a.length;)a[c++].resolve();for(var b=this.fieldsArray,c=0;c<b.length;)b[c++].resolve();return this},s.prototype._resolveFeaturesRecursive=function(a){return this._needsRecursiveFeatureResolution&&(a=this._edition||a,d.prototype._resolveFeaturesRecursive.call(this,a),this.oneofsArray.forEach(b=>{b._resolveFeatures(a)}),this.fieldsArray.forEach(b=>{b._resolveFeatures(a)})),this},s.prototype.get=function(a){return this.fields[a]||this.oneofs&&this.oneofs[a]||this.nested&&this.nested[a]||null},s.prototype.add=function(a){if(this.get(a.name))throw Error("duplicate name '"+a.name+"' in "+this);if(a instanceof g&&void 0===a.extend){if(this._fieldsById?this._fieldsById[a.id]:this.fieldsById[a.id])throw Error("duplicate id "+a.id+" in "+this);if(this.isReservedId(a.id))throw Error("id "+a.id+" is reserved in "+this);if(this.isReservedName(a.name))throw Error("name '"+a.name+"' is reserved in "+this);return a.parent&&a.parent.remove(a),this.fields[a.name]=a,a.message=this,a.onAdd(this),t(this)}return a instanceof f?(this.oneofs||(this.oneofs={}),this.oneofs[a.name]=a,a.onAdd(this),t(this)):d.prototype.add.call(this,a)},s.prototype.remove=function(a){if(a instanceof g&&void 0===a.extend){if(!this.fields||this.fields[a.name]!==a)throw Error(a+" is not a member of "+this);return delete this.fields[a.name],a.parent=null,a.onRemove(this),t(this)}if(a instanceof f){if(!this.oneofs||this.oneofs[a.name]!==a)throw Error(a+" is not a member of "+this);return delete this.oneofs[a.name],a.parent=null,a.onRemove(this),t(this)}return d.prototype.remove.call(this,a)},s.prototype.isReservedId=function(a){return d.isReservedId(this.reserved,a)},s.prototype.isReservedName=function(a){return d.isReservedName(this.reserved,a)},s.prototype.create=function(a){return new this.ctor(a)},s.prototype.setup=function(){for(var a=this.fullName,b=[],c=0;c<this.fieldsArray.length;++c)b.push(this._fieldsArray[c].resolve().resolvedType);this.encode=n(this)({Writer:l,types:b,util:m}),this.decode=o(this)({Reader:k,types:b,util:m}),this.verify=p(this)({types:b,util:m}),this.fromObject=q.fromObject(this)({types:b,util:m}),this.toObject=q.toObject(this)({types:b,util:m});var d=r[a];if(d){var e=Object.create(this);e.fromObject=this.fromObject,this.fromObject=d.fromObject.bind(e),e.toObject=this.toObject,this.toObject=d.toObject.bind(e)}return this},s.prototype.encode=function(a,b){return this.setup().encode(a,b)},s.prototype.encodeDelimited=function(a,b){return this.encode(a,b&&b.len?b.fork():b).ldelim()},s.prototype.decode=function(a,b){return this.setup().decode(a,b)},s.prototype.decodeDelimited=function(a){return a instanceof k||(a=k.create(a)),this.decode(a,a.uint32())},s.prototype.verify=function(a){return this.setup().verify(a)},s.prototype.fromObject=function(a){return this.setup().fromObject(a)},s.prototype.toObject=function(a,b){return this.setup().toObject(a,b)},s.d=function(a){return function(b){m.decorateType(b,a)}}},70051:(a,b)=>{"use strict";var c=b,d=c.isAbsolute=function(a){return/^(?:\/|\w+:)/.test(a)},e=c.normalize=function(a){var b=(a=a.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),c=d(a),e="";c&&(e=b.shift()+"/");for(var f=0;f<b.length;)".."===b[f]?f>0&&".."!==b[f-1]?b.splice(--f,2):c?b.splice(f,1):++f:"."===b[f]?b.splice(f,1):++f;return e+b.join("/")};c.resolve=function(a,b,c){return(c||(b=e(b)),d(b))?b:(c||(a=e(a)),(a=a.replace(/(?:\/|^)[^/]+$/,"")).length?e(a+"/"+b):b)}},71446:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Client=void 0;let d=c(17273),e=c(58130),f=c(13678),g=c(74216),h=c(39316),i=c(26207),j=Symbol(),k=Symbol(),l=Symbol(),m=Symbol();function n(a){return"function"==typeof a}function o(a){return a.stack.split("\n").slice(1).join("\n")}class p{constructor(a,b,c={}){var d,f;if(c=Object.assign({},c),this[k]=null!=(d=c.interceptors)?d:[],delete c.interceptors,this[l]=null!=(f=c.interceptor_providers)?f:[],delete c.interceptor_providers,this[k].length>0&&this[l].length>0)throw Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[m]=c.callInvocationTransformer,delete c.callInvocationTransformer,c.channelOverride)this[j]=c.channelOverride;else if(c.channelFactoryOverride){let d=c.channelFactoryOverride;delete c.channelFactoryOverride,this[j]=d(a,b,c)}else this[j]=new e.ChannelImplementation(a,b,c)}close(){this[j].close()}getChannel(){return this[j]}waitForReady(a,b){let c=d=>{let e;if(d)return void b(Error("Failed to connect before the deadline"));try{e=this[j].getConnectivityState(!0)}catch(a){b(Error("The channel has been closed"));return}if(e===f.ConnectivityState.READY)b();else try{this[j].watchConnectivityState(e,a,c)}catch(a){b(Error("The channel has been closed"))}};setImmediate(c)}checkOptionalUnaryResponseArguments(a,b,c){if(n(a))return{metadata:new h.Metadata,options:{},callback:a};if(n(b))if(a instanceof h.Metadata)return{metadata:a,options:{},callback:b};else return{metadata:new h.Metadata,options:a,callback:b};if(!(a instanceof h.Metadata&&b instanceof Object&&n(c)))throw Error("Incorrect arguments passed");return{metadata:a,options:b,callback:c}}makeUnaryRequest(a,b,c,e,f,h,n){var p,q;let r=this.checkOptionalUnaryResponseArguments(f,h,n),s={path:a,requestStream:!1,responseStream:!1,requestSerialize:b,responseDeserialize:c},t={argument:e,metadata:r.metadata,call:new d.ClientUnaryCallImpl,channel:this[j],methodDefinition:s,callOptions:r.options,callback:r.callback};this[m]&&(t=this[m](t));let u=t.call,v={clientInterceptors:this[k],clientInterceptorProviders:this[l],callInterceptors:null!=(p=t.callOptions.interceptors)?p:[],callInterceptorProviders:null!=(q=t.callOptions.interceptor_providers)?q:[]},w=(0,i.getInterceptingCall)(v,t.methodDefinition,t.callOptions,t.channel);u.call=w;let x=null,y=!1,z=Error();return w.start(t.metadata,{onReceiveMetadata:a=>{u.emit("metadata",a)},onReceiveMessage(a){null!==x&&w.cancelWithStatus(g.Status.INTERNAL,"Too many responses received"),x=a},onReceiveStatus(a){if(!y){if(y=!0,a.code===g.Status.OK)if(null===x){let b=o(z);t.callback((0,d.callErrorFromStatus)({code:g.Status.INTERNAL,details:"No message received",metadata:a.metadata},b))}else t.callback(null,x);else{let b=o(z);t.callback((0,d.callErrorFromStatus)(a,b))}z=null,u.emit("status",a)}}}),w.sendMessage(e),w.halfClose(),u}makeClientStreamRequest(a,b,c,e,f,h){var n,p;let q=this.checkOptionalUnaryResponseArguments(e,f,h),r={path:a,requestStream:!0,responseStream:!1,requestSerialize:b,responseDeserialize:c},s={metadata:q.metadata,call:new d.ClientWritableStreamImpl(b),channel:this[j],methodDefinition:r,callOptions:q.options,callback:q.callback};this[m]&&(s=this[m](s));let t=s.call,u={clientInterceptors:this[k],clientInterceptorProviders:this[l],callInterceptors:null!=(n=s.callOptions.interceptors)?n:[],callInterceptorProviders:null!=(p=s.callOptions.interceptor_providers)?p:[]},v=(0,i.getInterceptingCall)(u,s.methodDefinition,s.callOptions,s.channel);t.call=v;let w=null,x=!1,y=Error();return v.start(s.metadata,{onReceiveMetadata:a=>{t.emit("metadata",a)},onReceiveMessage(a){null!==w&&v.cancelWithStatus(g.Status.INTERNAL,"Too many responses received"),w=a},onReceiveStatus(a){if(!x){if(x=!0,a.code===g.Status.OK)if(null===w){let b=o(y);s.callback((0,d.callErrorFromStatus)({code:g.Status.INTERNAL,details:"No message received",metadata:a.metadata},b))}else s.callback(null,w);else{let b=o(y);s.callback((0,d.callErrorFromStatus)(a,b))}y=null,t.emit("status",a)}}}),t}checkMetadataAndOptions(a,b){let c,d;return a instanceof h.Metadata?(c=a,d=b||{}):(d=a||{},c=new h.Metadata),{metadata:c,options:d}}makeServerStreamRequest(a,b,c,e,f,h){var n,p;let q=this.checkMetadataAndOptions(f,h),r={path:a,requestStream:!1,responseStream:!0,requestSerialize:b,responseDeserialize:c},s={argument:e,metadata:q.metadata,call:new d.ClientReadableStreamImpl(c),channel:this[j],methodDefinition:r,callOptions:q.options};this[m]&&(s=this[m](s));let t=s.call,u={clientInterceptors:this[k],clientInterceptorProviders:this[l],callInterceptors:null!=(n=s.callOptions.interceptors)?n:[],callInterceptorProviders:null!=(p=s.callOptions.interceptor_providers)?p:[]},v=(0,i.getInterceptingCall)(u,s.methodDefinition,s.callOptions,s.channel);t.call=v;let w=!1,x=Error();return v.start(s.metadata,{onReceiveMetadata(a){t.emit("metadata",a)},onReceiveMessage(a){t.push(a)},onReceiveStatus(a){if(!w){if(w=!0,t.push(null),a.code!==g.Status.OK){let b=o(x);t.emit("error",(0,d.callErrorFromStatus)(a,b))}x=null,t.emit("status",a)}}}),v.sendMessage(e),v.halfClose(),t}makeBidiStreamRequest(a,b,c,e,f){var h,n;let p=this.checkMetadataAndOptions(e,f),q={path:a,requestStream:!0,responseStream:!0,requestSerialize:b,responseDeserialize:c},r={metadata:p.metadata,call:new d.ClientDuplexStreamImpl(b,c),channel:this[j],methodDefinition:q,callOptions:p.options};this[m]&&(r=this[m](r));let s=r.call,t={clientInterceptors:this[k],clientInterceptorProviders:this[l],callInterceptors:null!=(h=r.callOptions.interceptors)?h:[],callInterceptorProviders:null!=(n=r.callOptions.interceptor_providers)?n:[]},u=(0,i.getInterceptingCall)(t,r.methodDefinition,r.callOptions,r.channel);s.call=u;let v=!1,w=Error();return u.start(r.metadata,{onReceiveMetadata(a){s.emit("metadata",a)},onReceiveMessage(a){s.push(a)},onReceiveStatus(a){if(!v){if(v=!0,s.push(null),a.code!==g.Status.OK){let b=o(w);s.emit("error",(0,d.callErrorFromStatus)(a,b))}w=null,s.emit("status",a)}}}),s}}b.Client=p},71464:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Subchannel=void 0;let d=c(13678),e=c(54447),f=c(49152),g=c(74216),h=c(30999),i=c(41509),j=c(16050),k="subchannel",l=0x7fffffff;class m{constructor(a,b,c,f,g){var h;this.channelTarget=a,this.subchannelAddress=b,this.options=c,this.credentials=f,this.connector=g,this.connectivityState=d.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new j.ChannelzCallTracker,this.childrenTracker=new j.ChannelzChildrenTracker,this.streamTracker=new j.ChannelzCallTracker;let k={initialDelay:c["grpc.initial_reconnect_backoff_ms"],maxDelay:c["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new e.BackoffTimeout(()=>{this.handleBackoffTimer()},k),this.backoffTimeout.unref(),this.subchannelAddressString=(0,i.subchannelAddressToString)(b),this.keepaliveTime=null!=(h=c["grpc.keepalive_time_ms"])?h:-1,0===c["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new j.ChannelzTrace,this.channelzRef=(0,j.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(c,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(a){f.trace(g.LogVerbosity.DEBUG,k,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+a)}refTrace(a){f.trace(g.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+a)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([d.ConnectivityState.TRANSIENT_FAILURE],d.ConnectivityState.CONNECTING):this.transitionToState([d.ConnectivityState.TRANSIENT_FAILURE],d.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let a=this.options;if(a["grpc.keepalive_time_ms"]){let b=Math.min(this.keepaliveTime,l);a=Object.assign(Object.assign({},a),{"grpc.keepalive_time_ms":b})}this.connector.connect(this.subchannelAddress,this.credentials,a).then(a=>{this.transitionToState([d.ConnectivityState.CONNECTING],d.ConnectivityState.READY)?(this.transport=a,this.channelzEnabled&&this.childrenTracker.refChild(a.getChannelzRef()),a.addDisconnectListener(a=>{this.transitionToState([d.ConnectivityState.READY],d.ConnectivityState.IDLE),a&&this.keepaliveTime>0&&(this.keepaliveTime*=2,f.log(g.LogVerbosity.ERROR,`Connection to ${(0,h.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))})):a.shutdown()},a=>{this.transitionToState([d.ConnectivityState.CONNECTING],d.ConnectivityState.TRANSIENT_FAILURE,`${a}`)})}transitionToState(a,b,c){var e,f;if(-1===a.indexOf(this.connectivityState))return!1;this.trace(d.ConnectivityState[this.connectivityState]+" -> "+d.ConnectivityState[b]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+d.ConnectivityState[b]);let g=this.connectivityState;switch(this.connectivityState=b,b){case d.ConnectivityState.READY:this.stopBackoff();break;case d.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case d.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),null==(e=this.transport)||e.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case d.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),null==(f=this.transport)||f.shutdown(),this.transport=null;break;default:throw Error(`Invalid state: unknown ConnectivityState ${b}`)}for(let a of this.stateListeners)a(this,g,b,this.keepaliveTime,c);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,0===this.refcount&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.channelzEnabled&&(0,j.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([d.ConnectivityState.CONNECTING,d.ConnectivityState.READY],d.ConnectivityState.IDLE)}))}unrefIfOneRef(){return 1===this.refcount&&(this.unref(),!0)}createCall(a,b,c,d){let e;if(!this.transport)throw Error("Cannot create call, subchannel not READY");return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),e={onCallEnd:a=>{a.code===g.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):e={},this.transport.createCall(a,b,c,d,e)}startConnecting(){process.nextTick(()=>{this.transitionToState([d.ConnectivityState.IDLE],d.ConnectivityState.CONNECTING)||this.connectivityState!==d.ConnectivityState.TRANSIENT_FAILURE||(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(a){this.stateListeners.add(a)}removeConnectivityStateListener(a){this.stateListeners.delete(a)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([d.ConnectivityState.TRANSIENT_FAILURE],d.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}realSubchannelEquals(a){return a.getRealSubchannel()===this}throttleKeepalive(a){a>this.keepaliveTime&&(this.keepaliveTime=a)}}b.Subchannel=m},71600:(a,b,c)=>{"use strict";a.exports=h;var d=c(27791),e=c(18657),f=c(90290);function g(a){return"missing required '"+a.name+"'"}function h(a){for(var b=f.codegen(["r","l","e"],a.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(a.fieldsArray.filter(function(a){return a.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()")("if(t===e)")("break")("switch(t>>>3){"),c=0;c<a.fieldsArray.length;++c){var h=a._fieldsArray[c].resolve(),i=h.resolvedType instanceof d?"int32":h.type,j="m"+f.safeProp(h.name);b("case %i: {",h.id),h.map?(b("if(%s===util.emptyObject)",j)("%s={}",j)("var c2 = r.uint32()+r.pos"),void 0!==e.defaults[h.keyType]?b("k=%j",e.defaults[h.keyType]):b("k=null"),void 0!==e.defaults[i]?b("value=%j",e.defaults[i]):b("value=null"),b("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",h.keyType)("case 2:"),void 0===e.basic[i]?b("value=types[%i].decode(r,r.uint32())",c):b("value=r.%s()",i),b("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),void 0!==e.long[h.keyType]?b('%s[typeof k==="object"?util.longToHash(k):k]=value',j):b("%s[k]=value",j)):h.repeated?(b("if(!(%s&&%s.length))",j,j)("%s=[]",j),void 0!==e.packed[i]&&b("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",j,i)("}else"),void 0===e.basic[i]?b(h.delimited?"%s.push(types[%i].decode(r,undefined,((t&~7)|4)))":"%s.push(types[%i].decode(r,r.uint32()))",j,c):b("%s.push(r.%s())",j,i)):void 0===e.basic[i]?b(h.delimited?"%s=types[%i].decode(r,undefined,((t&~7)|4))":"%s=types[%i].decode(r,r.uint32())",j,c):b("%s=r.%s()",j,i),b("break")("}")}for(b("default:")("r.skipType(t&7)")("break")("}")("}"),c=0;c<a._fieldsArray.length;++c){var k=a._fieldsArray[c];k.required&&b("if(!m.hasOwnProperty(%j))",k.name)("throw util.ProtocolError(%j,{instance:m})",g(k))}return b("return m")}},71902:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ResolvingLoadBalancer=void 0;let d=c(64432),e=c(27885),f=c(13678),g=c(98675),h=c(34979),i=c(54447),j=c(74216),k=c(39316),l=c(49152),m=c(74216),n=c(30999),o=c(9054),p="resolving_load_balancer";function q(a){l.trace(m.LogVerbosity.DEBUG,p,a)}let r=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function s(a,b,c,d){for(let e of c.name)switch(d){case"EMPTY":if(!e.service&&!e.method)return!0;break;case"SERVICE":if(e.service===a&&!e.method)return!0;break;case"SERVICE_AND_METHOD":if(e.service===a&&e.method===b)return!0}return!1}function t(a,b,c,d){for(let e of c)if(s(a,b,e,d))return e;return null}function u(a){return function(b,c){var d,e;let f=b.split("/").filter(a=>a.length>0),g=null!=(d=f[0])?d:"",h=null!=(e=f[1])?e:"";if(a&&a.methodConfig)for(let b of r){let c=t(g,h,a.methodConfig,b);if(c)return{methodConfig:c,pickInformation:{},status:j.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:j.Status.OK,dynamicFilterFactories:[]}}}class v{constructor(a,b,c,l,m){this.target=a,this.channelControlHelper=b,this.onSuccessfulResolution=l,this.onFailedResolution=m,this.latestChildState=f.ConnectivityState.IDLE,this.latestChildPicker=new h.QueuePicker(this),this.currentState=f.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,c["grpc.service_config"]?this.defaultServiceConfig=(0,e.validateServiceConfig)(JSON.parse(c["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(f.ConnectivityState.IDLE,new h.QueuePicker(this)),this.childLoadBalancer=new o.ChildLoadBalancerHandler({createSubchannel:b.createSubchannel.bind(b),requestReresolution:()=>{this.backoffTimeout.isRunning()?(q("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(a,b)=>{this.latestChildState=a,this.latestChildPicker=b,this.updateState(a,b)},addChannelzChild:b.addChannelzChild.bind(b),removeChannelzChild:b.removeChannelzChild.bind(b)}),this.innerResolver=(0,g.createResolver)(a,{onSuccessfulResolution:(a,b,c,e,f)=>{var g;this.backoffTimeout.stop(),this.backoffTimeout.reset();let h=null;null===b?null===c?(this.previousServiceConfig=null,h=this.defaultServiceConfig):null===this.previousServiceConfig?this.handleResolutionFailure(c):h=this.previousServiceConfig:(h=b,this.previousServiceConfig=b);let i=null!=(g=null==h?void 0:h.loadBalancingConfig)?g:[],l=(0,d.getFirstUsableConfig)(i,!0);if(null===l)return void this.handleResolutionFailure({code:j.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new k.Metadata});this.childLoadBalancer.updateAddressList(a,l,f);let m=null!=h?h:this.defaultServiceConfig;this.onSuccessfulResolution(m,null!=e?e:u(m))},onError:a=>{this.handleResolutionFailure(a)}},c);let n={initialDelay:c["grpc.initial_reconnect_backoff_ms"],maxDelay:c["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new i.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},n),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===f.ConnectivityState.IDLE&&this.updateState(f.ConnectivityState.CONNECTING,new h.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(a,b){q((0,n.uriToString)(this.target)+" "+f.ConnectivityState[this.currentState]+" -> "+f.ConnectivityState[a]),a===f.ConnectivityState.IDLE&&(b=new h.QueuePicker(this)),this.currentState=a,this.channelControlHelper.updateState(a,b)}handleResolutionFailure(a){this.latestChildState===f.ConnectivityState.IDLE&&(this.updateState(f.ConnectivityState.TRANSIENT_FAILURE,new h.UnavailablePicker(a)),this.onFailedResolution(a))}exitIdle(){(this.currentState===f.ConnectivityState.IDLE||this.currentState===f.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(a,b){throw Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=f.ConnectivityState.IDLE,this.latestChildPicker=new h.QueuePicker(this),this.currentState=f.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}}b.ResolvingLoadBalancer=v},72342:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.addAdminServicesToServer=b.registerAdminService=void 0;let c=[];b.registerAdminService=function(a,b){c.push({getServiceDefinition:a,getHandlers:b})},b.addAdminServicesToServer=function(a){for(let{getServiceDefinition:b,getHandlers:d}of c)a.addService(b(),d())}},72451:a=>{"use strict";a.exports=d;var b,c=/\/|\./;function d(a,b){c.test(a)||(a="google/protobuf/"+a+".proto",b={nested:{google:{nested:{protobuf:{nested:b}}}}}),d[a]=b}d("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),d("duration",{Duration:b={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),d("timestamp",{Timestamp:b}),d("empty",{Empty:{fields:{}}}),d("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),d("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),d("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),d.get=function(a){return d[a]||null}},72481:(a,b,c)=>{"use strict";a.exports=j,j.className="ReflectionObject";let d=c(67369);var e,f=c(90290),g={enum_type:"OPEN",field_presence:"EXPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"},h={enum_type:"CLOSED",field_presence:"EXPLICIT",json_format:"LEGACY_BEST_EFFORT",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"EXPANDED",utf8_validation:"NONE"},i={enum_type:"OPEN",field_presence:"IMPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"};function j(a,b){if(!f.isString(a))throw TypeError("name must be a string");if(b&&!f.isObject(b))throw TypeError("options must be an object");this.options=b,this.parsedOptions=null,this.name=a,this._edition=null,this._defaultEdition="proto2",this._features={},this._featuresResolved=!1,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(j.prototype,{root:{get:function(){for(var a=this;null!==a.parent;)a=a.parent;return a}},fullName:{get:function(){for(var a=[this.name],b=this.parent;b;)a.unshift(b.name),b=b.parent;return a.join(".")}}}),j.prototype.toJSON=function(){throw Error()},j.prototype.onAdd=function(a){this.parent&&this.parent!==a&&this.parent.remove(this),this.parent=a,this.resolved=!1;var b=a.root;b instanceof e&&b._handleAdd(this)},j.prototype.onRemove=function(a){var b=a.root;b instanceof e&&b._handleRemove(this),this.parent=null,this.resolved=!1},j.prototype.resolve=function(){return this.resolved||this.root instanceof e&&(this.resolved=!0),this},j.prototype._resolveFeaturesRecursive=function(a){return this._resolveFeatures(this._edition||a)},j.prototype._resolveFeatures=function(a){if(!this._featuresResolved){var b={};if(!a)throw Error("Unknown edition for "+this.fullName);var c=Object.assign(this.options?Object.assign({},this.options.features):{},this._inferLegacyProtoFeatures(a));if(this._edition){if("proto2"===a)b=Object.assign({},h);else if("proto3"===a)b=Object.assign({},i);else if("2023"===a)b=Object.assign({},g);else throw Error("Unknown edition: "+a);this._features=Object.assign(b,c||{}),this._featuresResolved=!0;return}if(this.partOf instanceof d){var e=Object.assign({},this.partOf._features);this._features=Object.assign(e,c||{})}else if(this.declaringField);else if(this.parent){var f=Object.assign({},this.parent._features);this._features=Object.assign(f,c||{})}else throw Error("Unable to find a parent for "+this.fullName);this.extensionField&&(this.extensionField._features=this._features),this._featuresResolved=!0}},j.prototype._inferLegacyProtoFeatures=function(){return{}},j.prototype.getOption=function(a){if(this.options)return this.options[a]},j.prototype.setOption=function(a,b,c){return this.options||(this.options={}),/^features\./.test(a)?f.setProperty(this.options,a,b,c):c&&void 0!==this.options[a]||(this.getOption(a)!==b&&(this.resolved=!1),this.options[a]=b),this},j.prototype.setParsedOption=function(a,b,c){this.parsedOptions||(this.parsedOptions=[]);var d=this.parsedOptions;if(c){var e=d.find(function(b){return Object.prototype.hasOwnProperty.call(b,a)});if(e){var g=e[a];f.setProperty(g,c,b)}else(e={})[a]=f.setProperty({},c,b),d.push(e)}else{var h={};h[a]=b,d.push(h)}return this},j.prototype.setOptions=function(a,b){if(a)for(var c=Object.keys(a),d=0;d<c.length;++d)this.setOption(c[d],a[c[d]],b);return this},j.prototype.toString=function(){var a=this.constructor.className,b=this.fullName;return b.length?a+" "+b:a},j.prototype._editionToJSON=function(){if(this._edition&&"proto3"!==this._edition)return this._edition},j._configure=function(a){e=a}},72888:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.setup=b.RoundRobinLoadBalancer=void 0;let d=c(64432),e=c(13678),f=c(34979),g=c(41509),h=c(49152),i=c(74216),j="round_robin";function k(a){h.trace(i.LogVerbosity.DEBUG,j,a)}let l="round_robin";class m{getLoadBalancerName(){return l}constructor(){}toJsonObject(){return{[l]:{}}}static createFromJson(a){return new m}}class n{constructor(a,b=0){this.subchannelList=a,this.nextIndex=b}pick(a){let b=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:f.PickResultType.COMPLETE,subchannel:b,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}}class o{constructor(a){this.channelControlHelper=a,this.subchannels=[],this.currentState=e.ConnectivityState.IDLE,this.currentReadyPicker=null,this.lastError=null,this.subchannelStateListener=(a,b,c,d,f)=>{this.calculateAndUpdateState(),(c===e.ConnectivityState.TRANSIENT_FAILURE||c===e.ConnectivityState.IDLE)&&(f&&(this.lastError=f),this.channelControlHelper.requestReresolution(),a.startConnecting())}}countSubchannelsWithState(a){return this.subchannels.filter(b=>b.getConnectivityState()===a).length}calculateAndUpdateState(){if(this.countSubchannelsWithState(e.ConnectivityState.READY)>0){let a=this.subchannels.filter(a=>a.getConnectivityState()===e.ConnectivityState.READY),b=0;null!==this.currentReadyPicker&&(b=a.indexOf(this.currentReadyPicker.peekNextSubchannel()))<0&&(b=0),this.updateState(e.ConnectivityState.READY,new n(a,b))}else this.countSubchannelsWithState(e.ConnectivityState.CONNECTING)>0?this.updateState(e.ConnectivityState.CONNECTING,new f.QueuePicker(this)):this.countSubchannelsWithState(e.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(e.ConnectivityState.TRANSIENT_FAILURE,new f.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(e.ConnectivityState.IDLE,new f.QueuePicker(this))}updateState(a,b){k(e.ConnectivityState[this.currentState]+" -> "+e.ConnectivityState[a]),a===e.ConnectivityState.READY?this.currentReadyPicker=b:this.currentReadyPicker=null,this.currentState=a,this.channelControlHelper.updateState(a,b)}resetSubchannelList(){for(let a of this.subchannels)a.removeConnectivityStateListener(this.subchannelStateListener),a.unref(),this.channelControlHelper.removeChannelzChild(a.getChannelzRef());this.subchannels=[]}updateAddressList(a,b){for(let b of(this.resetSubchannelList(),k("Connect to address list "+a.map(a=>(0,g.subchannelAddressToString)(a))),this.subchannels=a.map(a=>this.channelControlHelper.createSubchannel(a,{})),this.subchannels)){b.ref(),b.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(b.getChannelzRef());let a=b.getConnectivityState();(a===e.ConnectivityState.IDLE||a===e.ConnectivityState.TRANSIENT_FAILURE)&&b.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let a of this.subchannels)a.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return l}}b.RoundRobinLoadBalancer=o,b.setup=function(){(0,d.registerLoadBalancerType)(l,o,m)}},73496:a=>{"use strict";a.exports=require("http2")},73993:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.channelOptionsEqual=b.recognizedOptions=void 0,b.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0},b.channelOptionsEqual=function(a,b){let c=Object.keys(a).sort(),d=Object.keys(b).sort();if(c.length!==d.length)return!1;for(let e=0;e<c.length;e+=1)if(c[e]!==d[e]||a[c[e]]!==b[d[e]])return!1;return!0}},74075:a=>{"use strict";a.exports=require("zlib")},74216:(a,b)=>{"use strict";var c,d,e;Object.defineProperty(b,"__esModule",{value:!0}),b.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=b.DEFAULT_MAX_SEND_MESSAGE_LENGTH=b.Propagate=b.LogVerbosity=b.Status=void 0,function(a){a[a.OK=0]="OK",a[a.CANCELLED=1]="CANCELLED",a[a.UNKNOWN=2]="UNKNOWN",a[a.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",a[a.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",a[a.NOT_FOUND=5]="NOT_FOUND",a[a.ALREADY_EXISTS=6]="ALREADY_EXISTS",a[a.PERMISSION_DENIED=7]="PERMISSION_DENIED",a[a.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",a[a.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",a[a.ABORTED=10]="ABORTED",a[a.OUT_OF_RANGE=11]="OUT_OF_RANGE",a[a.UNIMPLEMENTED=12]="UNIMPLEMENTED",a[a.INTERNAL=13]="INTERNAL",a[a.UNAVAILABLE=14]="UNAVAILABLE",a[a.DATA_LOSS=15]="DATA_LOSS",a[a.UNAUTHENTICATED=16]="UNAUTHENTICATED"}(c||(b.Status=c={})),function(a){a[a.DEBUG=0]="DEBUG",a[a.INFO=1]="INFO",a[a.ERROR=2]="ERROR",a[a.NONE=3]="NONE"}(d||(b.LogVerbosity=d={})),function(a){a[a.DEADLINE=1]="DEADLINE",a[a.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",a[a.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",a[a.CANCELLATION=8]="CANCELLATION",a[a.DEFAULTS=65535]="DEFAULTS"}(e||(b.Propagate=e={})),b.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1,b.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4194304},74915:(a,b,c)=>{"use strict";b.Service=c(40543)},75005:(a,b,c)=>{"use strict";var d=a.exports=c(93686);function e(a,b,c){return"function"==typeof b?(c=b,b=new d.Root):b||(b=new d.Root),b.load(a,c)}function f(a,b){return b||(b=new d.Root),b.loadSync(a)}d.build="light",d.load=e,d.loadSync=f,d.encoder=c(23464),d.decoder=c(71600),d.verifier=c(6620),d.converter=c(6792),d.ReflectionObject=c(72481),d.Namespace=c(26991),d.Root=c(31502),d.Enum=c(27791),d.Type=c(68134),d.Field=c(99408),d.OneOf=c(67369),d.MapField=c(49316),d.Service=c(25811),d.Method=c(23455),d.Message=c(4755),d.wrappers=c(19006),d.types=c(18657),d.util=c(90290),d.ReflectionObject._configure(d.Root),d.Namespace._configure(d.Type,d.Service,d.Enum),d.Root._configure(d.Type),d.Field._configure(d.Type)},75645:(a,b,c)=>{"use strict";a.exports=i;var d,e=c(60054),f=e.LongBits,g=e.utf8;function h(a,b){return RangeError("index out of range: "+a.pos+" + "+(b||1)+" > "+a.len)}function i(a){this.buf=a,this.pos=0,this.len=a.length}var j="undefined"!=typeof Uint8Array?function(a){if(a instanceof Uint8Array||Array.isArray(a))return new i(a);throw Error("illegal buffer")}:function(a){if(Array.isArray(a))return new i(a);throw Error("illegal buffer")},k=function(){return e.Buffer?function(a){return(i.create=function(a){return e.Buffer.isBuffer(a)?new d(a):j(a)})(a)}:j};function l(){var a=new f(0,0),b=0;if(this.len-this.pos>4){for(;b<4;++b)if(a.lo=(a.lo|(127&this.buf[this.pos])<<7*b)>>>0,this.buf[this.pos++]<128)return a;if(a.lo=(a.lo|(127&this.buf[this.pos])<<28)>>>0,a.hi=(a.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return a;b=0}else{for(;b<3;++b){if(this.pos>=this.len)throw h(this);if(a.lo=(a.lo|(127&this.buf[this.pos])<<7*b)>>>0,this.buf[this.pos++]<128)return a}return a.lo=(a.lo|(127&this.buf[this.pos++])<<7*b)>>>0,a}if(this.len-this.pos>4){for(;b<5;++b)if(a.hi=(a.hi|(127&this.buf[this.pos])<<7*b+3)>>>0,this.buf[this.pos++]<128)return a}else for(;b<5;++b){if(this.pos>=this.len)throw h(this);if(a.hi=(a.hi|(127&this.buf[this.pos])<<7*b+3)>>>0,this.buf[this.pos++]<128)return a}throw Error("invalid varint encoding")}function m(a,b){return(a[b-4]|a[b-3]<<8|a[b-2]<<16|a[b-1]<<24)>>>0}function n(){if(this.pos+8>this.len)throw h(this,8);return new f(m(this.buf,this.pos+=4),m(this.buf,this.pos+=4))}i.create=k(),i.prototype._slice=e.Array.prototype.subarray||e.Array.prototype.slice,i.prototype.uint32=function(){var a=0xffffffff;return function(){if(a=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(a=(a|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(a=(a|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(a=(a|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(a=(a|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return a;if((this.pos+=5)>this.len)throw this.pos=this.len,h(this,10);return a}}(),i.prototype.int32=function(){return 0|this.uint32()},i.prototype.sint32=function(){var a=this.uint32();return a>>>1^-(1&a)},i.prototype.bool=function(){return 0!==this.uint32()},i.prototype.fixed32=function(){if(this.pos+4>this.len)throw h(this,4);return m(this.buf,this.pos+=4)},i.prototype.sfixed32=function(){if(this.pos+4>this.len)throw h(this,4);return 0|m(this.buf,this.pos+=4)},i.prototype.float=function(){if(this.pos+4>this.len)throw h(this,4);var a=e.float.readFloatLE(this.buf,this.pos);return this.pos+=4,a},i.prototype.double=function(){if(this.pos+8>this.len)throw h(this,4);var a=e.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,a},i.prototype.bytes=function(){var a=this.uint32(),b=this.pos,c=this.pos+a;if(c>this.len)throw h(this,a);if(this.pos+=a,Array.isArray(this.buf))return this.buf.slice(b,c);if(b===c){var d=e.Buffer;return d?d.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,b,c)},i.prototype.string=function(){var a=this.bytes();return g.read(a,0,a.length)},i.prototype.skip=function(a){if("number"==typeof a){if(this.pos+a>this.len)throw h(this,a);this.pos+=a}else do if(this.pos>=this.len)throw h(this);while(128&this.buf[this.pos++]);return this},i.prototype.skipType=function(a){switch(a){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(a=7&this.uint32());)this.skipType(a);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+a+" at offset "+this.pos)}return this},i._configure=function(a){d=a,i.create=k(),d._configure();var b=e.Long?"toLong":"toNumber";e.merge(i.prototype,{int64:function(){return l.call(this)[b](!1)},uint64:function(){return l.call(this)[b](!0)},sint64:function(){return l.call(this).zzDecode()[b](!1)},fixed64:function(){return n.call(this)[b](!0)},sfixed64:function(){return n.call(this)[b](!1)}})}},76043:a=>{"use strict";a.exports=l;var b=/[\s{}=;:[\],'"()<>]/g,c=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,d=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,e=/^ *[*/]+ */,f=/^\s*\*?\/*/,g=/\n/g,h=/\s/,i=/\\(.?)/g,j={0:"\0",r:"\r",n:"\n",t:"	"};function k(a){return a.replace(i,function(a,b){switch(b){case"\\":case"":return b;default:return j[b]||""}})}function l(a,i){a=a.toString();var j=0,l=a.length,m=1,n=0,o={},p=[],q=null;function r(a){return Error("illegal "+a+" (line "+m+")")}function s(){var b="'"===q?d:c;b.lastIndex=j-1;var e=b.exec(a);if(!e)throw r("string");return j=b.lastIndex,y(q),q=null,k(e[1])}function t(b){return a.charAt(b)}function u(b,c,d){var h,j={type:a.charAt(b++),lineEmpty:!1,leading:d},k=b-(i?2:3);do if(--k<0||"\n"===(h=a.charAt(k))){j.lineEmpty=!0;break}while(" "===h||"	"===h);for(var l=a.substring(b,c).split(g),p=0;p<l.length;++p)l[p]=l[p].replace(i?f:e,"").trim();j.text=l.join("\n").trim(),o[m]=j,n=m}function v(b){var c=w(b),d=a.substring(b,c);return/^\s*\/\//.test(d)}function w(a){for(var b=a;b<l&&"\n"!==t(b);)b++;return b}function x(){if(p.length>0)return p.shift();if(q)return s();var c,d,e,f,g,k=0===j;do{if(j===l)return null;for(c=!1;h.test(e=t(j));)if("\n"===e&&(k=!0,++m),++j===l)return null;if("/"===t(j)){if(++j===l)throw r("comment");if("/"===t(j))if(i){if(f=j,g=!1,v(j-1)){g=!0;do if((j=w(j))===l||(j++,!k))break;while(v(j))}else j=Math.min(l,w(j)+1);g&&(u(f,j,k),k=!0),m++,c=!0}else{for(g="/"===t(f=j+1);"\n"!==t(++j);)if(j===l)return null;++j,g&&(u(f,j-1,k),k=!0),++m,c=!0}else{if("*"!==(e=t(j)))return"/";f=j+1,g=i||"*"===t(f);do{if("\n"===e&&++m,++j===l)throw r("comment");d=e,e=t(j)}while("*"!==d||"/"!==e);++j,g&&(u(f,j-2,k),k=!0),c=!0}}}while(c);var n=j;if(b.lastIndex=0,!b.test(t(n++)))for(;n<l&&!b.test(t(n));)++n;var o=a.substring(j,j=n);return('"'===o||"'"===o)&&(q=o),o}function y(a){p.push(a)}function z(){if(!p.length){var a=x();if(null===a)return null;y(a)}return p[0]}function A(a,b){var c=z();if(c===a)return x(),!0;if(!b)throw r("token '"+c+"', '"+a+"' expected");return!1}function B(a){var b,c=null;return void 0===a?(b=o[m-1],delete o[m-1],b&&(i||"*"===b.type||b.lineEmpty)&&(c=b.leading?b.text:null)):(n<a&&z(),b=o[a],delete o[a],b&&!b.lineEmpty&&(i||"/"===b.type)&&(c=b.leading?null:b.text)),c}return Object.defineProperty({next:x,peek:z,push:y,skip:A,cmnt:B},"line",{get:function(){return m}})}l.unescape=k},77508:(a,b)=>{"use strict";var c;Object.defineProperty(b,"__esModule",{value:!0}),b.StreamDecoder=void 0,function(a){a[a.NO_DATA=0]="NO_DATA",a[a.READING_SIZE=1]="READING_SIZE",a[a.READING_MESSAGE=2]="READING_MESSAGE"}(c||(c={}));class d{constructor(a){this.maxReadMessageLength=a,this.readState=c.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(a){let b,d=0,e=[];for(;d<a.length;)switch(this.readState){case c.NO_DATA:this.readCompressFlag=a.slice(d,d+1),d+=1,this.readState=c.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case c.READING_SIZE:if(b=Math.min(a.length-d,this.readSizeRemaining),a.copy(this.readPartialSize,4-this.readSizeRemaining,d,d+b),this.readSizeRemaining-=b,d+=b,0===this.readSizeRemaining){if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),-1!==this.maxReadMessageLength&&this.readMessageSize>this.maxReadMessageLength)throw Error(`Received message larger than max (${this.readMessageSize} vs ${this.maxReadMessageLength})`);if(this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=c.READING_MESSAGE;else{let a=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=c.NO_DATA,e.push(a)}}break;case c.READING_MESSAGE:if(b=Math.min(a.length-d,this.readMessageRemaining),this.readPartialMessage.push(a.slice(d,d+b)),this.readMessageRemaining-=b,d+=b,0===this.readMessageRemaining){let a=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),b=Buffer.concat(a,this.readMessageSize+5);this.readState=c.NO_DATA,e.push(b)}break;default:throw Error("Unexpected read state")}return e}}b.StreamDecoder=d},78484:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.RetryingCall=b.MessageBufferTracker=b.RetryThrottler=void 0;let d=c(74216),e=c(39316),f=c(49152),g="retrying_call";class h{constructor(a,b,c){this.maxTokens=a,this.tokenRatio=b,c?this.tokens=c.tokens*(a/c.maxTokens):this.tokens=a}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}}b.RetryThrottler=h;class i{constructor(a,b){this.totalLimit=a,this.limitPerCall=b,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(a,b){var c;let d=null!=(c=this.allocatedPerCall.get(b))?c:0;return!(this.limitPerCall-d<a)&&!(this.totalLimit-this.totalAllocated<a)&&(this.allocatedPerCall.set(b,d+a),this.totalAllocated+=a,!0)}free(a,b){var c;if(this.totalAllocated<a)throw Error(`Invalid buffer allocation state: call ${b} freed ${a} > total allocated ${this.totalAllocated}`);this.totalAllocated-=a;let d=null!=(c=this.allocatedPerCall.get(b))?c:0;if(d<a)throw Error(`Invalid buffer allocation state: call ${b} freed ${a} > allocated for call ${d}`);this.allocatedPerCall.set(b,d-a)}freeAll(a){var b;let c=null!=(b=this.allocatedPerCall.get(a))?b:0;if(this.totalAllocated<c)throw Error(`Invalid buffer allocation state: call ${a} allocated ${c} > total allocated ${this.totalAllocated}`);this.totalAllocated-=c,this.allocatedPerCall.delete(a)}}b.MessageBufferTracker=i;let j="grpc-previous-rpc-attempts";class k{constructor(a,b,c,d,e,f,g,h,i){if(this.channel=a,this.callConfig=b,this.methodName=c,this.host=d,this.credentials=e,this.deadline=f,this.callNumber=g,this.bufferTracker=h,this.retryThrottler=i,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,b.methodConfig.retryPolicy){this.state="RETRY";let a=b.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(a.initialBackoff.substring(0,a.initialBackoff.length-1))}else b.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(a){f.trace(d.LogVerbosity.DEBUG,g,"["+this.callNumber+"] "+a)}reportStatus(a){this.trace("ended with status: code="+a.code+' details="'+a.details+'"'),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var b;null==(b=this.listener)||b.onReceiveStatus({code:a.code,details:a.details,metadata:a.metadata})})}cancelWithStatus(a,b){for(let{call:c}of(this.trace("cancelWithStatus code: "+a+' details: "'+b+'"'),this.reportStatus({code:a,details:b,metadata:new e.Metadata}),this.underlyingCalls))c.cancelWithStatus(a,b)}getPeer(){return null!==this.committedCallIndex?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(a){var b;return null!=(b=this.writeBuffer[a-this.writeBufferOffset])?b:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if("COMMITTED"!==this.state)return;let a=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let b=this.writeBufferOffset;b<a;b++){let a=this.getBufferEntry(b);a.allocated&&this.bufferTracker.free(a.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(a-this.writeBufferOffset),this.writeBufferOffset=a}commitCall(a){if("COMMITTED"!==this.state&&"COMPLETED"!==this.underlyingCalls[a].state){this.trace("Committing call ["+this.underlyingCalls[a].call.getCallNumber()+"] at index "+a),this.state="COMMITTED",this.committedCallIndex=a;for(let b=0;b<this.underlyingCalls.length;b++)b!==a&&"COMPLETED"!==this.underlyingCalls[b].state&&(this.underlyingCalls[b].state="COMPLETED",this.underlyingCalls[b].call.cancelWithStatus(d.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if("COMMITTED"===this.state)return;let a=-1,b=-1;for(let[c,d]of this.underlyingCalls.entries())"ACTIVE"===d.state&&d.nextMessageToSend>a&&(a=d.nextMessageToSend,b=c);-1===b?this.state="TRANSPARENT_ONLY":this.commitCall(b)}isStatusCodeInList(a,b){return a.some(a=>a===b||a.toString().toLowerCase()===d.Status[b].toLowerCase())}getNextRetryBackoffMs(){var a;let b=null==(a=this.callConfig)?void 0:a.methodConfig.retryPolicy;if(!b)return 0;let c=Math.random()*this.nextRetryBackoffSec*1e3,d=Number(b.maxBackoff.substring(0,b.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*b.backoffMultiplier,d),c}maybeRetryCall(a,b){let c;if("RETRY"!==this.state)return void b(!1);let d=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(d.maxAttempts,5))return void b(!1);if(null===a)c=this.getNextRetryBackoffMs();else if(a<0){this.state="TRANSPARENT_ONLY",b(!1);return}else c=a,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var a,c;if("RETRY"!==this.state)return void b(!1);(null==(c=null==(a=this.retryThrottler)?void 0:a.canRetryCall())||c)&&(b(!0),this.attempts+=1,this.startNewAttempt())},c)}countActiveCalls(){let a=0;for(let b of this.underlyingCalls)(null==b?void 0:b.state)==="ACTIVE"&&(a+=1);return a}handleProcessedStatus(a,b,c){var d,e,f;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(b),this.reportStatus(a);break;case"HEDGING":if(this.isStatusCodeInList(null!=(d=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)?d:[],a.code)){let d;if(null==(e=this.retryThrottler)||e.addCallFailed(),null===c)d=0;else if(c<0){this.state="TRANSPARENT_ONLY",this.commitCall(b),this.reportStatus(a);return}else d=c;setTimeout(()=>{this.maybeStartHedgingAttempt(),0===this.countActiveCalls()&&(this.commitCall(b),this.reportStatus(a))},d)}else this.commitCall(b),this.reportStatus(a);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,a.code)?(null==(f=this.retryThrottler)||f.addCallFailed(),this.maybeRetryCall(c,c=>{c||(this.commitCall(b),this.reportStatus(a))})):(this.commitCall(b),this.reportStatus(a))}}getPushback(a){let b=a.get("grpc-retry-pushback-ms");if(0===b.length)return null;try{return parseInt(b[0])}catch(a){return -1}}handleChildStatus(a,b){var c;if("COMPLETED"===this.underlyingCalls[b].state)return;if(this.trace("state="+this.state+" handling status with progress "+a.progress+" from child ["+this.underlyingCalls[b].call.getCallNumber()+"] in state "+this.underlyingCalls[b].state),this.underlyingCalls[b].state="COMPLETED",a.code===d.Status.OK){null==(c=this.retryThrottler)||c.addCallSucceeded(),this.commitCall(b),this.reportStatus(a);return}if("COMMITTED"===this.state)return void this.reportStatus(a);let e=this.getPushback(a.metadata);switch(a.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(a,b,e):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(b),this.reportStatus(a);break;case"PROCESSED":this.handleProcessedStatus(a,b,e)}}maybeStartHedgingAttempt(){if("HEDGING"!==this.state||!this.callConfig.methodConfig.hedgingPolicy)return;let a=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(a.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var a,b,c;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),"HEDGING"!==this.state||!this.callConfig.methodConfig.hedgingPolicy)return;let d=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(d.maxAttempts,5))return;let e=null!=(a=d.hedgingDelay)?a:"0s",f=Number(e.substring(0,e.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},1e3*f),null==(c=(b=this.hedgingTimer).unref)||c.call(b)}startNewAttempt(){let a=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+a.getCallNumber()+"] for attempt "+this.attempts);let b=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:a,nextMessageToSend:0});let c=this.attempts-1,d=this.initialMetadata.clone();c>0&&d.set(j,`${c}`);let e=!1;a.start(d,{onReceiveMetadata:d=>{this.trace("Received metadata from child ["+a.getCallNumber()+"]"),this.commitCall(b),e=!0,c>0&&d.set(j,`${c}`),"ACTIVE"===this.underlyingCalls[b].state&&this.listener.onReceiveMetadata(d)},onReceiveMessage:c=>{this.trace("Received message from child ["+a.getCallNumber()+"]"),this.commitCall(b),"ACTIVE"===this.underlyingCalls[b].state&&this.listener.onReceiveMessage(c)},onReceiveStatus:d=>{this.trace("Received status from child ["+a.getCallNumber()+"]"),!e&&c>0&&d.metadata.set(j,`${c}`),this.handleChildStatus(d,b)}}),this.sendNextChildMessage(b),this.readStarted&&a.startRead()}start(a,b){this.trace("start called"),this.listener=b,this.initialMetadata=a,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(a){var b,c;let d=this.underlyingCalls[a],e=d.nextMessageToSend;null==(c=(b=this.getBufferEntry(e)).callback)||c.call(b),this.clearSentMessages(),d.nextMessageToSend+=1,this.sendNextChildMessage(a)}sendNextChildMessage(a){let b=this.underlyingCalls[a];if("COMPLETED"!==b.state&&this.getBufferEntry(b.nextMessageToSend)){let c=this.getBufferEntry(b.nextMessageToSend);switch(c.entryType){case"MESSAGE":b.call.sendMessageWithContext({callback:b=>{this.handleChildWriteCompleted(a)}},c.message.message);break;case"HALF_CLOSE":b.nextMessageToSend+=1,b.call.halfClose()}}}sendMessageWithContext(a,b){var c;this.trace("write() called with message of length "+b.length);let d={message:b,flags:a.flags},e=this.getNextBufferIndex(),f={entryType:"MESSAGE",message:d,allocated:this.bufferTracker.allocate(b.length,this.callNumber)};if(this.writeBuffer.push(f),f.allocated)for(let[d,f]of(null==(c=a.callback)||c.call(a),this.underlyingCalls.entries()))"ACTIVE"===f.state&&f.nextMessageToSend===e&&f.call.sendMessageWithContext({callback:a=>{this.handleChildWriteCompleted(d)}},b);else{if(this.commitCallWithMostMessages(),null===this.committedCallIndex)return;let c=this.underlyingCalls[this.committedCallIndex];f.callback=a.callback,"ACTIVE"===c.state&&c.nextMessageToSend===e&&c.call.sendMessageWithContext({callback:a=>{this.handleChildWriteCompleted(this.committedCallIndex)}},b)}}startRead(){for(let a of(this.trace("startRead called"),this.readStarted=!0,this.underlyingCalls))(null==a?void 0:a.state)==="ACTIVE"&&a.call.startRead()}halfClose(){this.trace("halfClose called");let a=this.getNextBufferIndex();for(let b of(this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1}),this.underlyingCalls))(null==b?void 0:b.state)==="ACTIVE"&&b.nextMessageToSend===a&&(b.nextMessageToSend+=1,b.call.halfClose())}setCredentials(a){throw Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}}b.RetryingCall=k},78548:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Http2SubchannelConnector=void 0;let d=c(73496),e=c(34631),f=c(16050),g=c(74216),h=c(15982),i=c(49152),j=c(98675),k=c(41509),l=c(30999),m=c(91645),n=c(4721),o=c(20407),p="transport",q="transport_flowctrl",r=c(28592).rE,{HTTP2_HEADER_AUTHORITY:s,HTTP2_HEADER_CONTENT_TYPE:t,HTTP2_HEADER_METHOD:u,HTTP2_HEADER_PATH:v,HTTP2_HEADER_TE:w,HTTP2_HEADER_USER_AGENT:x}=d.constants,y=2e4,z=Buffer.from("too_many_pings","ascii");class A{constructor(a,b,c,e){this.session=a,this.options=c,this.remoteName=e,this.keepaliveTimeMs=-1,this.keepaliveTimeoutMs=y,this.keepaliveTimerId=null,this.pendingSendKeepalivePing=!1,this.keepaliveTimeoutId=null,this.keepaliveWithoutCalls=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.streamTracker=new f.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,k.subchannelAddressToString)(b),0===c["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,f.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[c["grpc.primary_user_agent"],`grpc-node-js/${r}`,c["grpc.secondary_user_agent"]].filter(a=>a).join(" "),"grpc.keepalive_time_ms"in c&&(this.keepaliveTimeMs=c["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in c&&(this.keepaliveTimeoutMs=c["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in c?this.keepaliveWithoutCalls=1===c["grpc.keepalive_permit_without_calls"]:this.keepaliveWithoutCalls=!1,a.once("close",()=>{this.trace("session closed"),this.stopKeepalivePings(),this.handleDisconnect()}),a.once("goaway",(a,b,c)=>{let e=!1;a===d.constants.NGHTTP2_ENHANCE_YOUR_CALM&&c&&c.equals(z)&&(e=!0),this.trace("connection closed by GOAWAY with code "+a+" and data "+(null==c?void 0:c.toString())),this.reportDisconnectToOwner(e)}),a.once("error",a=>{this.trace("connection closed with error "+a.message)}),i.isTracerEnabled(p)&&(a.on("remoteSettings",b=>{this.trace("new settings received"+(this.session!==a?" on the old connection":"")+": "+JSON.stringify(b))}),a.on("localSettings",b=>{this.trace("local settings acknowledged by remote"+(this.session!==a?" on the old connection":"")+": "+JSON.stringify(b))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var a,b,c;let d,e=this.session.socket,f=e.remoteAddress?(0,k.stringToSubchannelAddress)(e.remoteAddress,e.remotePort):null,g=e.localAddress?(0,k.stringToSubchannelAddress)(e.localAddress,e.localPort):null;if(this.session.encrypted){let b=e,c=b.getCipher(),f=b.getCertificate(),g=b.getPeerCertificate();d={cipherSuiteStandardName:null!=(a=c.standardName)?a:null,cipherSuiteOtherName:c.standardName?null:c.name,localCertificate:f&&"raw"in f?f.raw:null,remoteCertificate:g&&"raw"in g?g.raw:null}}else d=null;return{remoteAddress:f,localAddress:g,security:d,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:null!=(b=this.session.state.localWindowSize)?b:null,remoteFlowControlWindow:null!=(c=this.session.state.remoteWindowSize)?c:null}}trace(a){i.trace(g.LogVerbosity.DEBUG,p,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+a)}keepaliveTrace(a){i.trace(g.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+a)}flowControlTrace(a){i.trace(g.LogVerbosity.DEBUG,q,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+a)}internalsTrace(a){i.trace(g.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+a)}reportDisconnectToOwner(a){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(b=>b(a)))}handleDisconnect(){this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let a of this.activeCalls)a.onDisconnect()})}addDisconnectListener(a){this.disconnectListeners.push(a)}clearKeepaliveTimer(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null)}clearKeepaliveTimeout(){this.keepaliveTimeoutId&&(clearTimeout(this.keepaliveTimeoutId),this.keepaliveTimeoutId=null)}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var a,b;if(this.clearKeepaliveTimer(),!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId||(this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),null==(b=(a=this.keepaliveTimeoutId).unref)||b.call(a));try{this.session.ping((a,b,c)=>{a&&(this.keepaliveTrace("Ping failed with error "+a.message),this.handleDisconnect()),this.keepaliveTrace("Received ping response"),this.clearKeepaliveTimeout(),this.maybeStartKeepalivePingTimer()})}catch(a){this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var a,b;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):this.keepaliveTimerId||this.keepaliveTimeoutId||(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimerId=null==(b=(a=setTimeout(()=>{this.maybeSendPing()},this.keepaliveTimeMs)).unref)?void 0:b.call(a)))}stopKeepalivePings(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null),this.clearKeepaliveTimeout()}removeActiveCall(a){this.activeCalls.delete(a),0===this.activeCalls.size&&this.session.unref()}addActiveCall(a){this.activeCalls.add(a),1===this.activeCalls.size&&(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(a,b,c,d,e){let f,g,h,i=a.toHttp2Headers();i[s]=b,i[x]=this.userAgent,i[t]="application/grpc",i[u]="POST",i[v]=c,i[w]="trailers";try{f=this.session.request(i)}catch(a){throw this.handleDisconnect(),a}return this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed),this.channelzEnabled?(this.streamTracker.addCallStarted(),g={addMessageSent:()=>{var a;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,null==(a=e.addMessageSent)||a.call(e)},addMessageReceived:()=>{var a;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,null==(a=e.addMessageReceived)||a.call(e)},onCallEnd:a=>{var b;null==(b=e.onCallEnd)||b.call(e,a),this.removeActiveCall(h)},onStreamEnd:a=>{var b;a?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),null==(b=e.onStreamEnd)||b.call(e,a)}}):g={addMessageSent:()=>{var a;null==(a=e.addMessageSent)||a.call(e)},addMessageReceived:()=>{var a;null==(a=e.addMessageReceived)||a.call(e)},onCallEnd:a=>{var b;null==(b=e.onCallEnd)||b.call(e,a),this.removeActiveCall(h)},onStreamEnd:a=>{var b;null==(b=e.onStreamEnd)||b.call(e,a)}},h=new n.Http2SubchannelCall(f,g,d,this,(0,o.getNextCallNumber)()),this.addActiveCall(h),h}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}getOptions(){return this.options}shutdown(){this.session.close(),(0,f.unregisterChannelzRef)(this.channelzRef)}}class B{constructor(a){this.channelTarget=a,this.session=null,this.isShutdown=!1}trace(a){i.trace(g.LogVerbosity.DEBUG,p,(0,l.uriToString)(this.channelTarget)+" "+a)}createSession(a,b,c,f){return this.isShutdown?Promise.reject():new Promise((g,h)=>{var i,n,o;let p;f.realTarget?(p=(0,l.uriToString)(f.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,l.uriToString)(f.realTarget))):(p=null,this.trace("creating HTTP/2 session to "+(0,k.subchannelAddressToString)(a)));let q=(0,j.getDefaultAuthority)(null!=(i=f.realTarget)?i:this.channelTarget),r=b._getConnectionOptions()||{};r.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in c?r.maxSessionMemory=c["grpc-node.max_session_memory"]:r.maxSessionMemory=Number.MAX_SAFE_INTEGER;let s="http://";if("secureContext"in r){if(s="https://",c["grpc.ssl_target_name_override"]){let a=c["grpc.ssl_target_name_override"];r.checkServerIdentity=(b,c)=>(0,e.checkServerIdentity)(a,c),r.servername=a}else{let a=null!=(o=null==(n=(0,l.splitHostPort)(q))?void 0:n.host)?o:"localhost";r.servername=a}f.socket&&(r.createConnection=(a,b)=>f.socket)}else r.createConnection=(b,c)=>f.socket?f.socket:m.connect(a);r=Object.assign(Object.assign(Object.assign({},r),a),{enableTrace:1===c["grpc-node.tls_enable_trace"]});let t=d.connect(s+q,r);this.session=t;let u="Failed to connect";t.unref(),t.once("connect",()=>{t.removeAllListeners(),g(new A(t,a,c,p)),this.session=null}),t.once("close",()=>{this.session=null,setImmediate(()=>{h(`${u} (${new Date().toISOString()})`)})}),t.once("error",a=>{u=a.message,this.trace("connection failed with error "+u)})})}connect(a,b,c){var d,f;if(this.isShutdown)return Promise.reject();let g=b._getConnectionOptions()||{};if("secureContext"in g){if(g.ALPNProtocols=["h2"],c["grpc.ssl_target_name_override"]){let a=c["grpc.ssl_target_name_override"];g.checkServerIdentity=(b,c)=>(0,e.checkServerIdentity)(a,c),g.servername=a}else if("grpc.http_connect_target"in c){let a=(0,j.getDefaultAuthority)(null!=(d=(0,l.parseUri)(c["grpc.http_connect_target"]))?d:{path:"localhost"}),b=(0,l.splitHostPort)(a);g.servername=null!=(f=null==b?void 0:b.host)?f:a}c["grpc-node.tls_enable_trace"]&&(g.enableTrace=!0)}return(0,h.getProxiedConnection)(a,c,g).then(d=>this.createSession(a,b,c,d))}shutdown(){var a;this.isShutdown=!0,null==(a=this.session)||a.close(),this.session=null}}b.Http2SubchannelConnector=B},79546:(a,b,c)=>{"use strict";a.exports=f;var d=c(75645);(f.prototype=Object.create(d.prototype)).constructor=f;var e=c(60054);function f(a){d.call(this,a)}f._configure=function(){e.Buffer&&(f.prototype._slice=e.Buffer.prototype.slice)},f.prototype.string=function(){var a=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+a,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+a,this.len))},f._configure()},79551:a=>{"use strict";a.exports=require("url")},80275:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OutlierDetectionLoadBalancingConfig=b.BaseSubchannelWrapper=b.registerAdminService=b.FilterStackFactory=b.BaseFilter=b.PickResultType=b.QueuePicker=b.UnavailablePicker=b.ChildLoadBalancerHandler=b.subchannelAddressToString=b.validateLoadBalancingConfig=b.getFirstUsableConfig=b.registerLoadBalancerType=b.createChildChannelControlHelper=b.BackoffTimeout=b.durationToMs=b.uriToString=b.createResolver=b.registerResolver=b.log=b.trace=void 0;var d=c(49152);Object.defineProperty(b,"trace",{enumerable:!0,get:function(){return d.trace}}),Object.defineProperty(b,"log",{enumerable:!0,get:function(){return d.log}});var e=c(98675);Object.defineProperty(b,"registerResolver",{enumerable:!0,get:function(){return e.registerResolver}}),Object.defineProperty(b,"createResolver",{enumerable:!0,get:function(){return e.createResolver}});var f=c(30999);Object.defineProperty(b,"uriToString",{enumerable:!0,get:function(){return f.uriToString}});var g=c(60649);Object.defineProperty(b,"durationToMs",{enumerable:!0,get:function(){return g.durationToMs}});var h=c(54447);Object.defineProperty(b,"BackoffTimeout",{enumerable:!0,get:function(){return h.BackoffTimeout}});var i=c(64432);Object.defineProperty(b,"createChildChannelControlHelper",{enumerable:!0,get:function(){return i.createChildChannelControlHelper}}),Object.defineProperty(b,"registerLoadBalancerType",{enumerable:!0,get:function(){return i.registerLoadBalancerType}}),Object.defineProperty(b,"getFirstUsableConfig",{enumerable:!0,get:function(){return i.getFirstUsableConfig}}),Object.defineProperty(b,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return i.validateLoadBalancingConfig}});var j=c(41509);Object.defineProperty(b,"subchannelAddressToString",{enumerable:!0,get:function(){return j.subchannelAddressToString}});var k=c(9054);Object.defineProperty(b,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return k.ChildLoadBalancerHandler}});var l=c(34979);Object.defineProperty(b,"UnavailablePicker",{enumerable:!0,get:function(){return l.UnavailablePicker}}),Object.defineProperty(b,"QueuePicker",{enumerable:!0,get:function(){return l.QueuePicker}}),Object.defineProperty(b,"PickResultType",{enumerable:!0,get:function(){return l.PickResultType}});var m=c(6775);Object.defineProperty(b,"BaseFilter",{enumerable:!0,get:function(){return m.BaseFilter}});var n=c(88474);Object.defineProperty(b,"FilterStackFactory",{enumerable:!0,get:function(){return n.FilterStackFactory}});var o=c(72342);Object.defineProperty(b,"registerAdminService",{enumerable:!0,get:function(){return o.registerAdminService}});var p=c(36454);Object.defineProperty(b,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return p.BaseSubchannelWrapper}});var q=c(9827);Object.defineProperty(b,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return q.OutlierDetectionLoadBalancingConfig}})},81165:a=>{"use strict";a.exports=function a(a,b){for(var c=Array(arguments.length-1),d=0,e=2,f=!0;e<arguments.length;)c[d++]=arguments[e++];return new Promise(function(e,g){c[d]=function(a){if(f)if(f=!1,a)g(a);else{for(var b=Array(arguments.length-1),c=0;c<b.length;)b[c++]=arguments[c];e.apply(null,b)}};try{a.apply(b||null,c)}catch(a){f&&(f=!1,g(a))}})}},81630:a=>{"use strict";a.exports=require("http")},82566:a=>{"use strict";a.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Api":{"fields":{"name":{"type":"string","id":1},"methods":{"rule":"repeated","type":"Method","id":2},"options":{"rule":"repeated","type":"Option","id":3},"version":{"type":"string","id":4},"sourceContext":{"type":"SourceContext","id":5},"mixins":{"rule":"repeated","type":"Mixin","id":6},"syntax":{"type":"Syntax","id":7}}},"Method":{"fields":{"name":{"type":"string","id":1},"requestTypeUrl":{"type":"string","id":2},"requestStreaming":{"type":"bool","id":3},"responseTypeUrl":{"type":"string","id":4},"responseStreaming":{"type":"bool","id":5},"options":{"rule":"repeated","type":"Option","id":6},"syntax":{"type":"Syntax","id":7}}},"Mixin":{"fields":{"name":{"type":"string","id":1},"root":{"type":"string","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}}}}}}}}')},84672:(a,b,c)=>{Promise.resolve().then(c.bind(c,60967))},85842:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.CallCredentials=void 0;let d=c(39316);function e(a){return"getRequestHeaders"in a&&"function"==typeof a.getRequestHeaders}class f{static createFromMetadataGenerator(a){return new h(a)}static createFromGoogleCredential(a){return f.createFromMetadataGenerator((b,c)=>{let f;(f=e(a)?a.getRequestHeaders(b.service_url):new Promise((c,d)=>{a.getRequestMetadata(b.service_url,(a,b)=>a?void d(a):b?void c(b):void d(Error("Headers not set by metadata plugin")))})).then(a=>{let b=new d.Metadata;for(let c of Object.keys(a))b.add(c,a[c]);c(null,b)},a=>{c(a)})})}static createEmpty(){return new i}}b.CallCredentials=f;class g extends f{constructor(a){super(),this.creds=a}async generateMetadata(a){let b=new d.Metadata;for(let c of(await Promise.all(this.creds.map(b=>b.generateMetadata(a)))))b.merge(c);return b}compose(a){return new g(this.creds.concat([a]))}_equals(a){return this===a||a instanceof g&&this.creds.every((b,c)=>b._equals(a.creds[c]))}}class h extends f{constructor(a){super(),this.metadataGenerator=a}generateMetadata(a){return new Promise((b,c)=>{this.metadataGenerator(a,(a,d)=>{void 0!==d?b(d):c(a)})})}compose(a){return new g([this,a])}_equals(a){return this===a||a instanceof h&&this.metadataGenerator===a.metadataGenerator}}class i extends f{generateMetadata(a){return Promise.resolve(new d.Metadata)}compose(a){return a}_equals(a){return a instanceof i}}},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},88174:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.restrictControlPlaneStatusCode=void 0;let d=c(74216),e=[d.Status.OK,d.Status.INVALID_ARGUMENT,d.Status.NOT_FOUND,d.Status.ALREADY_EXISTS,d.Status.FAILED_PRECONDITION,d.Status.ABORTED,d.Status.OUT_OF_RANGE,d.Status.DATA_LOSS];b.restrictControlPlaneStatusCode=function(a,b){return e.includes(a)?{code:d.Status.INTERNAL,details:`Invalid status from control plane: ${a} ${d.Status[a]} ${b}`}:{code:a,details:b}}},88474:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.FilterStackFactory=b.FilterStack=void 0;class c{constructor(a){this.filters=a}sendMetadata(a){let b=a;for(let a=0;a<this.filters.length;a++)b=this.filters[a].sendMetadata(b);return b}receiveMetadata(a){let b=a;for(let a=this.filters.length-1;a>=0;a--)b=this.filters[a].receiveMetadata(b);return b}sendMessage(a){let b=a;for(let a=0;a<this.filters.length;a++)b=this.filters[a].sendMessage(b);return b}receiveMessage(a){let b=a;for(let a=this.filters.length-1;a>=0;a--)b=this.filters[a].receiveMessage(b);return b}receiveTrailers(a){let b=a;for(let a=this.filters.length-1;a>=0;a--)b=this.filters[a].receiveTrailers(b);return b}push(a){this.filters.unshift(...a)}getFilters(){return this.filters}}b.FilterStack=c;class d{constructor(a){this.factories=a}push(a){this.factories.unshift(...a)}clone(){return new d([...this.factories])}createFilter(){return new c(this.factories.map(a=>a.createFilter()))}}b.FilterStackFactory=d},88523:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ResolvingCall=void 0;let d=c(74216),e=c(47989),f=c(39316),g=c(49152),h=c(88174),i="resolving_call";class j{constructor(a,b,c,f,g,h){this.channel=a,this.method=b,this.filterStackFactory=f,this.credentials=g,this.callNumber=h,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadline=c.deadline,this.host=c.host,c.parentCall&&(c.flags&d.Propagate.CANCELLATION&&c.parentCall.on("cancelled",()=>{this.cancelWithStatus(d.Status.CANCELLED,"Cancelled by parent call")}),c.flags&d.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+c.parentCall.getDeadline()),this.deadline=(0,e.minDeadline)(this.deadline,c.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(a){g.trace(d.LogVerbosity.DEBUG,i,"["+this.callNumber+"] "+a)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.trace("Deadline: "+(0,e.deadlineToString)(this.deadline));let a=(0,e.getRelativeTimeout)(this.deadline);if(a!==1/0){this.trace("Deadline will be reached in "+a+"ms");let b=()=>{this.cancelWithStatus(d.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};a<=0?process.nextTick(b):this.deadlineTimer=setTimeout(b,a)}}outputStatus(a){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let b=this.filterStack.receiveTrailers(a);this.trace("ended with status: code="+b.code+' details="'+b.details+'"'),this.statusWatchers.forEach(a=>a(b)),process.nextTick(()=>{var a;null==(a=this.listener)||a.onReceiveStatus(b)})}}sendMessageOnChild(a,b){if(!this.child)throw Error("sendMessageonChild called with child not populated");let c=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:b,flags:a.flags})).then(b=>{this.writeFilterPending=!1,c.sendMessageWithContext(a,b.message),this.pendingHalfClose&&c.halfClose()},a=>{this.cancelWithStatus(a.code,a.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw Error("getConfig called before start");let a=this.channel.getConfig(this.method,this.metadata);if("NONE"===a.type)return void this.channel.queueCallForConfig(this);if("ERROR"===a.type)return void(this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(a.error));let b=a.config;if(b.status!==d.Status.OK){let{code:a,details:c}=(0,h.restrictControlPlaneStatusCode)(b.status,"Failed to route call to method "+this.method);this.outputStatus({code:a,details:c,metadata:new f.Metadata});return}if(b.methodConfig.timeout){let a=new Date;a.setSeconds(a.getSeconds()+b.methodConfig.timeout.seconds),a.setMilliseconds(a.getMilliseconds()+b.methodConfig.timeout.nanos/1e6),this.deadline=(0,e.minDeadline)(this.deadline,a),this.runDeadlineTimer()}this.filterStackFactory.push(b.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(a=>{this.child=this.channel.createInnerCall(b,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.child.start(a,{onReceiveMetadata:a=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(a))},onReceiveMessage:a=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(a).then(a=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(a),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},a=>{this.cancelWithStatus(a.code,a.details)})},onReceiveStatus:a=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=a:this.outputStatus(a)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},a=>{this.outputStatus(a)})}reportResolverError(a){var b;(null==(b=this.metadata)?void 0:b.getOptions().waitForReady)?this.channel.queueCallForConfig(this):this.outputStatus(a)}cancelWithStatus(a,b){var c;this.trace("cancelWithStatus code: "+a+' details: "'+b+'"'),null==(c=this.child)||c.cancelWithStatus(a,b),this.outputStatus({code:a,details:b,metadata:new f.Metadata})}getPeer(){var a,b;return null!=(b=null==(a=this.child)?void 0:a.getPeer())?b:this.channel.getTarget()}start(a,b){this.trace("start called"),this.metadata=a.clone(),this.listener=b,this.getConfig()}sendMessageWithContext(a,b){this.trace("write() called with message of length "+b.length),this.child?this.sendMessageOnChild(a,b):this.pendingMessage={context:a,message:b}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(a){this.credentials=this.credentials.compose(a)}addStatusWatcher(a){this.statusWatchers.push(a)}getCallNumber(){return this.callNumber}}b.ResolvingCall=j},90146:a=>{"use strict";a.exports=function a(a,b,c){var d=c||8192,e=d>>>1,f=null,g=d;return function(c){if(c<1||c>e)return a(c);g+c>d&&(f=a(d),g=0);var h=b.call(f,g,g+=c);return 7&g&&(g=(7|g)+1),h}}},90290:(a,b,c)=>{"use strict";var d,e,f=a.exports=c(60054),g=c(27481);f.codegen=c(96953),f.fetch=c(26740),f.path=c(70051),f.fs=f.inquire("fs"),f.toArray=function(a){if(a){for(var b=Object.keys(a),c=Array(b.length),d=0;d<b.length;)c[d]=a[b[d++]];return c}return[]},f.toObject=function(a){for(var b={},c=0;c<a.length;){var d=a[c++],e=a[c++];void 0!==e&&(b[d]=e)}return b};var h=/\\/g,i=/"/g;f.isReserved=function(a){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(a)},f.safeProp=function(a){return!/^[$\w_]+$/.test(a)||f.isReserved(a)?'["'+a.replace(h,"\\\\").replace(i,'\\"')+'"]':"."+a},f.ucFirst=function(a){return a.charAt(0).toUpperCase()+a.substring(1)};var j=/_([a-z])/g;f.camelCase=function(a){return a.substring(0,1)+a.substring(1).replace(j,function(a,b){return b.toUpperCase()})},f.compareFieldsById=function(a,b){return a.id-b.id},f.decorateType=function(a,b){if(a.$type)return b&&a.$type.name!==b&&(f.decorateRoot.remove(a.$type),a.$type.name=b,f.decorateRoot.add(a.$type)),a.$type;d||(d=c(68134));var e=new d(b||a.name);return f.decorateRoot.add(e),e.ctor=a,Object.defineProperty(a,"$type",{value:e,enumerable:!1}),Object.defineProperty(a.prototype,"$type",{value:e,enumerable:!1}),e};var k=0;f.decorateEnum=function(a){if(a.$type)return a.$type;e||(e=c(27791));var b=new e("Enum"+k++,a);return f.decorateRoot.add(b),Object.defineProperty(a,"$type",{value:b,enumerable:!1}),b},f.setProperty=function(a,b,c,d){function e(a,b,c){var f=b.shift();if("__proto__"===f||"prototype"===f)return a;if(b.length>0)a[f]=e(a[f]||{},b,c);else{var g=a[f];if(g&&d)return a;g&&(c=[].concat(g).concat(c)),a[f]=c}return a}if("object"!=typeof a)throw TypeError("dst must be an object");if(!b)throw TypeError("path must be specified");return e(a,b=b.split("."),c)},Object.defineProperty(f,"decorateRoot",{get:function(){return g.decorated||(g.decorated=new(c(31502)))}})},91043:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.setup=b.PickFirstLoadBalancer=b.shuffled=b.PickFirstLoadBalancingConfig=void 0;let d=c(64432),e=c(13678),f=c(34979),g=c(49152),h=c(74216),i="pick_first";function j(a){g.trace(h.LogVerbosity.DEBUG,i,a)}let k="pick_first",l=250;class m{constructor(a){this.shuffleAddressList=a}getLoadBalancerName(){return k}toJsonObject(){return{[k]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(a){if("shuffleAddressList"in a&&"boolean"!=typeof a.shuffleAddressList)throw Error("pick_first config field shuffleAddressList must be a boolean if provided");return new m(!0===a.shuffleAddressList)}}b.PickFirstLoadBalancingConfig=m;class n{constructor(a){this.subchannel=a}pick(a){return{pickResultType:f.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}}function o(a){let b=a.slice();for(let a=b.length-1;a>1;a--){let c=Math.floor(Math.random()*(a+1)),d=b[a];b[a]=b[c],b[c]=d}return b}b.shuffled=o;class p{constructor(a){this.channelControlHelper=a,this.children=[],this.currentState=e.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(a,b,c,d,e)=>{this.onSubchannelStateUpdate(a,b,c,e)},this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(a=>a.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.updateState(e.ConnectivityState.READY,new n(this.currentPick)):0===this.children.length?this.updateState(e.ConnectivityState.IDLE,new f.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(e.ConnectivityState.TRANSIENT_FAILURE,new f.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(e.ConnectivityState.CONNECTING,new f.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){for(let{subchannel:a}of(this.stickyTransientFailureMode=!0,this.children))a.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(null!==this.currentPick){let a=this.currentPick;this.currentPick=null,a.unref(),a.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(a.getChannelzRef())}}onSubchannelStateUpdate(a,b,c,d){var f;if(null==(f=this.currentPick)?void 0:f.realSubchannelEquals(a)){c!==e.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[b,f]of this.children.entries())if(a.realSubchannelEquals(f.subchannel)){c===e.ConnectivityState.READY&&this.pickSubchannel(f.subchannel),c===e.ConnectivityState.TRANSIENT_FAILURE&&(f.hasReportedTransientFailure=!0,d&&(this.lastError=d),this.maybeEnterStickyTransientFailureMode(),b===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(b+1)),f.subchannel.startConnecting();return}}startNextSubchannelConnecting(a){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[b,c]of this.children.entries())if(b>=a){let a=c.subchannel.getConnectivityState();if(a===e.ConnectivityState.IDLE||a===e.ConnectivityState.CONNECTING)return void this.startConnecting(b)}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(a){var b,c;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=a,this.children[a].subchannel.getConnectivityState()===e.ConnectivityState.IDLE&&(j("Start connecting to subchannel with address "+this.children[a].subchannel.getAddress()),process.nextTick(()=>{var b;null==(b=this.children[a])||b.subchannel.startConnecting()})),this.connectionDelayTimeout=null==(c=(b=setTimeout(()=>{this.startNextSubchannelConnecting(a+1)},l)).unref)?void 0:c.call(b)}pickSubchannel(a){this.currentPick&&a.realSubchannelEquals(this.currentPick)||(j("Pick subchannel with address "+a.getAddress()),this.stickyTransientFailureMode=!1,null!==this.currentPick&&(this.currentPick.unref(),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeConnectivityStateListener(this.subchannelStateListener)),this.currentPick=a,a.ref(),this.channelControlHelper.addChannelzChild(a.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(a,b){j(e.ConnectivityState[this.currentState]+" -> "+e.ConnectivityState[a]),this.currentState=a,this.channelControlHelper.updateState(a,b)}resetSubchannelList(){for(let a of this.children)this.currentPick&&a.subchannel.realSubchannelEquals(this.currentPick)||a.subchannel.removeConnectivityStateListener(this.subchannelStateListener),a.subchannel.unref(),this.channelControlHelper.removeChannelzChild(a.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(a){let b=a.map(a=>({subchannel:this.channelControlHelper.createSubchannel(a,{}),hasReportedTransientFailure:!1}));for(let{subchannel:a}of b)a.ref(),this.channelControlHelper.addChannelzChild(a.getChannelzRef());for(let{subchannel:a}of(this.resetSubchannelList(),this.children=b,this.children))if(a.addConnectivityStateListener(this.subchannelStateListener),a.getConnectivityState()===e.ConnectivityState.READY)return void this.pickSubchannel(a);for(let a of this.children)a.subchannel.getConnectivityState()===e.ConnectivityState.TRANSIENT_FAILURE&&(a.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(a,b){b instanceof m&&(b.getShuffleAddressList()&&(a=o(a)),this.latestAddressList=a,this.connectToAddressList(a))}exitIdle(){this.currentState===e.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return k}}b.PickFirstLoadBalancer=p,b.setup=function(){(0,d.registerLoadBalancerType)(k,p,m),(0,d.registerDefaultLoadBalancerType)(k)}},91645:a=>{"use strict";a.exports=require("net")},92217:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.setup=void 0;let d=c(91645),e=c(74216),f=c(39316),g=c(98675),h=c(30999),i=c(49152),j="ip_resolver";function k(a){i.trace(e.LogVerbosity.DEBUG,j,a)}let l="ipv4",m="ipv6",n=443;class o{constructor(a,b,c){var g;this.listener=b,this.addresses=[],this.error=null,this.hasReturnedResult=!1,k("Resolver constructed for target "+(0,h.uriToString)(a));let i=[];if(a.scheme!==l&&a.scheme!==m){this.error={code:e.Status.UNAVAILABLE,details:`Unrecognized scheme ${a.scheme} in IP resolver`,metadata:new f.Metadata};return}for(let b of a.path.split(",")){let c=(0,h.splitHostPort)(b);if(null===c||a.scheme===l&&!(0,d.isIPv4)(c.host)||a.scheme===m&&!(0,d.isIPv6)(c.host)){this.error={code:e.Status.UNAVAILABLE,details:`Failed to parse ${a.scheme} address ${b}`,metadata:new f.Metadata};return}i.push({host:c.host,port:null!=(g=c.port)?g:n})}this.addresses=i,k("Parsed "+a.scheme+" address list "+this.addresses)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(a){return a.path.split(",")[0]}}b.setup=function(){(0,g.registerResolver)(l,o),(0,g.registerResolver)(m,o)}},93026:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Server=void 0;let d=c(73496),e=c(74216),f=c(29115),g=c(4369),h=c(98675),i=c(49152),j=c(41509),k=c(30999),l=c(16050),m=0x7fffffff,n=0x7fffffff,o=2e4,{HTTP2_HEADER_PATH:p}=d.constants,q="server";function r(){}function s(a){return{code:e.Status.UNIMPLEMENTED,details:`The server does not implement the method ${a}`}}function t(a,b){let c=s(b);switch(a){case"unary":return(a,b)=>{b(c,null)};case"clientStream":return(a,b)=>{b(c,null)};case"serverStream":return a=>{a.emit("error",c)};case"bidi":return a=>{a.emit("error",c)};default:throw Error(`Invalid handlerType ${a}`)}}class u{constructor(a){var b,c,d,e;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new l.ChannelzTrace,this.callTracker=new l.ChannelzCallTracker,this.listenerChildrenTracker=new l.ChannelzChildrenTracker,this.sessionChildrenTracker=new l.ChannelzChildrenTracker,this.options=null!=a?a:{},0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,l.registerChannelzServer)(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=null!=(b=this.options["grpc.max_connection_age_ms"])?b:m,this.maxConnectionAgeGraceMs=null!=(c=this.options["grpc.max_connection_age_grace_ms"])?c:m,this.keepaliveTimeMs=null!=(d=this.options["grpc.keepalive_time_ms"])?d:n,this.keepaliveTimeoutMs=null!=(e=this.options["grpc.keepalive_timeout_ms"])?e:o,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(a){return()=>{var b,c,d;let e,f=this.sessions.get(a),g=a.socket,h=g.remoteAddress?(0,j.stringToSubchannelAddress)(g.remoteAddress,g.remotePort):null,i=g.localAddress?(0,j.stringToSubchannelAddress)(g.localAddress,g.localPort):null;if(a.encrypted){let a=g,c=a.getCipher(),d=a.getCertificate(),f=a.getPeerCertificate();e={cipherSuiteStandardName:null!=(b=c.standardName)?b:null,cipherSuiteOtherName:c.standardName?null:c.name,localCertificate:d&&"raw"in d?d.raw:null,remoteCertificate:f&&"raw"in f?f.raw:null}}else e=null;return{remoteAddress:h,localAddress:i,security:e,remoteName:null,streamsStarted:f.streamTracker.callsStarted,streamsSucceeded:f.streamTracker.callsSucceeded,streamsFailed:f.streamTracker.callsFailed,messagesSent:f.messagesSent,messagesReceived:f.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:f.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:f.lastMessageSentTimestamp,lastMessageReceivedTimestamp:f.lastMessageReceivedTimestamp,localFlowControlWindow:null!=(c=a.state.localWindowSize)?c:null,remoteFlowControlWindow:null!=(d=a.state.remoteWindowSize)?d:null}}}trace(a){i.trace(e.LogVerbosity.DEBUG,q,"("+this.channelzRef.id+") "+a)}addProtoService(){throw Error("Not implemented. Use addService() instead")}addService(a,b){if(null===a||"object"!=typeof a||null===b||"object"!=typeof b)throw Error("addService() requires two objects as arguments");let c=Object.keys(a);if(0===c.length)throw Error("Cannot add an empty service to a server");c.forEach(c=>{let d,e,f=a[c];d=f.requestStream?f.responseStream?"bidi":"clientStream":f.responseStream?"serverStream":"unary";let g=b[c];if(void 0===g&&"string"==typeof f.originalName&&(g=b[f.originalName]),e=void 0!==g?g.bind(b):t(d,c),!1===this.register(f.path,e,f.responseSerialize,f.requestDeserialize,d))throw Error(`Method handler for ${f.path} already provided.`)})}removeService(a){if(null===a||"object"!=typeof a)throw Error("removeService() requires object as argument");Object.keys(a).forEach(b=>{let c=a[b];this.unregister(c.path)})}bind(a,b){throw Error("Not implemented. Use bindAsync() instead")}bindAsync(a,b,c){if(!0===this.started)throw Error("server is already started");if(this.shutdown)throw Error("bindAsync called after shutdown");if("string"!=typeof a)throw TypeError("port must be a string");if(null===b||!(b instanceof g.ServerCredentials))throw TypeError("creds must be a ServerCredentials object");if("function"!=typeof c)throw TypeError("callback must be a function");let f=(0,k.parseUri)(a);if(null===f)throw Error(`Could not parse port "${a}"`);let m=(0,h.mapUriDefaultScheme)(f);if(null===m)throw Error(`Could not get a default scheme for port "${a}"`);let n={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?n.maxSessionMemory=this.options["grpc-node.max_session_memory"]:n.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(n.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let o=(a,b)=>{process.nextTick(()=>c(a,b))},p=()=>{let a;if(b._isSecure()){let c=Object.assign(n,b._getSettings());c.enableTrace=1===this.options["grpc-node.tls_enable_trace"],(a=d.createSecureServer(c)).on("secureConnection",a=>{a.on("error",a=>{this.trace("An incoming TLS connection closed with error: "+a.message)})})}else a=d.createServer(n);return a.setTimeout(0,r),this._setupHandlers(a),a},q=(a,b,c)=>0===a.length?Promise.resolve({port:b,count:c}):Promise.all(a.map(a=>{let c;this.trace("Attempting to bind "+(0,j.subchannelAddressToString)(a)),c=(0,j.isTcpSubchannelAddress)(a)?{host:a.host,port:b}:a;let d=p();return new Promise((e,f)=>{let g=b=>{this.trace("Failed to bind "+(0,j.subchannelAddressToString)(a)+" with error "+b.message),e(b)};d.once("error",g),d.listen(c,()=>{let a;if(this.shutdown){d.close(),e(Error("bindAsync failed because server is shutdown"));return}let c=d.address();a="string"==typeof c?{path:c}:{host:c.address,port:c.port};let f=(0,l.registerChannelzSocket)((0,j.subchannelAddressToString)(a),()=>({localAddress:a,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(f),this.http2ServerList.push({server:d,channelzRef:f}),this.trace("Successfully bound "+(0,j.subchannelAddressToString)(a)),e("port"in a?a.port:b),d.removeListener("error",g)})})})).then(a=>{let d=0;for(let c of a)if("number"==typeof c&&(d+=1,c!==b))throw Error("Invalid state: multiple port numbers added from single address");return{port:b,count:d+c}}),s=a=>{if(0===a.length)return Promise.resolve({port:0,count:0});let b=a[0],c=p();return new Promise((d,e)=>{let f=c=>{this.trace("Failed to bind "+(0,j.subchannelAddressToString)(b)+" with error "+c.message),d(s(a.slice(1)))};c.once("error",f),c.listen(b,()=>{if(this.shutdown){c.close(),d({port:0,count:0});return}let b=c.address(),e={host:b.address,port:b.port},g=(0,l.registerChannelzSocket)((0,j.subchannelAddressToString)(e),()=>({localAddress:e,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(g),this.http2ServerList.push({server:c,channelzRef:g}),this.trace("Successfully bound "+(0,j.subchannelAddressToString)(e)),d(q(a.slice(1),b.port,1)),c.removeListener("error",f)})})},t={onSuccessfulResolution:(b,c,d)=>{let f;if(t.onSuccessfulResolution=()=>{},this.shutdown&&o(Error("bindAsync failed because server is shutdown"),0),0===b.length)return void o(Error(`No addresses resolved for port ${a}`),0);(f=(0,j.isTcpSubchannelAddress)(b[0])?0===b[0].port?s(b):q(b,b[0].port,0):q(b,1,0)).then(a=>{if(0===a.count){let a=`No address added out of total ${b.length} resolved`;i.log(e.LogVerbosity.ERROR,a),o(Error(a),0)}else a.count<b.length&&i.log(e.LogVerbosity.INFO,`WARNING Only ${a.count} addresses added out of total ${b.length} resolved`),o(null,a.port)},a=>{let c=`No address added out of total ${b.length} resolved`;i.log(e.LogVerbosity.ERROR,c),o(Error(c),0)})},onError:a=>{o(Error(a.details),0)}};(0,h.createResolver)(m,t,this.options).updateResolution()}forceShutdown(){for(let{server:a,channelzRef:b}of this.http2ServerList)a.listening&&a.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(b),(0,l.unregisterChannelzRef)(b))});this.started=!1,this.shutdown=!0,this.sessions.forEach((a,b)=>{b.destroy(d.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&(0,l.unregisterChannelzRef)(this.channelzRef)}register(a,b,c,d,e){return!this.handlers.has(a)&&(this.handlers.set(a,{func:b,serialize:c,deserialize:d,type:e,path:a}),!0)}unregister(a){return this.handlers.delete(a)}start(){if(0===this.http2ServerList.length||this.http2ServerList.every(({server:a})=>!0!==a.listening))throw Error("server must be bound in order to start");if(!0===this.started)throw Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(a){let b=b=>{this.channelzEnabled&&(0,l.unregisterChannelzRef)(this.channelzRef),a(b)},c=0;function d(){0==--c&&b()}for(let{server:a,channelzRef:b}of(this.started=!1,this.shutdown=!0,this.http2ServerList))a.listening&&(c++,a.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(b),(0,l.unregisterChannelzRef)(b)),d()}));this.sessions.forEach((a,b)=>{b.closed||(c+=1,b.close(d))}),0===c&&b()}addHttp2Port(){throw Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(a,b){let c=b[d.constants.HTTP2_HEADER_CONTENT_TYPE];return"string"==typeof c&&!!c.startsWith("application/grpc")||(a.respond({[d.constants.HTTP2_HEADER_STATUS]:d.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1)}_retrieveHandler(a){this.trace("Received call to method "+a+" at address "+this.serverAddressString);let b=this.handlers.get(a);return void 0===b?(this.trace("No handler registered for method "+a+". Sending UNIMPLEMENTED status."),null):b}_respondWithError(a,b,c=null){let d=new f.Http2ServerCallStream(b,null,this.options);void 0===a.code&&(a.code=e.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),null==c||c.streamTracker.addCallFailed()),d.sendError(a)}_channelzHandler(a,b){let c=this.sessions.get(a.session);if(this.callTracker.addCallStarted(),null==c||c.streamTracker.addCallStarted(),!this._verifyContentType(a,b)){this.callTracker.addCallFailed(),null==c||c.streamTracker.addCallFailed();return}let d=b[p],g=this._retrieveHandler(d);if(!g)return void this._respondWithError(s(d),a,c);let h=new f.Http2ServerCallStream(a,g,this.options);h.once("callEnd",a=>{a===e.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),c&&(h.once("streamEnd",a=>{a?c.streamTracker.addCallSucceeded():c.streamTracker.addCallFailed()}),h.on("sendMessage",()=>{c.messagesSent+=1,c.lastMessageSentTimestamp=new Date}),h.on("receiveMessage",()=>{c.messagesReceived+=1,c.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(h,g,b)||(this.callTracker.addCallFailed(),null==c||c.streamTracker.addCallFailed(),h.sendError({code:e.Status.INTERNAL,details:`Unknown handler type: ${g.type}`}))}_streamHandler(a,b){if(!0!==this._verifyContentType(a,b))return;let c=b[p],d=this._retrieveHandler(c);if(!d)return void this._respondWithError(s(c),a,null);let g=new f.Http2ServerCallStream(a,d,this.options);this._runHandlerForCall(g,d,b)||g.sendError({code:e.Status.INTERNAL,details:`Unknown handler type: ${d.type}`})}_runHandlerForCall(a,b,c){var d;let e=a.receiveMetadata(c),f=null!=(d=e.get("grpc-encoding")[0])?d:"identity";e.remove("grpc-encoding");let{type:g}=b;if("unary"===g)v(a,b,e,f);else if("clientStream"===g)w(a,b,e,f);else if("serverStream"===g)x(a,b,e,f);else{if("bidi"!==g)return!1;y(a,b,e,f)}return!0}_setupHandlers(a){if(null===a)return;let b=a.address(),c="null";b&&(c="string"==typeof b?b:b.address+":"+b.port),this.serverAddressString=c;let e=this.channelzEnabled?this._channelzHandler:this._streamHandler;a.on("stream",e.bind(this)),a.on("session",a=>{var b,c,e,f,g;if(!this.started)return void a.destroy();let h=(0,l.registerChannelzSocket)(null!=(b=a.socket.remoteAddress)?b:"unknown",this.getChannelzSessionInfoGetter(a),this.channelzEnabled),i={ref:h,streamTracker:new l.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(a,i);let j=a.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+j),this.sessionChildrenTracker.refChild(h));let k=null,n=null,o=!1;if(this.maxConnectionAgeMs!==m){let b=this.maxConnectionAgeMs/10,f=Math.random()*b*2-b;k=null==(e=(c=setTimeout(()=>{var b,c;o=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+j);try{a.goaway(d.constants.NGHTTP2_NO_ERROR,0x7fffffff,Buffer.from("max_age"))}catch(b){a.destroy();return}a.close(),this.maxConnectionAgeGraceMs!==m&&(n=null==(c=(b=setTimeout(()=>{a.destroy()},this.maxConnectionAgeGraceMs)).unref)?void 0:c.call(b))},this.maxConnectionAgeMs+f)).unref)?void 0:e.call(c)}let p=null==(g=(f=setInterval(()=>{var b,c;let d=null==(c=(b=setTimeout(()=>{o=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+j),a.close()},this.keepaliveTimeoutMs)).unref)?void 0:c.call(b);try{a.ping((a,b,c)=>{clearTimeout(d)})}catch(b){a.destroy()}},this.keepaliveTimeMs)).unref)?void 0:g.call(f);a.on("close",()=>{this.channelzEnabled&&(o||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+j),this.sessionChildrenTracker.unrefChild(h),(0,l.unregisterChannelzRef)(h)),k&&clearTimeout(k),n&&clearTimeout(n),p&&clearTimeout(p),this.sessions.delete(a)})})}}async function v(a,b,c,d){try{let e=await a.receiveUnaryMessage(d);if(void 0===e||a.cancelled)return;let g=new f.ServerUnaryCallImpl(a,c,e);b.func(g,(b,c,d,e)=>{a.sendUnaryMessage(b,c,d,e)})}catch(b){a.sendError(b)}}function w(a,b,c,d){let e=new f.ServerReadableStreamImpl(a,c,b.deserialize,d);function g(b,c,d,f){e.destroy(),a.sendUnaryMessage(b,c,d,f)}a.cancelled||(e.on("error",g),b.func(e,g))}async function x(a,b,c,d){try{let e=await a.receiveUnaryMessage(d);if(void 0===e||a.cancelled)return;let g=new f.ServerWritableStreamImpl(a,c,b.serialize,e);b.func(g)}catch(b){a.sendError(b)}}function y(a,b,c,d){let e=new f.ServerDuplexStreamImpl(a,c,b.serialize,b.deserialize,d);a.cancelled||b.func(e)}b.Server=u},93131:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.loadPackageDefinition=b.makeClientConstructor=void 0;let d=c(71446),e={unary:d.Client.prototype.makeUnaryRequest,server_stream:d.Client.prototype.makeServerStreamRequest,client_stream:d.Client.prototype.makeClientStreamRequest,bidi:d.Client.prototype.makeBidiStreamRequest};function f(a){return["__proto__","prototype","constructor"].includes(a)}function g(a,b,c){c||(c={});class g extends d.Client{}return Object.keys(a).forEach(b=>{let c;if(f(b))return;let d=a[b];if("string"==typeof b&&"$"===b.charAt(0))throw Error("Method names cannot start with $");c=d.requestStream?d.responseStream?"bidi":"client_stream":d.responseStream?"server_stream":"unary";let i=d.requestSerialize,j=d.responseDeserialize,k=h(e[c],d.path,i,j);g.prototype[b]=k,Object.assign(g.prototype[b],d),d.originalName&&!f(d.originalName)&&(g.prototype[d.originalName]=g.prototype[b])}),g.service=a,g.serviceName=b,g}function h(a,b,c,d){return function(...e){return a.call(this,b,c,d,...e)}}function i(a){return"format"in a}b.makeClientConstructor=g,b.loadPackageDefinition=function(a){let b={};for(let c in a)if(Object.prototype.hasOwnProperty.call(a,c)){let d=a[c],e=c.split(".");if(e.some(a=>f(a)))continue;let h=e[e.length-1],j=b;for(let a of e.slice(0,-1))j[a]||(j[a]={}),j=j[a];i(d)?j[h]=d:j[h]=g(d,h,{})}return b}},93686:(a,b,c)=>{"use strict";var d=b;function e(){d.util._configure(),d.Writer._configure(d.BufferWriter),d.Reader._configure(d.BufferReader)}d.build="minimal",d.Writer=c(59665),d.BufferWriter=c(61134),d.Reader=c(75645),d.BufferReader=c(79546),d.util=c(60054),d.rpc=c(74915),d.roots=c(27481),d.configure=e,e()},94735:a=>{"use strict";a.exports=require("events")},96138:a=>{"use strict";a.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Type":{"fields":{"name":{"type":"string","id":1},"fields":{"rule":"repeated","type":"Field","id":2},"oneofs":{"rule":"repeated","type":"string","id":3},"options":{"rule":"repeated","type":"Option","id":4},"sourceContext":{"type":"SourceContext","id":5},"syntax":{"type":"Syntax","id":6}}},"Field":{"fields":{"kind":{"type":"Kind","id":1},"cardinality":{"type":"Cardinality","id":2},"number":{"type":"int32","id":3},"name":{"type":"string","id":4},"typeUrl":{"type":"string","id":6},"oneofIndex":{"type":"int32","id":7},"packed":{"type":"bool","id":8},"options":{"rule":"repeated","type":"Option","id":9},"jsonName":{"type":"string","id":10},"defaultValue":{"type":"string","id":11}},"nested":{"Kind":{"values":{"TYPE_UNKNOWN":0,"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Cardinality":{"values":{"CARDINALITY_UNKNOWN":0,"CARDINALITY_OPTIONAL":1,"CARDINALITY_REQUIRED":2,"CARDINALITY_REPEATED":3}}}},"Enum":{"fields":{"name":{"type":"string","id":1},"enumvalue":{"rule":"repeated","type":"EnumValue","id":2},"options":{"rule":"repeated","type":"Option","id":3},"sourceContext":{"type":"SourceContext","id":4},"syntax":{"type":"Syntax","id":5}}},"EnumValue":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"rule":"repeated","type":"Option","id":3}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}},"Any":{"fields":{"type_url":{"type":"string","id":1},"value":{"type":"bytes","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')},96953:a=>{"use strict";function b(a,c){"string"==typeof a&&(c=a,a=void 0);var d=[];function e(a){if("string"!=typeof a){var c=f();if(b.verbose&&console.log("codegen: "+c),c="return "+c,a){for(var g=Object.keys(a),h=Array(g.length+1),i=Array(g.length),j=0;j<g.length;)h[j]=g[j],i[j]=a[g[j++]];return h[j]=c,Function.apply(null,h).apply(null,i)}return Function(c)()}for(var k=Array(arguments.length-1),l=0;l<k.length;)k[l]=arguments[++l];if(l=0,a=a.replace(/%([%dfijs])/g,function(a,b){var c=k[l++];switch(b){case"d":case"f":return String(Number(c));case"i":return String(Math.floor(c));case"j":return JSON.stringify(c);case"s":return String(c)}return"%"}),l!==k.length)throw Error("parameter count mismatch");return d.push(a),e}function f(b){return"function "+(b||c||"")+"("+(a&&a.join(",")||"")+"){\n  "+d.join("\n  ")+"\n}"}return e.toString=f,e}a.exports=b,b.verbose=!1},97659:a=>{"use strict";a.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"options":{"go_package":"google.golang.org/protobuf/types/descriptorpb","java_package":"com.google.protobuf","java_outer_classname":"DescriptorProtos","csharp_namespace":"Google.Protobuf.Reflection","objc_class_prefix":"GPB","cc_enable_arenas":true,"optimize_for":"SPEED"},"nested":{"FileDescriptorSet":{"edition":"proto2","fields":{"file":{"rule":"repeated","type":"FileDescriptorProto","id":1}},"extensions":[[536000000,536000000]]},"Edition":{"edition":"proto2","values":{"EDITION_UNKNOWN":0,"EDITION_LEGACY":900,"EDITION_PROTO2":998,"EDITION_PROTO3":999,"EDITION_2023":1000,"EDITION_2024":1001,"EDITION_1_TEST_ONLY":1,"EDITION_2_TEST_ONLY":2,"EDITION_99997_TEST_ONLY":99997,"EDITION_99998_TEST_ONLY":99998,"EDITION_99999_TEST_ONLY":99999,"EDITION_MAX":2147483647}},"FileDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"package":{"type":"string","id":2},"dependency":{"rule":"repeated","type":"string","id":3},"publicDependency":{"rule":"repeated","type":"int32","id":10},"weakDependency":{"rule":"repeated","type":"int32","id":11},"optionDependency":{"rule":"repeated","type":"string","id":15},"messageType":{"rule":"repeated","type":"DescriptorProto","id":4},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":5},"service":{"rule":"repeated","type":"ServiceDescriptorProto","id":6},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":7},"options":{"type":"FileOptions","id":8},"sourceCodeInfo":{"type":"SourceCodeInfo","id":9},"syntax":{"type":"string","id":12},"edition":{"type":"Edition","id":14}}},"DescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"field":{"rule":"repeated","type":"FieldDescriptorProto","id":2},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":6},"nestedType":{"rule":"repeated","type":"DescriptorProto","id":3},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":4},"extensionRange":{"rule":"repeated","type":"ExtensionRange","id":5},"oneofDecl":{"rule":"repeated","type":"OneofDescriptorProto","id":8},"options":{"type":"MessageOptions","id":7},"reservedRange":{"rule":"repeated","type":"ReservedRange","id":9},"reservedName":{"rule":"repeated","type":"string","id":10},"visibility":{"type":"SymbolVisibility","id":11}},"nested":{"ExtensionRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2},"options":{"type":"ExtensionRangeOptions","id":3}}},"ReservedRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}}}},"ExtensionRangeOptions":{"edition":"proto2","fields":{"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999},"declaration":{"rule":"repeated","type":"Declaration","id":2,"options":{"retention":"RETENTION_SOURCE"}},"features":{"type":"FeatureSet","id":50},"verification":{"type":"VerificationState","id":3,"options":{"default":"UNVERIFIED","retention":"RETENTION_SOURCE"}}},"extensions":[[1000,536870911]],"nested":{"Declaration":{"fields":{"number":{"type":"int32","id":1},"fullName":{"type":"string","id":2},"type":{"type":"string","id":3},"reserved":{"type":"bool","id":5},"repeated":{"type":"bool","id":6}},"reserved":[[4,4]]},"VerificationState":{"values":{"DECLARATION":0,"UNVERIFIED":1}}}},"FieldDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":3},"label":{"type":"Label","id":4},"type":{"type":"Type","id":5},"typeName":{"type":"string","id":6},"extendee":{"type":"string","id":2},"defaultValue":{"type":"string","id":7},"oneofIndex":{"type":"int32","id":9},"jsonName":{"type":"string","id":10},"options":{"type":"FieldOptions","id":8},"proto3Optional":{"type":"bool","id":17}},"nested":{"Type":{"values":{"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Label":{"values":{"LABEL_OPTIONAL":1,"LABEL_REPEATED":3,"LABEL_REQUIRED":2}}}},"OneofDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"options":{"type":"OneofOptions","id":2}}},"EnumDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"value":{"rule":"repeated","type":"EnumValueDescriptorProto","id":2},"options":{"type":"EnumOptions","id":3},"reservedRange":{"rule":"repeated","type":"EnumReservedRange","id":4},"reservedName":{"rule":"repeated","type":"string","id":5},"visibility":{"type":"SymbolVisibility","id":6}},"nested":{"EnumReservedRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}}}},"EnumValueDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"type":"EnumValueOptions","id":3}}},"ServiceDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"method":{"rule":"repeated","type":"MethodDescriptorProto","id":2},"options":{"type":"ServiceOptions","id":3}}},"MethodDescriptorProto":{"edition":"proto2","fields":{"name":{"type":"string","id":1},"inputType":{"type":"string","id":2},"outputType":{"type":"string","id":3},"options":{"type":"MethodOptions","id":4},"clientStreaming":{"type":"bool","id":5},"serverStreaming":{"type":"bool","id":6}}},"FileOptions":{"edition":"proto2","fields":{"javaPackage":{"type":"string","id":1},"javaOuterClassname":{"type":"string","id":8},"javaMultipleFiles":{"type":"bool","id":10},"javaGenerateEqualsAndHash":{"type":"bool","id":20,"options":{"deprecated":true}},"javaStringCheckUtf8":{"type":"bool","id":27},"optimizeFor":{"type":"OptimizeMode","id":9,"options":{"default":"SPEED"}},"goPackage":{"type":"string","id":11},"ccGenericServices":{"type":"bool","id":16},"javaGenericServices":{"type":"bool","id":17},"pyGenericServices":{"type":"bool","id":18},"deprecated":{"type":"bool","id":23},"ccEnableArenas":{"type":"bool","id":31,"options":{"default":true}},"objcClassPrefix":{"type":"string","id":36},"csharpNamespace":{"type":"string","id":37},"swiftPrefix":{"type":"string","id":39},"phpClassPrefix":{"type":"string","id":40},"phpNamespace":{"type":"string","id":41},"phpMetadataNamespace":{"type":"string","id":44},"rubyPackage":{"type":"string","id":45},"features":{"type":"FeatureSet","id":50},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[42,42],[38,38],"php_generic_services"],"nested":{"OptimizeMode":{"values":{"SPEED":1,"CODE_SIZE":2,"LITE_RUNTIME":3}}}},"MessageOptions":{"edition":"proto2","fields":{"messageSetWireFormat":{"type":"bool","id":1},"noStandardDescriptorAccessor":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"mapEntry":{"type":"bool","id":7},"deprecatedLegacyJsonFieldConflicts":{"type":"bool","id":11,"options":{"deprecated":true}},"features":{"type":"FeatureSet","id":12},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[4,4],[5,5],[6,6],[8,8],[9,9]]},"FieldOptions":{"edition":"proto2","fields":{"ctype":{"type":"CType","id":1,"options":{"default":"STRING"}},"packed":{"type":"bool","id":2},"jstype":{"type":"JSType","id":6,"options":{"default":"JS_NORMAL"}},"lazy":{"type":"bool","id":5},"unverifiedLazy":{"type":"bool","id":15},"deprecated":{"type":"bool","id":3},"weak":{"type":"bool","id":10,"options":{"deprecated":true}},"debugRedact":{"type":"bool","id":16},"retention":{"type":"OptionRetention","id":17},"targets":{"rule":"repeated","type":"OptionTargetType","id":19},"editionDefaults":{"rule":"repeated","type":"EditionDefault","id":20},"features":{"type":"FeatureSet","id":21},"featureSupport":{"type":"FeatureSupport","id":22},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[4,4],[18,18]],"nested":{"CType":{"values":{"STRING":0,"CORD":1,"STRING_PIECE":2}},"JSType":{"values":{"JS_NORMAL":0,"JS_STRING":1,"JS_NUMBER":2}},"OptionRetention":{"values":{"RETENTION_UNKNOWN":0,"RETENTION_RUNTIME":1,"RETENTION_SOURCE":2}},"OptionTargetType":{"values":{"TARGET_TYPE_UNKNOWN":0,"TARGET_TYPE_FILE":1,"TARGET_TYPE_EXTENSION_RANGE":2,"TARGET_TYPE_MESSAGE":3,"TARGET_TYPE_FIELD":4,"TARGET_TYPE_ONEOF":5,"TARGET_TYPE_ENUM":6,"TARGET_TYPE_ENUM_ENTRY":7,"TARGET_TYPE_SERVICE":8,"TARGET_TYPE_METHOD":9}},"EditionDefault":{"fields":{"edition":{"type":"Edition","id":3},"value":{"type":"string","id":2}}},"FeatureSupport":{"fields":{"editionIntroduced":{"type":"Edition","id":1},"editionDeprecated":{"type":"Edition","id":2},"deprecationWarning":{"type":"string","id":3},"editionRemoved":{"type":"Edition","id":4}}}}},"OneofOptions":{"edition":"proto2","fields":{"features":{"type":"FeatureSet","id":1},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"EnumOptions":{"edition":"proto2","fields":{"allowAlias":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"deprecatedLegacyJsonFieldConflicts":{"type":"bool","id":6,"options":{"deprecated":true}},"features":{"type":"FeatureSet","id":7},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[5,5]]},"EnumValueOptions":{"edition":"proto2","fields":{"deprecated":{"type":"bool","id":1},"features":{"type":"FeatureSet","id":2},"debugRedact":{"type":"bool","id":3},"featureSupport":{"type":"FieldOptions.FeatureSupport","id":4},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"ServiceOptions":{"edition":"proto2","fields":{"features":{"type":"FeatureSet","id":34},"deprecated":{"type":"bool","id":33},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"MethodOptions":{"edition":"proto2","fields":{"deprecated":{"type":"bool","id":33},"idempotencyLevel":{"type":"IdempotencyLevel","id":34,"options":{"default":"IDEMPOTENCY_UNKNOWN"}},"features":{"type":"FeatureSet","id":35},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"nested":{"IdempotencyLevel":{"values":{"IDEMPOTENCY_UNKNOWN":0,"NO_SIDE_EFFECTS":1,"IDEMPOTENT":2}}}},"UninterpretedOption":{"edition":"proto2","fields":{"name":{"rule":"repeated","type":"NamePart","id":2},"identifierValue":{"type":"string","id":3},"positiveIntValue":{"type":"uint64","id":4},"negativeIntValue":{"type":"int64","id":5},"doubleValue":{"type":"double","id":6},"stringValue":{"type":"bytes","id":7},"aggregateValue":{"type":"string","id":8}},"nested":{"NamePart":{"fields":{"namePart":{"rule":"required","type":"string","id":1},"isExtension":{"rule":"required","type":"bool","id":2}}}}},"FeatureSet":{"edition":"proto2","fields":{"fieldPresence":{"type":"FieldPresence","id":1,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_2023","edition_defaults.value":"EXPLICIT"}},"enumType":{"type":"EnumType","id":2,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"OPEN"}},"repeatedFieldEncoding":{"type":"RepeatedFieldEncoding","id":3,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"PACKED"}},"utf8Validation":{"type":"Utf8Validation","id":4,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"VERIFY"}},"messageEncoding":{"type":"MessageEncoding","id":5,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_LEGACY","edition_defaults.value":"LENGTH_PREFIXED"}},"jsonFormat":{"type":"JsonFormat","id":6,"options":{"retention":"RETENTION_RUNTIME","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"ALLOW"}},"enforceNamingStyle":{"type":"EnforceNamingStyle","id":7,"options":{"retention":"RETENTION_SOURCE","targets":"TARGET_TYPE_METHOD","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"STYLE2024"}},"defaultSymbolVisibility":{"type":"VisibilityFeature.DefaultSymbolVisibility","id":8,"options":{"retention":"RETENTION_SOURCE","targets":"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"EXPORT_TOP_LEVEL"}}},"extensions":[[1000,9994],[9995,9999],[10000,10000]],"reserved":[[999,999]],"nested":{"FieldPresence":{"values":{"FIELD_PRESENCE_UNKNOWN":0,"EXPLICIT":1,"IMPLICIT":2,"LEGACY_REQUIRED":3}},"EnumType":{"values":{"ENUM_TYPE_UNKNOWN":0,"OPEN":1,"CLOSED":2}},"RepeatedFieldEncoding":{"values":{"REPEATED_FIELD_ENCODING_UNKNOWN":0,"PACKED":1,"EXPANDED":2}},"Utf8Validation":{"values":{"UTF8_VALIDATION_UNKNOWN":0,"VERIFY":2,"NONE":3}},"MessageEncoding":{"values":{"MESSAGE_ENCODING_UNKNOWN":0,"LENGTH_PREFIXED":1,"DELIMITED":2}},"JsonFormat":{"values":{"JSON_FORMAT_UNKNOWN":0,"ALLOW":1,"LEGACY_BEST_EFFORT":2}},"EnforceNamingStyle":{"values":{"ENFORCE_NAMING_STYLE_UNKNOWN":0,"STYLE2024":1,"STYLE_LEGACY":2}},"VisibilityFeature":{"fields":{},"reserved":[[1,536870911]],"nested":{"DefaultSymbolVisibility":{"values":{"DEFAULT_SYMBOL_VISIBILITY_UNKNOWN":0,"EXPORT_ALL":1,"EXPORT_TOP_LEVEL":2,"LOCAL_ALL":3,"STRICT":4}}}}}},"FeatureSetDefaults":{"edition":"proto2","fields":{"defaults":{"rule":"repeated","type":"FeatureSetEditionDefault","id":1},"minimumEdition":{"type":"Edition","id":4},"maximumEdition":{"type":"Edition","id":5}},"nested":{"FeatureSetEditionDefault":{"fields":{"edition":{"type":"Edition","id":3},"overridableFeatures":{"type":"FeatureSet","id":4},"fixedFeatures":{"type":"FeatureSet","id":5}},"reserved":[[1,1],[2,2],"features"]}}},"SourceCodeInfo":{"edition":"proto2","fields":{"location":{"rule":"repeated","type":"Location","id":1}},"extensions":[[536000000,536000000]],"nested":{"Location":{"fields":{"path":{"rule":"repeated","type":"int32","id":1,"options":{"packed":true}},"span":{"rule":"repeated","type":"int32","id":2,"options":{"packed":true}},"leadingComments":{"type":"string","id":3},"trailingComments":{"type":"string","id":4},"leadingDetachedComments":{"rule":"repeated","type":"string","id":6}}}}},"GeneratedCodeInfo":{"edition":"proto2","fields":{"annotation":{"rule":"repeated","type":"Annotation","id":1}},"nested":{"Annotation":{"fields":{"path":{"rule":"repeated","type":"int32","id":1,"options":{"packed":true}},"sourceFile":{"type":"string","id":2},"begin":{"type":"int32","id":3},"end":{"type":"int32","id":4},"semantic":{"type":"Semantic","id":5}},"nested":{"Semantic":{"values":{"NONE":0,"SET":1,"ALIAS":2}}}}}},"SymbolVisibility":{"edition":"proto2","values":{"VISIBILITY_UNSET":0,"VISIBILITY_LOCAL":1,"VISIBILITY_EXPORT":2}}}}}}}}')},98356:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.setup=void 0;let d=c(98675);class e{constructor(a,b,c){let d;this.listener=b,this.addresses=[],this.hasReturnedResult=!1,d=""===a.authority?"/"+a.path:a.path,this.addresses=[{path:d}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{}))}destroy(){}static getDefaultAuthority(a){return"localhost"}}b.setup=function(){(0,d.registerResolver)("unix",e)}},98675:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.mapUriDefaultScheme=b.getDefaultAuthority=b.createResolver=b.registerDefaultScheme=b.registerResolver=void 0;let d=c(30999),e={},f=null;b.registerResolver=function(a,b){e[a]=b},b.registerDefaultScheme=function(a){f=a},b.createResolver=function(a,b,c){if(void 0!==a.scheme&&a.scheme in e)return new e[a.scheme](a,b,c);throw Error(`No resolver could be created for target ${(0,d.uriToString)(a)}`)},b.getDefaultAuthority=function(a){if(void 0!==a.scheme&&a.scheme in e)return e[a.scheme].getDefaultAuthority(a);throw Error(`Invalid target ${(0,d.uriToString)(a)}`)},b.mapUriDefaultScheme=function(a){if(void 0===a.scheme||!(a.scheme in e))if(null!==f)return{scheme:f,authority:void 0,path:(0,d.uriToString)(a)};else return null;return a}},99408:(a,b,c)=>{"use strict";a.exports=j;var d,e=c(72481);((j.prototype=Object.create(e.prototype)).constructor=j).className="Field";var f=c(27791),g=c(18657),h=c(90290),i=/^required|optional|repeated$/;function j(a,b,c,d,f,j,k){if(h.isObject(d)?(k=f,j=d,d=f=void 0):h.isObject(f)&&(k=j,j=f,f=void 0),e.call(this,a,j),!h.isInteger(b)||b<0)throw TypeError("id must be a non-negative integer");if(!h.isString(c))throw TypeError("type must be a string");if(void 0!==d&&!i.test(d=d.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==f&&!h.isString(f))throw TypeError("extend must be a string");"proto3_optional"===d&&(d="optional"),this.rule=d&&"optional"!==d?d:void 0,this.type=c,this.id=b,this.extend=f||void 0,this.repeated="repeated"===d,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!h.Long&&void 0!==g.long[c],this.bytes="bytes"===c,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this.comment=k}j.fromJSON=function(a,b){var c=new j(a,b.id,b.type,b.rule,b.extend,b.options,b.comment);return b.edition&&(c._edition=b.edition),c._defaultEdition="proto3",c},Object.defineProperty(j.prototype,"required",{get:function(){return"LEGACY_REQUIRED"===this._features.field_presence}}),Object.defineProperty(j.prototype,"optional",{get:function(){return!this.required}}),Object.defineProperty(j.prototype,"delimited",{get:function(){return this.resolvedType instanceof d&&"DELIMITED"===this._features.message_encoding}}),Object.defineProperty(j.prototype,"packed",{get:function(){return"PACKED"===this._features.repeated_field_encoding}}),Object.defineProperty(j.prototype,"hasPresence",{get:function(){return!this.repeated&&!this.map&&(this.partOf||this.declaringField||this.extensionField||"IMPLICIT"!==this._features.field_presence)}}),j.prototype.setOption=function(a,b,c){return e.prototype.setOption.call(this,a,b,c)},j.prototype.toJSON=function(a){var b=!!a&&!!a.keepComments;return h.toObject(["edition",this._editionToJSON(),"rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",b?this.comment:void 0])},j.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=g.defaults[this.type])?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof d?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof f&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof f||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=h.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var a;h.base64.test(this.typeDefault)?h.base64.decode(this.typeDefault,a=h.newBuffer(h.base64.length(this.typeDefault)),0):h.utf8.write(this.typeDefault,a=h.newBuffer(h.utf8.length(this.typeDefault)),0),this.typeDefault=a}return this.map?this.defaultValue=h.emptyObject:this.repeated?this.defaultValue=h.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof d&&(this.parent.ctor.prototype[this.name]=this.defaultValue),e.prototype.resolve.call(this)},j.prototype._inferLegacyProtoFeatures=function(a){if("proto2"!==a&&"proto3"!==a)return{};var b={};if("required"===this.rule&&(b.field_presence="LEGACY_REQUIRED"),this.parent&&void 0===g.defaults[this.type]){var c=this.parent.get(this.type.split(".").pop());c&&c instanceof d&&c.group&&(b.message_encoding="DELIMITED")}return!0===this.getOption("packed")?b.repeated_field_encoding="PACKED":!1===this.getOption("packed")&&(b.repeated_field_encoding="EXPANDED"),b},j.prototype._resolveFeatures=function(a){return e.prototype._resolveFeatures.call(this,this._edition||a)},j.d=function(a,b,c,d){return"function"==typeof b?b=h.decorateType(b).name:b&&"object"==typeof b&&(b=h.decorateEnum(b).name),function(e,f){h.decorateType(e.constructor).add(new j(f,a,b,c,{default:d}))}},j._configure=function(a){d=a}}};var __webpack_require__=require("../webpack-runtime.js");__webpack_require__.C(exports);var __webpack_exec__=a=>__webpack_require__(__webpack_require__.s=a),__webpack_exports__=__webpack_require__.X(0,[195,509,273],()=>__webpack_exec__(65724));module.exports=__webpack_exports__})();